@&#MAIN-TITLE@&#A novel and provably secure biometrics-based three-factor remote authentication scheme for mobile client–server networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We point out that Yeh et al.’s scheme is not secure because it has several disadvantages in security.


                        
                        
                           
                           We point out that Khan et al.’s scheme is not secure with some weaknesses.


                        
                        
                           
                           We present a new three-factor scheme based on ECC.


                        
                        
                           
                           We prove our scheme secure with a formal proof and analysis.


                        
                        
                           
                           By comparing with some latest schemes, our scheme is more practical for application due to the security and efficiency.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Three-factor

Biometrics

Formal proof

User anonymity

@&#ABSTRACT@&#


               
               
                  The biometrics, the password and the storage device are the elements of the three-factor authentication. In 2013, Yeh et al. proposed a three-factor user authentication scheme based on elliptic curve cryptography. However, we find that it has weaknesses including useless user identity, ambiguous process, no session key and no mutual authentication. Also, it cannot resist the user forgery attack and the server spoofing attack. Moreover, Khan et al. propose a fingerprint-based remote authentication scheme with mobile devices. Unfortunately it cannot withstand the user impersonation attack and the De-synchronization attack. Furthermore, the user’s identity cannot be anonymous, either. To overcome the disadvantages, we propose a new three-factor remote authentication scheme and give a formal proof with strong forward security. It could provide the user’s privacy and is secure. Compared to some recent three-factor authentication schemes, our scheme is secure and practical.
               
            

@&#INTRODUCTION@&#

Nowadays, network communication develops faster and faster. But it is well-known to everyone that such open environment is insecure. An attacker may use every kind of information he can master to forge a legal user, or at least get useful data from the information. A remote user authentication scheme plays an important role in establishing communication over insecure channels. Researchers have studied two-factor authentication [1–3] schemes using both a password and a memory device for over 20years. Persons who own the two elements at the same time can login the special system. Furthermore, because biometrics recognition becomes a popular issue in the past decades, researchers have developed three-factor remote authentication schemes to enhance the security of network communication. With rapid development of mobile technology, mobile devices like PDAs, mobile cells turn to be the memory devices in authentication schemes. In recent years, many three-factor authentication schemes have been presented [4–17].

In 2009, Fan and Lin [4] proposed a three-factor authentication scheme with public-key and symmetric cryptosystems. In 2010, Li and Hwang [5] proposed a three-factor authentication scheme with low computation using only hash function. But Das [6] pointed out that Li-Hwang’s scheme had some design flaws and then presented a new biometrics-based scheme. However, An [7] showed that Das’s scheme had disadvantages like under the impersonation attack and the server spoofing attack. Then a new scheme was proposed after criticizing. Unfortunately Khan and Kumari [8] pointed out that An’s scheme was vulnerable to the password guessing attack and the forgery attack and lacked mutual authentication and user anonymity. User anonymity is an important character in evaluation nowadays. Also, the above schemes in [5–7] do not make the user’s identity hidden in the authentication phase. It is harmful for the users if their identities are exposing to attackers. However, Yeh et al. [9] claimed that design flaws existed in Fan et al.’s scheme and it was under the insider attack. So they presented a new biometrics-based scheme employing elliptic curve cryptosystem(ECC). Unfortunately, we find the scheme has the weaknesses including useless user identity, ambiguous login and authentication process, no session key and no mutual authentication. Furthermore, it could not resist the user impersonation attack.

In 2012, Chen et al. [11] proposed a new biometrics-based three-factor authentication scheme with mobile devices. In the same year, Truong et al. [12] claimed that Chen et al.’s scheme was under the replay attack, the forgery attack and without user anonymity. They gave their scheme after analysis. However, Khan et al. [13,18] criticized the above two schemes in [11,12] due to the off-line password guessing attack and so on. Khan et al. proposed a new scheme in [13]. However, we find that this scheme cannot keep user anonymity or strong forward security and is vulnerable to the user impersonation attack. Also, since the collected biometrics cannot be the same in different logins, Khan et al.’s scheme is under the De-synchronization attack. The meaning of this attack is that the relative data during a legal user’s normal authentication process are incongruous. For example, when the user’s biometric information input in the login phase is compared with the original template collected in the registration phase without pre-dealing tools, such as the fuzzy extractor, the attack will happen.

Furthermore, in this paper we present a new three-factor user authentication scheme using the mobile device to overcome the weaknesses and prove the scheme secure with a formal security model.

The remainder of the paper is organized as follows: Section 2 shows the preliminaries that contain notations used through the paper, some knowledge about ECC, fuzzy extractor and some premises for analyzing the paper. In Sections 3 and 4 we list schemes in [9,13] and point out their disadvantages. Our scheme is showed in Section 5. The formal security proof and security analysis of our scheme are in Sections 6 and 7 respectively. The performance comparison between our scheme and some recent schemes is in Section 8. Finally, the conclusion is in Section 9.

The notations are listed below:
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      PW
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       the i-th user with his identity, password and biometrics
                                    
                                    
                                       
                                          
                                             
                                                S
                                                ,
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                x
                                                ,
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       the remote server with its identity, private key and public key
                                    
                                    
                                       
                                          A
                                       
                                       the adversary/attacker
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       the security length parameter, for hash values and random numbers
                                    
                                    
                                       
                                          
                                             
                                                h
                                                (
                                                ·
                                                )
                                                ,
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                ·
                                                )
                                             
                                          
                                       
                                       one-way hash functions: 
                                             
                                                
                                                   
                                                      {
                                                      0
                                                      ,
                                                      1
                                                      }
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                
                                                ↦
                                                
                                                
                                                   
                                                      {
                                                      0
                                                      ,
                                                      1
                                                      }
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      sk
                                                   
                                                   
                                                      u
                                                   
                                                
                                                ,
                                                
                                                   
                                                      sk
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       session keys generated by 
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           and S respectively
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                ·
                                                )
                                                /
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      k
                                                   
                                                
                                                (
                                                ·
                                                )
                                             
                                          
                                       
                                       the symmetric encryption/decryption function with key k
                                       
                                    
                                    
                                       
                                          
                                             
                                                ⊕
                                                /
                                                ⊗
                                             
                                          
                                       
                                       X-OR/N-OR operation
                                    
                                 
                              
                           
                        
                     

The elliptic curve equation on 
                           
                              E
                              (
                              
                                 
                                    F
                                 
                                 
                                    p
                                 
                              
                              )
                           
                         is in the form: 
                           
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              +
                              ax
                              +
                              b
                              
                              mod
                              
                              p
                           
                        , where 
                           
                              a
                              ,
                              b
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              4
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              +
                              27
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              
                              mod
                              
                              p
                              
                              ≠
                              
                              0
                           
                        . We omit 
                           
                              mod
                              
                              p
                           
                         in the latter part.
                           Assumption 1
                           Elliptic curve discrete logarithm problem (ECDLP): given points 
                                 
                                    P
                                    ,
                                    Q
                                    ∈
                                    G
                                 
                              , it is hard to compute the integer 
                                 
                                    α
                                 
                               where 
                                 
                                    Q
                                    =
                                    α
                                    P
                                 
                              .

Elliptic curve Diffie–Hellman problem (ECDHP): given points 
                                 
                                    α
                                    P
                                    ,
                                    β
                                    P
                                    ∈
                                    G
                                 
                              , where 
                                 
                                    α
                                    ,
                                    β
                                 
                               are random integers, it is hard to compute the value 
                                 
                                    α
                                    β
                                    P
                                 
                              .


                        
                           Definition 1
                           Human beings’ biometrics can be extracted nearly uniform random strings via a 
                                 
                                    (
                                    M
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    l
                                    ,
                                    τ
                                    ,
                                    ∊
                                    )
                                 
                               fuzzy extractor. A fuzzy extractor includes a pair of randomized processes 
                                 
                                    (
                                    Gen
                                    ,
                                    Rep
                                    )
                                 
                              . w is the input biometrics for distribution W on M of min-entropy 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          e
                                       
                                    
                                 
                              . 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          l
                                       
                                    
                                 
                               is the extracted secret string. 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               is a helper string. Persons may input biometric information with error-tolerance by the fuzzy extractor. Moreover, (1) 
                                 
                                    Gen
                                    (
                                    w
                                    )
                                    =
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    )
                                 
                              : The fuzzy extractors make sure that the static distance 
                                 
                                    SD
                                    (
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    ,
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    )
                                    ⩽
                                    ∊
                                 
                               and 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          l
                                       
                                    
                                 
                               denotes the uniform distribution with l-bit binary strings. (2) 
                                 
                                    Rep
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                 
                              : The fuzzy extractors make sure that if 
                                 
                                    dis
                                    (
                                    w
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ⩽
                                    τ
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                 
                               were produced by Gen at first, 
                                 
                                    Rep
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                 
                              .

We list two special cases about the match process.
                           Definition 2
                           (1) The distance between two templates w and 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                 
                               for the same biometric information is low with high probability. That is to say, 
                                 
                                    Pr
                                    [
                                    dis
                                    (
                                    w
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ⩽
                                    τ
                                    ]
                                    ⩾
                                    1
                                    -
                                    
                                       
                                          ε
                                       
                                       
                                          fn
                                       
                                    
                                 
                              . Here 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          fn
                                       
                                    
                                 
                               is the “false negative” rate. (2) If 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          2
                                       
                                    
                                 
                               are biometric information distributions for two persons, the distance between their templates 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                 
                               is high with great probability. With a bound 
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    τ
                                    ,
                                    Pr
                                    [
                                    dis
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    >
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    ]
                                    ⩾
                                    1
                                    -
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                 
                              . 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                 
                               is the ”false positive” rate.


                        
                           Assumption 3
                           Some basic assumptions are illustrated below for analyzing the remote authentication schemes. (1) S’s private key x, hash values and random numbers resists guessing. (2) The collision of the hash function cannot be found in polynomial time. Also, the message encrypted by symmetric encryption algorithm cannot be decrypted by the attackers who do not own the key. (3) According to [4], the three-factor authentication must be secure even if A gets two of the three factors.

We show the abilities of the attacker A according to the listed remote three-factor authentication schemes in Section 1.

We concentrate on A’s abilities and the corresponding data without considering the way to achieve them. Note that Case (5) is a special point only to describe the character of strong forward security. (1) All users’ passwords are in a finite set and can be guessed by A. (2) A can control the insecure public channel between the users and S, such as eavesdropping, intercepting, creating and modifying any transmitted messages. (3) A may get the memory device from the user and extract information from it [19]. (4) A can know the previous session keys. (5) According to [3], even if A can get all of the user’s and the server’s long-term data, such as information in memory device and the server, and user’s identity, password and biometrics, he still cannot compute the past session keys. If this case is applied, Case (4) never happens.

Yeh et al.’s scheme consists of four phases: initiation, registration, login and authentication. They are as follows:


                           S chooses the finite cyclic additional group G generated by a point P with a large prime order n over a finite field 
                              
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                              
                            on an elliptic curve. Then 
                              
                                 x
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 xP
                              
                            and 
                              
                                 h
                                 (
                                 ·
                                 )
                              
                            are selected as S’s private key, the public key and the one-way hash function. At last, S stores x and publishes 
                              
                                 E
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 ,
                                 G
                                 ,
                                 P
                              
                            and 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                              
                           .


                           
                              
                                 1.
                                 
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     enters 
                                       
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                       
                                    , selects a random string 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and computes 
                                       
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                       
                                    . Then 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     sends 
                                       
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                       
                                     to S through a secure channel.

After receiving the message from 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          S
                                       
                                     computes 
                                       
                                          W
                                          =
                                          h
                                          (
                                          P
                                          ⊕
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                       
                                     and stores 
                                       
                                          W
                                          ,
                                          h
                                          (
                                          ·
                                          )
                                          ,
                                          P
                                       
                                     and 
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                          
                                       
                                     into a smart card and sends it to 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     via a secure channel.


                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     checks whether 
                                       
                                          W
                                          =
                                          h
                                          (
                                          P
                                          ⊕
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                       
                                     is right. If it is correct, 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     accepts the card. Then he stores the sketch 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                     using 
                                       
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                       
                                     as an encryption key.


                           
                              
                                 1.
                                 
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     inputs 
                                       
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and submits 
                                       
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    . The card decrypts 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                     and recovers 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                       
                                    . Then the card calculates 
                                       
                                          
                                             
                                                BB
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    .


                                    S computes W and verifies 
                                       
                                          W
                                          ?
                                          =
                                          h
                                          (
                                          P
                                          ⊕
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                       
                                    . If it is true, S accepts the login request. Otherwise, S rejects it.


                           
                              
                                 1.
                                 
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     chooses a private key 
                                       
                                          
                                             
                                                q
                                             
                                             
                                                u
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                       
                                     from 
                                       
                                          
                                             
                                                BB
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    , and computes 
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                          =
                                          
                                             
                                                q
                                             
                                             
                                                u
                                             
                                          
                                          P
                                          ,
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                q
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                u
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    . 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     makes 
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                       
                                     to be his public key and sends 
                                       
                                          
                                             
                                                m
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          {
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                          ,
                                          
                                             
                                                M
                                             
                                             
                                                u
                                             
                                          
                                          }
                                       
                                     to S.


                                    S computes 
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                xQ
                                             
                                             
                                                u
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                M
                                             
                                             
                                                u
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                       
                                     and checks 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                          ?
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                       
                                    . If it is false, S rejects the session.


                                    S selects a random point 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                       
                                     and computes 
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          P
                                          ,
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                M
                                             
                                             
                                                s
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    . Then S sends 
                                       
                                          
                                             
                                                m
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          {
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                M
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          }
                                       
                                     to S.


                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     checks 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          ?
                                          =
                                          
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    . If it is true, S is authenticated. Then 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     computes 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                M
                                             
                                             
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     and 
                                       
                                          L
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                       
                                     and sends L to S.


                                    S checks 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ?
                                          =
                                          L
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                u
                                             
                                          
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    . If it is true, S accepts 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                    ’s login request.

Moreover, in Section 5.2.4 of Yeh et al.’s paper, there is a password change phase. We also list the process here.


                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            selects a new password 
                              
                                 
                                    
                                       PW
                                    
                                    
                                       i
                                    
                                    
                                       new
                                    
                                 
                              
                            and sends 
                              
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 h
                                 (
                                 
                                    
                                       PW
                                    
                                    
                                       i
                                    
                                    
                                       new
                                    
                                 
                                 ⊕
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            to S. S computes 
                              
                                 
                                    
                                       W
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 h
                                 (
                                 P
                                 ⊕
                                 h
                                 (
                                 
                                    
                                       PW
                                    
                                    
                                       i
                                    
                                    
                                       new
                                    
                                 
                                 ⊕
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                              
                            and replaces W with 
                              
                                 
                                    
                                       W
                                    
                                    
                                       new
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                           ’s smart card.

We illustrate the weakness as follows: (1) The user 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            only inputs 
                              
                                 
                                    
                                       PW
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                            in the login phase. 
                              
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                              
                            is useless because it is not used. (2) In the login phase, no information is transmitted to S. We doubt how to validate W on the server side. In the registration phase, S only stores W into the smart card but not in itself. So it knows neither W nor 
                              
                                 h
                                 (
                                 
                                    
                                       PW
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                           . So step 2 of the login phase cannot be done. (3) At the beginning of authentication, 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            computes his public key 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       u
                                    
                                 
                              
                           . It is wasteful to compute a constant in every authentication. (4) In step 2 of Authentication, S checks 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                                 ?
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                              
                            after computing 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                    
                                       ′
                                    
                                 
                              
                           . It is strange because 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            does not send 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                              
                            to S. (5) In step 3 of Authentication, S computes 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 P
                              
                           . In fact, there is no new 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                              
                            produced by S. We can see that 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                              
                            in step 4 of Authentication. S need not compute 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                              
                            again. Furthermore, it is wasteful to send 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                              
                           . (6) In the registration and password change phases, 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            submits 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            to S, but S does not do anything referring to 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                           . So 
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            is useless in the two phases.

(1) For user impersonation attack: According to Yeh et al.’s scheme, 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       u
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                           ’s public key. That is to say, 
                              
                                 
                                    
                                       q
                                    
                                    
                                       u
                                    
                                 
                              
                            is always the same number. Similarly, 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       u
                                    
                                 
                                 xP
                              
                            is constant, too. So A can get one 
                              
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                              
                           , generate a random point 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and compute 
                              
                                 
                                    
                                       M
                                    
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                              
                           . The forged 
                              
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 }
                              
                            appears. After A gets 
                              
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 }
                                 ,
                                 L
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                              
                            can be calculated and sent to S. Until now the user impersonation attack is finished. (2) For server spoofing attack: If A gets 
                              
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       u
                                    
                                 
                                 }
                              
                           , it is easy to compute 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                              
                            from the message. Then he could calculate 
                              
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                              
                            and select a random point 
                              
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                              
                           . Finally 
                              
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                              
                            and a message 
                              
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       s
                                    
                                 
                                 }
                              
                            can be generated. So the server spoofing attack is successful.

There is no session key formed at the end of the authentication. That will make it easy for A to pretend to be one entity and eavesdrop the content in the following part of the session. Also, according to the last item, A can forge all the messages in the channel. So this scheme does not reach mutual authentication.

Khan et al.’s scheme has four phases: registration, login, mutual authentication and session key agreement and password change. The password change phase does not relate to the attacks, so we omit it here. Furthermore, in this scheme, 
                           
                              
                                 
                                    ID
                                 
                                 
                                    s
                                 
                              
                           
                         is a secret identity only known by S.


                           
                              
                                 1.
                                 
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     chooses 
                                       
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and inputs them with the biometrics 
                                       
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                       
                                    . 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                     is a random number. Then 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     submits the message to S via a secure channel.


                                    S generates a random number 
                                       
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                       
                                    , computes the following data: 
                                       
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ⊗
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          h
                                          (
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          )
                                          ⊕
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                h
                                             
                                             
                                                h
                                                (
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊕
                                                h
                                                (
                                                x
                                                ∥
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∥
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      s
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    . Then it sends 
                                       
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                     to the user’s mobile device through a secure channel.


                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     stores the data and injects 
                                       
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                     into the mobile device.


                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            inputs 
                              
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       PW
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            on sensor and the mobile device does the following steps:
                              
                                 1.
                                 Calculates 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          (
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ⊕
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          h
                                          (
                                          
                                             
                                                PW
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ⊗
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                G
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and checks 
                                       
                                          
                                             
                                                h
                                             
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ?
                                          =
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                       
                                    . If the equation does not hold, the session terminates.

Generates a nonce 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                       
                                     and computes the data: 
                                       
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          ⊕
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                RCID
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          )
                                          ⊕
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                C
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                h
                                             
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    . Then the message 
                                       
                                          {
                                          
                                             
                                                RCID
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                3
                                             
                                          
                                          }
                                       
                                     is sent to S.


                           
                              
                                 1.
                                 
                                    S computes 
                                       
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          =
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                RCID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          )
                                          ⊕
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     with checking 
                                       
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                       
                                    . Then it calculates 
                                       
                                          h
                                          (
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          )
                                       
                                     and checks 
                                       
                                          
                                             
                                                C
                                             
                                             
                                                3
                                             
                                          
                                          ?
                                          =
                                          
                                             
                                                h
                                             
                                             
                                                h
                                                (
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊕
                                                h
                                                (
                                                x
                                                ∥
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ∥
                                                
                                                   
                                                      ID
                                                   
                                                   
                                                      s
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    . If they are not equal, rejects the session. S generates a nonce 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                       
                                    , computes 
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          h
                                          (
                                          h
                                          (
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          )
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ⊕
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     and sends 
                                       
                                          {
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                     to 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                    .


                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     computes 
                                       
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          =
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          ⊕
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                       
                                     and checks 
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ?
                                          =
                                          h
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    . If the equation does not hold, the mobile device rejects the session. Otherwise, it computes 
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          h
                                          (
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ∥
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          )
                                       
                                     and sends 
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                     to S. 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                       
                                     computes the session key 
                                       
                                          
                                             
                                                sk
                                             
                                             
                                                u
                                             
                                          
                                          =
                                          h
                                          (
                                          
                                             
                                                G
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          ⊕
                                          
                                             
                                                hpw
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          )
                                       
                                    .


                                    S checks 
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                          ?
                                          =
                                          h
                                          (
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ∥
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          )
                                       
                                    . If it is right, S calculates 
                                       
                                          
                                             
                                                sk
                                             
                                             
                                                s
                                             
                                          
                                          =
                                          h
                                          (
                                          h
                                          (
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ⊕
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          ∥
                                          
                                             
                                                N
                                             
                                             
                                                s
                                             
                                          
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                i
                                             
                                          
                                          ∥
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          ∥
                                          h
                                          (
                                          x
                                          ∥
                                          
                                             
                                                ID
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          )
                                       
                                    . Otherwise S terminates the session.

A registered attacker A can calculate 
                              
                                 
                                    
                                       N
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       ID
                                    
                                    
                                       A
                                    
                                 
                                 ⊕
                                 
                                    
                                       N
                                    
                                    
                                       A
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       ID
                                    
                                    
                                       A
                                    
                                 
                                 ,
                                 
                                    
                                       hpw
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 h
                                 (
                                 
                                    
                                       PW
                                    
                                    
                                       A
                                    
                                 
                                 ∥
                                 
                                    
                                       N
                                    
                                    
                                       A
                                    
                                 
                                 )
                                 ⊗
                                 
                                    
                                       B
                                    
                                    
                                       A
                                    
                                 
                              
                            and 
                              
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       A
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       A
                                    
                                 
                              
                            by retrieving 
                              
                                 (
                                 
                                    
                                       ID
                                    
                                    
                                       A
                                    
                                 
                                 ⊕
                                 
                                    
                                       N
                                    
                                    
                                       A
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       A
                                    
                                 
                              
                            from his own mobile device. 
                              
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                            is used for every registered user. Then if A gets 
                              
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            from 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                           ’s mobile device and 
                              
                                 (
                                 
                                    
                                       RCID
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            from 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                            in the public channel and computes 
                              
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 h
                                 (
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ⊕
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       RCID
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 h
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                                 )
                                 ⊕
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                           . So A can get 
                              
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                              
                           ’s real identity 
                              
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                              
                            and Khan et al.’s scheme cannot make the users anonymous.

After the above operations, A has mastered 
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                              
                           . He can select a random number 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                              
                            to produce the message 
                              
                                 {
                                 
                                    
                                       RCID
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 }
                              
                            according to the login steps. Once receiving from 
                              
                                 S
                                 ,
                                 A
                              
                            can compute 
                              
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 ⊕
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                           . 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                              
                            is constructed by 
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                 
                              
                            and 
                              
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                           . 
                              
                                 
                                    
                                       sk
                                    
                                    
                                       u
                                    
                                 
                              
                            is built with 
                              
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                              
                           . So the whole attack process can be perfectly finished.

In each login phase, the mobile device uses the temporary input biometrics 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            to calculate 
                              
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                              
                           , and checks 
                              
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ?
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                              
                           . Without the pre-dealing tool, like a fuzzy extractor, the checking is hard to pass and the De-synchronization attack appears.

Once A gets 
                              
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 ,
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                            and 
                              
                                 h
                                 (
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⊕
                                 h
                                 (
                                 x
                                 ∥
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                           , he can calculate every session key 
                              
                                 h
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 
                                    
                                       N
                                    
                                    
                                       s
                                    
                                 
                                 ∥
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 
                                    
                                       ID
                                    
                                    
                                       i
                                    
                                 
                                 ∥
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ⊕
                                 
                                    
                                       hpw
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ∥
                                 
                                    
                                       N
                                    
                                    
                                       u
                                    
                                 
                                 )
                              
                            in every session without the long-term secret keys, such as x. So the scheme lacks strong forward security.

Our scheme contains five phases: Initialization, Registration, Login, Authentication and Password change. The login and authentication phases are in Fig. 1
                     .


                        S produces 
                           
                              E
                              (
                              
                                 
                                    F
                                 
                                 
                                    p
                                 
                              
                              )
                              ,
                              G
                           
                         and P like Yeh et al.’s scheme. But there is no public key 
                           
                              
                                 
                                    Q
                                 
                                 
                                    s
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ID
                                 
                                 
                                    s
                                 
                              
                           
                         is known in the system.


                        
                           
                              1.
                              A user 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  chooses his identity 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , password 
                                    
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and a nonce 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , imprints 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                    
                                  via a terminal and gets 
                                    
                                       Gen
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             bi
                                          
                                       
                                       )
                                    
                                 . Then 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  submits 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             H
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                       
                                       )
                                       ⊕
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to S through a secure channel.


                                 S chooses a random number 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , computes 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             s
                                          
                                       
                                       ∥
                                       x
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ⊕
                                       
                                          
                                             H
                                          
                                          
                                             i
                                          
                                       
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       x
                                       )
                                       ⊕
                                       
                                          
                                             H
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and then sends 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       P
                                    
                                  and 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  via a secure channel.


                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  computes 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       ⊕
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       ⊕
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . Then 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  stores 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       P
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             bi
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                    
                                  into a mobile device.


                        
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         inputs 
                           
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                           
                         on the terminal. The mobile device selects random numbers 
                           
                              α
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    n
                                 
                                 
                                    ∗
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                        , and computes the data: 
                           
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                              =
                              Rep
                              (
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    bi
                                 
                              
                              )
                              ,
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              =
                              α
                              P
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ⊕
                              h
                              (
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                              )
                              ⊕
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              )
                              ⊕
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ⊕
                              h
                              (
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                              )
                              ,
                              
                                 
                                    C
                                 
                                 
                                    4
                                 
                              
                              =
                              h
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ∥
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ∥
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                              ∥
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    5
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    C
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        . Then 
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         sends the message 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                              =
                              {
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         to S.


                        
                           
                              1.
                              Once S receives 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                    
                                 , it computes 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             s
                                          
                                       
                                       ∥
                                       x
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ⊕
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                 , and decrypts 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             5
                                          
                                       
                                    
                                  to get 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             4
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . Then it calculates 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       x
                                       )
                                    
                                  and checks 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             4
                                          
                                          
                                             ′
                                          
                                       
                                       ?
                                       =
                                       h
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 . If it is not right, S rejects the session. If three wrong 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                    
                                  appear in a defined short time, 
                                    
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                    
                                  will be frozen. Otherwise, S does the following step.


                                 S chooses random numbers 
                                    
                                       β
                                       ∈
                                       
                                          
                                             Z
                                          
                                          
                                             n
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                 , and calculates the data: 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             6
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             s
                                          
                                       
                                       ∥
                                       x
                                       ∥
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       x
                                       )
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             7
                                          
                                       
                                       =
                                       β
                                       P
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       ⊕
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ⊕
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             9
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       x
                                       )
                                       ⊕
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             sk
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             7
                                          
                                       
                                       ∥
                                       β
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             10
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             ID
                                          
                                          
                                             s
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             6
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             8
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             9
                                          
                                       
                                       ∥
                                       
                                          
                                             sk
                                          
                                          
                                             s
                                          
                                       
                                       ∥
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             11
                                          
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   9
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             6
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             8
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             10
                                          
                                       
                                       )
                                    
                                 . Then S sends 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             C
                                          
                                          
                                             7
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             11
                                          
                                       
                                       }
                                    
                                  to 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                 .

After 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  receives 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                    
                                 , the mobile device computes 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             9
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                       
                                       ⊕
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , decrypts 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             11
                                          
                                       
                                    
                                  and gets 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             6
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             8
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             10
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . Then the mobile device calculates 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             8
                                          
                                          
                                             ′
                                          
                                       
                                       ⊕
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ⊕
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             sk
                                          
                                          
                                             u
                                          
                                       
                                       =
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             7
                                          
                                       
                                       ∥
                                       α
                                       
                                          
                                             C
                                          
                                          
                                             7
                                          
                                       
                                       )
                                    
                                  and checks 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             10
                                          
                                          
                                             ′
                                          
                                       
                                       ?
                                       =
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             ID
                                          
                                          
                                             s
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             6
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             8
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             9
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             sk
                                          
                                          
                                             u
                                          
                                       
                                       ∥
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 . If the equation does not hold, 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  will stop the session.

The mobile device computes 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             new
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             6
                                          
                                          
                                             ′
                                          
                                       
                                       ⊕
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                       
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                       
                                       )
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             ID
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                       )
                                    
                                 , and replaces 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                    
                                  with 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             new
                                          
                                       
                                    
                                  respectively.


                        
                           
                              1.
                              
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  does the Login phase, and sends an extra password change request to S. S does the first step of Authentication. If it is right, S computes 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       h
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 , and sends 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             a
                                          
                                       
                                    
                                  with a permission to 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . Otherwise, S rejects the request.

When 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                    
                                  receives 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             a
                                          
                                       
                                    
                                  and the permission, he first checks 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             a
                                          
                                       
                                       ?
                                       =
                                       h
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ∥
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 . If it is right, he will input a new password 
                                    
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                    
                                  and new biometric information 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                    
                                  at the same time in the terminal. The mobile device computes 
                                    
                                       Gen
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                       )
                                       =
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                          
                                             new
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             bi
                                          
                                          
                                             new
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             new
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                       
                                       )
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                       ∥
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                          
                                             new
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                          
                                             new
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                       
                                       ∥
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                       
                                       )
                                       ⊕
                                       h
                                       (
                                       
                                          
                                             PW
                                          
                                          
                                             i
                                          
                                          
                                             new
                                          
                                       
                                       ∥
                                       
                                          
                                             R
                                          
                                          
                                             bi
                                          
                                          
                                             new
                                          
                                       
                                       )
                                    
                                 . Then it replaces 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             bi
                                          
                                       
                                    
                                  with 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                          
                                             new
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                          
                                             new
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             bi
                                          
                                          
                                             new
                                          
                                       
                                    
                                  respectively.

Based on [20], we prove our scheme with a formal security model. Here we suppose that only a user U and a server S join our protocol 
                           
                              P
                           
                        . During the execution of 
                           
                              P
                              ,
                              U
                           
                         and S can have many instances, respectively. Each instance owns a number k and is an oracle. One instance is an execution of 
                           
                              P
                           
                        . We use 
                           
                              
                                 
                                    U
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                           
                         as the k-th instance for U and S, or 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         with no differentiation. An oracle has three possible states: accept, reject or 
                           
                              ⊥
                           
                        . The oracle reaches the accept state when it receives the correct message. Otherwise it reaches the reject state. If no decision has occurred or no result has been returned, the state 
                           
                              ⊥
                           
                         appears. Here we omit the three-time limitation in the authentication phase.

Before the instances begin, U has registered on S and owns an identity ID, a password PW, his biometrics B and a mobile device including 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              P
                              ,
                              
                                 
                                    P
                                 
                                 
                                    b
                                 
                              
                           
                         and e. S owns the secret key x and an identity 
                           
                              
                                 
                                    ID
                                 
                                 
                                    s
                                 
                              
                           
                        . PW is in a dictionary D with quantity 
                           
                              ∣
                              D
                              ∣
                           
                        .

According to Section 2.4, the attacker A completely controls the channel, and tries to break the privacy of the authentication processes or the session keys. A can make some styles of queries and get answers.

Some definitions are listed to explain the security of the scheme as follows and readers can find the referred queries for our scheme in Table 1
                        .


                        
                           
                              Partnering
                              :
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         or 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         has a partner 
                           
                              
                                 
                                    pid
                                 
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         or 
                           
                              
                                 
                                    pid
                                 
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                        , a session key 
                           
                              
                                 
                                    sk
                                 
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         or 
                           
                              
                                 
                                    sk
                                 
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         and a session identity 
                           
                              
                                 
                                    sid
                                 
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         or 
                           
                              
                                 
                                    sid
                                 
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         if it is accepted and has formed a session key. 
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         are partners when 
                           
                              
                                 
                                    pid
                                 
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    pid
                                 
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    sid
                                 
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    sid
                                 
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    sk
                                 
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    sk
                                 
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                        .


                        
                           
                              sfs
                              -
                              fresh
                              :
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         is 
                           
                              sfs
                              -
                              fresh
                           
                         while any of the following condition does not occur: (1) A 
                           
                              Reveal
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         or 
                           
                              Reveal
                              (
                              
                                 
                                    pid
                                 
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         appears. (2) A 
                           
                              Corrupt
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         or 
                           
                              Corrupt
                              (
                              
                                 
                                    pid
                                 
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         happens before 
                           
                              Test
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        . (3) For 
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                        , all three kinds of 
                           
                              Corrupt
                              (
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              ,
                              z
                              )
                           
                         are asked.


                        
                           
                              sfs
                              -
                              security
                           
                        : We define that the advantage of the adversary A against 
                           
                              P
                           
                         is the probability of correctly guessing the bit b, which is generated in the 
                           
                              Test
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         query. Also, 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                           
                         is accepted and 
                           
                              sfs
                              -
                              fresh
                           
                        . If A outputs 
                           
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                           
                        , the advantage is defined as 
                           
                              
                                 
                                    Adv
                                 
                                 
                                    P
                                 
                                 
                                    sfs
                                 
                              
                              (
                              A
                              )
                              =
                              2
                              Pr
                              [
                              b
                              =
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                              ]
                              -
                              1
                           
                        . We consider our scheme is 
                           
                              sfs
                              -
                              secure
                           
                         if 
                           
                              
                                 
                                    Adv
                                 
                                 
                                    P
                                 
                                 
                                    sfs
                                 
                              
                              (
                              A
                              )
                           
                         is negligibly greater than 
                           
                              max
                              {
                              O
                              (
                              
                                 
                                    q
                                 
                                 
                                    s
                                 
                              
                              )
                              (
                              
                                 
                                    1
                                 
                                 
                                    ∣
                                    D
                                    ∣
                                 
                              
                              ,
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    ε
                                 
                                 
                                    fp
                                 
                              
                              )
                              }
                           
                        , depending on the security parameter 
                           
                              
                                 
                                    l
                                 
                                 
                                    s
                                 
                              
                           
                        . Here 
                           
                              
                                 
                                    q
                                 
                                 
                                    s
                                 
                              
                           
                         is the query times of 
                           
                              Send
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              ,
                              m
                              )
                           
                        .

Moreover, we list two extra computation assumptions.
                           
                              1.
                              Elliptic Curve Decisional Diffie–Hellman (ECDDH) assumption: 
                                    
                                       aP
                                       ,
                                       bP
                                    
                                  and cP are elements in G. A can decide if 
                                    
                                       cP
                                       =
                                       abP
                                    
                                 .

Elliptic Curve Gap Diffie–Hellman (ECGDH) assumption: Given aP and bP in G, the probability of calculating abP with an ECDDH oracle in time t is 
                                    
                                       
                                          
                                             Adv
                                          
                                          
                                             G
                                          
                                          
                                             ECGDH
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                 .


                        
                           Theorem 1
                           
                              G is a cyclic group on an elliptic curve with order n. D is the password dictionary with size 
                              
                                 
                                    ∣
                                    D
                                    ∣
                                 
                              
                              . The security length 
                              
                                 
                                    
                                       
                                          l
                                       
                                       
                                          s
                                       
                                    
                                 
                               
                              is for hash values and random numbers. l is the length of extracted biometric secret string and 
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                 
                               
                              is the probability of “false positive”. 
                              
                                 
                                    P
                                 
                               
                              is our scheme. For any attacker A running with time upper bound t makes Send queries, Execute queries and hash oracle queries 
                              
                                 
                                    h
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                               
                              for 
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          h
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                               
                              times, where 
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    t
                                    +
                                    O
                                    (
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                    )
                                    
                                       
                                          T
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          m
                                       
                                    
                                 
                               
                              is the time of a scalar multiplication in G,
                              
                                 
                                    (1)
                                    
                                       
                                          
                                             Adv
                                          
                                          
                                             P
                                          
                                          
                                             sfs
                                          
                                       
                                       (
                                       A
                                       )
                                       ⩽
                                       
                                          
                                             O
                                             (
                                             
                                                
                                                   (
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             n
                                             -
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             O
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             O
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   s
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       +
                                       max
                                       
                                          
                                             
                                                2
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               ∣
                                                               D
                                                               ∣
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               ε
                                                            
                                                            
                                                               fp
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       O
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   s
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   e
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             Adv
                                          
                                          
                                             G
                                          
                                          
                                             ECGDH
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       )
                                    
                                 
                              
                           

We define games from 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                 
                               to 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          5
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          Succ
                                       
                                       
                                          i
                                       
                                    
                                 
                               is the event that A guesses the bit b for 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          i
                                       
                                    
                                 
                               in the test session successfully. According to our model, A need not guess or compute the user’s identity due to only one user. The games are listed as follows:


                              Game 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          0
                                       
                                    
                                 
                              : This is the real scheme with the random oracle model. We see that 
                                 
                                    
                                       
                                          Adv
                                       
                                       
                                          P
                                       
                                       
                                          sfs
                                       
                                    
                                    (
                                    A
                                    )
                                    =
                                    2
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                    -
                                    1
                                 
                              . We choose a random bit 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                 
                               if the game aborts or stops without answers from A or A has not finished the games due to more queries or more time than the upper bounds.


                              Game 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                 
                              : We simulate all the oracles for queries and use three lists to store the answers to the oracles. 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          h
                                       
                                    
                                 
                               stores the answers to hash oracles. But if the random oracles are queried by A, the records are stored in 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                              . 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          P
                                       
                                    
                                 
                               is for transcripts between U and S. All oracles are demonstrated in Table 1. Through the simulation, 
                                 
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                    =
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                 
                              .


                              Game 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                 
                              : We simulate all oracles in game 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                 
                              , but some collisions should be avoided on the transcripts. 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          7
                                       
                                    
                                 
                               may be the same points and 
                                 
                                    e
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                 
                               and u may be the same random numbers in different transcripts. Also, collisions may happen among hash values. If the above cases occur, the game is aborted. 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                 
                               are indistinguishable unless the collisions of points, hash values and random numbers appear. According to birthday paradox, we can see that 
                                 
                                    ∣
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                    -
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                    ∣
                                    ⩽
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          2
                                          (
                                          n
                                          -
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              .


                              Game 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          3
                                       
                                    
                                 
                              : In this game, we abort the game if A has luckily calculated correct 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          11
                                       
                                    
                                 
                               without hash queries. According to 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    ID
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          11
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                9
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          6
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          8
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                    )
                                 
                              , it means that A has obtained correct 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          8
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          9
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                 
                              . Here we define 
                                 
                                    K
                                    1
                                    =
                                    h
                                    (
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    x
                                    ∥
                                    e
                                    )
                                    ,
                                    K
                                    2
                                    =
                                    h
                                    (
                                    ID
                                    ∥
                                    x
                                    )
                                 
                               and 
                                 
                                    K
                                    3
                                    =
                                    h
                                    (
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    x
                                    ∥
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                              . And we can see: 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    K
                                    1
                                    ⊕
                                    u
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    K
                                    2
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    h
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∥
                                    K
                                    1
                                    ⊕
                                    u
                                    ∥
                                    K
                                    2
                                    ∥
                                    e
                                    )
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          6
                                       
                                    
                                    =
                                    K
                                    2
                                    ⊕
                                    K
                                    3
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    K
                                    1
                                    ⊕
                                    e
                                    ⊕
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          9
                                       
                                    
                                    =
                                    K
                                    2
                                    ⊕
                                    u
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                    =
                                    h
                                    (
                                    ID
                                    ∥
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    K
                                    2
                                    ⊕
                                    K
                                    3
                                    ∥
                                    K
                                    1
                                    ⊕
                                    e
                                    ⊕
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ∥
                                    K
                                    2
                                    ⊕
                                    u
                                    ∥
                                    sk
                                    ∥
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    )
                                 
                              .

Because e,
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                 
                               and u can be selected with no limitation, we can only discuss 
                                 
                                    K
                                    1
                                    ,
                                    K
                                    2
                                    ,
                                    K
                                    3
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          4
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                 
                              . They only appear in Send queries. Some rules in Send queries should be changed to achieve the goal.

To respond to 
                                 
                                    Send
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    e
                                    )
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                 
                               should check if 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∥
                                    K
                                    1
                                    ⊕
                                    u
                                    ∥
                                    K
                                    2
                                    ∥
                                    e
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          4
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    e
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          P
                                       
                                    
                                 
                              . If either of them fails, S terminates the game. The probability for this is bounded by 
                                 
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              .

Moreover, if a legal user produces 
                                 
                                    K
                                    1
                                 
                               and 
                                 
                                    K
                                    2
                                 
                              , he has to ask the hash query 
                                 
                                    (
                                    PW
                                    ∥
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                    ∗
                                    )
                                 
                              . Neither PW or 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                 
                               is known by S. So S cannot check this case and the rules for 
                                 
                                    Send
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    e
                                    )
                                 
                               cannot be changed. Also, 
                                 
                                    (
                                    ID
                                    ∥
                                    e
                                    ,
                                    ∗
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                               should be checked. Third, 
                                 
                                    K
                                    1
                                 
                               and 
                                 
                                    K
                                    2
                                 
                               are hash values appearing in the oracle 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∥
                                    K
                                    1
                                    ⊕
                                    u
                                    ∥
                                    K
                                    2
                                    ∥
                                    e
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              . So the probability for the case is bounded by 
                                 
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              .

To respond to 
                                 
                                    Send
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          11
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                 
                               should check if 
                                 
                                    (
                                    1
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          7
                                       
                                    
                                    ∥
                                    ∗
                                    ,
                                    ∗
                                    )
                                    ,
                                    (
                                    ID
                                    ∥
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          6
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          8
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          9
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    ∗
                                    ∥
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    e
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          11
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          P
                                       
                                    
                                 
                              . If any of them fails, 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                 
                               stops the game. The probability is bounded by 
                                 
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               for 
                                 
                                    (
                                    1
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          7
                                       
                                    
                                    ∥
                                    ∗
                                    ,
                                    ∗
                                    )
                                 
                              , and 
                                 
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               for 
                                 
                                    (
                                    ID
                                    ∥
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          6
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          8
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          9
                                       
                                       
                                          ′
                                       
                                    
                                    ∥
                                    ∗
                                    ∥
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                    )
                                 
                              .

Furthermore, suppose that A has asked hash queries for 
                                 
                                    (
                                    ID
                                    ∥
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    K
                                    2
                                    ⊕
                                    K
                                    3
                                    ∥
                                    K
                                    1
                                    ⊕
                                    e
                                    ⊕
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ∥
                                    K
                                    2
                                    ⊕
                                    u
                                    ∥
                                    ∗
                                    ∥
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          10
                                       
                                    
                                    )
                                 
                              , the user should check if 
                                 
                                    (
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    ∗
                                    ∥
                                    e
                                    ,
                                    K
                                    1
                                    )
                                    ,
                                    (
                                    ID
                                    ∥
                                    ∗
                                    ,
                                    K
                                    2
                                    )
                                    ,
                                    (
                                    
                                       
                                          ID
                                       
                                       
                                          s
                                       
                                    
                                    ∥
                                    ∗
                                    ∥
                                    
                                       
                                          e
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    K
                                    3
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                              . If any of them fails, the game aborts. The probability of this case is bounded by 
                                 
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              .

The two games 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          3
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                 
                               are indistinguishable unless S rejects 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                 
                               or 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                 
                               rejects 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          11
                                       
                                    
                                 
                              . So we have 
                                 
                                    ∣
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                    -
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                    ∣
                                    ⩽
                                    
                                       
                                          O
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              .


                              Game 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          4
                                       
                                    
                                 
                              : In this game, we bring in the ECGDH problem. If A can get the session key 
                                 
                                    
                                       
                                          sk
                                       
                                       
                                          u
                                       
                                    
                                 
                               or 
                                 
                                    
                                       
                                          sk
                                       
                                       
                                          s
                                       
                                    
                                 
                               successfully and win the game, we claim that we use A to solve the ECGDH problem. From Section 5, anyone can see that if A can compute the session key, he must ask a 
                                 
                                    (
                                    1
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ∥
                                    
                                       
                                          C
                                       
                                       
                                          7
                                       
                                    
                                    ∥
                                    ∗
                                    )
                                 
                               query. Here we denote the query as 
                                 
                                    (
                                    1
                                    ,
                                    α
                                    P
                                    ∥
                                    β
                                    P
                                    ∥
                                    α
                                    β
                                    P
                                    )
                                 
                              . So the 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    q
                                    )
                                 
                               query should be modified as follows: Once A queries 
                                 
                                    (
                                    1
                                    ,
                                    α
                                    P
                                    ∥
                                    β
                                    P
                                    ∥
                                    X
                                    )
                                 
                              , we check if 
                                 
                                    (
                                    1
                                    ,
                                    α
                                    P
                                    ∥
                                    β
                                    P
                                    ∥
                                    ∗
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                              . If it exists, 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                               is the answer. Otherwise, we check 
                                 
                                    X
                                    ?
                                    =
                                    ECDDH
                                    (
                                    α
                                    P
                                    ,
                                    β
                                    P
                                    )
                                 
                               by the ECDDH oracle. If X is wrong, we reject the query. If X is right and the corresponding 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                               does not exist, we choose a random string 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                              , answer A with 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                               and store 
                                 
                                    (
                                    1
                                    ,
                                    α
                                    P
                                    ∥
                                    β
                                    P
                                    ∥
                                    X
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               into 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                              .

According to the previous games, all hash results are random. So A has no advantage in guessing the session key sk in the test session only if A can successfully pass the 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                               oracle above. We call this event Guessing. Obviously we can see that 
                                 
                                    ∣
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                    -
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                    ∣
                                    =
                                    Pr
                                    [
                                    Guessing
                                    ]
                                 
                              .

According to Section 2, the basis of discussing three-factor security is that the adversary can get data for at most two factors. We divide Guessing into two cases: online guessing attack and off-line attack.


                              Case 1: The attacker A can use the 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    z
                                    )
                                 
                               query to get two factors before online guessing. If A gets PW and B, he has no way to start queries due to lack of data in the mobile device. So 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    1
                                    )
                                 
                               is necessary for A and two subcases can be divided.


                              Subcase 1: A has also queried 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    2
                                    )
                                 
                               and needs to do online password guessing. He selects a password from D and makes 
                                 
                                    Send
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    e
                                    )
                                 
                               queries. Suppose that the wrong passwords A used are abandoned and the number of them is 
                                 
                                    wrong
                                 
                              , the probability that the next password is wrong is bounded by 
                                 
                                    1
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          ∣
                                          D
                                          ∣
                                          -
                                          wrong
                                       
                                    
                                 
                               where 
                                 
                                    wrong
                                    ⩽
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                 
                              . A can win in this Subcase with probability 
                                 
                                    Pr
                                    [
                                    Subcase
                                    1
                                    ]
                                    =
                                    1
                                    -
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          ∣
                                          D
                                          ∣
                                          -
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                          
                                       
                                       
                                          ∣
                                          D
                                          ∣
                                       
                                    
                                 
                              .


                              Subcase 2: A has also queried 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                               and tries to pass the biometrics checking. In fact there are two ways to do this. One is guessing 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                 
                              , with the probability 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                 
                               each time. The other is the possible accident ”false positive” case with probability 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                 
                              . For example, according to [20], it is suitable that 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                    ≈
                                    
                                       
                                          2
                                       
                                       
                                          -
                                          14
                                       
                                    
                                 
                              . So this Subcase is bounded by 
                                 
                                    max
                                    {
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                    )
                                    }
                                 
                              .


                              Case 2: First A uses 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    1
                                    )
                                 
                               to get the information stored in mobile device, then he asks 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                               or 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    2
                                    )
                                 
                               and sends 
                                 
                                    Execute
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                               and hash oracles. The result of one 
                                 
                                    Execute
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                               can be produced in two ways: one is a pure Execute query; the other is using successive Send queries. We know that A should ask 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                               to win and then the ECGDH problem is broken. We can get 
                                 
                                    α
                                    β
                                    P
                                 
                               from 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          A
                                       
                                    
                                 
                               with the bounded probability 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              . So we get 
                                 
                                    Pr
                                    [
                                    Case
                                    2
                                    ]
                                    ⩽
                                    O
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          Adv
                                       
                                       
                                          G
                                       
                                       
                                          ECGDH
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    )
                                 
                               where 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    t
                                    +
                                    O
                                    (
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                    )
                                    
                                       
                                          T
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                              .

We can see that 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          4
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          3
                                       
                                    
                                 
                               are indistinguishable unless Guessing occurs. So 
                                 
                                    ∣
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                    -
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                    ∣
                                    ⩽
                                    max
                                    {
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          1
                                       
                                       
                                          ∣
                                          D
                                          ∣
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ε
                                       
                                       
                                          fp
                                       
                                    
                                    )
                                    }
                                    +
                                    O
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          Adv
                                       
                                       
                                          G
                                       
                                       
                                          ECGDH
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    )
                                 
                              .


                              Game 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          5
                                       
                                    
                                 
                              : In this game, we think about the strong forward security mentioned in Section 2. According to the definition of 
                                 
                                    sfs
                                    -
                                    fresh
                                    ,
                                    A
                                 
                               only can ask 
                                 
                                    Corrupt
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                               query after 
                                 
                                    Test
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                               query. That means this situation only appears in the old games. For this situation, once A queries for Execute or hash oracles, the answers are selected from old transcripts. We choose two indexes 
                                 
                                    γ
                                    ,
                                    δ
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    …
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          e
                                       
                                    
                                    }
                                 
                              . If the Test query does not corresponding to the case that U and S involved in 
                                 
                                    γ
                                 
                              -th query and 
                                 
                                    δ
                                 
                              -th query respectively, the game is aborted. According to the last case of Game 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          4
                                       
                                    
                                 
                              , we can see that 
                                 
                                    ∣
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          5
                                       
                                    
                                    ]
                                    -
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                    ∣
                                    ⩽
                                    O
                                    (
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                s
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                e
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          Adv
                                       
                                       
                                          P
                                       
                                       
                                          ECGDH
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    )
                                 
                              .

After the above discussion, A has no advantage in guessing b. So 
                                 
                                    Pr
                                    [
                                    
                                       
                                          Succ
                                       
                                       
                                          5
                                       
                                    
                                    ]
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              . Combining the above games, Theorem 1 is obtained.□

In this Section, we show some concrete reasons to explain the security of our scheme and compare with some recent schemes [9,13–17] in Table 2
                     . We use 
                        
                           ✓
                           ,
                           ×
                        
                      and 
                        
                           ?
                        
                      to denote that the scheme satisfies, does not satisfy and has no relation to the corresponding character.

The password 
                           
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                           
                         and the biometric secret string 
                           
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                           
                         are both protected by the hash function and a random number 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                         in the form of 
                           
                              h
                              (
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                              )
                              ⊕
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                        . So it can resist this attack. They cannot be got or guessed by the malicious administrator of the server S.

We suppose A gets 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    bi
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           
                         from 
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                        ’s mobile device and the transcription 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    7
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    11
                                 
                              
                              )
                           
                         from the communication channel. To satisfy three-factor security, we suppose A gets two factors of 
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                        . If 
                           
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                           
                         or 
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                           
                         is compromised, A should try for the third one. Let’s analyze the cases. Suppose A knows 
                           
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                           
                         via 
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                           
                         and he aims to guess a password 
                           
                              
                                 
                                    PW
                                 
                                 
                                    ∗
                                 
                              
                           
                        , he may calculate 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ⊕
                              h
                              (
                              
                                 
                                    PW
                                 
                                 
                                    i
                                 
                              
                              ∥
                              
                                 
                                    R
                                 
                                 
                                    bi
                                 
                              
                              )
                           
                        , which is the front half part of 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        . But he does not know 
                           
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                           
                         and cannot guess the random number 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                        , so the latter part is secure and the password cannot be guessed. Similar situation occurs if A needs 
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                           
                        . So our scheme is not under the off-line guessing attack. Here we notice that the attacker A can obtain basic parameters needed in a session in Khan et al.’s scheme [13] without guessing, so we use 
                           
                              ?
                           
                         to fill the corresponding blank.

As we have explained in Section 7.2, if A knows the information in the mobile device and either of the secret biometric string or password, he cannot guess the third factor. Moreover, our scheme has only three on-line chances for password or biometrics guessing. It is difficult for A to pass the authentication and our scheme keeps three-factor security so that it resists the user impersonation attack.

If A wants to forge the messages from 
                           
                              S
                              ,
                              x
                           
                         is a necessary element. However, according to our premises, it cannot be obtained. So A cannot calculate 
                           
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    s
                                 
                              
                              ∥
                              x
                              ∥
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    s
                                 
                              
                              ∥
                              x
                              ∥
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         or 
                           
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                              ∥
                              x
                              )
                           
                         and the scheme resists the server spoofing attack.

Unlike Khan et al.’s scheme, our scheme employs the fuzzy extractor to cope with the biometrics. That will guarantee the probability of correct acceptance for legal users. But we find schemes in [15–17] do not employ the pre-dealing tools but cope with the input biometrics in the computation directly.

If A gets some session keys luckily, other session keys will not be affected. A cannot calculate 
                           
                              α
                              β
                              P
                           
                         from 
                           
                              α
                              P
                           
                         and 
                           
                              β
                              P
                           
                         because the session keys are built with ECCDH problem. Note that schemes in [16,17] do not have session keys at the end of authentication phase, so we put 
                           
                              ?
                           
                         in the corresponding blanks in Table 2.

In our scheme, 
                           
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                           
                         is encrypted by a random number 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         in message 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                        . A can only obtain 
                           
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                           
                         by calculating 
                           
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    s
                                 
                              
                              ∥
                              x
                              ∥
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         correctly. But it is difficult for A to get the value without knowing the server’s private key x. So the user’s identity remains anonymous in the session. But in Yeh et al.’s scheme there is no identity referred in transmitted messages in login and authentication and we use 
                           
                              ?
                           
                         to fill the blank. Also, the user’s identity is in plaintext in [14,17]. In [16], the user sends a string 
                           
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                              )
                              ∥
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                           
                         as a “random identity” in which 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                           
                         is a value during the registration. 
                           
                              h
                              (
                              
                                 
                                    ID
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is always the same and it could be thought as the user’s identity in the communication channel. We fill the corresponding blanks with 
                           
                              ×
                           
                        .

It is obvious that the user’s password is freely selected by the user himself and there is also a special phase for the user to change the password. Here we point out that there is no password change phase in [16].

We can see that in the authentication phase, S and 
                           
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           
                         both calculate a session key 
                           
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              (
                              α
                              P
                              ∥
                              β
                              P
                              ∥
                              α
                              β
                              P
                              )
                           
                         based on ECCDH problem. That is opposite to [9,16,17], where no session keys are formed.

If A has got all the long-term information of two participants and messages in channel, he still cannot know the previous session keys. It is simply because of the ECCDH problem. However, schemes in [9,16,17] do not have session keys at last, so this character does not exist for them.

As we mentioned above, persons may input different biometric information with error-tolerance by the fuzzy extractor practically. Our scheme has the reproduction step for the error-tolerance while schemes in [13,15–17] do not refer that important operation. So our scheme is practical.

We compare the time cost, the communication cost, and the transmission times in login and authentication phases, and security with [9,13–17] in this Section. The results are in Table 3
                     .

We use SHA1 as the hash function and its value length is 160 bits, same to the random number and the user’s identity. The symmetric encryption algorithm we employ is AES and each of the block is 128bits. The point in ECC group owns two coordinates and each of them is 160bits. 
                        
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 a
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 s
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 Rep
                              
                           
                        
                      are the time cost for one computation of scalar multiplication in G, point addition in G, symmetric encryption/decryption, hash function and biometrical secret string reproduction respectively. From [2], 
                        
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           =
                           7.3529
                           
                           ms
                        
                     , 
                        
                           
                              
                                 T
                              
                              
                                 s
                              
                           
                           =
                           0.1303
                           
                           ms
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                           =
                           0.0004
                           
                           ms
                        
                     . And we get 
                        
                           
                              
                                 T
                              
                              
                                 a
                              
                           
                           =
                           0.0613
                           
                           ms
                        
                      with the same platform in [2].

From Table 3, we can see that: (1) Our scheme is better than [9,15] in time cost. (2) Our scheme is better than [9] for the communication cost. (3) Our scheme uses less transmission times than [9,13,16]. (4) All the other schemes have security disadvantages without formal proof while ours is the only winner in the index “security and formal proof”. So our scheme is the best.

@&#CONCLUSION@&#

Biometrics is an important element in authentication. Though Yeh et al. and Khan et al. proposed their own biometrics-based three-factor authentication schemes, we find both of them have weaknesses. To overcome the disadvantages, we propose a novel biometrics-based three-factor authentication scheme with ECC and the mobile device. To pre-deal the imperfect biometrics input in the registration and the authentication processes, fuzzy extractor is employed in our scheme. We give a formal proof based on random oracles and ECGDH problem to illustrate the attacker’s low success probability. Compared with six recent three-factor authentication schemes from eleven security aspects and the performance, our scheme is well-performed for communication network.

@&#ACKNOWLEDGEMENT@&#

This research is supported by Fujian Education and Scientific Research Program for Young and Middle-aged Teachers under Grant Nos. JA14369 and JA13465 and National Natural Science Foundation of China under Grant No. 61300220.

@&#REFERENCES@&#

