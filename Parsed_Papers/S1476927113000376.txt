@&#MAIN-TITLE@&#Image database analysis of Hodgkin lymphoma

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We perform automated analysis on a database of Hodgkin lymphoma (HL) images.


                        
                        
                           
                           The database contains images of the two HL types, nodular sclerosis and mixed cellularity, as well as reactive lymphoid tissue.


                        
                        
                           
                           Preprocessing narrows down the region of interest that contains malignant cells.


                        
                        
                           
                           Preprocessing reduces the extensive requirements on computer power and memory for the automated analysis of HL images.


                        
                        
                           
                           The degree of CD30+ staining is a characteristic feature of HL images.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hodgkin lymphoma

Image analysis

CD30+ stain

Nodular sclerosis

Mixed cellularity

@&#ABSTRACT@&#


               
               
                  Hodgkin lymphoma (HL) is a special type of B cell lymphoma, arising from germinal center B-cells. Morphological and immunohistochemical features of HL as well as the spatial distribution of malignant cells differ from other lymphoma and cancer types. Sophisticated protocols for immunostaining and the acquisition of high-resolution images become routine in pathological labs. Large and daily growing databases of high-resolution digital images are currently emerging. A systematic tissue image analysis and computer-aided exploration may provide new insights into HL pathology. The automated analysis of high resolution images, however, is a hard task in terms of required computing time and memory. Special concepts and pipelines for analyzing high-resolution images can boost the exploration of image databases.
                  In this paper, we report an analysis of digital color images recorded in high-resolution of HL tissue slides. Applying a protocol of CD30 immunostaining to identify malignant cells, we implement a pipeline to handle and explore image data of stained HL tissue images. To the best of our knowledge, this is the first systematic application of image analysis to HL tissue slides. To illustrate the concept and methods we analyze images of two different HL types, nodular sclerosis and mixed cellularity as the most common forms and reactive lymphoid tissue for comparison. We implemented a pipeline which is adapted to the special requirements of whole slide images of HL tissue and identifies relevant regions that contain malignant cells.
                  Using a preprocessing approach, we separate the relevant tissue region from the background. We assign pixels in the images to one of the six predefined classes: Hematoxylin
                     +, CD30+, Nonspecific red, Unstained, Background, and Low intensity, applying a supervised recognition method. Local areas with pixels assigned to the class CD30+ identify regions of interest. As expected, an increased amount of CD30+ pixels is a characteristic feature of nodular sclerosis, and the non-lymphoma cases show a characteristically low amount of CD30+ stain. Images of mixed cellularity samples include cases of high CD30+ coloring as well as cases of low CD30+ coloring.
               
            

@&#INTRODUCTION@&#

Hodgkin lymphoma (HL) is a type of lymphoma, originating from germinal center B-cells in most of the cases (Küppers et al., 1994). In HL, neoplastic cells circumvent immune surveillance and apoptotic control. Characteristically, in HL, the malignant cells make up only about 1% of the tumor mass, while being outnumbered by a microenvironment of reactive lymphoid cells (Steidl et al., 2011; Mathas et al., 2009). According to the WHO classification, two main subtypes can be described, the classical HL (cHL) and the nodular lymphocyte-predominant HL (NLP HL).

The assignment to cHL is based on the identification of characteristic tumor cells termed Hodgkin cells and Reed–Sternberg cells (HRS cells) (Reed, 1902; Sternberg, 1898). Using immunohistochemical methods for immunophenotypic differentiation of HL, the cluster-of-differentiation (CD) protocols are of particular interest. They are used to identify cell surface proteins presented on leukocytes, e.g., CD30, CD20, and CD15. For example, CD30 belongs to the tumor necrosis receptor family (TNFR), and is usually expressed by HRS cells but can also be expressed by activated blasts in reactive lesions like lymphadenitis.


                     Fig. 1
                      illustrates a typical CD30+ immunostained HRS cell within its microenvironment. Hematoxylin counterstaining is applied to visualize cell nuclei. Depending on immunophenotypic findings and the composition of the cellular microenvironment cHL is further divided into two subtypes, the most common one termed nodular sclerosis (NS cHL) and the mixed cellularity (MC cHL) (Hansmann and Willenbrock, 2002). All subtypes of cHL share an immunophenotype of CD30+ (Küppers, 2009). CD15 and CD20 can be variably expressed, with usual CD20-negativity and CD15-positivity. However, CD30 expression can also be observed in reactive lesions. Therefore a detailed investigation of the location of CD30 blasts is mandatory and image analysis may provide systematic information for this task.

Moreover, the expression of various cytokines and chemokines is thought to be responsible for the attraction of different cells, such as small lymphocytes, macrophages, mast cells, plasma cells, stromal cells, histiocytes, or fibroblasts (Aldinucci et al., 2010; Steidl et al., 2011). The extent of cellular infiltration, involving many different cell types as a response to inflammatory signals, represents a key characteristic of HL (Hartmann et al., 2013). The events that happen in the course of malignancy development as well as the complex interaction network of malignant cells in HL are not understood. Here, image analysis may provide new insights into the pathology of HL.

There is a broad range of literature on image analysis of non-lymphoid tumors. For example, Naik et al. (2008) used a Bayesian nuclear segmentation scheme in prostate and breast cancer histopathology. Bayesian models with additional contextual information from Markov random fields have been applied as a probabilistic approach for prostate cancer detection (Monaco et al., 2009). Lei et al. (2011) applied Gaussian mixture models to perform local and global clustering, extracting different tissue constituents in cervix histology images. Sertel et al. (2009) developed a system for segmentation of eosinophilic and basophilic structures in hematoxylin and eosin (H&E) stained tissue section images of neuroblastoma. Large-scale computations and machine learning algorithms have been applied to breast histology images (Petushi et al., 2006). Karacali and Tözeren (2007) proposed a high-throughput method of texture heterogeneity on breast tissue images to identify regions of interest. An automatic classification of three types of malignant lymphomas has been proposed by Orlov et al. (2010), taking into account chronic lymphocytic leukemia, follicular lymphoma, and mantle cell lymphoma. They achieved high accuracy in discriminating the different lymphoma types using various statistical and texture features. Sertel et al. developed a computer-aided method to detect follicles based on texture features in an immunostained image followed by the detection of centroblasts within the follicular regions (Sertel et al., 2008).

Today, a number of software solutions for analyzing images are available. Commercial software includes general tools like MATLAB (Matlab, 2013) as well as software geared especially toward digital pathology like Aperio ImageScope (Aperio, 2013), Definiens Tissue Studio (Definiens), and many other. There exist also freely available tools, the most prominent of which are CellProfiler (Lamprecht et al., 2007), ImageJ (Abramoff et al., 2004), GNU Octave (Eaton et al., 2008), and Scilab (Enterprises and Consortium, 2013). Despite all these approaches, no special work exists for the analysis of HL images that takes into account the specific characteristics of that lymphoma type. That is important, because NS cHL and MC cHL represent two different types of HL which often have distinct patterns of tumor cell distribution. In NS cHL, the tumor cells grow in a nodular pattern with broad collagen bands separating the nodules. In contrast, MC cHL tumor cells are more isolated and often distributed over the whole tissue section. NS cHL accounts for about 64%, whereas MC cHL is found in about 30% of the cHL cases in our database. While the visual differentiation between the two types of cHL is possible in many cases, non-lymphoma NL images sometimes exhibit features similar to cHL subtypes as for example, lymphadenitis which is an infection of the lymph nodes, resulting from certain bacterial or viral infections and often leading to inflammation and swelling of lymph nodes.

Our work aims to analyze the considered types based on CD30 stained tissue sections, using pixel based image processing techniques. To be flexible in handling and exploring HL whole slide tissue-images and to easily extend the software in future projects we implemented a new pipeline. Our software is intended to evolve into a tool that extracts statistical information from a large database of Hodgkin lymphoma images. We aim to combine our software solutions with existing imaging software solutions like CellProfiler (Lamprecht et al., 2007).

The image sources used in this study are CD30 stained tissue slides of lymph node sections. The tissue slides are pretreated, and immunostained for CD30 as previously described (Hartmann et al., 2011). The reddish coloring is basically produced by the enzyme alkaline phosphatase that is bound via a biotin–streptavidin linker to a CD30 antibody and hydrolyzes the magenta dye new fuchsine. Hematoxylin counterstain was applied to stain cell nuclei. The digital slides are captured using an Aperio ScanScope XT scanning device with a 40× objective lens. Typical dimensions of tissue samples are on the average 15mm2, and the images reach resolutions of up to 100,000×100,000 pixels (0.23μm per pixel). The images are recorded in the specific Aperio SVS format, a single-file pyramidal TIFF with non-standard metadata and compression. Each picture in SVS format stores the digitized images in high resolution (0.23μm per pixel) and simultaneously in various levels of lower resolutions. If not otherwise mentioned, we use the second level that is down-scaled by a factor of 16 (3.68μm per pixel). The slides were manually assigned by pathologists to NS cHL (nodular sclerosis classical Hodgkin lymphoma), MC cHL (mixed cellularity classical Hodgkin lymphoma), and NL (non-lymphoma, lymphadenitis with and without follicular hyperplasia). Samples are randomly selected by pathologists who eliminated untypical cases from an anonymized data set from the Senckenberg Institute of Pathology Frankfurt am Main. Tissue sections of small size are ignored, because they are not representative for the complete lymph node. Furthermore, only tissue sections with distinct immunostaining are considered. In the selected images, CD30+ cells can be visually distinguished from the background. The selection yields a representative set of 62 images of NS cHL, 57 images of MC cHL, and 51 images of NL.

@&#METHODS@&#

We use Openslide 3.2 to handle whole slide images, applying the Java Advanced Imaging API (Goode and Satyanarayanan, 2008). The input images contain stained tissue in front of a bright background. Some of the images show artifacts like air bubbles, small tissue fragments, and stain residues. To eliminate such artifacts, as well as background, we developed an appropriate procedure of preprocessing steps.

The idea of the preprocessing is to identify regions of interest, eliminating the background. The procedure applies a simple intensity threshold after smoothing to eliminate single bright pixels within the tissue regions. Impurities as bubbles or small fragments of tissue are removed by region-based segmentation and region size thresholding. The preprocessing procedure performs three consecutive steps, spatial filtering, thresholding, and region-based segmentation. In the following description we will adopt the terminology of Gonzalez and Woods (2008).
                           
                              1.
                              
                                 Spatial filtering. A spatial filtering, using a weighted averaging filter of size 43×43 pixels, smoothes the image. The weights are chosen according to a Gaussian distribution with a variance of σ
                                 =3 pixels. The linear spatial filter is separately applied to each RGB channel.


                                 Thresholding. We determine an intensity threshold for each individual image, whereby the thresholding distinguishes between tissue and background. We generate a gray scale image by averaging the RGB values at each point. For each image the histogram of gray values shows a distinct peak at high-intensity brightness (data not shown). This high-intensity peak corresponds to the substantial amount of bright background in the image and serves as basis for the intensity value of the local minimum next and below the background peak. Intensity thresholding classifies points to be either a background point (gray value above threshold) or an object point (gray value below threshold).


                                 Region-based segmentation. A region-based segmentation eliminates small isolated areas of tissue. The object points are partitioned into connected spatial regions of tissue. A region-growing algorithm based on 8-connectivity between pixels appends each object point to one of the (unconnected) seed points. Some areas of tissue (region size below 40,000 pixels) are disregarded, because they correspond to isolated tissue fragments and/or singular spots on the object slide (see Fig. 2
                                 ). The left part of Fig. 2 depicts an example of a tissue image. Background and isolated small fragments are eliminated in the corresponding preprocessed image shown in the left part of Fig. 2.

After preprocessing, the pixels considered as tissue are assigned to one of the classes:
                           
                              1.
                              
                                 Hematoxylin
                                 +. Deep blue pixel inside hematoxylin positive stained cell nuclei.

CD30+. Red pixel of CD30+ stained regions. A pixel of this class is typically found near the membrane of a RS cell and, hence, indicates a malignant cell.


                                 Nonspecific red. Red pixel of prolate regions resembling vessels. The red color is not a result of a CD30+ staining.


                                 Unstained. Pixel of unspecific low color. Typically, pixels of this class are located in unspecifically stained tissue regions.


                                 Background. Bright pixels that are typical for background and are not eliminated by preprocessing.


                                 Low intensity. Pixel of low intensity. Regions of low intensity are characteristic for slices that are accidentally folded during preparation of a stained histologic specimen. These dark regions are not suited for further analysis.

We manually select a set of 36 prototype image sections to represent each class, i.e., six images per class with an image size between 150 and 1000 pixels (data not shown). We compute a prototype pattern vector for each class. The components of the prototype vector are the three descriptors: (1) Brightness (mean of the three RGB color values), (2) Spatial mean color (the three spatial mean RGB values averaged over the neighbored points, 8-connectivity), and (3) CD30 saturation (saturation of the CD30 staining)


                        
                           
                              (1)
                              
                                 
                                    S
                                    
                                       CD
                                       30
                                    
                                 
                                 =
                                 max
                                 (
                                 |
                                 R
                                 −
                                 B
                                 |
                                 ,
                                 |
                                 R
                                 −
                                 G
                                 |
                                 )
                                 −
                                 min
                                 (
                                 |
                                 R
                                 −
                                 B
                                 |
                                 ,
                                 |
                                 R
                                 −
                                 G
                                 |
                                 ,
                                 |
                                 B
                                 −
                                 G
                                 |
                                 )
                                 ,
                              
                           
                        where R, B and G are color values (RGB-model). Note that, high color values for red and blue are typical for the applied staining with new fuchsine and hematoxylin, respectively, whereas high color values for green most likely represent artifacts or non-specific fluctuations.

We compute a prototype vector for each class by averaging over the points of the corresponding prototype images. Now, we can use the prototype vectors of the six classes Hematoxylin
                        +, CD30+, Nonspecific red, Unstained, Background, and Low intensity to assign each individual pixel to one of these classes. Thus, we determine the vector of descriptors, covering brightness, spatial mean color, and CD30 saturation for each point, which we then compare with each of the six prototype vectors. A Euclidean distance is appropriate for the spatial mean color. We chose absolute values of differences for brightness and CD30 saturation. The mean of these three quantities serves as distance to the prototype vectors. The minimal distance classifier assigns the point to the “nearest” prototype vector. In this way, all object points of an image are classified and we obtain points of the six classes. Because all points assigned to the classes Background or Low intensity are not relevant for further analysis, we eliminate them from the set of object points.

@&#RESULTS AND DISCUSSION@&#

The fraction of points eliminated by the preprocessing varies strongly with the area of tissue slides and the quality of tissue preparation. We observe a typical value for the fraction of background of 55%, but portions down to 10% or up to 90% background are not exceptional. The area of low intensity is considerably smaller and typically below 2%.


                        Fig. 3
                         illustrates the assignment of pixels to the six classes. On the top part of Fig. 3 three sections of images are shown: a region with CD30+ cells (Fig. 3A, top left), a region with a folded tissue slice (Fig. 3C, middle top), and a region with unspecific red coloring (Fig. 3E, top right). The lower part of Fig. 3 depicts the assignment of the pixels in these three sections to the six classes CD30+, Nonspecific red, Background, Hematoxylin
                        +, Unstained, and Low intensity, by color coding. The similarity of the images of color coded pixel classification in the lower part to the corresponding original images in the upper part demonstrates the correct functionality of the applied pixel classification procedure.

The correct pixel classification narrows down regions in the tissue that contain CD30+ color-marked cells. These regions are of special interest, because CD30 is a marker for HRS cells. The identification of these regions is demonstrated in Fig. 4
                        . The upper part of Fig. 4 shows a section of a tissue image. This image is split into 22×61 subimages each of size 118μm×118μm (i.e., 512×512 pixels in the image of highest resolution). We apply the assignment of pixels to the six classes for this tissue section based on an image with 16 times lower resolution. This lower resolution image is available without computational costs by the second level of the multi-resolution SVS format (see Section 2). The second level of the SVS format has a resolution of 3.68μm per pixel. This down-scaling of the resolution reduces the computing time for pixel classification by a factor of 256 compared to a pixel classification in highest resolution of 0.23μm per pixel. The regions of interest are shown in the lower part in Fig. 4. For the tissue shown in Fig. 4, the region of interest is about 25% of the entire image, i.e., about 75% would give no information on the properties and distribution of HRS cells. This example demonstrates that a correct low-resolution pixel classification followed by an identification of regions of interest can substantially reduce the computational costs for an advanced high-resolution analysis.

We have to be aware that a CD30+ color-marking alone is not an unequivocal identifier of malignant cells. In clinical practice, HRS cells are determined and collected based on the staining, distribution and the morphology of the cells. A visual inspection of the tissue section in a light microscope by an expert pathologist is required for the decision whether the cell is malignant or not. Nevertheless, it is of interest, whether the pixels assigned to the various classes (e.g., to CD30+) reveal typical features. To study this question we count the number of pixels assigned to the respective classes. We consider each of the 62 images of NS cHL, 57 images of MC cHL, and 51 images of NL.


                        Fig. 5
                         shows box plot statistics for the relative amount of pixels of the classes CD30+, Hematoxylin
                        +, Unstained, and Nonspecific red for non-lymphoma tissue (top part, Fig. 5A), as well as for the two pathological cases NS cHL (middle part, Fig. 5B) and MC cHL (bottom part, Fig. 5C). In all cases, the fraction of tissue that is CD30+ or nonspecific red is small compared to the majority of hematoxylin+ tissue and unstained tissue. The median for the portion of Hematoxylin
                        + tissue is highest for non-lymphoma tissue (60%) and can be interpreted as a high density of cell nuclei. The median of the portion of Hematoxylin
                        + tissue decreases for the images of MC cHL lymphoma. The relatively low median 34% for NS cHL lymphoma correlates with the clinical observation of thick collagen bands for this HL subclass (Pileri et al., 2002).

A high fraction of area classified as hematoxylin+ or unstained characterizes tissue images of non-lymphoma. Let f denote the fraction of hematoxylin+ or unstained area. For a given image, we define the degree of staining, ds, as an integer value for which f fulfills
                           
                              (2)
                              
                                 1
                                 −
                                 
                                    
                                       
                                          10
                                          
                                             −
                                             3
                                          
                                       
                                    
                                    
                                       2
                                       ×
                                       
                                          4
                                          ds
                                       
                                    
                                 
                                 <
                                 f
                                 ≤
                                 1
                                 −
                                 
                                    
                                       
                                          10
                                          
                                             −
                                             3
                                          
                                       
                                    
                                    
                                       8
                                       ×
                                       
                                          4
                                          ds
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Fig. 6
                         depicts the distribution of images according to their ds. The distribution of images is significantly different for non-lymphoma, MC cHL, and NS cHL. NL is characterized by low ds. 94% of the images of NL have a ds below or equal two. The distributions for MC cHL and NS cHL both have their maximum at ds
                        =4, but the distribution for MC cHL is much broader and shows a distinct tail toward lower ds. All images with a ds below one are of type NL. For ds
                        =1, we find images of MC cHL or NL, but not of NS cHL. Images of all types can have ds between two and four, but images with ds
                        >4 are either of type MC cHL or NS cHL. No image of NL with high degree of staining, ds
                        >4, appears in our data set.


                        Fig. 7
                         shows the probability that an image of given ds is of type NL, MC cHL, or NS cHL. We assume that, in a first step the images are classified according to their ds. Afterward, we randomly chose one image from the set of images of a given ds. The probability to find an image of type NL, MC cHL, or NS cHL is plotted versus ds in Fig. 7. Obviously, an image with low ds (<1), is of type NL, exhibiting a probability of one (p
                        =1). For increasing staining, however, the probability for NL drops to zero. Images with a high ds (>4) are not of type NL. Consequently, the probability to find MC cHL or NS cHL with a ds below one is zero. For ds
                        =1, the probability of MC cHL is p
                        =0.24 and grows further for increasing ds. The probability for NS cHL is zero for ds
                        =1, becomes p
                        =0.2 for ds
                        =2, and grows further for higher ds. For the highest observed ds (ds
                        =5), the image is either of type NS cHL or MC cHL (both cases with probability p
                        =0.5).

Notice that the probability distributions depicted in Fig. 7 are only valid for our data set of 170 images. They reflect the approximate equipartition of NL, MC cHL, and NS cHL cases in the data set. The statistical analysis of a different set of images will lead to a similar qualitative behavior as shown in Fig. 7, but our particular selection of images hampers a biological interpretation of the specific numbers of the probabilities. Concerning the incidence statistics of Hodgkin lymphoma the subtype NS cHL is much more common and accounts for 50–60% of cases whereas the subtype MC cHL accounts for 13–15% of all newly diagnosed cases (Swerdlow et al., 2008).

The cases of NL lymph nodes, on the other hand, predominate the cases of cHL. But no reliable numbers are known for data sets of lymph node images which are typical for clinical or pathological practice. An extension of our study to the complete set of available and relevant whole slide images of lymph nodes would be necessary in order to determine relevant probabilities. The analysis of our set of 160 images requires approximately one day running time on 4 dual Core™ Intel Xenon CPU at 3.2GHz (64 bit openSUSE 12.1). A study of a significantly larger data set of images would require extensive computing time and hence, is out of the scope of this work.

We tested various strategies to distinguish NL, NS cHL, and MC cHL based on the combined information of the ds and fraction of CD30+ of an image. The large variety of values for the fraction of CD30+ within each group hinders a successful automated classification of images. Especially, the differentiation of NS cHL and MC cHL is difficult for many images. Inevitable prerequisite for a promising approach of automated classification of HL images seems to be the concerted incorporation of information on the degree of staining and information on the number, density, distribution, and morphology of malignant cells.

@&#CONCLUSION@&#

In this work, we present the method and results of a new pipeline for automated image analysis adapted to the requirements of the pathology of HL. The diagnosis of HL is based on the identification of characteristic multinucleated giant cells within an inflammatory milieu. The malignant cells can be rather sparse in the lymphoma and their detection by visual inspection can be a hard and exhausting task even for an experienced pathologist. Our aim is to extract statistical features relevant for the pathology of HL from extensive databases of high-resolution color images of immunostained tissue slides. The file size of high-resolution images recorded in pathological research and diagnostics is typically in the range of 30GB. Exploring these images with sophisticated image analysis methods on an automatic basis and for a large number of tissue slides is of great interest for the research on HL. Typical tasks are the detection of HRS cells, the observation of different cell types, the determination of the morphology of malignant cells, and the collection of the locations of all malignant cells. The requirements in terms of computing time and computer memory of a brute force approach, however, would be computational extremely extensive.

We take advantage of the multilevel resolution of images in SVS format and narrow down the region of interest that potentially contains malignant cells. Our fast procedure achieves a considerable reduction of the dimension of the image data. The data processing has two steps. In a first preprocessing step, the relevant tissue is separated from the typically bright background and from frequently occurring artifacts, such as isolated small tissue fragments, stain splatter, or bubbles. In a second step, a pixel classification is applied to identify regions in the tissue that show considerable CD30 antibody staining.

We apply our pipeline to the three pathological groups NS cHL, MC cHL, and NL represented by 62 images, 57 images, and 51 images, respectively. For each image we divide the tissue into regions of CD30+, hematoxylin+, unstained, and nonspecific red. The number of pixels of these classes is requisite to compute ds for each image. The number of images per ds gives distributions that show characteristic features for NL, MC cHL, and NS cHL. Images of NL have typically low ds (<1). High values for the ds are characteristic of NS cHL and MC cHL.

Visual inspection of the images indicates that the spatial distribution of CD30+ cells differs between the image groups. For instance, in NS cHL the CD30+ cells are arranged in a nodular pattern whereas in most cases of MC cHL or NL CD30+, cells seem to be equally distributed over the entire tissue section. Therefore, we conclude that information on the spatial distribution of malignant cells is a prerequisite for an attempt to automatically analyze images. Ideally, a combination of our pipeline with standard tools (e.g., CellProfiler) is applied to facilitate the computation of such descriptors for an extended data set of images of HL tissue. Currently, we extend our approach to extract information on the spatial distribution and organization of cells.

@&#REFERENCES@&#

