@&#MAIN-TITLE@&#Matrix weighted rational curves and surfaces

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We extend rational curves and surfaces that have real weights to rational curves and surfaces permitting matrix weights.


                        
                        
                           
                           Matrix weighted rational curves and surfaces maintain many similar properties or algorithms of traditional rational curves and surfaces.


                        
                        
                           
                           The matrix weights permit novel geometric means for shape control of rational curves and surfaces.


                        
                        
                           
                           Matrix weighted NURBS curves and surfaces are suitable for curve or surface reconstruction with no need of solving large systems.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Rational curves and surfaces

Matrix weight

Control normals

Surface reconstruction

@&#ABSTRACT@&#


               
               
                  Rational curves and surfaces are powerful tools for shape representation and geometric modeling. However, the real weights are generally difficult to choose except for a few special cases such as representing conics. This paper presents an extension of rational curves and surfaces by replacing the real weights with matrices. The matrix weighted rational curves and surfaces have the same structures as the traditional rational curves and surfaces but the matrix weights can be defined in geometric ways. In particular, the weight matrices for the extended rational Bézier, NURBS or the generalized subdivision curves and surfaces are computed using the normal vectors specified at the control points. Similar to the effects of control points, the specified normals can be used to control the curve or the surface's shape efficiently. It is also shown that matrix weighted NURBS curves and surfaces can pass through their control points, thus curve or surface reconstruction by the extended NURBS model no longer needs solving any large system but just choosing control points and control normals from the input data.
               
            

@&#INTRODUCTION@&#

In Computer Aided Geometric Design, rational curves and surfaces like
                        
                           (1)
                           
                              R
                              (
                              ξ
                              )
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    ξ
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    ξ
                                    )
                                 
                              
                              ,
                              
                              
                              
                              ξ
                              ∈
                              Ξ
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              i
                           
                        
                      are the control points, 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                      are the scalar weights and 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                        (
                        ξ
                        )
                      are the blending functions defined on a 1D or 2D domain, are powerful tools for shape representation, modeling and reconstruction. Particularly, polynomial or rational Bézier curves and surfaces, NURBS (non-uniform rational B-spline) curves and surfaces and the generalized subdivision surfaces are widely used in CAD or computer animation industry (Farin, 2001; DeRose et al., 1998; Müller et al., 2006). As its compact representation of freeform as well as analytical curves and surfaces, NURBS has even become de facto industry standard in CAD commercial software (Piegl and Tiller, 1997).

Except for representing typical curves or surfaces such as conics or rotational surfaces, the potentials of rational curves and surfaces have not been explored thoroughly for geometric modeling. One possible reason is due to the limitations of the current representation. Generally, the geometric meaning of weights of rational curves and surfaces is not as clear as their control points. High order rational curves and surfaces are useful for high quality shape modeling (Cashman et al., 2009), but how to construct them is not as clear as desired. Rational curves and surfaces are also promising for shape reconstruction from scanned data but the determination of the weights is not a simple task (Xie et al., 2012). If some differential quantities or sharp features should be considered, the reconstruction of curves and surfaces becomes nonlinear and optimization techniques have to be employed (Gofuku et al., 2009; Wu et al., 2013; Ma et al., 2015).

A geometric approach to construct rational curves and surfaces is the technique of dual Bézier curves and surfaces which treat the Bézier control points as control lines or control planes (Hoschek, 1983). Rational Bézier curves and surfaces are obtained as the envelopes of the dual Bézier curves or the dual Bézier surfaces. Even this is usually feasible, the denominator of an obtained rational Bézier curve or surface may vanish when the initial control lines or control planes have not been properly given. Another interesting extension of rational Bézier curves is complex rational Bézier curves (Sánchez-Reyes, 2009). Complex rational Bézier curves replace the scalar weights of the classical rational Bézier curves by complex numbers and several typical plane curves can be represented by complex rational Bézier curves of lower degrees. However, complex rational Bézier curves only lie in 2D space. Other interesting extensions of Bézier or NURBS curves and surfaces include plus curves and surfaces which use parameterized control lines (Goshtasby, 2005), curves and surfaces with basis functions that contain shape parameters (Juhász and Róth, 2013) or spline curves and surfaces with added geometric details controlled by vectors (Kosinka et al., 2015).

In this paper we present extended representation models of rational curves and surfaces with the following goals: (1) The new models maintain the same structures as the usual ones; (2) The new models are compatible with the traditional rational curves and surfaces; (3) The new weights permit geometric definitions and can be used for easy shape editing; (4) Curve or surface reconstruction using the extended rational models is simple and direct.

A rational curve or surface in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      can be regarded as the perspective projection of a non-rational curve or surface in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                      (Farin, 1999). Similarly, we define rational curves and surfaces in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      by the mapping of homogeneous curves or homogeneous surfaces in 
                        
                           
                              R
                           
                           
                              (
                              d
                              +
                              1
                              )
                              ×
                              d
                           
                        
                     . Concretely, we should only replace the scalar weights in Equation (1) with 
                        d
                        ×
                        d
                      matrices. If the denominator matrix function is non-singular over the whole parameter domain, a matrix weighted rational curve or surface will be obtained. It is clear that the extended rational curves and surfaces have the same structures as the traditional ones. If all the weight matrices are defined by multiplying a set of real numbers with the same non-singular matrix, the matrix weighted rational curve or surface will degenerate to a conventional rational curve or surface.

To achieve the third or even the fourth goal, we propose to compute the weight matrices based on normal vectors and real numbers specified at the control points of the curves or the surfaces. This is motivated by the observation that a rational curve or surface is in fact the solution to least-squares fitting to the control points with weights given by a set of basis functions. If we fit a curve or a surface to the points as well as to a set of lines or planes that pass through the points, we obtain a rational curve or a rational surface with matrix weights. These curves and surfaces can be controlled using control points together with control normals. Moreover, matrix weighted NURBS curves and surfaces can even pass through their control points, thus curve or surface reconstruction by the proposed models becomes easy because the control points of the reconstructed curve or surface should only be selected from the input data.

As the popular subdivision schemes proposed by Catmull and Clark (1978), Doo and Sabin (1978) or Loop (1987) are just the generalized B-spline surfaces with arbitrary topology control meshes, they can be extended to matrix weighted rational subdivision surfaces and the shapes of the extended subdivision surfaces can be controlled using control points and control normals. Similarly, other B-spline or NURBS compatible subdivision surfaces, for example the schemes in Sederberg et al. (1998), Stam (2001), Schaefer and Goldman (2009), can be generalized to matrix weighted rational subdivision surfaces too.

The paper is structured as follows. Section 2 presents the general definition and basic properties of matrix weighted rational curves and surfaces. More details about matrix weighted rational Bézier curves and matrix weighted NURBS curves are given in Section 3 and Section 4, respectively. Section 5 is devoted to matrix weighted rational parametric surfaces and matrix weighted rational subdivision surfaces. In Section 6 we present several interesting examples to show the potential applications of the proposed models. Section 7 concludes the paper.

In this section we present the definition of general matrix weighted rational curves and surfaces. A method for defining the weight matrices using specified normals and some basic properties of the obtained curves and surfaces will also be given.

Assume that 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 n
                              
                           
                         are a sequence or a set of points lying in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                                 ×
                                 d
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         are a set of known matrices. Suppose that 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           (
                           t
                           )
                           ≥
                           0
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         are a set of blending functions defined over a 1D or 2D domain Ξ. If the matrix function 
                           M
                           (
                           ξ
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 n
                              
                           
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           (
                           ξ
                           )
                         is non-singular for any 
                           ξ
                           ∈
                           Ξ
                        , a valid matrix weighted rational curve or surface is given by
                           
                              (2)
                              
                                 Q
                                 (
                                 ξ
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ,
                                 
                                 
                                 
                                 ξ
                                 ∈
                                 Ξ
                              
                           
                         Particularly, if we choose 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           W
                        , where 
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           ∈
                           R
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         and W is a 
                           d
                           ×
                           d
                         matrix that satisfies 
                           |
                           W
                           |
                           ≠
                           0
                        , the matrix weighted rational curve or surface 
                           Q
                           (
                           ξ
                           )
                         will degenerate to a conventional rational curve or surface as given by Equation (1).

Though there may exist many methods for defining the weight matrices for matrix weighted rational curves and surfaces, we present here a geometric approach to compute them. Suppose that 
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         are a set of unit normal vectors and 
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           >
                           0
                        , 
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           >
                           −
                           1
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         are a set of real numbers. The weight matrices for 
                           Q
                           (
                           ξ
                           )
                         are defined as follows
                           
                              (3)
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 I
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 )
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                         where I is the 
                           d
                           ×
                           d
                         identity matrix. Before we derive the condition when a matrix weighted rational curve or surface is valid, we have the following theorem.


                        
                           Theorem 2.1
                           
                              Suppose that 
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                              
                              , 
                              
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                               
                              are a set of unit vectors, 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                              
                              , 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 −
                                 1
                              
                              , 
                              
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                               
                              are real numbers and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                               
                              are the matrices defined by Equation 
                              
                                 (3)
                              
                              . The matrix 
                              
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                              , where the coefficients satisfy 
                              
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ≥
                                 0
                               
                              and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                              
                              , is non-singular.
                           

To prove the theorem we prove that the determinant of matrix 
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                               is greater than zero. Let 
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                              , the matrix 
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                               can be reformulated as 
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 I
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 )
                              . Assuming that λ is an arbitrary eigenvalue and v is the corresponding eigenvector of the matrix, it yields that
                                 
                                    
                                       λ
                                       v
                                       =
                                       
                                          [
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             n
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          I
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          )
                                          ]
                                       
                                       v
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       v
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 v
                              , 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              . Dotting either side of above equation by vector v, we have
                                 
                                    
                                       λ
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       1
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                               As 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 =
                                 |
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 v
                                 |
                                 ≤
                                 1
                               and 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 −
                                 1
                              , 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              , it can be concluded that 
                                 λ
                                 >
                                 0
                              . Since the matrix 
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                               is symmetric and has d eigenvalues, namely 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              , …, 
                                 
                                    
                                       λ
                                    
                                    
                                       d
                                    
                                 
                              , we have 
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       s
                                    
                                 
                                 |
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                              . This proves the theorem.  □

From Theorem 2.1 we know that if the blending functions 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           (
                           ξ
                           )
                         are non-negative and linear independent over the parameter domain, the matrix weighted rational curve or surface 
                           Q
                           (
                           ξ
                           )
                         given by Equation (2) is valid.

From a geometric point of view, a rational curve or a rational surface is the solution to the weighted least squares fitting to the control points with weights chosen as the scaled blending functions. It can be shown that a matrix weighted rational curve or surface with weight matrices defined by Equation (3) is the solution to the weighted least squares fitting to the control points and lines/planes that pass through the points. For a set of given points 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , normal vectors 
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                         and coefficients 
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           >
                           0
                        , 
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           >
                           −
                           1
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                        , let
                           
                              (4)
                              
                                 F
                                 (
                                 Q
                                 (
                                 ξ
                                 )
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 
                                    
                                       [
                                       Q
                                       (
                                       ξ
                                       )
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 
                                    
                                       [
                                       (
                                       Q
                                       (
                                       ξ
                                       )
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ⋅
                                       
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         By minimizing the functional 
                           F
                           (
                           Q
                           (
                           ξ
                           )
                           )
                         we have
                           
                              (5)
                              
                                 
                                    
                                       ∂
                                       F
                                       (
                                       Q
                                       (
                                       ξ
                                       )
                                       )
                                    
                                    
                                       ∂
                                       Q
                                       (
                                       ξ
                                       )
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 [
                                 Q
                                 (
                                 ξ
                                 )
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 ]
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 Q
                                 (
                                 ξ
                                 )
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 0
                                 .
                              
                           
                         Solving Equation (5) we obtain the matrix weighted rational curve or matrix weighted rational surface 
                           Q
                           (
                           ξ
                           )
                         with weight matrices defined by Equation (3). Clearly, if all 
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                         vanish, the solution to Equation (5) is a conventional rational curve or a conventional rational surface. Similar to the effects of control points 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , the normals 
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                         can be used to control the curve or surface's shape efficiently. We therefore refer the normals as the control normals of the curves or surfaces.

Matrix weighted rational curves and surfaces maintain several fundamental properties of traditional rational curves and surfaces. These properties are useful for shape modeling using the proposed models of curves and surfaces. We state the following two properties for the matrix weighted rational curves but similar properties hold for the matrix weighted rational surfaces.


                        
                           Property 2.2
                           Geometric invariance


                           
                              The shape of a matrix weighted rational curve is invariant under the translation or uniform scaling of all control points. Moreover, if the weight matrices are defined by Equation 
                              
                                 (3)
                              
                              , the shape of the curve is also invariant under the rotation of the coordinate system.
                           

We first prove the geometric invariance under the translation or uniform scaling of the control points. Suppose that a matrix weighted rational curve is represented by Equation (2). Since
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                n
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             ξ
                                             )
                                             ]
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ,
                                    
                                 
                               we have
                                 
                                    
                                       Q
                                       (
                                       ξ
                                       )
                                       +
                                       
                                          
                                             Q
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                n
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             ξ
                                             )
                                             ]
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             Q
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       ξ
                                       )
                                       .
                                    
                                 
                               This proves that the shape of a matrix weighted rational curve is invariant under the translation of control points. For a nonzero real number s we have
                                 
                                    
                                       s
                                       Q
                                       (
                                       ξ
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                n
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             ξ
                                             )
                                             ]
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       s
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ,
                                    
                                 
                               which proves the geometric invariance under the uniform scaling of the control points.

We next prove the geometric invariance under the rotation of the coordinate system. Suppose that 
                                 A
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                       ×
                                       d
                                    
                                 
                               is a rotation matrix. It yields that 
                                 A
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 I
                               and 
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                              . By multiplying A on either side of the expression of 
                                 Q
                                 (
                                 ξ
                                 )
                              , we have
                                 
                                    
                                       
                                          
                                             
                                                A
                                                Q
                                                (
                                                ξ
                                                )
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                A
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            0
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      I
                                                      +
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      ξ
                                                      )
                                                      ]
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                A
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                I
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      T
                                                   
                                                
                                                A
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                ξ
                                                )
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                
                                                   
                                                      [
                                                      A
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            0
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      I
                                                      +
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      ξ
                                                      )
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                A
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      T
                                                   
                                                
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                A
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      T
                                                   
                                                
                                                )
                                                A
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                ξ
                                                )
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            0
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      [
                                                      I
                                                      +
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      A
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            A
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      ]
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      ξ
                                                      )
                                                      }
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                [
                                                I
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                A
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      (
                                                      A
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      T
                                                   
                                                
                                                ]
                                                A
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                ξ
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                               Thus 
                                 A
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 A
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                               are the control points and control normals of 
                                 A
                                 Q
                                 (
                                 ξ
                                 )
                              . The proposition is proven.  □


                        
                           Property 2.3
                           Effects of weights


                           
                              Suppose that 
                              
                                 Q
                                 (
                                 ξ
                                 )
                               
                              is a matrix weighted rational curve defined by Equation 
                              
                                 (2)
                               
                              and the weight matrices are defined by Equation 
                              
                                 (3)
                              
                              . The curve 
                              
                                 Q
                                 (
                                 ξ
                                 )
                               
                              will be approximate tangent to the line or the plane that passes through point 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               
                              with normal vector 
                              
                                 
                                    
                                       n
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               
                              when the parameter 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               
                              approaches infinity. If 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               
                              approaches infinity, the points on 
                              
                                 Q
                                 (
                                 ξ
                                 )
                               
                              will approach the control point 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                              .
                           

From the definition of the functional 
                                 F
                                 (
                                 Q
                                 (
                                 ξ
                                 )
                                 )
                               we know that if 
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               approaches infinity the term 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 
                                    
                                       [
                                       (
                                       Q
                                       (
                                       t
                                       )
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                       ⋅
                                       
                                          
                                             n
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       2
                                    
                                 
                               will approach zero for any 
                                 ξ
                                 ∈
                                 
                                    support
                                 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 )
                                 ⋂
                                 Ξ
                               when the functional 
                                 F
                                 (
                                 Q
                                 (
                                 ξ
                                 )
                                 )
                               is minimized. As 
                                 (
                                 Q
                                 (
                                 ξ
                                 )
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 )
                                 ⋅
                                 
                                    
                                       n
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               approaches zero, the curve 
                                 Q
                                 (
                                 ξ
                                 )
                               will be approximate tangent to the line (
                                 d
                                 =
                                 2
                              ) or to the plane (
                                 d
                                 ≥
                                 3
                              ) that passes through point 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               with normal 
                                 
                                    
                                       n
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              . Similarly, if 
                                 
                                    
                                       ω
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                               approaches infinity, the term 
                                 
                                    
                                       (
                                       Q
                                       (
                                       ξ
                                       )
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                               with 
                                 ξ
                                 ∈
                                 
                                    support
                                 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 ξ
                                 )
                                 )
                                 ⋂
                                 Ξ
                               will approach zero too and the point on curve 
                                 Q
                                 (
                                 ξ
                                 )
                               will approach the control point 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              .  □

A matrix weighted rational Bézier curve of degree n is defined by
                        
                           (6)
                           
                              Q
                              (
                              t
                              )
                              =
                              
                                 
                                    [
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              (
                              t
                              )
                              ,
                              
                              
                              
                              t
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                        
                      where 
                        
                           
                              B
                           
                           
                              i
                              ,
                              n
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              n
                              !
                           
                           
                              i
                              !
                              (
                              n
                              −
                              i
                              )
                              !
                           
                        
                        
                           
                              t
                           
                           
                              i
                           
                        
                        
                           
                              (
                              1
                              −
                              t
                              )
                           
                           
                              n
                              −
                              i
                           
                        
                      are the Bernstein basis functions. Based on Theorem 2.1 we know that the matrix weighted rational Bézier curve is valid when the weight matrices are given by Equation (3).

Besides the basic properties stated in Section 2, matrix weighted rational Bézier curves have some other elegant properties due to the special basis functions.


                     
                        Property 3.1
                        End property


                        
                           A matrix weighted rational Bézier curve of degree n interpolates two end control points. If the weight matrices satisfy 
                           
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    M
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    n
                                 
                              
                           
                           , the derivatives of the curve at two ends are parallel to the two end control legs.
                        

Suppose that a matrix weighted rational Bézier curve 
                              Q
                              (
                              t
                              )
                            is defined by Equation (6). Substituting 
                              t
                              =
                              0
                            into the equation, we have
                              
                                 
                                    Q
                                    (
                                    0
                                    )
                                    =
                                    
                                       
                                          [
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             n
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                ,
                                                n
                                             
                                          
                                          (
                                          0
                                          )
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    (
                                    0
                                    )
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    .
                                 
                              
                            Similarly, we have 
                              Q
                              (
                              1
                              )
                              =
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           .

Denoting 
                              
                                 
                                    P
                                 
                                 
                                    M
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              (
                              t
                              )
                            and 
                              M
                              (
                              t
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              (
                              t
                              )
                           , the matrix weighted rational Bézier curve becomes 
                              Q
                              (
                              t
                              )
                              =
                              
                                 
                                    M
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              
                                 
                                    P
                                 
                                 
                                    M
                                 
                              
                              (
                              t
                              )
                           . Thus the derivative of 
                              Q
                              (
                              t
                              )
                            can be obtained as
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    [
                                    
                                       
                                          P
                                       
                                       
                                          M
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    
                                       
                                          M
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    t
                                    )
                                    Q
                                    (
                                    t
                                    )
                                    ]
                                    .
                                 
                              
                            If 
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    n
                                 
                              
                           , we have 
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              (
                              0
                              )
                              =
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              (
                              1
                              )
                              =
                              0
                           . Therefore, the derivatives of the matrix weighted rational Bézier curve at two ends are obtained as
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             0
                                             )
                                             =
                                             
                                                
                                                   M
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             0
                                             )
                                             [
                                             
                                                
                                                   P
                                                
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             0
                                             )
                                             −
                                             
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             0
                                             )
                                             Q
                                             (
                                             0
                                             )
                                             ]
                                             =
                                             n
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             1
                                             )
                                             =
                                             
                                                
                                                   M
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             1
                                             )
                                             [
                                             
                                                
                                                   P
                                                
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             1
                                             )
                                             −
                                             
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             1
                                             )
                                             Q
                                             (
                                             1
                                             )
                                             ]
                                             =
                                             n
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             )
                                             .
                                             
                                          
                                       
                                    
                                 
                              
                            The proposition is proven.  □


                     
                        Property 3.2
                        Conversion


                        
                           A matrix weighted Bézier curve of degree n in 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            
                           can be converted to a rational Bézier curve of degree dn.
                        

Let 
                              M
                              (
                              t
                              )
                            be the matrix function of degree n as defined in Equation (6). The inverse of 
                              M
                              (
                              t
                              )
                            is computed by 
                              
                                 
                                    [
                                    M
                                    (
                                    t
                                    )
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    ⋆
                                 
                              
                              (
                              t
                              )
                              /
                              |
                              M
                              (
                              t
                              )
                              |
                           , where 
                              
                                 
                                    M
                                 
                                 
                                    ⋆
                                 
                              
                              (
                              t
                              )
                            represents the adjoint matrix of 
                              M
                              (
                              t
                              )
                            and 
                              |
                              M
                              (
                              t
                              )
                              |
                            is the determinant of the matrix function. The matrix weighted rational Bézier curve 
                              Q
                              (
                              t
                              )
                            can be reformulated as 
                              Q
                              (
                              t
                              )
                              =
                              
                                 
                                    M
                                 
                                 
                                    ⋆
                                 
                              
                              (
                              t
                              )
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              (
                              t
                              )
                              /
                              |
                              M
                              (
                              t
                              )
                              |
                           . With simple computation, both the numerator and denominator can be formulated as Bézier functions of degree dn. Therefore, the matrix weighted rational Bézier curve 
                              Q
                              (
                              t
                              )
                            is a rational Bézier curve of degree dn by reformulation.  □

Even though matrix weighted rational Bézier curves can be reformulated as traditional rational Bézier curves, the former ones own the advantages of lower degrees and smaller numbers of control points. A curve with fewer control points can be edited more easily and the control normals can help to model straight or flat features very well. Fig. 1
                     (a) illustrates a matrix weighted rational Bézier curve of degree 10 with weight matrices computed by the specified control normals. By choosing all 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              i
                           
                        
                        =
                        1
                      except for 
                        
                           
                              μ
                           
                           
                              2
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              5
                           
                        
                        =
                        
                           
                              μ
                           
                           
                              8
                           
                        
                        =
                        20
                      a bottle like shape with flat bottom and straight sides is generated. When the curve has been transformed into a rational Bézier curve of degree 20, the shape of the control polygon differs significantly with that of the curve; see Fig. 1(b). From the figure we also learn that a matrix weighted rational Bézier curve may not lie in the convex hull of its control polygon. The convex hull of a matrix weighted rational Bézier curve can be obtained by converting it to a rational Bézier curve or some other methods.

A point on a matrix weighted rational Bézier curve 
                        Q
                        (
                        t
                        )
                        =
                        
                           
                              M
                           
                           
                              −
                              1
                           
                        
                        (
                        t
                        )
                        
                           
                              P
                           
                           
                              M
                           
                        
                        (
                        t
                        )
                      can be obtained by computing the matrix 
                        M
                        (
                        t
                        )
                      and point 
                        
                           
                              P
                           
                           
                              M
                           
                        
                        (
                        t
                        )
                      using the traditional de Casteljau algorithm. Alternatively, the point can also be obtained by applying a matrix rational de Casteljau algorithm which is similar to the rational algorithm for robust computation of points on rational Bézier curves (Farin, 2001). For a matrix weighted rational Bézier curve as defined by Equation (6), the matrix rational de Casteljau algorithm begins with the initialization 
                        
                           
                              M
                           
                           
                              i
                           
                           
                              [
                              0
                              ]
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              M
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              Q
                           
                           
                              i
                           
                           
                              [
                              0
                              ]
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              P
                           
                           
                              i
                           
                        
                      for 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                      and computes the intermediate matrices and points
                        
                           
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                          
                                             [
                                             r
                                             ]
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       (
                                       1
                                       −
                                       t
                                       )
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                          
                                             [
                                             r
                                             −
                                             1
                                             ]
                                          
                                       
                                       (
                                       t
                                       )
                                       +
                                       t
                                       
                                          
                                             M
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             [
                                             r
                                             −
                                             1
                                             ]
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                          
                                          
                                             [
                                             r
                                             ]
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                
                                             
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          [
                                          (
                                          1
                                          −
                                          t
                                          )
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                             
                                                [
                                                r
                                                −
                                                1
                                                ]
                                             
                                          
                                          (
                                          t
                                          )
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                             
                                                [
                                                r
                                                −
                                                1
                                                ]
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          t
                                          
                                             
                                                M
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                             
                                                [
                                                r
                                                −
                                                1
                                                ]
                                             
                                          
                                          (
                                          t
                                          )
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                             
                                                [
                                                r
                                                −
                                                1
                                                ]
                                             
                                          
                                          (
                                          t
                                          )
                                          ]
                                       
                                    
                                 
                              
                           
                        
                      for 
                        r
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        n
                      and 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                        −
                        r
                     . Finally, the point is obtained as 
                        Q
                        (
                        t
                        )
                        =
                        
                           
                              Q
                           
                           
                              0
                           
                           
                              [
                              n
                              ]
                           
                        
                        (
                        t
                        )
                     . It is noticed that points 
                        
                           
                              Q
                           
                           
                              i
                           
                           
                              [
                              r
                              ]
                           
                        
                        (
                        t
                        )
                     , 
                        
                           
                              Q
                           
                           
                              i
                           
                           
                              [
                              r
                              −
                              1
                              ]
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              Q
                           
                           
                              i
                              +
                              1
                           
                           
                              [
                              r
                              −
                              1
                              ]
                           
                        
                        (
                        t
                        )
                      may not lie on the same line and the point evaluation by the matrix rational de Casteljau algorithm may no longer be a corner cutting process.

Degree elevation of a matrix weighted rational Bézier curve is also similar to that of the conventional rational Bézier curves. Assume that 
                        
                           
                              M
                           
                           
                              −
                              1
                           
                        
                      and 
                        
                           
                              M
                           
                           
                              n
                              +
                              1
                           
                        
                      are zero matrices. Let 
                        
                           
                              
                                 
                                    M
                                 
                                 ‾
                              
                           
                           
                              i
                           
                        
                        =
                        
                           i
                           
                              n
                              +
                              1
                           
                        
                        
                           
                              M
                           
                           
                              i
                              −
                              1
                           
                        
                        +
                        
                           (
                           1
                           −
                           
                              i
                              
                                 n
                                 +
                                 1
                              
                           
                           )
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                      and
                        
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       ‾
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       i
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       (
                                       1
                                       −
                                       
                                          i
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 [
                                 
                                    i
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    
                                       i
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      
                     
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                        +
                        1
                     . A matrix weighted rational Bézier curve 
                        Q
                        (
                        t
                        )
                      can be represented as
                        
                           
                              Q
                              (
                              t
                              )
                              =
                              
                                 
                                    [
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    n
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    [
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                M
                                             
                                             ‾
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          n
                                          +
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          M
                                       
                                       ‾
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       ‾
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    n
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                              .
                           
                        
                      By the same reason as the matrix rational de Casteljau algorithm, degree elevation of matrix weighted rational Bézier curves is generally not a corner cutting process either.

Suppose that 
                        
                           
                              P
                           
                           
                              i
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                      are a sequence of given points, 
                        
                           
                              M
                           
                           
                              i
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                              ×
                              d
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                      are a set of given matrices. Let 
                        t
                        =
                        {
                        
                           
                              t
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              n
                              +
                              k
                           
                        
                        }
                      be a non-decreasing sequence and no k numbers are the same except for at two ends, a matrix weighted NURBS curve of order k (degree 
                        k
                        −
                        1
                     ) is defined by
                        
                           (7)
                           
                              Q
                              (
                              t
                              )
                              =
                              
                                 
                                    [
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    ]
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              (
                              t
                              )
                              ,
                              
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ]
                           
                        
                      where 
                        
                           
                              N
                           
                           
                              i
                              ,
                              k
                           
                        
                        (
                        t
                        )
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        n
                      are the B-splines defined on the knot vector t. Particularly, the matrix weighted NURBS curve is valid when the weight matrices are defined by Equation (3).

Let 
                        M
                        (
                        t
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        
                           
                              N
                           
                           
                              i
                              ,
                              k
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              P
                           
                           
                              M
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                        
                           
                              M
                           
                           
                              i
                           
                        
                        
                           
                              P
                           
                           
                              i
                           
                        
                        
                           
                              N
                           
                           
                              i
                              ,
                              k
                           
                        
                        (
                        t
                        )
                     . Both the matrix 
                        M
                        (
                        t
                        )
                      and the point 
                        
                           
                              P
                           
                           
                              M
                           
                        
                        (
                        t
                        )
                      can be computed by the deBoor–Cox algorithm. Then, the corresponding point on the matrix weighted NURBS curve 
                        Q
                        (
                        t
                        )
                      can be obtained as 
                        Q
                        (
                        t
                        )
                        =
                        
                           
                              M
                           
                           
                              −
                              1
                           
                        
                        (
                        t
                        )
                        
                           
                              P
                           
                           
                              M
                           
                        
                        (
                        t
                        )
                      and the derivative of 
                        Q
                        (
                        t
                        )
                      can be computed by 
                        
                           
                              Q
                           
                           
                              ′
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              M
                           
                           
                              −
                              1
                           
                        
                        (
                        t
                        )
                        
                           [
                           
                              
                                 P
                              
                              
                                 M
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                           −
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                           Q
                           (
                           t
                           )
                           ]
                        
                     , where 
                        
                           
                              P
                           
                           
                              M
                           
                           
                              ′
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              M
                           
                           
                              ′
                           
                        
                        (
                        t
                        )
                      are the derivatives of the corresponding B-spline curve or the B-spline matrix function. Alternatively, the point 
                        Q
                        (
                        t
                        )
                      can also be evaluated using the matrix rational deBoor–Cox algorithm, just as the rational deBoor–Cox algorithm for a NURBS curve (Farin, 2001).

In addition to the basic properties stated in Section 2, matrix weighted NURBS curves maintain a few similar properties as NURBS curves.


                     
                        Property 4.1
                        Continuity order


                        
                           A matrix weighted NURBS curve of order k is infinitely differentiable on the interior of knot spans and 
                           
                              k
                              −
                              1
                              −
                              p
                            
                           times differentiable at a knot of multiplicity p.
                        


                     
                        Property 4.2
                        End interpolation


                        
                           If the knot vector of a matrix weighted NURBS curve 
                           
                              Q
                              (
                              t
                              )
                            
                           satisfies 
                           
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              =
                              …
                              =
                              
                                 
                                    t
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                              =
                              …
                              =
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    k
                                 
                              
                           
                           , we have 
                           
                              Q
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                            
                           and 
                           
                              Q
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           
                           . Moreover, if 
                           
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    M
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    n
                                 
                              
                           
                           , we also have 
                           
                              
                                 
                                    Q
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    k
                                    −
                                    1
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                              )
                            
                           and 
                           
                              
                                 
                                    Q
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    k
                                    −
                                    1
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          +
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                              −
                              
                                 
                                    P
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                           
                           .
                        


                     
                        Property 4.3
                        Local approximation


                        
                           The movement of control point 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            
                           or the change of weight matrix 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            
                           only changes the curve defined on interval 
                           
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    k
                                 
                              
                              )
                           
                           . If 
                           
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    l
                                    +
                                    1
                                 
                              
                              )
                           
                           , the expression for the matrix weighted NURBS curve is simplified as
                           
                              
                                 
                                    Q
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          [
                                          
                                             ∑
                                             
                                                i
                                                =
                                                l
                                                −
                                                k
                                                +
                                                1
                                             
                                             l
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                          ]
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          l
                                          −
                                          k
                                          +
                                          1
                                       
                                       l
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    .
                                 
                              
                           
                        

Similar to the conversion of matrix weighted rational Bézier curves, matrix weighted NURBS curves can be converted to the traditional NURBS curves. 
                        Property 4.4
                        Conversion to NURBS


                        
                           A matrix weighted NURBS curve of order k in 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            
                           can be converted to a NURBS curve of order 
                           
                              d
                              (
                              k
                              −
                              1
                              )
                              +
                              1
                           
                           .
                        

Besides matrix weighted NURBS curves of degree one that interpolate all of their control points, matrix weighted NURBS curves of higher degrees can interpolate selected control points when the control normals and scalar weights are properly given.


                     
                        Property 4.5
                        Almost-interpolation


                        
                           Assume that 
                           
                              k
                              >
                              2
                            
                           is an integer and 
                           
                              l
                              =
                              ⌊
                              
                                 
                                    k
                                    −
                                    1
                                 
                                 2
                              
                              ⌋
                           
                           , where ⌊⌋ represents the integer part of a number. Let 
                           
                              
                                 
                                    λ
                                 
                                 
                                    q
                                    +
                                    j
                                 
                              
                              =
                              
                                 
                                    N
                                 
                                 
                                    q
                                    +
                                    j
                                    ,
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    q
                                    +
                                    
                                       k
                                       2
                                    
                                 
                              
                              )
                           
                           , 
                           
                              j
                              =
                              ±
                              1
                              ,
                              ±
                              2
                              ,
                              …
                              ,
                              ±
                              l
                           
                           , where 
                           
                              
                                 
                                    N
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              (
                              t
                              )
                            
                           are the uniform B-splines of order k and 
                           
                              
                                 
                                    t
                                 
                                 
                                    q
                                    +
                                    
                                       k
                                       2
                                    
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    q
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    q
                                    +
                                    k
                                 
                              
                              )
                           
                           . Suppose that L is the line that passes through point 
                           
                              
                                 
                                    P
                                 
                                 
                                    q
                                 
                              
                            
                           with direction 
                           
                              
                                 
                                    n
                                 
                                 
                                    q
                                 
                              
                            
                           on a plane, and points 
                           
                              
                                 
                                    P
                                 
                                 
                                    q
                                    +
                                    j
                                 
                              
                            
                           and normals 
                           
                              
                                 
                                    n
                                 
                                 
                                    q
                                    +
                                    j
                                 
                              
                           
                           , 
                           
                              j
                              =
                              ±
                              1
                              ,
                              …
                              ,
                              ±
                              l
                            
                           symmetrically lie on two sides of the line L on the plane. If the weights 
                           
                              
                                 
                                    μ
                                 
                                 
                                    q
                                    +
                                    j
                                 
                              
                           
                           , 
                           
                              j
                              =
                              ±
                              1
                              ,
                              ±
                              2
                              ,
                              …
                              ,
                              ±
                              l
                            
                           are all chosen as
                           
                              
                                 (8)
                                 
                                    μ
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                |
                                                j
                                                |
                                                =
                                                1
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                q
                                                +
                                                j
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                q
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                q
                                             
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                q
                                                +
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                |
                                                j
                                                |
                                                =
                                                1
                                             
                                             
                                                l
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                q
                                                +
                                                j
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                q
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                q
                                                +
                                                j
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                q
                                                +
                                                j
                                             
                                             
                                                T
                                             
                                          
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                q
                                                +
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                q
                                             
                                          
                                          )
                                       
                                    
                                    ,
                                 
                              
                            
                           the matrix weighted NURBS curve with weight matrices 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              I
                              +
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              )
                            
                           passes through point 
                           
                              
                                 
                                    P
                                 
                                 
                                    q
                                 
                              
                            
                           at 
                           
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    q
                                    +
                                    
                                       k
                                       2
                                    
                                 
                              
                           
                           .
                        

Suppose that a matrix weighted NURBS curve 
                              Q
                              (
                              t
                              )
                            passes through point 
                              
                                 
                                    P
                                 
                                 
                                    q
                                 
                              
                            at 
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    q
                                    +
                                    
                                       k
                                       2
                                    
                                 
                              
                           , it requires that 
                              Q
                              (
                              
                                 
                                    t
                                 
                                 
                                    q
                                    +
                                    
                                       k
                                       2
                                    
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                 
                                 
                                    q
                                 
                              
                           . Since 
                              Q
                              (
                              t
                              )
                            satisfies Equation (5), we have
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          +
                                          
                                             k
                                             2
                                          
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          +
                                          
                                             k
                                             2
                                          
                                       
                                    
                                    )
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    0
                                    .
                                 
                              
                            By deleting all the vanishing terms and letting 
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                              =
                              μ
                           , we have
                              
                                 
                                    
                                       ∑
                                       
                                          |
                                          j
                                          |
                                          =
                                          1
                                       
                                       l
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          q
                                          +
                                          j
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          q
                                          +
                                          j
                                       
                                    
                                    )
                                    +
                                    μ
                                    
                                       ∑
                                       
                                          |
                                          j
                                          |
                                          =
                                          1
                                       
                                       l
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          q
                                          +
                                          j
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          q
                                          +
                                          j
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          q
                                          +
                                          j
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          q
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          q
                                          +
                                          j
                                       
                                    
                                    )
                                    =
                                    0
                                    .
                                 
                              
                            Dotting either side of the equation by 
                              
                                 
                                    n
                                 
                                 
                                    q
                                 
                              
                            we have a unique solution of μ given by Equation (8). As points 
                              
                                 
                                    P
                                 
                                 
                                    q
                                    +
                                    j
                                 
                              
                            and normals 
                              
                                 
                                    n
                                 
                                 
                                    q
                                    +
                                    j
                                 
                              
                           , 
                              j
                              =
                              ±
                              1
                              ,
                              …
                              ,
                              ±
                              l
                            symmetrically lie on two sides of the line L, the above steps can be reversed, which proves the proposition.  □

We are interested in the computation of parameter μ for matrix weighted NURBS curves of order 3 or 4. If 
                        k
                        =
                        3
                      or 
                        k
                        =
                        4
                     , we have 
                        l
                        =
                        ⌊
                        
                           
                              k
                              −
                              1
                           
                           2
                        
                        ⌋
                        =
                        1
                      and 
                        
                           
                              λ
                           
                           
                              q
                              −
                              1
                           
                        
                        =
                        
                           
                              λ
                           
                           
                              q
                              +
                              1
                           
                        
                     . Particularly, if points 
                        
                           
                              P
                           
                           
                              q
                              +
                              j
                           
                        
                      and unit normals 
                        
                           
                              n
                           
                           
                              q
                              +
                              j
                           
                        
                     , 
                        j
                        =
                        −
                        1
                        ,
                        0
                        ,
                        1
                      are uniformly sampled from a circular arc, it can be further verified that 
                        
                           
                              n
                           
                           
                              q
                           
                           
                              T
                           
                        
                        (
                        
                           
                              P
                           
                           
                              q
                           
                        
                        −
                        
                           
                              P
                           
                           
                              q
                              −
                              1
                           
                        
                        )
                        =
                        
                           
                              n
                           
                           
                              q
                           
                           
                              T
                           
                        
                        (
                        
                           
                              P
                           
                           
                              q
                           
                        
                        −
                        
                           
                              P
                           
                           
                              q
                              +
                              1
                           
                        
                        )
                      and 
                        
                           
                              n
                           
                           
                              q
                           
                           
                              T
                           
                        
                        (
                        
                           
                              P
                           
                           
                              q
                           
                        
                        −
                        
                           
                              P
                           
                           
                              q
                              +
                              j
                           
                        
                        )
                        =
                        
                           
                              n
                           
                           
                              q
                              +
                              j
                           
                           
                              T
                           
                        
                        (
                        
                           
                              P
                           
                           
                              q
                              +
                              j
                           
                        
                        −
                        
                           
                              P
                           
                           
                              q
                           
                        
                        )
                      for 
                        j
                        =
                        −
                        1
                        ,
                        1
                     . As a result, the formula for parameter μ is simplified as
                        
                           (9)
                           
                              μ
                              =
                              
                                 2
                                 
                                    
                                       
                                          n
                                       
                                       
                                          q
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          q
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          q
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    q
                                    )
                                    |
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          q
                                          )
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          q
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              N
                           
                           
                              1
                           
                        
                        (
                        q
                        )
                      represents the index set of 1-ring neighbor points of point 
                        
                           
                              P
                           
                           
                              q
                           
                        
                      and 
                        |
                        
                           
                              N
                           
                           
                              1
                           
                        
                        (
                        q
                        )
                        |
                      is the valence of point 
                        
                           
                              P
                           
                           
                              q
                           
                        
                     . We will use this latter formula to compute the local parameter μ for defining the weight matrices for surface reconstruction by low order matrix weighted NURBS surfaces or low order matrix weighted rational subdivision surfaces.


                     Fig. 2
                      illustrates an example of curve reconstruction by matrix weighted NURBS. The input 200 points were sampled from a spiral spline which has four pieces of monotone curvature plots. To reconstruct a smooth curve we first chose 30 points from the original data and compute normal vectors for the chosen points based on the input data. By using these points and normals as control points or control normals and computing the weight matrices by Equation (3) and Equation (8), matrix weighted NURBS curves of degree 1, 3 or 10 are generated. Even though the matrix weighted NURBS curve of degree 1 is only 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      continuous at the joint points, it is still visually smooth; see Fig. 2(a). The matrix weighted NURBS curves of higher degrees can achieve higher orders of smoothness and improved fairness as well; see Figs. 2(b) and (c) for the reconstruction results.

This section presents the extensions of Bézier surfaces and NURBS surfaces to matrix weighted rational surfaces. Several popular subdivision surfaces which are also the generalized B-spline surfaces with arbitrary topology control meshes will be extended to matrix weighted rational subdivision surfaces.

Similar to the extensions of Bézier or NURBS curves, rectangle Bézier surfaces and NURBS surfaces can be extended to matrix weighted rational surfaces directly. Assuming 
                           
                              
                                 P
                              
                              
                                 i
                                 j
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                        ; 
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         are a set of given points in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        , 
                           
                              
                                 M
                              
                              
                                 i
                                 j
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                        ; 
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         are a set of given matrices in 
                           
                              
                                 R
                              
                              
                                 d
                                 ×
                                 d
                              
                           
                        , a matrix weighted rational Bézier surface is defined by
                           
                              (10)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          m
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          n
                                       
                                       
                                          
                                             M
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             ,
                                             m
                                          
                                       
                                       (
                                       s
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             ,
                                             n
                                          
                                       
                                       (
                                       t
                                       )
                                       ]
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    m
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       m
                                    
                                 
                                 (
                                 s
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       ,
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 
                                 
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 ∈
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         With the same set of control points and weight matrices, a matrix weighted NURBS surface is obtained as
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          =
                                          
                                             
                                                [
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   m
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      0
                                                   
                                                   n
                                                
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                u
                                                )
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      j
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                (
                                                v
                                                )
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             n
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          (
                                          u
                                          )
                                          
                                             
                                                N
                                             
                                             
                                                j
                                                ,
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          (
                                          v
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ∈
                                          [
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                m
                                                +
                                                1
                                             
                                          
                                          ]
                                          ×
                                          [
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          ]
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 i
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           (
                           u
                           )
                         and 
                           
                              
                                 N
                              
                              
                                 j
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           v
                           )
                         are the B-splines defined on knot vector 
                           u
                           =
                           {
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 m
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           }
                         or 
                           v
                           =
                           {
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 n
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           }
                        , respectively.

Besides the rectangle Bézier patches, triangular Bézier patches can also be generalized to matrix weighted rational Bézier triangles. Suppose that 
                           
                              
                                 P
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        , 
                           0
                           ≤
                           i
                           ,
                           j
                           ,
                           k
                           ≤
                           n
                        , 
                           i
                           +
                           j
                           +
                           k
                           =
                           n
                         are the given control points and 
                           
                              
                                 M
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         are the corresponding weight matrices. A matrix weighted rational triangular Bézier patch of degree n is defined by
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          w
                                          )
                                          =
                                          
                                             
                                                [
                                                
                                                   ∑
                                                   
                                                      i
                                                      +
                                                      j
                                                      +
                                                      k
                                                      =
                                                      n
                                                   
                                                
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      n
                                                   
                                                
                                                (
                                                u
                                                ,
                                                v
                                                ,
                                                w
                                                )
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                +
                                                j
                                                +
                                                k
                                                =
                                                n
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          w
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          0
                                          ≤
                                          u
                                          ,
                                          v
                                          ,
                                          w
                                          ≤
                                          1
                                          ,
                                          u
                                          +
                                          v
                                          +
                                          w
                                          =
                                          1
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 B
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                              
                              
                                 n
                              
                           
                           (
                           u
                           ,
                           v
                           ,
                           w
                           )
                           =
                           
                              
                                 n
                                 !
                              
                              
                                 i
                                 !
                                 j
                                 !
                                 k
                                 !
                              
                           
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                         are the Bernstein basis functions defined on a triangular domain.

To control the surface shape using control points and control normals, the weight matrices 
                           
                              
                                 M
                              
                              
                                 i
                                 j
                              
                           
                         or 
                           
                              
                                 M
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         for Equations (10), (11) or (12) can be computed by Equation (3) using normal vectors 
                           
                              
                                 n
                              
                              
                                 i
                                 j
                              
                           
                         or 
                           
                              
                                 n
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         together with scalar weights 
                           
                              
                                 ω
                              
                              
                                 i
                                 j
                              
                           
                        , 
                           
                              
                                 μ
                              
                              
                                 i
                                 j
                              
                           
                         or 
                           
                              
                                 ω
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        , 
                           
                              
                                 μ
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         specified at the control points. As the matrix weighted rational surfaces have the same representation forms as the classical rational surfaces, they can be evaluated using similar algorithms for scalar weighted rational surfaces.


                        Fig. 3
                        (a) illustrates an input control mesh and the traditional triangular Bézier patch generated by the control mesh. Under the same set of control points together with normals specified at the control points, a matrix weighted rational Bézier triangle is generated; see Fig. 3(b).

An original control mesh consisting of control points sampled from a twisted torus and a uniform B-spline surface of degree 3 in the u-direction (along the minor circle) and degree 6 in the v-direction (along the major circle) generated by the control mesh are illustrated in Fig. 4
                        (a). We further model a matrix weighted NURBS surface of degree (
                           3
                           ,
                           6
                        ) by the control mesh together with a set of control normals specified at the control points. By computing all the weight matrices 
                           
                              
                                 M
                              
                              
                                 i
                                 j
                              
                           
                         with 
                           
                              
                                 ω
                              
                              
                                 i
                                 j
                              
                           
                           =
                           1
                         and 
                           
                              
                                 μ
                              
                              
                                 i
                                 j
                              
                           
                           =
                           10
                        , a twisted torus shape with salient local features modeled by a matrix weighted NURBS surface is obtained; see Fig. 4(b).

Just as the extensions of NURBS surfaces to matrix weighted NURBS surfaces, subdivision surfaces which are also the generalized B-spline surfaces with arbitrary topology control meshes can be extended to matrix weighted rational subdivision surfaces. Particularly, the weight matrices can be defined using the specified normals such that the shapes of the extended subdivision surfaces can be controlled by control points and control normals.

The control data for matrix weighted rational subdivision consists of an initial control mesh and a set of weight matrices specified at the initial control points. For each subdivision the control points and weight matrices will be refined and the generated points will be reconnected to form a new mesh by the same topology refinement rules of the traditional subdivision scheme. Suppose that mesh vertices in mesh 
                           
                              
                                 M
                              
                              
                                 k
                              
                           
                         are refined by a non-rational subdivision scheme as
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    j
                                 
                                 
                                    
                                       s
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                         where the subdivision mask 
                           {
                           
                              
                                 s
                              
                              
                                 i
                                 j
                              
                           
                           }
                         satisfies 
                           
                              
                                 ∑
                              
                              
                                 j
                              
                           
                           
                              
                                 s
                              
                              
                                 i
                                 j
                              
                           
                           =
                           1
                         and 
                           
                              
                                 s
                              
                              
                                 i
                                 j
                              
                           
                           ≥
                           0
                        . The new weight matrices and new vertices by a matrix weighted rational subdivision scheme are computed by
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                j
                                             
                                             
                                                k
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                         Clearly, the matrix weighted rational subdivision will degenerate to the traditional subdivision when all the initial weight matrices are non-singular and are equal with each other.

As an example, we briefly present the algorithm steps and smoothness analysis for matrix weighted rational Catmull–Clark subdivision. Other popular subdivision schemes like Doo–Sabin subdivision and Loop subdivision can be extended similarly.

The first step to refine a mesh 
                           
                              
                                 M
                              
                              
                                 k
                              
                           
                         is to compute new weight matrices. For a face F that consists of vertices 
                           
                              
                                 V
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                         and weight matrices 
                           
                              
                                 M
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           L
                           −
                           1
                         in mesh 
                           
                              
                                 M
                              
                              
                                 k
                              
                           
                        , the face matrix corresponding to the face is computed by
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       F
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    L
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       L
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         When all face matrices have been obtained, the edge matrix for each edge is computed by
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       E
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    4
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       0
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                              
                           
                         where 
                           
                              
                                 M
                              
                              
                                 0
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 1
                              
                              
                                 k
                              
                           
                         are the weight matrices at two ends of the edge and 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         are the face matrices computed for the two neighboring faces of the edge. After that, we refine the weight matrices corresponding to all vertices of 
                           
                              
                                 M
                              
                              
                                 k
                              
                           
                        . If a vertex 
                           
                              
                                 V
                              
                              
                                 V
                              
                              
                                 k
                              
                           
                         is of valence n, the new weight matrix for the vertex is obtained as
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       V
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       n
                                       −
                                       2
                                    
                                    n
                                 
                                 
                                    
                                       M
                                    
                                    
                                       V
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         are the face matrices of the neighboring faces and 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 k
                              
                           
                         are the end weight matrices of neighboring edges other than 
                           
                              
                                 M
                              
                              
                                 V
                              
                              
                                 k
                              
                           
                        .

The second step is to compute new mesh vertices based on the control data of 
                           
                              
                                 M
                              
                              
                                 k
                              
                           
                         and the newly obtained weight matrices as follows
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                F
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      F
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             1
                                             L
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                L
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                E
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      E
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             1
                                             4
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                0
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                0
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                V
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                [
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      V
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             1
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                n
                                                −
                                                2
                                             
                                             n
                                          
                                          
                                             
                                                M
                                             
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Lastly, connect all the refined vertices into a new mesh, just by the topology refinement rules of Catmull–Clark subdivision.

As for the smoothness of the subdivision surface we have the following result.


                        
                           Theorem 5.1
                           
                              Suppose that 
                              
                                 
                                    
                                       M
                                    
                                    
                                       0
                                    
                                 
                               
                              is an arbitrary topology control mesh and 
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                               
                              are the unit normal vectors specified at the control points 
                              
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                               
                              of the mesh. If the weight matrices for the points are defined by 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 I
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              , where 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                               
                              and 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 −
                                 1
                              
                              , the mesh sequences generated by the matrix weighted rational Catmull–Clark subdivision converge and the limit surface is 
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               
                              except for at the extraordinary points where the smoothness is 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                              .
                           

By employing the homogeneous coordinates representation, the control data for the initial control mesh are 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . Thus, the presented matrix weighted rational Catmull–Clark subdivision becomes non-rational subdivision in the homogeneous space 
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       d
                                       +
                                       1
                                       )
                                       ×
                                       d
                                    
                                 
                              . Based on the smoothness analysis of Catmull–Clark subdivision (Doo and Sabin, 1978; Ball and Storry, 1988; Reif, 1995), the homogeneous meshes consisting of data 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 )
                               converge to a 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               surface except for at extraordinary points where the smoothness becomes 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               in 
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       d
                                       +
                                       1
                                       )
                                       ×
                                       d
                                    
                                 
                              . On the other hand, from Equation (13) and Theorem 2.1 we know that each matrix 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                               is non-singular. From Halstead et al. (1993) we know that the limit matrix of 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                               is just a convex combination of the initial weight matrices even at an extraordinary vertex. By Theorem 2.1 once again, we conclude that the matrix component of the limit surface in the homogeneous space is nonsingular. Thus, the matrix weighted rational Catmull–Clark subdivision surface in Euclidean space is valid and has the same smoothness as the limit surface in the homogeneous space, i.e., the limit surface is 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               except for at the extraordinary points where the smoothness is 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              .  □


                        Fig. 5
                        (a) illustrates a surface generated by Catmull–Clark subdivision from an initial control mesh. By using the same control mesh and computing the weight matrices based on the specified unit normal vectors, a matrix weighted rational Catmull–Clark subdivision surface is generated; see Fig. 5(b). Note that the control normals for vertices on each middle boundary control polygon are parallel, thus the four middle boundary curves are the same as those of the Catmull–Clark surface. Under the control of the specified normals, the surface becomes straight and flat in the vertical direction. Fig. 5(c) shows that if we choose some negative weights μ, the surface may shrink in the opposite directions of the control normals.

In this section we present a few more examples to demonstrate how to use the proposed models for shape modeling or surface reconstruction. For each example, the weight matrices are defined with normal vectors specified at the initial control points together with the default choice of 
                        
                           
                              ω
                           
                           
                              i
                           
                        
                        =
                        1
                      or 
                        
                           
                              ω
                           
                           
                              i
                              j
                           
                        
                        =
                        1
                     . If a matrix weighted NURBS surface is generated, the basis functions are defined on uniform knot vectors except for the multiple knots at the boundaries.

First, we present an example of surface design using Bézier or matrix weighted rational Bézier surfaces. Fig. 6
                     (a) illustrates a control mesh that consists of 
                        9
                        ×
                        11
                      control points and a Bézier surface of degree 
                        (
                        8
                        ,
                        10
                        )
                      generated from the control mesh. To generate a matrix weighted rational Bézier surface from the control mesh we first assign a set of unit normals at the control points. By choosing all parameters 
                        
                           
                              μ
                           
                           
                              i
                              j
                           
                        
                        =
                        1.35
                      except for 
                        
                           
                              μ
                           
                           
                              4
                              ,
                              j
                           
                        
                        =
                        1000
                     , 
                        0
                        ≤
                        j
                        ≤
                        10
                     , a sliding board like surface that has a flat bottom is generated; see Fig. 6(b).

Second, we present an example of surface reconstruction by a matrix weighted NURBS surface. Fig. 7
                     (a) illustrates a screwdriver model from which 
                        25
                        ×
                        50
                      points, where 25 is the total row number, were sampled. A set of unit normal vectors at the sampled points have also been estimated from the surface. To reconstruct a bi-cubic matrix weighted NURBS surface with sharp features from the points and normals, we compute 
                        
                           
                              μ
                           
                           
                              i
                              j
                           
                        
                        =
                        
                           1
                           
                              
                                 
                                    d
                                 
                                 
                                    m
                                    i
                                    n
                                 
                              
                              +
                              η
                           
                        
                     , where 
                        
                           
                              d
                           
                           
                              m
                              i
                              n
                           
                        
                        =
                        min
                        ⁡
                        {
                        
                           
                              n
                           
                           
                              i
                              j
                           
                        
                        
                           
                              n
                           
                           
                              i
                              +
                              1
                              ,
                              j
                           
                        
                        ,
                        
                           
                              n
                           
                           
                              i
                              j
                           
                        
                        
                           
                              n
                           
                           
                              i
                              −
                              1
                              ,
                              j
                           
                        
                        ,
                        
                           
                              n
                           
                           
                              i
                              j
                           
                        
                        
                           
                              n
                           
                           
                              i
                              ,
                              j
                              +
                              1
                           
                        
                        ,
                        
                           
                              n
                           
                           
                              i
                              j
                           
                        
                        
                           
                              n
                           
                           
                              i
                              ,
                              j
                              −
                              1
                           
                        
                        }
                      and 
                        η
                        =
                        0.15
                     . In case 
                        i
                        ±
                        1
                      or 
                        j
                        ±
                        1
                      is outside the range, the term 
                        
                           
                              n
                           
                           
                              i
                              j
                           
                        
                        
                           
                              n
                           
                           
                              i
                              ±
                              1
                              ,
                              j
                           
                        
                      or 
                        
                           
                              n
                           
                           
                              i
                              j
                           
                        
                        
                           
                              n
                           
                           
                              i
                              ,
                              j
                              ±
                              1
                           
                        
                      is chosen as 1 directly. Fig. 7(b) illustrates the matrix weighted NURBS surface and the control mesh together with the control normals scaled with weights 
                        
                           
                              μ
                           
                           
                              i
                              j
                           
                        
                     . Fig. 7(c) illustrates the final matrix weighted NURBS surface with clear sharp features. As a comparison, a bi-cubic B-spline surface can be used to fit the sampled points closely, but the original features have been blurred; see Fig. 7(d).

Third, we present two examples of surface modeling by matrix weighted rational subdivision schemes. Fig. 8
                     (a) illustrates an initial control mesh and the Catmull–Clark subdivision surface generated by the control mesh. To model features like flat stairs on the surface a set of control normals are also assigned. Then a subdivision surface with salient features is obtained by applying the matrix weighted rational Catmull–Clark subdivision; see Fig. 8(b) for the control normals and the subdivision surface. Similarly, Figs. 8(c) and (d) are the surfaces generated by the Doo–Sabin subdivision or matrix weighted rational Doo–Sabin subdivision, respectively. The weight matrices for the latter one are computed using the specified normals and a fixed parameter 
                        μ
                        =
                        
                           2
                        
                      for all control points. As the boundary control points together with the control normals at these points lie in the same plane and the parameter μ satisfies Equation (9), the boundary curve by the matrix weighted rational subdivision interpolates exactly the control points.

Lastly, we present an example of surface generation using matrix weighted rational Loop subdivision. The comparison with the traditional Loop subdivision is also given. Fig. 9
                     (a) illustrates the control mesh and the Loop subdivision surface. By choosing the control normals as the averages of normals of neighboring faces for all vertices of the control mesh and computing the scalar weight 
                        
                           
                              μ
                           
                           
                              i
                           
                        
                      by Equation (9), a matrix weighted rational Loop subdivision surface that does not suffer shrinkage from the control mesh is generated; see Fig. 9(c). By employing the technique in Yang and Zheng (2013) we compute the curvatures of an intermediate subdivision mesh to check the smoothness of the subdivision surfaces. From Figs. 9(b) and (d) we can see that the curvature artifacts near the extraordinary vertices within the Loop subdivision surface almost disappear in the matrix weighted rational subdivision surface.

@&#CONCLUSION@&#

We have generalized conventional rational curves and surfaces to matrix weighted rational curves and surfaces. The new models of rational curves and surfaces maintain the same structures and many similar properties as the traditional ones but the matrix weights permit clear shape parameters for geometric modeling. In addition to control points, control normals have been used to control the shapes of extended rational Bézier or extended NURBS curves and surfaces as well as several extended rational subdivision surfaces efficiently. Due to their nice properties such as almost-interpolation of control points, matrix weighted NURBS curves and surfaces are also suitable for curve or surface reconstruction from sampled points even with no need of solving large systems. As matrix weighted rational Bézier or NURBS curves and surfaces can be transformed from and to the traditional rational representations of curves and surfaces, it is convenient to plug the proposed models into Bézier or NURBS based modeling systems.

Several techniques need to be developed further in the future which can make the matrix weighted rational models even more useful for geometric modeling or surface reconstruction: (1) Define the weight matrices in some other geometric ways such that the obtained curves or surfaces can have other desired features; (2) Reconstruct curves and surfaces by adaptively choosing the control points and control normals from the input data; (3) Improve the smoothness of matrix weighted rational subdivision surfaces by applying geometric driven or non-stationary subdivision rules on the weight matrices.

@&#ACKNOWLEDGEMENTS@&#

We thank the editor and the reviewers for helpful comments and suggestions. This work is supported by the National Natural Science Foundation of China grants (11290142, 61272300).

@&#REFERENCES@&#

