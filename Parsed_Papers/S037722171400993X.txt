@&#MAIN-TITLE@&#Adding flexibility in a natural gas transportation network using interruptible transportation services

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a natural gas pipeline network with a system operator and a shipper.


                        
                        
                           
                           We examine the effect of introducing interruptible transportation services.


                        
                        
                           
                           We use stochastic programming to model uncertainty in prices and network capacity.


                        
                        
                           
                           Interruptible transportation services increase network flow and profitability.


                        
                        
                           
                           Increased security of supply levels increases the effect of interruptible services.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Interruptible transportation service

Natural gas

Security of supply

Stochastic programming

@&#ABSTRACT@&#


               
               
                  We present a modeling framework for analyzing if the use of interruptible transportation services can improve capacity utilization in a natural gas transportation network. The network consists of two decision makers: the transmission system operator (TSO) and a shipper of natural gas. The TSO is responsible for the routing of gas in the network and allocates capacity to the shipper to ensure that the security of supply in the network is within given bounds. The TSO can offer two different types of transportation services: firm and interruptible. Only firm services have a security of supply measure, while the interruptible services can freely be interrupted whenever the available capacity in the transportation network is not sufficiently large. We apply our modeling framework on a case study with realistic data from the Norwegian Continental Shelf. The results indicate substantial increased throughput and profits with the introduction of interruptible services.
               
            

@&#INTRODUCTION@&#

In this paper we discuss whether the introduction of interruptible transportation services in a natural gas network can increase throughput without deteriorating the security of supply. In our modeling framework we include both firm and interruptible transportation services, where firm services are characterized by a guaranteed level of security of supply while interruptible services are delivered provided there is available capacity on the given day. We present a general model framework and a case study based on realistic data from the Norwegian natural gas transportation system that covers nearly 20 percent of European gas consumption (Norwegian Petroleum Directorate, 2012).

Interruptible transportation services are well known within the natural gas supply chain, as they are available in the US and in several European systems (including the Norwegian). These services allow the TSO to oversell the capacity by reselling capacity that is booked firm but not nominated without relieving the obligation to the original buyer, as described in Doane, McAfee, Nayyar, and Williams (2008). It is usually required that all firm capacity, defined by a predefined static limit, is sold before any capacity can be resold as interruptible. The intention of the interruptible services is to improve the short term redistribution of transportation capacity to support an efficient use of the network (Ruff, 2012). Our motivation for introducing interruptible transportation services is different. We focus on increasing the capacity initially made available by the TSO rather than redistribution of allocated capacity between the producers. The latter will increase the utilization of the offered capacity in the network, while the former will increase the capacity offered. This implies a slightly different definition since we discuss interruptible contracts in a primary market without any assumption on resale. We are not aware of any natural gas network or examples in the literature where interruptible services are used for this purpose.

A high level of security of supply is important on the market side, for the shippers to be able to deliver in long-term contracts. It is also important on the production side, to ensure that the oil production on the fields with associated gas will not be decreased. In order to maintain a high level of security of supply on firm services, it is necessary for the system operator to withhold some capacity in the system at the time of booking to have flexibility to handle uncertainties in the final operation. This withheld flexibility can decrease the capacity utilization in the network. Security of supply can be expressed through different measures. Within the power sector the N-1 method, requiring feasible operation even if one element in the network goes down, is a traditional way of providing robustness in case of contingencies (see for instance Vournas, 2001). Bopp, Kannan, Palocsay, and Stevens (1996) use a set of business rules to achieve satisfactory security of supply when optimizing the planning problem of a local natural gas distribution company. Guldmann and Wang (1999) include a curtailment cost on not satisfied demand for a similar problem. In the stochastic programming literature a variety of risk measures are presented (see for example Rockafellar, 2007), but so far these are rarely applied in natural gas applications. We define the security of supply level as the expected throughput in the whole system relative to the total firm booking:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             Security
                                             
                                             of
                                             
                                             supply
                                          
                                          =
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                Scenarios
                                             
                                          
                                          
                                             Probability
                                             s
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      Nodes
                                                   
                                                
                                                
                                                   Flow
                                                   is
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      Nodes
                                                   
                                                
                                                
                                                   Booking
                                                   is
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     This is the same definition as used by Hellemo, Midthun, Tomasgard, and Werner (2013), but in contrast to them we also report numerical analysis.

Unplanned events, such as outages and technical failure, cause uncertainty in the available capacity in the transportation network. Furthermore, the system operator must take into account system effects that make it impossible to a priori determine fixed capacities (see Midthun, Bj°rndal, and Tomasgard, 2009). This corresponds to the arguments by Vazquez, Hallack, and Glachant (2012) who point out that the shipper’s simplified view on the transportation network, only acting in accordance with entry and exit booking points, requires the TSO to withhold some capacity to match the booking obligations with the physical network capabilities.

The short-term system flexibility comes from the possibility to increase production levels in some fields, to reroute the gas, and from the storage capabilities in the pipelines (linepack). Midthun, Nowak, and Tomasgard (2007) and Keyaerts, Hallack, Glachant, and D’haeseleer (2011) show that linepack also has a commercial value that introduces a trade-off in relation to security of supply. We have not included linepack and this trade-off in our analysis to limit the model complexity and to focus the analysis on effects of interruptible contracts. In our single-period model the availability of linepack would have increased the network capacity that could reduce the value of introducing interruptible services, while in a realistic dynamic setting this effect would highly depend on the time structure of network events and the trade-off between commercial use and security of supply considerations.

Modeling the physics of gas transportation in pipeline networks is challenging, mainly due to nonlinear properties in pressure dynamics in pipelines, compressor efficiency and gas quality management. Martin, Möller, and Moritz (2006) and Tomasgard, R°mo, Fodstad, and Midthun (2007) optimizes a steady-state representation of gas network pressures and flows. Moritz (2007) models transient flows, while Ulstein, Nygreen, and Sagli (2007), Selot, Kuok, Robinson, Mason, and Barton (2008) and Li, Armagan, Tomasgard, and Barton (2011) model gas quality issues. We use a linear steady-state approximation of the pressure dynamics in pipelines. We assume a homogeneous gas quality, and thereby avoid the nonlinearities from gas quality management. This assumption is a reasonable approximation in networks with small quality variations, for instance downstream of processing, but it is otherwise a simplification.

Our contribution is both a modeling framework that allows for detailed analysis of interruptible services to address uncertainty in network capacity availability in the natural gas transportation network, as well as a case study based on realistic data and topology from the Norwegian Continental Shelf (NCS). In addition, we introduce a new production cost function for natural gas fields that takes into account associated oil production. Our models are based on stochastic programming and do not include strategic behavior of the participants. The validity of this will be discussed in further detail when we introduce our models.

In Section 2 we describe in more detail the decision sequence as well as some of our assumptions. We then present the modeling framework in Section 3, before we move on to the case study in Section 4. Finally, we conclude in Section 5.

In this section we present the model structure and discuss the underlying assumptions. In our model framework, we establish a decision sequence involving the agents in the supply chain (see Fig. 1
                     ). At t = 1 the shippers submit their booking requests under the uncertainty of available firm capacity and at t = 2 the TSO allocates the capacity between the shippers. The TSO tries to minimize the deviation between requested booking and allocated capacity while meeting the security of supply requirements (see Eq. (1)). At t = 3, when the allocated firm booking is known by the shippers, they book interruptible capacity. The interruptible capacity is unlimited, but the shippers will include the probability of interruptions when making booking decisions. At t = 4 uncertainty regarding network events and market prices are resolved. The TSO then allocates interruptions based on a feasible routing pattern. Finally, at t = 5 the shippers produce and do short term trades. The decision sequence we have described is similar to the one used in the current system on the NCS, apart from the difference in use of interruptible services.

The objective of this work is to evaluate the potential from introducing interruptible transportation services for the network as a whole, while recognizing that different agents in the system have different incentives. The modeling has been guided by the Norwegian system. We have made some important modeling choices to make the model framework tractable and focus on the effects we intend to analyze:

                        
                           (1)
                           We analyze the perfect competition situation which means we can model all shippers as a single agent. It implies that any strategic behavior that could improve a single shipper’s performance, but reduce the overall supply chain performance, is not captured. It is not clear if such gaming is present in the transportation market on the NCS, thus we have decided to not model gaming for our initial study. The aggregation of all shippers into a single agent reduces the uncertainty seen by the shippers, since the modeled shipper knows the total booking in the system. This also means that we find a benchmark solution for the shipper’s profits in the network when interruptible services are introduced. This corresponds to maximizing the total supply chain profits in our model. With more than one shipper competing for the booking capacity, the shippers’ profits in the network will be reduced (or at best stay the same) compared to the situation when all shippers are unified to one decision unit. The difference will depend on the rules for capacity allocation between the different shippers, and is not the focus of this paper.

We model booking of firm and interruptible services by a sequential procedure. The reason for this is that we want to force the shippers to prioritize firm capacity, and provide realistic incentives for firm services relative to interruptible services. Existing interruptible services are available only if firm capacity is already fully utilized, which we expect to be a requirement also if interruptible services are introduced in the primary transportation service market. The sequential model setup implies that the shipper will book firm services as long as the marginal value exceeds the firm tariff, without the option of gambling on the future availability of cheaper interruptible services.

We model the TSO and the shipper as independent agents rather than an integrated agent even though we seek a perfect competition situation. This is reasonable since we model a regulated TSO rather than a profit maximizing TSO. The modeling choice makes us able to observe how the two agents’ different objectives and access to information about different parts of the supply chain affect the overall performance.

We assume that both shipper and TSO base their expectations of network events on statistical properties from historical observations which are common knowledge for both. We expect this to closely resemble the real-world situation.

Booking tariffs can be set as a market driven equilibrium price or defined as a regulated fixed tariff. The existing regime on NCS use fixed tariffs. These are set to cover short and long term costs of the network and a “reasonable” rate-of-return for the investors. Regulated tariffs support the underlying principle that profits on the NCS should be generated from production and sales of natural gas, not from the transportation network. On the other hand, this regime is more limited on providing price signals for efficient allocation of capacity than a market driven price. For more details, see Dahl (2001) and Gassco (2012).

From a shipper’s perspective it is reasonable to expect interruptible tariffs to be less than firm tariffs, but that might not be the result when tariffs are based on costs. For example if interruptible capacity is seen as additional capacity “on top of” the firm capacity, the interruptible capacity will typically be priced by a more expensive part of the compressor cost curve. To keep our model in accordance with the current regime on the NCS, we use fixed tariffs and the tariffs for interruptible services are lower than for firm (Gassco, 2012).

This section provides a mathematical formulation of the models. A model system overview is given in Fig. 2
                     , and the full notation is provided in Appendix B. The model system consists of five optimization models, three shipper problems, SP1–SP3, and two models for the TSO, TSO1–TSO2. Among these, three models are stochastic problems, SP1, SP2 and TSO1, while two models are deterministic problems, SP3 and TSO2. Fig. 2 shows the sequence the models are run in (from left to right), the decisions that are taken in each model and the information flow (division into stages). The text within each box belonging to a model describes the decisions taken by the model. Results from each problem except SP3 are used by all the following models, as illustrated by the curved arcs on top. The three horizontal areas in the illustration, white, light gray, and dark gray, indicates the information set that each decision is based on, and corresponds to the scenario tree illustrated in Fig. 3
                     . The outcomes in the second stage (light gray) represent network events, 
                        
                           
                              s
                              2
                           
                           ∈
                           
                              S
                              2
                           
                        
                      and the outcomes in the third stage (dark gray) represent market prices, 
                        
                           
                              s
                              3
                           
                           ∈
                           
                              S
                              3
                           
                        
                     . These outcomes are assumed to be independent of each other and identical in all the models. A scenario then consists of a combination of an event and a price outcome. The outcomes have the corresponding probabilities 
                        
                           π
                           
                              s
                              2
                           
                        
                      and 
                        
                           π
                           
                              s
                              3
                           
                        
                     .

In the first shipper problem, SP1, the producer requests booking based on event and market outcomes and estimates of future interruptions, production and sales decisions. At this stage the shipper does not see the possibility to book interruptible capacity later. Based on the booking request the TSO allocates firm capacity in TSO1. In the second shipper problem, SP2, interruptible booking decisions are taken. This problem is similar to SP1, except that firm capacity is given and interruptible booking capacity is made available. When all booking is decided and the events in the transportation network have become known the TSO decides how much interruptible and firm capacity he needs to interrupt in TSO2. Based on the final available capacity and the realized market prices the shipper decides on the amounts to produce and sell in SP3.


                     SP1 and SP2 are three stage quadratic stochastic programs, while SP3 is a deterministic model that is run for all nodes in the last stage of the scenario tree. The first stage decision in SP1 and SP2 is capacity booking, while in the second stage the shipper’s estimates of the TSO’s interruption decisions are made based on the event outcomes. The third stage is the actual operation with production and sales. SP2 and SP3 are variants of SP1, where firm booking is fixed in SP2 while both booking types are fixed in SP3. SP3 is the same problem as the last stage of SP1 and SP2.

The TSO problems use a network composed of field nodes, 
                        
                           g
                           ∈
                           G
                           ,
                        
                      market nodes, 
                        
                           m
                           ∈
                           M
                           ,
                        
                      intermediate nodes, 
                        
                           i
                           ∈
                           I
                        
                      and connecting pipelines. The field nodes and market nodes constitute the booking nodes, 
                        
                           n
                           ∈
                           N
                           =
                           G
                           ∪
                           M
                           ,
                        
                      that are the network nodes in the shipper’s problems. In accordance with the separate responsibilities of TSO and shipper in an entry–exit system (Alonso, Olmos, and Serrano, 2010), the shipper does not see the pipelines, but rather a fully connected network.

In SP1 interruptible booking is set to zero. This means that the shipper does not foresee the possibility to book interruptible capacity as he makes his initial booking request. This mimics the market design rule that interruptible capacity should only be made available if all firm capacity is allocated.

The objective of a shipper is to maximize his expected profit that is the expected income from selling gas in the spot markets less the expected production costs and the transportation cost (booking tariffs):

                              
                                 (2)
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         s
                                                         2
                                                      
                                                      ∈
                                                      
                                                         S
                                                         2
                                                      
                                                   
                                                
                                                
                                                   π
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         s
                                                         3
                                                      
                                                      ∈
                                                      
                                                         S
                                                         3
                                                      
                                                   
                                                
                                                
                                                   π
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         P
                                                         
                                                            m
                                                            ,
                                                            
                                                               s
                                                               3
                                                            
                                                         
                                                      
                                                      
                                                         x
                                                         
                                                            m
                                                            ,
                                                            
                                                               s
                                                               2
                                                            
                                                            ,
                                                            
                                                               s
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         g
                                                         ∈
                                                         G
                                                      
                                                   
                                                   
                                                      F
                                                      g
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         
                                                            g
                                                            ,
                                                            
                                                               s
                                                               2
                                                            
                                                            ,
                                                            
                                                               s
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   T
                                                   n
                                                   F
                                                
                                                
                                                   z
                                                   n
                                                   F
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 P
                                 
                                    m
                                    ,
                                    
                                       s
                                       3
                                    
                                 
                              
                            is the market price in market m in market outcome s
                           3, 
                              
                                 x
                                 
                                    m
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       3
                                    
                                 
                              
                            is the volume sold in market m in the scenario given by event outcome s
                           2 and market outcome s
                           3. The production cost is given by the cost function Fg
                           () which is a function of the production 
                              
                                 y
                                 
                                    g
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       3
                                    
                                 
                              
                            in field g. The cost of firm booking is given by the tariff 
                              
                                 T
                                 n
                                 F
                              
                            in node n and the booking level 
                              
                                 
                                    z
                                    n
                                    F
                                 
                                 ,
                              
                            and these costs are independent of whether the capacity is interrupted or not.

The production cost function consists of two parts, one for production with associated oil, called “must-take”, and one for the swing field production. The reasoning behind this is that each of the field nodes in our network represents a set of fields, each with different properties. In the must-take area, the natural gas is closely linked to the oil production. If the gas production is decreased, the oil production must also be decreased. Such a decrease will then lead to a substantial loss for the shipper. For the swing fields, the gas production will not influence the oil production. We represent the production costs for these fields with a quadratic cost function based on a modification of the function provided by Golombek, Gjelsvik, and Rosendahl (1995). We omit the logarithmic part that, in effect, provides maximum production levels. Instead we have implemented a fixed upper limit for the production in each field node. The production cost function is represented by (3)–(6) and is illustrated in Fig. 4
                           . The production cost for the must-take production, 
                              
                                 
                                    c
                                    
                                       g
                                       ,
                                       
                                          s
                                          2
                                       
                                       ,
                                       
                                          s
                                          3
                                       
                                    
                                    MT
                                 
                                 ,
                              
                            is modeled by a set of Q linear constraints:

                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                   MT
                                                
                                                ≥
                                                
                                                   C
                                                   
                                                      g
                                                      ,
                                                      q
                                                   
                                                   
                                                      A
                                                      MT
                                                   
                                                
                                                +
                                                
                                                   C
                                                   
                                                      g
                                                      ,
                                                      q
                                                   
                                                   
                                                      B
                                                      MT
                                                   
                                                
                                                
                                                   y
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                
                                                
                                                g
                                                ∈
                                                G
                                                ,
                                                q
                                                ∈
                                                Q
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 C
                                 
                                    g
                                    ,
                                    q
                                 
                                 
                                    A
                                    MT
                                 
                              
                            and 
                              
                                 C
                                 
                                    g
                                    ,
                                    q
                                 
                                 
                                    B
                                    MT
                                 
                              
                            are cost parameters for field g and linear constraint q. In addition, there is the quadratic production cost function in the swing fields:

                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                   SW
                                                
                                                =
                                                
                                                   C
                                                   g
                                                   
                                                      B
                                                      SW
                                                   
                                                
                                                
                                                   y
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                   SW
                                                
                                                +
                                                
                                                   C
                                                   g
                                                   
                                                      C
                                                      SW
                                                   
                                                
                                                
                                                   y
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         SW
                                                      
                                                      2
                                                   
                                                
                                                
                                                g
                                                ∈
                                                G
                                                ,
                                                q
                                                ∈
                                                Q
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 C
                                 g
                                 
                                    B
                                    SW
                                 
                              
                            is the cost parameter for the linear part of the cost function in field g while 
                              
                                 C
                                 g
                                 
                                    C
                                    SW
                                 
                              
                            is the cost parameter for the quadratic part of the cost function. The production related to swing capacity in a field is given by 
                              
                                 y
                                 
                                    g
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       3
                                    
                                 
                                 SW
                              
                            which is the difference between the total production in a node, 
                              
                                 y
                                 
                                    g
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       3
                                    
                                 
                              
                            and the defined must-take level 
                              
                                 Y
                                 g
                                 MT
                              
                           :

                              
                                 (5)
                                 
                                    
                                       
                                          y
                                          
                                             g
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                          SW
                                       
                                       ≥
                                       
                                          y
                                          
                                             g
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                       
                                       −
                                       
                                          Y
                                          g
                                          MT
                                       
                                       
                                       g
                                       ∈
                                       G
                                       ,
                                       
                                          s
                                          2
                                       
                                       ∈
                                       
                                          S
                                          2
                                       
                                       ,
                                       
                                          s
                                          3
                                       
                                       ∈
                                       
                                          S
                                          3
                                       
                                       .
                                    
                                 
                              
                           The cost function 
                              
                                 F
                                 (
                                 
                                    y
                                    
                                       g
                                       ,
                                       
                                          s
                                          2
                                       
                                       ,
                                       
                                          s
                                          3
                                       
                                    
                                 
                                 )
                              
                            is then given as:

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                F
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         g
                                                         ,
                                                         
                                                            s
                                                            2
                                                         
                                                         ,
                                                         
                                                            s
                                                            3
                                                         
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   c
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                   MT
                                                
                                                +
                                                
                                                   c
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                   SW
                                                
                                                
                                                g
                                                ∈
                                                G
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Production should stay within the production capacity limits:

                              
                                 (7)
                                 
                                    
                                       
                                          y
                                          
                                             g
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                       
                                       ≤
                                       
                                          Y
                                          
                                             g
                                             ,
                                             
                                                s
                                                2
                                             
                                          
                                       
                                       
                                       g
                                       ∈
                                       G
                                       ,
                                       
                                          s
                                          2
                                       
                                       ∈
                                       
                                          S
                                          2
                                       
                                       ,
                                       
                                          s
                                          3
                                       
                                       ∈
                                       
                                          S
                                          3
                                       
                                       .
                                    
                                 
                              
                           
                        

The shipper has to book capacity to inject gas into the network from the field nodes and to extract gas from the network to the market nodes. Firm capacity is booked in the first stage and we require that the requested booking for entry capacity in the fields should equal the requested booking for exit capacity in the markets:

                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      G
                                                   
                                                
                                                
                                                   z
                                                   g
                                                   F
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   z
                                                   m
                                                   F
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The TSO will always allocate capacity such that the firm booking is balanced. This is necessary to make it possible for the TSO to evaluate the capacity in each node, which depends on the flow pattern in the system.

In reality the shipper has historical data and observations on network capacities and events. In our model we need to approximate this in a transportation capacity, 
                              
                                 
                                    H
                                    
                                       n
                                       ,
                                       
                                          s
                                          2
                                       
                                    
                                 
                                 ,
                              
                            that depends on the event outcomes. This is done by a preprocessing procedure described in Appendix A. The transportation capacity is static in the sense that it does not take into account how the shipper’s own production and delivery decisions affect the flow patterns and thereby the capacity. The shipper’s estimate for interruption of firm booking, 
                              
                                 a
                                 
                                    n
                                    ,
                                    
                                       s
                                       2
                                    
                                 
                                 
                                    
                                    F
                                 
                              
                            can then be described by the difference between the transportation capacity and the booking 
                              
                                 z
                                 n
                                 
                                    
                                    F
                                 
                              
                           :

                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                   
                                                      n
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                   F
                                                
                                                ≥
                                                
                                                   z
                                                   n
                                                   F
                                                
                                                −
                                                
                                                   H
                                                   
                                                      n
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Gas is sold in spot markets with perfect competition. The total sales by the shipper are then limited by the total production:

                              
                                 (10)
                                 
                                    
                                       
                                          ∑
                                          
                                             g
                                             ∈
                                             G
                                          
                                       
                                       
                                          y
                                          
                                             g
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             m
                                             ∈
                                             M
                                          
                                       
                                       
                                          x
                                          
                                             m
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                       
                                       
                                       
                                          s
                                          2
                                       
                                       ∈
                                       
                                          S
                                          2
                                       
                                       ,
                                       
                                          s
                                          3
                                       
                                       ∈
                                       
                                          S
                                          3
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 x
                                 
                                    m
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       3
                                    
                                 
                              
                            is the volume sold in market m in event outcome s
                           2 and market outcome s
                           3. In addition, the sale in market m is limited by the uninterrupted booking into this node:

                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   
                                                      m
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                
                                                ≤
                                                
                                                   z
                                                   m
                                                   F
                                                
                                                −
                                                
                                                   a
                                                   
                                                      m
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                   F
                                                
                                                
                                                m
                                                ∈
                                                M
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Finally, we must make sure that the uninterrupted booking is sufficient for the production levels in the field nodes:

                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                      ,
                                                      
                                                         s
                                                         3
                                                      
                                                   
                                                
                                                ≤
                                                
                                                   z
                                                   g
                                                   F
                                                
                                                −
                                                
                                                   a
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                   F
                                                
                                                
                                                g
                                                ∈
                                                G
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ∈
                                                
                                                   S
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The TSO allocates firm capacity to the shipper based on the booking requests from SP1. The TSO seeks to satisfy the requests, but are limited by the transportation capacities in the network and a requirement on expected security of supply. TSO1 is a two-stage quadratic stochastic program, where allocations are given in the first stage; while the routing decisions are made in the second stage after the network capacity availability is known. The objective of this problem is to minimize the square deviation from booking requests, such that the allocation stays close to the requests from the shipper:

                           
                              (13)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         z
                                                         ¯
                                                      
                                                      n
                                                      F
                                                   
                                                   −
                                                   
                                                      z
                                                      n
                                                      F
                                                   
                                                   )
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 z
                                 ¯
                              
                              n
                              F
                           
                         is the booking requests made by the shipper while 
                           
                              z
                              n
                              F
                           
                         is the allocated capacity to the shipper from the TSO. We must make sure that the shipper capacity allocation is no more than he requested 
                           
                              
                                 z
                                 ¯
                              
                              n
                              
                                 
                                 F
                              
                           
                        :

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                n
                                                F
                                             
                                             ≤
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                n
                                                F
                                             
                                             
                                             n
                                             ∈
                                             N
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        On expectation, the security of supply should be at least R, which corresponds to limiting the expected interruption-to-booking-ratio to be less than 1 − R. The security of supply is the total expected delivery rate by the TSO over total firm booking. This limits the expected interruptions, which are represented by the difference between the allocated firm bookings to a market node m, 
                           
                              z
                              m
                              F
                           
                         and the sum of flows 
                           
                              f
                              
                                 j
                                 ,
                                 m
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                         from nodes j to market m:

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      s
                                                      2
                                                   
                                                   ∈
                                                   
                                                      S
                                                      2
                                                   
                                                
                                             
                                             
                                                π
                                                
                                                   s
                                                   2
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   z
                                                   m
                                                   F
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      I
                                                      (
                                                      m
                                                      )
                                                   
                                                
                                                
                                                   f
                                                   
                                                      j
                                                      ,
                                                      m
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                (
                                                1
                                                −
                                                R
                                                )
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                z
                                                m
                                                F
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We then add constraints to make sure that the flows are limited by the allocated booking in the booking nodes (fields g and markets m). The set 
                           
                              O
                              (
                              j
                              )
                           
                         gives the nodes which are connected directly downstream to a pipeline going from node j, while the set 
                           
                              I
                              (
                              j
                              )
                           
                         gives the nodes that are connected directly upstream to a pipeline in node j.

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   O
                                                   (
                                                   g
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   g
                                                   ,
                                                   j
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ≤
                                             
                                                z
                                                g
                                                F
                                             
                                             
                                             g
                                             ∈
                                             G
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                   (
                                                   m
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   j
                                                   ,
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ≤
                                             
                                                z
                                                m
                                                F
                                             
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        For the intermediate nodes (that are not booking nodes) we must take care of the mass balance:

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                   (
                                                   j
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   O
                                                   (
                                                   j
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             
                                             j
                                             ∈
                                             J
                                             ∖
                                             N
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The events are modeled by reduced capacities 
                           
                              K
                              
                                 i
                                 ,
                                 j
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                         in pipelines between nodes i and j. In fields and markets the reduced capacity is given by 
                           
                              K
                              
                                 j
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                        :

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   j
                                                   ,
                                                   i
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ≤
                                             
                                                K
                                                
                                                   j
                                                   ,
                                                   i
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             
                                             j
                                             ∈
                                             J
                                             ,
                                             i
                                             ∈
                                             O
                                             
                                                (
                                                j
                                                )
                                             
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   O
                                                   (
                                                   g
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   g
                                                   ,
                                                   j
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ≤
                                             
                                                K
                                                
                                                   g
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             
                                             g
                                             ∈
                                             G
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                   (
                                                   m
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   j
                                                   ,
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ≤
                                             
                                                K
                                                
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The dynamic capacity of the network depends on the pressure in each node, and is described through a Weymouth equation for each pipeline. The Weymouth equation has the following form:

                           
                              (22)
                              
                                 
                                    
                                       f
                                       
                                          j
                                          ,
                                          i
                                          ,
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    =
                                    
                                       K
                                       
                                          j
                                          ,
                                          i
                                       
                                       W
                                    
                                    
                                       
                                          
                                             p
                                             
                                                j
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                             2
                                          
                                          −
                                          
                                             p
                                             
                                                i
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                             2
                                          
                                       
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    i
                                    ∈
                                    O
                                    
                                       (
                                       
                                       j
                                       )
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ∈
                                    
                                       S
                                       2
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              K
                              
                                 j
                                 ,
                                 i
                              
                              W
                           
                         is the Weymouth constant for the pipeline going from node j to node i. This constant depends on characteristics of the pipeline such as diameter, length and roughness (for more details, see for instance Campbell (1992)). The pressure in node j in event outcome s
                        2 is then given by 
                           
                              p
                              
                                 j
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                        . Since (22) is not linear, an outer approximation derived by Taylor series expansion around fixed pressure points PIl
                         and POl
                         is used (R°mo et al., 2009):

                           
                              (23)
                              
                                 
                                    
                                       f
                                       
                                          j
                                          ,
                                          i
                                          ,
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    ≤
                                    
                                       K
                                       
                                          j
                                          ,
                                          i
                                       
                                       W
                                    
                                    
                                       (
                                       
                                          
                                             PI
                                             l
                                          
                                          
                                             
                                                PI
                                                l
                                                2
                                             
                                             
                                             −
                                             
                                             
                                                PO
                                                l
                                                2
                                             
                                          
                                       
                                       
                                          p
                                          
                                             i
                                             ,
                                             
                                                s
                                                2
                                             
                                          
                                       
                                       −
                                       
                                          
                                             PO
                                             l
                                          
                                          
                                             
                                                PI
                                                l
                                                2
                                             
                                             −
                                             
                                                PO
                                                l
                                                2
                                             
                                          
                                       
                                       
                                          p
                                          
                                             j
                                             ,
                                             
                                                s
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    l
                                    ∈
                                    L
                                    ,
                                    
                                       s
                                       2
                                    
                                    ∈
                                    
                                       S
                                       2
                                    
                                    ,
                                 
                              
                           
                        where the set 
                           L
                         gives the fixed points used for the linearization. In our experience around 20 of these constraints are needed to assure a good fit to the Weymouth equation. Finally, we must make sure that the pressure in each node j is within its upper and lower limit (
                           
                              
                                 P
                                 ¯
                              
                              j
                           
                         and 
                           P
                         
                        
                           j
                        ):

                           
                              (24)
                              
                                 
                                    
                                       
                                          P
                                          ̲
                                       
                                       j
                                    
                                    ≤
                                    
                                       p
                                       
                                          j
                                          ,
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    ≤
                                    
                                       
                                          P
                                          ¯
                                       
                                       j
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                       s
                                       2
                                    
                                    ∈
                                    
                                       S
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

In SP2 the objective function in SP1 (see Eq. (2)) is extended with interruptible booking tariff

                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                T
                                                n
                                                I
                                             
                                             
                                                z
                                                n
                                                I
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The main change is that the allocation of firm capacity has been done by the TSO and is now input to the shipper’s optimization problem, 
                           
                              
                                 z
                                 ¯
                              
                              n
                              F
                           
                        . In the first stage in this three-stage stochastic program the shipper decides how much interruptible capacity to book, 
                           
                              z
                              n
                              I
                           
                        . In the second stage the network capacity availability becomes known and finally, in the third stage, the market prices become known.

When the network capacity availability becomes known in the second stage, the TSO decides upon routing and thus on how much of the shipper’s booked capacity that must be interrupted. The shipper estimates the event dependent interruption, 
                           
                              
                                 a
                                 
                                    n
                                    ,
                                    
                                       s
                                       2
                                    
                                 
                              
                              ,
                           
                         as the difference between the total booking and the shipper’s estimate for available capacity in event outcome s
                        2, 
                           
                              
                                 H
                                 
                                    n
                                    ,
                                    
                                       s
                                       2
                                    
                                 
                              
                              :
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ≥
                                             
                                                (
                                                
                                                   
                                                      z
                                                      ¯
                                                   
                                                   n
                                                   F
                                                
                                                +
                                                
                                                   z
                                                   n
                                                   I
                                                
                                                )
                                             
                                             −
                                             
                                                H
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ,
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Finally, the shipper assumes that the TSO will allocate capacities such that the final booking is balanced in the sense that entry (field) capacity equals exit (market) capacity:

                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   G
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      z
                                                      ¯
                                                   
                                                   g
                                                   F
                                                
                                                +
                                                
                                                   z
                                                   g
                                                   I
                                                
                                                −
                                                
                                                   a
                                                   
                                                      g
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      z
                                                      ¯
                                                   
                                                   m
                                                   F
                                                
                                                +
                                                
                                                   z
                                                   m
                                                   I
                                                
                                                −
                                                
                                                   a
                                                   
                                                      m
                                                      ,
                                                      
                                                         s
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We also need to include the mass balances in this problem, now including both firm and interruptible booking. The injections and extractions are not allowed to exceed the allocated capacity in each booking node, that is the booked firm (
                           
                              
                                 z
                                 ¯
                              
                              g
                              F
                           
                         and 
                           
                              
                                 z
                                 ¯
                              
                              m
                              F
                           
                        ) and interruptible capacity (
                           
                              z
                              g
                              I
                           
                         and 
                           
                              z
                              m
                              I
                           
                        ) less the estimated interruptions (
                           
                              a
                              
                                 g
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                         and 
                           
                              a
                              
                                 m
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                        ).

                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   g
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                   ,
                                                   
                                                      s
                                                      3
                                                   
                                                
                                             
                                             ≤
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                g
                                                F
                                             
                                             +
                                             
                                                z
                                                g
                                                I
                                             
                                             −
                                             
                                                a
                                                
                                                   g
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ,
                                             
                                             g
                                             ∈
                                             G
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                             ∈
                                             
                                                S
                                                3
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                   ,
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                S
                                             
                                             ≤
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                m
                                                F
                                             
                                             +
                                             
                                                z
                                                m
                                                I
                                             
                                             −
                                             
                                                a
                                                
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ,
                                             
                                             m
                                             ∈
                                             M
                                             ,
                                             
                                                s
                                                2
                                             
                                             ∈
                                             
                                                S
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                             ∈
                                             
                                                S
                                                3
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        TSO2 is a quadratic mixed integer linear program run for each of the event outcomes in 
                           
                              S
                              2
                           
                        . When the network capacity availability is known, the TSO decides how much firm and interruptible capacity that can be delivered. The allocation of firm capacity has been determined in TSO1, and the interruptible booking by the shipper was determined in SP2.

The objective is to minimize the square of interruptions weighted by the booking tariffs. Note that this is different from minimizing the total interrupted booking capacity. Instead of decreasing the total available booking for the shippers, the ISO will try to maintain the same booking pattern as before the interruptions. This is to avoid large interruptions in parts of the network when this is possible to avoid by evening out the interruptions.

                           
                              (30)
                              
                                 
                                    min
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          T
                                          n
                                          F
                                       
                                       
                                          a
                                          
                                             n
                                             ,
                                             
                                                s
                                                2
                                             
                                          
                                          
                                             F
                                             2
                                          
                                       
                                       +
                                       
                                          T
                                          n
                                          I
                                       
                                       
                                          a
                                          
                                             n
                                             ,
                                             
                                                s
                                                2
                                             
                                          
                                          
                                             I
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

The TSO must then make sure that there is a balance between firm booking 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 g
                                 F
                              
                              ,
                           
                         interruptible booking 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 g
                                 I
                              
                              ,
                           
                         interruption of firm and interruptible capacity (
                           
                              
                                 a
                                 
                                    g
                                    ,
                                    
                                       s
                                       2
                                    
                                 
                                 F
                              
                              +
                              
                                 a
                                 
                                    g
                                    ,
                                    
                                       s
                                       2
                                    
                                 
                                 I
                              
                           
                        ) and the flow 
                           
                              f
                              
                                 g
                                 ,
                                 j
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                         in each booking node:

                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   O
                                                   (
                                                   g
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   g
                                                   ,
                                                   j
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                g
                                                F
                                             
                                             +
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                g
                                                I
                                             
                                             −
                                             
                                                a
                                                
                                                   g
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                F
                                             
                                             −
                                             
                                                a
                                                
                                                   g
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                I
                                             
                                             ,
                                             
                                             g
                                             ∈
                                             G
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   I
                                                   (
                                                   m
                                                   )
                                                
                                             
                                             
                                                f
                                                
                                                   j
                                                   ,
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                m
                                                F
                                             
                                             +
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                m
                                                I
                                             
                                             −
                                             
                                                a
                                                
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                F
                                             
                                             −
                                             
                                                a
                                                
                                                   m
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                I
                                             
                                             ,
                                             
                                             m
                                             ∈
                                             M
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The TSO must also make sure that the interruption of capacity is not larger than the allocated booking of firm and interruptible services:

                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                F
                                             
                                             ≤
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                n
                                                F
                                             
                                             ,
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                I
                                             
                                             ≤
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                I
                                             
                                             ,
                                             
                                             n
                                             ∈
                                             N
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        To give firm booking priority, no firm booking should be interrupted unless all interruptible booking in the same node is interrupted. The two following constraints enforce this by the use of the binary variable 
                           
                              β
                              
                                 n
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                         that is 1 if some firm booking is interrupted:

                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                F
                                             
                                             ≤
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                n
                                                F
                                             
                                             
                                                β
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ,
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                                I
                                             
                                             ≥
                                             
                                                
                                                   z
                                                   ¯
                                                
                                                n
                                                I
                                             
                                             
                                                β
                                                
                                                   n
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                
                                             
                                             ,
                                             
                                             n
                                             ∈
                                             N
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The flows are limited by the capacities in the network, with constraints equal to (18)–(24) of TSO1.

In this section we first present the data and the assumptions for our case study. We then discuss the numerical results and our main findings.

The topology in our case study is based on the topology on the NCS, and is illustrated in Fig. 5
                        . The basis for the topology is given in Norwegian Petroleum Directorate (2011), while details on production and transportation capacities and plans are confidential and provided by the Norwegian system operator, Gassco. Our network has a maximum delivery capacity of 351 mega standard cubic meters, while the largest daily delivery from NCS in 2011 was 361 mega standard cubic meters (Gassco, 2011). The eight fields that we use in our case study represent approximately 50 real fields, aggregated by region. These aggregated fields can cover both must-take fields and swing fields, and the swing fields imply a larger daily production capacity than transportation capacity. All fields and markets are booking nodes in the network, such that they require booking of transportation capacity corresponding to their production and sale. The booking tariffs for firm transportation capacity correspond to the real tariffs on the NCS, defined individually for each booking node, and are available at Gassco (2012). We have assumed the booking tariff for interruptible services to be half the price of firm services. The model has been tested with security of supply requirements, R, for firm services in the range from 0.99 to 1 (where 1 indicates that all firm capacity must be delivered in all scenarios).

Real production cost data are not easily available, so we have based our estimates on different sources. The production costs of must-take production are estimated based on gas-to-oil ratios in Norwegian Petroleum Directorate (2011), where larger oil share gives a larger marginal production cost. The oil price is taken from the Norwegian national budget for 2012. For the production cost in the swing fields, we have based our parameters on Golombek, Gjelsvik, and Rosendahl (1998) and Kon-Kraft (2003).

We have generated price outcomes based on real spot prices from 2010 to 2011 for all market hubs directly connected to the NCS export network, which is NPB (UK), Zeebrugge (Belgium), Gas Pool (Germany) and NetConnect (Germany). Since we only have one node representing the markets in Germany, we have defined the price for the market node “Germany” as the average of the two German market hubs. The Dunkerque price is estimated as 10 percent of the GasPool price and 90 percent of the Zeebrugge price. The market prices are represented by 10 outcomes that are generated with the moment-matching procedure described in Høyland, Kaut, and Wallace (2003). Testing our model framework on multiple sets of generated market price outcomes showed that 10 was a sufficient number of outcomes to achieve in-sample stability (Kaut, Wallace, Vladimirou, and Zenios, 2007), with a standard deviation of 0.01 percent on the SP3 objective function value. Fig. 6
                            shows the prices for the 10 outcomes.

Due to lack of real data, our events are described by constructed data. We have defined 19 events with reduced capacity, each corresponding to a separate outcome. In addition, we have a default outcome where the system operates at full capacity. We do not consider multiple simultaneous events in any of the outcomes. This means that each event outcome only gives capacity reduction in a single node. The event outcomes are constructed such that all markets and fields have capacity reduction in one outcome, while the two processing plants Kollsnes and Kårstø (in our test case a field and an intermediate node, respectively) have four events each. The probability and extent of the capacity reductions are calibrated so that the availability corresponds to the average availability figures reported by Gassco (2010); 2011). Since our field nodes represent an aggregate of several smaller fields we have distinguished between field nodes that represent only a few underlying fields and field nodes that represent many. The capacity reduction is larger for field nodes with few underlying fields and smaller but more likely for field nodes with several underlying fields. Table 1
                            lists the events with the affected node, probability and the capacity reduction.

In total the 10 market outcomes and 20 event outcomes give a three-stage scenario tree with 200 scenarios.

@&#RESULTS AND DISCUSSION@&#

The model is implemented in Mosel version 3.2.2 and solved by Xpress Optimizer version 22.01.10 on a 2.80 gigahertz dual core computer with 4 gigabytes RAM. All problems are solved to optimality, and the whole sequence of shipper and TSO problems were solved within seconds. A benchmark is calculated with the same model framework. The difference is that there are no interruptible services available in the benchmark, which also means that SP2 is superfluous. In the following we use the label “Without” for the benchmark solution, while “With” indicates tests with interruptible services. We test the two model setups for increasing security of supply requirements, and compare the effects on booking levels, total throughputs, incomes and costs.

Our first observation is that the total booking stays constant independent of the security of supply level when interruptible services are available. This can be seen in Fig. 7
                            where the firm booking decreases, while the interruptible booking increases with the same amount. This observation comes from the fact that tariffs are below the marginal value of capacity so that it is the shipper’s view on network capacity that limits the booking. Since the shipper’s preference for transportation capacity is not reduced from SP1 to SP2 he will seek to obtain the same total amount of capacity by increasing the interruptible booking. A sensitivity analysis shows that this observation do not change if interruptible tariff is increased to 50 percent above firm tariff.

Our second observation is that the shipper finds the flexibility of unbalanced booking valuable. When allowed, the shipper consistently books nearly 90 mega standard cubic meters more entry capacity than exit capacity, even though it implies paying for some transportation capacity that necessarily will be interrupted. Enforcing balance also in the interruptible booking increases the booking and expected interruption even further. This value comes from the ability to adapt to events by substituting production with fields that are not affected by an event. It should be noted that the tariffs are very small, <13 percent of the average spot price, so the option cost of this flexibility is very low.

The allocated firm capacity is falling with increasing security of supply level, which comes natural since increasing buffers are needed to withstand the events. Our third observation is that the benchmark has a falling expected throughput as the security of supply requirement increases, as can be observed in Fig. 8
                           . On the other hand, according to our fourth observation the expected throughput is insensitive to the security of supply requirement when interruptible services are available. These two last observations together confirm our hypothesis, that including interruptible services to the transportation service regime will increase the efficiency by enabling a larger expected throughput in the transportation network without reducing the security of supply. The expected throughput increases with 24 percent when introducing interruptible services at the lowest security of supply level (0.99), and the difference increases to over 269 percent when the security of supply requirement is 1.

Resulting income shows a pattern similar to the total flow, with an increase of between 24 percent (with security of supply level of 0.99) and 267 percent (with security of supply level of 1) compared to the benchmark. Differences in average achieved spot prices are small, which is reasonable since both booking and interruption are allocated before spot prices become known. The ability to adapt to the varying spot prices is therefore limited. Our fifth observation on the other hand is a dramatic increase in production cost due to decreased oil production for the benchmark as security of supply increases, as can be seen in Fig. 9
                           . When the transportation capacity is reduced, production of natural gas at the field must be reduced and therefore also the oil production. This leads to the largest changes in the benchmark since the transportation capacity falls below the must-take production limits in these fields when the security of supply requirements is high. Since we do not have real production cost functions available there is substantial uncertainty with respect to the true monetary cost of this decreased oil production. The profit margins of oil is however substantially larger than for gas, so the shape of the production cost functions are representative. We therefore also argue that the improved ability of stable oil production through introduction of interruptible services is valid. The non-monotone shape of the curves in Fig. 9 is due to our model framework with a sequence of models with objectives that are not fully aligned, where an early booking or allocation decision can be non-optimal for the final supply chain performance.

In our modeling framework the TSO is a non-profit agent who minimizes the deviation between the shipper’s booking requests and the flow in the network. The shipper on the other hand is profit maximizing. This corresponds well to the incentives of the agents in the Norwegian system. These non-aligned objectives can however cause inefficiencies seen from a system perspective. The TSO do neither have information about spot prices nor production costs. The TSO might therefore give priority to a swing field and interrupt must-take production, or interrupt a high price market rather than a low price market.
                              1
                           
                           
                              1
                              In real life operation the TSO naturally have more insight in the system than what is provided to him through the bookings, so it is unlikely that swing production would be given priority over must-take production in actual operation.
                            In the modeled booking regime, which corresponds closely to the real Norwegian system, there is no way for the shippers to signal priorities between different booking nodes, which leave a risk for inefficient operation when prices or costs vary.

To test the significance of the agents’ differing incentives on the supply chain performance, we ran our case study with an alternative set of TSO models where the incentives were more in line with the shipper’s incentives. That is, the original objective functions were replaced with an objective where social surplus in the network were maximized. This corresponds to an idealized situation where the TSO has all price and production cost information. Fig. 10
                            compares profits with the social surplus maximizing TSO to the original formulation. The sixth observation is that the profits can increase if the TSO maximizes social surplus rather than taking market signals from the booking requests only. With improved information, and the mandate to act on it, the TSO can increase the profits in the system. Due to increased flow and income there is approximately 10 percent increase of profit for security of supply requirements <0.997 when interruptible services are available. For stricter security of supply requirements the profit increases are less regular. With interruptible services the model where the TSO maximizes social surplus avoids withholding must-take production with valuable associated oil, which causes a major profit increase of 69 percent when security of supply is 1.

We have considered two types of uncertainty in our model: events in the network and market prices. The flexibility offered by the interruptible services can be used to increase the throughput in the system due to uncertainty regarding events. The interruptible services also allow the shipper to have unbalanced booking which could be valuable with volatile market prices. While we have demonstrated that the effect on throughput is indeed significant, we have not been able to demonstrate any significant value of including interruptible services when unknown market prices are the only source of uncertainty. This is however as expected since interruptions are allocated before market uncertainty is resolved in our model framework. To analyze the effect of interruptible services on market uncertainty, we would have to increase the number of stages in our models. This is due to the number of iterations used on the NCS to allocate firm capacity and the possibility to adapt the capacity allocation to market prices as the uncertainty is gradually reduced.

@&#CONCLUSIONS@&#

In this paper we have developed a framework for analysis of interruptible transportation services in the natural gas system. We have also developed a new production cost function where the effects of reduced gas production on oil production in the same field are incorporated. We have tested the modeling framework on a case study with realistic input data, and a topology that is similar to the topology on the Norwegian Continental Shelf. The results from our case study show that there is a substantial gain in efficiency in the network when interruptible services are introduced to address network events. Both total flow and income in the system is drastically increased compared to the benchmark solution where interruptible services are not available. For the highest level of security of supply, the increase in flow and income in the system is as large as 250 percent.

@&#ACKNOWLEDGMENTS@&#

The work in this project has been founded by the Ramona project (The Research Council of Norway, project number 175967). We thank Statoil and Gassco for providing us with valuable input and Dr. Ruud Egging for useful discussions on model formulation. We also thank the reviewers for suggestions that helped improve the quality of the paper.

In real life, a shipper bases his expectation for network capacity availability on historical observations and knowledge about the system. To generate the shipper’s estimates to network capacity we have used an optimization model where the objective is to find the best possible utilization of the network in each scenario 
                        
                           
                              (
                              
                                 s
                                 2
                              
                              ,
                              
                                 s
                                 3
                              
                              )
                           
                           ∈
                           
                              (
                              
                                 S
                                 2
                              
                              ,
                              
                                 S
                                 3
                              
                              )
                           
                        
                     :

                        
                           (A.1)
                           
                              
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                M
                                             
                                          
                                          
                                             P
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                          
                                             x
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                g
                                                ∈
                                                G
                                             
                                          
                                          
                                             c
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The production cost 
                        
                           c
                           
                              g
                              ,
                              
                                 s
                                 2
                              
                              ,
                              
                                 s
                                 3
                              
                           
                        
                      is represented by the set Q of linear constraints describing must-take production as in the shipper problems and a constraint representing the linear production cost of swing production.

                        
                           (A.2)
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          ≥
                                          
                                             C
                                             
                                                g
                                                ,
                                                q
                                             
                                             
                                                A
                                                MT
                                             
                                          
                                          +
                                          
                                             C
                                             
                                                g
                                                ,
                                                q
                                             
                                             
                                                B
                                                MT
                                             
                                          
                                          
                                             y
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          
                                          g
                                          ∈
                                          G
                                          ,
                                          q
                                          ∈
                                          Q
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    
                                       
                                          c
                                          
                                             g
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          ≥
                                          
                                             C
                                             g
                                             
                                                B
                                                SW
                                             
                                          
                                          
                                             (
                                             
                                                y
                                                
                                                   g
                                                   ,
                                                   
                                                      s
                                                      2
                                                   
                                                   ,
                                                   
                                                      s
                                                      3
                                                   
                                                
                                             
                                             −
                                             
                                                Y
                                                g
                                                MT
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                          g
                                          ∈
                                          G
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The following two constraints make sure the flows correspond to production and sales decisions:

                        
                           (A.4)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                O
                                                (
                                                g
                                                )
                                             
                                          
                                          
                                             f
                                             
                                                g
                                                ,
                                                j
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          
                                          g
                                          ∈
                                          G
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.5)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                I
                                                (
                                                m
                                                )
                                             
                                          
                                          
                                             f
                                             
                                                j
                                                ,
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          
                                          m
                                          ∈
                                          M
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The production is limited by the production capacities as in constraint (7) in SP1 and the flows are limited by the network capacities with constraints equal to (18)–(24) in TSO1.

The problem utilizes the TSO’s knowledge of the physical network structure and capacities, and the shipper’s knowledge of production costs and market prices. The problem has a hybrid objective, where we seek to maximize throughput in the system, but with a realistic distribution between the fields and the markets. To achieve this we maximize sales income less production cost as defined in SP1.
                        2
                     
                     
                        2
                        The quadratic part of the production cost is removed to avoid that production is limited by high production costs.
                     
                  

For each event outcome 
                        
                           
                              s
                              2
                           
                           ∈
                           
                              S
                              2
                           
                        
                      we set the shipper’s estimate for available capacity based on the market outcome 
                        
                           
                              
                                 s
                                 ^
                              
                              3
                           
                           ∈
                           
                              S
                              3
                           
                        
                      with the largest total throughput 
                        
                           
                              ∑
                              
                                 m
                                 ∈
                                 M
                              
                           
                           
                              x
                              
                                 m
                                 ,
                                 
                                    s
                                    2
                                 
                                 ,
                                 
                                    s
                                    3
                                 
                              
                           
                        
                     . This gives the following definition of the estimated capacity 
                        
                           
                              H
                              
                                 n
                                 ,
                                 
                                    s
                                    2
                                 
                              
                           
                           :
                        
                     
                     
                        
                           (A.6)
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                          =
                                          
                                             y
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   
                                                      s
                                                      ^
                                                   
                                                   3
                                                
                                             
                                          
                                          ,
                                          
                                          g
                                          ∈
                                          G
                                          ,
                                          
                                             s
                                             2
                                          
                                          ∈
                                          
                                             S
                                             2
                                          
                                          ,
                                          
                                             
                                                s
                                                ^
                                             
                                             3
                                          
                                          =
                                          
                                             argmax
                                             
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                M
                                             
                                          
                                          
                                             x
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.7)
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                          =
                                          
                                             x
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   
                                                      s
                                                      ^
                                                   
                                                   3
                                                
                                             
                                          
                                          ,
                                          
                                          m
                                          ∈
                                          M
                                          ,
                                          
                                             s
                                             2
                                          
                                          ∈
                                          
                                             S
                                             2
                                          
                                          ,
                                          
                                             
                                                s
                                                ^
                                             
                                             3
                                          
                                          =
                                          
                                             argmax
                                             
                                                
                                                   s
                                                   3
                                                
                                                ∈
                                                
                                                   S
                                                   3
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                m
                                                ∈
                                                M
                                             
                                          
                                          
                                             x
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                              
                              
                              
                              
                                 
                                    Name
                                    Description
                                    Type
                                 
                              
                              
                                 
                                    
                                       
                                          g
                                       
                                    
                                    Field
                                    Index
                                 
                                 
                                    
                                       
                                          m
                                       
                                    
                                    Market
                                    Index
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                    Node with transportation booking
                                    Index
                                 
                                 
                                    
                                       
                                          
                                             j
                                             ,
                                             i
                                          
                                       
                                    
                                    Nodes in general
                                    Index
                                 
                                 
                                    
                                       
                                          
                                             s
                                             ,
                                             
                                                s
                                                2
                                             
                                             ,
                                             
                                                s
                                                3
                                             
                                          
                                       
                                    
                                    Outcome
                                    Index
                                 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    Linearization of production cost function
                                    Index
                                 
                                 
                                    
                                       
                                          J
                                       
                                    
                                    Nodes
                                    Set
                                 
                                 
                                    
                                       
                                          
                                             I
                                             (
                                             j
                                             )
                                          
                                       
                                    
                                    Nodes with pipeline going into node 
                                          j
                                       
                                    
                                    Set
                                 
                                 
                                    
                                       
                                          
                                             O
                                             (
                                             j
                                             )
                                          
                                       
                                    
                                    Nodes with pipeline going out from node 
                                          j
                                       
                                    
                                    Set
                                 
                                 
                                    
                                       
                                          G
                                       
                                    
                                    Fields, 
                                          
                                             G
                                             ⊂
                                             J
                                          
                                       
                                    
                                    Set
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    Markets, 
                                          
                                             M
                                             ⊂
                                             J
                                          
                                       
                                    
                                    Set
                                 
                                 
                                    
                                       
                                          N
                                       
                                    
                                    Booking nodes, 
                                          
                                             N
                                             =
                                             G
                                             ∪
                                             M
                                          
                                       
                                    
                                    Set
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                       
                                    
                                    Scenario nodes in second stage, event outcomes
                                    Set
                                 
                                 
                                    
                                       
                                          
                                             S
                                             3
                                          
                                       
                                    
                                    Scenario nodes in third stage, market price outcomes
                                    Set
                                 
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    Linear pieces in production cost function
                                    Set
                                 
                                 
                                    
                                       
                                          
                                             π
                                             
                                                s
                                                2
                                             
                                          
                                       
                                    
                                    Probability of event outcome
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             π
                                             
                                                s
                                                3
                                             
                                          
                                       
                                    
                                    Probability of market outcome
                                    Constant
                                 
                                 
                                    
                                       
                                          R
                                       
                                    
                                    Requirement on security of supply for firm services
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             Y
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Production capacity (uncertain)
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             Y
                                             g
                                             MT
                                          
                                       
                                    
                                    Must-take production capacity
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             T
                                             n
                                             F
                                          
                                       
                                    
                                    Firm tariff
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             T
                                             n
                                             I
                                          
                                       
                                    
                                    Interruptible tariff
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             H
                                             
                                                n
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Transportation capacity through node 
                                          n
                                        assumed by the shipper (uncertain)
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             P
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    Spot price (uncertain)
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             C
                                             
                                                g
                                                ,
                                                q
                                             
                                             
                                                A
                                                MT
                                             
                                          
                                       
                                    
                                    Coefficient of constant part of must-take production cost
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             C
                                             
                                                g
                                                ,
                                                q
                                             
                                             
                                                B
                                                MT
                                             
                                          
                                       
                                    
                                    Coefficient of linear part of must-take production cost, 
                                          <
                                       0
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             C
                                             g
                                             
                                                B
                                                SW
                                             
                                          
                                       
                                    
                                    Coefficient of linear part of swing production cost
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             C
                                             g
                                             
                                                C
                                                SW
                                             
                                          
                                       
                                    
                                    Coefficient of quadratic part of swing production cost
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             K
                                             
                                                i
                                                ,
                                                j
                                             
                                             W
                                          
                                       
                                    
                                    Weymouth constant
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             K
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Static pipeline capacity under event
                                    constant
                                 
                                 
                                    
                                       
                                          
                                             K
                                             
                                                j
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Static node capacity under event
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             
                                                P
                                                ¯
                                             
                                             j
                                          
                                       
                                    
                                    Maximum pressure in node
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             
                                                P
                                                ̲
                                             
                                             j
                                          
                                       
                                    
                                    Minimum pressure in node
                                    Constant
                                 
                                 
                                    
                                       
                                          
                                             z
                                             n
                                             F
                                          
                                       
                                    
                                    Firm booking
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             z
                                             n
                                             I
                                          
                                       
                                    
                                    Interruptible booking
                                    
                                 
                                 
                                    
                                       
                                          
                                             a
                                             
                                                n
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                             F
                                          
                                       
                                    
                                    Interruption of firm capacity
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             a
                                             
                                                n
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                             I
                                          
                                       
                                    
                                    Interruption of interruptible capacity
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             a
                                             
                                                n
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Total interruption of booked capacity
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             x
                                             
                                                m
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    Spot sale
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             y
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    Production
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             c
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                             MT
                                          
                                       
                                    
                                    Must take production cost
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             c
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                             SW
                                          
                                       
                                    
                                    Swing production cost
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             f
                                             
                                                j
                                                ,
                                                j
                                                j
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Flow
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             p
                                             
                                                j
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Pressure
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             β
                                             
                                                n
                                                ,
                                                
                                                   s
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    Binary variable that is 1 if firm booking is interrupted
                                    Variable
                                 
                                 
                                    
                                       
                                          
                                             c
                                             
                                                g
                                                ,
                                                
                                                   s
                                                   2
                                                
                                                ,
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    Production cost
                                    Variable
                                 
                              
                           
                        
                     
                  

If a variable is overlined in a problem description, it is a constant in that problem.

@&#REFERENCES@&#

