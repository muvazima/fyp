@&#MAIN-TITLE@&#Euclidean upgrading from segment lengths: DLT-like algorithm and its variants

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A DLT-like algorithm for Euclidean upgrading from segment lengths is proposed.


                        
                        
                           
                           The constraint equation is parameterized in a simple way.


                        
                        
                           
                           The plane at infinity is directly extracted from the intermediate results.


                        
                        
                           
                           This algorithm has higher accuracy than the existing linear algorithms.


                        
                        
                           
                           Weighting and nonlinear refinement further improve the accuracy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

DLT-like algorithm

Euclidean upgrading

Multi-camera calibration

Segment lengths

Weighted DLT-like algorithm

@&#ABSTRACT@&#


               
               
                  In this paper, how to calibrate a fixed multi-camera system and simultaneously achieve a Euclidean reconstruction from a set of segments is addressed. It is well known that only a projective reconstruction could be achieved without any prior information. Here, the known segment lengths are exploited to upgrade the projective reconstruction to a Euclidean reconstruction and simultaneously calibrate the intrinsic and extrinsic camera parameters. At first, a DLT(Direct Linear Transformation)-like algorithm for the Euclidean upgrading from segment lengths is derived in a very simple way. Although the intermediate results in the DLT-like algorithm are essentially equivalent to the quadric of segments (QoS), the DLT-like algorithm is of higher accuracy than the existing linear algorithms derived from the QoS because of a more accurate way to extract the plane at infinity from the intermediate results. Then, to further improve the accuracy of Euclidean upgrading, two weighted DLT-like algorithms are presented by weighting the linear constraint equations in the original DLT-like algorithm. Finally, using the results of these linear algorithms as the initial values, a new weighted nonlinear algorithm for Euclidean upgrading is explored to recover the Euclidean structure more accurately. Extensive experimental results on both the synthetic data and the real image data demonstrate the effectiveness of our proposed algorithms in Euclidean upgrading and multi-camera calibration.
               
            

@&#INTRODUCTION@&#

With an uncalibrated multi-camera system, a projective reconstruction of the 3D points in the common field of view is possible to be obtained from the correspondence between their projections. Rectifying this projective reconstruction to a Euclidean reconstruction, i.e. performing Euclidean upgrading, is equivalent to calibrating the intrinsic and extrinsic parameters of the cameras. In literature, camera calibration methods can be divided into two categories: self-calibration and reference-object-based calibration. The self-calibration methods do not use any geometry information about the scene and they usually require some sort of constraints on the intrinsic parameters [1–6], or constraints on the motion of cameras [7–9]. The reference-object-based methods are mainly based on some calibration objects of known size, such as 3D calibration object [10,11], 2D calibration object [12,13], and 1D calibration object [14–17]. Compared with the self-calibration methods, the reference-object-based methods can provide higher calibration accuracy due to the use of Euclidean knowledge.

In the case of calibrating multi-camera systems [18,19], both 3D calibration objects and 2D calibration objects are prone to be self-occluded so that the marker points on them cannot be observed by all the referred cameras simultaneously, whereas 1D calibration objects are immune to self-occlusion. In [14,16,17], the 1D objects contain at least three marker points in order to calibrate one or more cameras, where the marker points are required to be exactly collinear and the distances between these marker points need to be measured with high precision. Liebowitz and Carlsson [20] proposed a method to recover the Euclidean structure from an affinely distorted space by the knowledge of segment lengths. This method can be used to calibrate multiple affine cameras with a segment undergoing general motions. This calibration object, a segment with two end points, is more flexible than the conventional 1D objects, since only the distance between the two end points needs to be known, and the collinearity requirement is not involved anymore. Moreover, even without the knowledge about the segment length, a Euclidean reconstruction can still be obtained despite that its global scale is undetermined.

Can the Euclidean structure be recovered from a projectively distorted space from the knowledge of segment lengths? Ronda and Valdés [21] gave this question an affirmative answer and proposed three algorithms based on the quadric of segments (QoS) defined in a higher-dimensional space by a set of segments of fixed length. These algorithms based on the QoS need to solve a set of homogeneous linear equations in 55 variables, and thus require at least 54 segments in the projective space. The work of Ronda and Valdés [21] is very interesting but involves some very complex mathematics. The main contributions of them are that the relation of the QoS with the standard geometry associated to the Euclidean structure of space is given and the explicit formulae are derived to obtain the dual absolute quadric and the absolute quadratic complex from the QoS.

In this paper, we find that for the Euclidean upgrading from segment lengths, it is not necessary to use such complex mathematics as in [21], or in other words, a DLT (Direct Linear Transformation)-like algorithm can be derived in a very simple way. The derived algorithm consists of two main steps: First, a set of 4-order polynomial equations on the plane at infinity and the image of the absolute conic (IAC) are introduced from a given projective reconstruction of the scene consisting of segments with known lengths. Then, these 4-order polynomial equations are transformed into a set of inhomogeneous linear equations in 54 variables by a simple linearization technique, from which the least squares solution to the 54 variables can be computed in a linear way. Although the intermediate results in the DLT-like algorithm are essentially equivalent to the QoS, the DLT-like algorithm extracts the plane at infinity more accurately than the existing linear algorithms derived from the QoS and thus has higher accuracy in Euclidean upgrading. In addition, considering that the constraint equations in the above DLT-like algorithm have different reliabilities due to the measurement errors, we design two strategies to assign weights on these constraint equations, resulting in two weighted DLT-like algorithms. At last, a new weighted nonlinear algorithm for Euclidean upgrading is explored to refine the obtained results by these linear algorithms.

The rest of this paper is organized as follows. In Section 2 we describe the notations and related work. Section 3 presents a DLT-like algorithm for Euclidean upgrading from segment lengths and discusses the relationship between the DLT-like algorithm and existing algorithms. Then, two weighted DLT-like algorithms are proposed in Section 4. Section 5 introduces a weighted nonlinear algorithm to refine the results by these linear algorithms. The experimental results are reported in Section 6, followed by some concluding marks in Section 7.

Here, the homogeneous coordinates of a space point are denoted by X
                        =[x
                        1,x
                        2,x
                        3,1]T, and the corresponding inhomogeneous coordinates are denoted by 
                           
                              
                                 X
                                 ˜
                              
                              =
                              
                                 
                                    
                                       x
                                       1
                                    
                                    
                                       x
                                       2
                                    
                                    
                                       x
                                       3
                                    
                                 
                                 T
                              
                           
                        . A segment is determined by its two end points {X,Y}. Given the images of m (m
                        ≥4) segments in general position under n (n
                        ≥2) views, the projective camera matrices and the projective reconstruction of the segments can be obtained from the correspondences between the images of the 2m end points [5], which are related to the real Euclidean structure by a 4×4 transformation matrix. The projective camera matrices of the n views are denoted by P
                           j
                         (1≤
                        j
                        ≤
                        n), and the projective reconstruction of the end points of segments {X
                        
                           i
                        ,Y
                        
                           i
                        } (1≤
                        i
                        ≤
                        m) are denoted by 
                           
                              
                                 X
                                 pi
                              
                              =
                              
                                 
                                    
                                       
                                          X
                                          ˜
                                       
                                       pi
                                       T
                                    
                                    1
                                 
                                 T
                              
                           
                         and 
                           
                              
                                 Y
                                 pi
                              
                              =
                              
                                 
                                    
                                       
                                          Y
                                          ˜
                                       
                                       pi
                                       T
                                    
                                    1
                                 
                                 T
                              
                           
                        .

Ronda and Valdés [21] proposed three algorithms for Euclidean upgrading with a set of segments of known lengths. These algorithms are designed based on the quadric of segments (QoS): For segments {X,Y}, let σ(X,Y) be a 10-vector composed of the elements of the symmetric matrix (XY
                        T
                        +
                        YX
                        T). Then, for all the segments of fixed length d, σ(X,Y) lie on a quadric called the QoS of length d. The QoS can be written as 
                           
                              
                                 C
                                 1
                              
                              +
                              
                                 
                                    
                                       d
                                       2
                                    
                                    2
                                 
                              
                              
                                 C
                                 2
                              
                           
                        , where the dimensions of the linear spaces spanned by C1 and C2 are respectively 20 and 35. Given a segment {X
                        
                           i
                        ,Y
                        
                           i
                        } of length d
                        
                           i
                        , the constraint equation on C1 and C2 is obtained as
                           
                              (1)
                              
                                 
                                    
                                       σ
                                       T
                                    
                                    
                                       
                                          X
                                          pi
                                       
                                       
                                          Y
                                          pi
                                       
                                    
                                    
                                       
                                          
                                             C
                                             1
                                          
                                          +
                                          
                                             
                                                
                                                   d
                                                   i
                                                   2
                                                
                                                2
                                             
                                          
                                          
                                             C
                                             2
                                          
                                       
                                    
                                    σ
                                    
                                       
                                          X
                                          pi
                                       
                                       
                                          Y
                                          pi
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

Given at least 54 segments of known lengths, C1 and C2 can be determined uniquely. Then, C1 and C2 are used respectively to extract the Euclidean structure in the following three algorithms (C1S, C1A, and C2A):

C1 in Eq. (1) determines the real structure up to a Euclidean transformation with an unknown scale. An explicit formula to derive the absolute quadratic complex from C1 is given in [21], where the absolute quadratic complex is the quadric in terms of the Plücker coordinates of the lines which intersect the absolute conic [6]. A rectifying matrix is then extracted from the absolute quadratic complex to recover a Euclidean reconstruction [6], where the scale ambiguity can be determined by changing the overall scale of the structure such that the length constraints are satisfied. This algorithm is called C1S.

The scale ambiguity of the Euclidean reconstruction can also be reduced with the affine adjustment algorithm [20]. Here, an affine transformation matrix is computed linearly to minimize the total reconstruction error of segment lengths. The algorithm C1S followed by the affine adjustment step is called C1A. And the experimental results in [21] show that the affine adjustment step can improve the accuracy of Euclidean upgrading.

C2 in Eq. (1) encodes the information of the plane at infinity. In the implementation of the algorithm C2A in [21], the plane at infinity is computed as the polar plane of the center of a sphere with respect to the sphere. For a given space point Y, the sphere A
                              Y
                            with center Y and radius infinity is extracted from C2 through
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                Y
                                             
                                          
                                          ij
                                       
                                       =
                                       
                                          σ
                                          T
                                       
                                       
                                          
                                             e
                                             i
                                          
                                          Y
                                       
                                       
                                          C
                                          2
                                       
                                       σ
                                       
                                          
                                             e
                                             j
                                          
                                          Y
                                       
                                       ,
                                    
                                 
                              
                           where (A
                              Y
                           )
                              ij
                            is the element in the i-th row and the j-th column of A
                              Y
                           , and e
                           
                              i
                            is the i-th column of the 4×4 identity matrix. And then the plane at infinity is obtained as the polar plane of Y with respect to A
                              Y
                           , i.e.
                              
                                 (2)
                                 
                                    
                                       
                                          π
                                          ∞
                                       
                                       =
                                       
                                          A
                                          Y
                                       
                                       Y
                                       .
                                    
                                 
                              
                           
                        

When C2 is not accurate due to the error in the projective reconstruction of the segments, the result of Eq. (2) is dependent on the choice of Y. Therefore, multiple values of Y are used to compute a matrix which is composed of multiple estimations of the plane at infinity and then a final result is obtained by the SVD of this matrix. Next, a rectifying matrix is constructed from the plane at infinity to transform the projective reconstruction to an affine reconstruction. At last, the affine adjustment [20] is performed to refine the affine reconstruction to a Euclidean reconstruction.

A simpler way to directly extract the plane at infinity from C2 was also given in [21]. In this simpler way, the plane at infinity is computed as
                              
                                 (3)
                                 
                                    
                                       
                                          π
                                          ∞
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                      T
                                                   
                                                   
                                                      
                                                         e
                                                         1
                                                      
                                                      
                                                         e
                                                         α
                                                      
                                                   
                                                   
                                                      C
                                                      2
                                                   
                                                   σ
                                                   
                                                      
                                                         e
                                                         β
                                                      
                                                      
                                                         e
                                                         γ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                      T
                                                   
                                                   
                                                      
                                                         e
                                                         4
                                                      
                                                      
                                                         e
                                                         α
                                                      
                                                   
                                                   
                                                      C
                                                      2
                                                   
                                                   σ
                                                   
                                                      
                                                         e
                                                         β
                                                      
                                                      
                                                         e
                                                         γ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where α, β, and γ represent three arbitrary numbers in {1,2,3,4}. When the projective reconstruction of the segments is influenced by noise, the estimation of C2 in Eq. (1) does not satisfy its internal constraints and the accuracy of the computed π
                           ∞ in Eq. (3) is dependent on the choices of α, β, and γ. The influence of the choices of α, β, and γ was not tested in [21], and we will give some analyses in the later part of this paper.

This section proposes a DLT-like algorithm for Euclidean upgrading from segment lengths, and discusses the relationship between the DLT-like algorithm and the existing linear algorithms derived from the QoS.

Given a projective reconstruction of the segments and the corresponding projective camera matrices, we can always choose a projective coordinate system such that the first projective camera projection matrix has the canonical form P1
                        =(I|0). Let π
                        ∞
                        =(n
                        T,1)T be the coordinates of the plane at infinity in this projective space and K
                           j
                         (1≤
                        j
                        ≤
                        n) the intrinsic matrix of the j-th view. Then, according to the theory of stratified reconstruction [5], the Euclidean camera projection matrices of the n views and the Euclidean reconstruction {X
                        
                           ei
                        ,Y
                        
                           ei
                        } of the segments {X
                        
                           i
                        ,Y
                        
                           i
                        } can be expressed respectively as
                           
                              (4)
                              
                                 
                                    
                                    
                                       P
                                       ej
                                    
                                    ∼
                                    
                                       P
                                       j
                                    
                                    
                                       
                                          
                                             
                                                
                                                s
                                                
                                                   K
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                −
                                                s
                                                
                                                   n
                                                   T
                                                
                                                
                                                   K
                                                   1
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          1
                                          ≤
                                          j
                                          ≤
                                          n
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                    
                                       X
                                       ei
                                    
                                    ∼
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                         
                                                            K
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   
                                                      T
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       X
                                       pi
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          ei
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   
                                                      K
                                                      1
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                          
                                       
                                       
                                          1
                                          +
                                          
                                             n
                                             T
                                          
                                          
                                             
                                                X
                                                ˜
                                             
                                             pi
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                          ≤
                                          i
                                          ≤
                                          m
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       Y
                                       ei
                                    
                                    ∼
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      
                                                         K
                                                         1
                                                      
                                                   
                                                
                                                −
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   T
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       Y
                                       pi
                                    
                                    ,
                                    
                                       
                                          Y
                                          ˜
                                       
                                       ei
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   
                                                      K
                                                      1
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                Y
                                                ˜
                                             
                                             pi
                                          
                                       
                                       
                                          1
                                          +
                                          
                                             n
                                             T
                                          
                                          
                                             
                                                Y
                                                ˜
                                             
                                             pi
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                          ≤
                                          i
                                          ≤
                                          m
                                       
                                    
                                    ,
                                 
                              
                           
                        where “∼” denotes equality up to an unknown scalar multiplication, and s is the overall scale.

Since 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 ei
                              
                              
                                 
                                    Y
                                    ˜
                                 
                                 ei
                              
                           
                         is the Euclidean reconstruction of the segments {X
                        
                           i
                        ,Y
                        
                           i
                        } of length d
                        
                           i
                        , the following equation holds
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                ei
                                             
                                             −
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                ei
                                             
                                          
                                       
                                       T
                                    
                                    
                                       
                                          
                                             
                                                X
                                                ˜
                                             
                                             ei
                                          
                                          −
                                          
                                             
                                                Y
                                                ˜
                                             
                                             ei
                                          
                                       
                                    
                                    =
                                    
                                       d
                                       i
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

Denote ω
                        =(sK1)−T(sK1)−1 as the image of the absolute conic under the first view. Substituting Eqs. (5) and (6) into Eq. (7), a constraint equation on (n,ω) is obtained as
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                          
                                          T
                                       
                                    
                                    ω
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                             
                                                1
                                                +
                                                
                                                   n
                                                   T
                                                
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                             
                                                1
                                                +
                                                
                                                   n
                                                   T
                                                
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       d
                                       i
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

Eq. (8) can be rewritten as
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             T
                                          
                                          ω
                                          
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                                −
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             d
                                             i
                                             2
                                          
                                          
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      n
                                                      T
                                                   
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             2
                                          
                                          
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      n
                                                      T
                                                   
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             2
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

This is a 4-order polynomial equation in 9 variables (3 variables in n and 6 different variables in the symmetric matrix ω). Given a projective reconstruction of 9 segments, a nonlinear solution to the Euclidean upgrading can be obtained from Eq. (9) in theory. However, it is very difficult in practice to solve such a set of 4-order polynomial equations in 9 variables. In order to obtain a linear solution of (n,ω), a linearization of Eq. (9) will be derived in the next subsection.

For n
                        =[n
                        1,n
                        2,n
                        3]T, its anti-symmetric matrix is defined as
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                       ×
                                    
                                    =
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                −
                                                
                                                   n
                                                   3
                                                
                                             
                                             
                                                
                                                   n
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   3
                                                
                                             
                                             
                                                0
                                             
                                             
                                                −
                                                
                                                   n
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   n
                                                   2
                                                
                                             
                                             
                                                
                                                   n
                                                   1
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        Define a 6×6 matrix Λ and a 6-dimensional vector 
                           
                              p
                              
                                 
                                    
                                       
                                          X
                                          ˜
                                       
                                       pi
                                    
                                 
                                 
                                    
                                       
                                          Y
                                          ˜
                                       
                                       pi
                                    
                                 
                              
                           
                         as
                           
                              (10)
                              
                                 
                                    Λ
                                    =
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                ω
                                                
                                                   
                                                      n
                                                   
                                                   ×
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   ×
                                                
                                                ω
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   ×
                                                   T
                                                
                                                ω
                                                
                                                   
                                                      n
                                                   
                                                   ×
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    p
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                                −
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                                ×
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        then, the left hand side of Eq. (9) is rewritten as
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             T
                                          
                                          ω
                                          
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                                −
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                         −
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                                  T
                                                               
                                                               
                                                                  
                                                                     Y
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  n
                                                                  T
                                                               
                                                               
                                                                  
                                                                     X
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                
                                             
                                             T
                                          
                                          ω
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      −
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                               T
                                                            
                                                            
                                                               
                                                                  Y
                                                                  ˜
                                                               
                                                               pi
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               n
                                                               T
                                                            
                                                            
                                                               
                                                                  X
                                                                  ˜
                                                               
                                                               pi
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                         −
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         n
                                                      
                                                      ×
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                         ×
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                
                                             
                                             T
                                          
                                          ω
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      −
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      n
                                                   
                                                   ×
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      ×
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             p
                                             T
                                          
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          Λ
                                          p
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

For a
                        =(a
                        1,a
                        2,a
                        3)T, define vector q(a) as
                           
                              
                                 
                                    q
                                    
                                       a
                                    
                                    =
                                    
                                       
                                          
                                             
                                                a
                                                1
                                                2
                                             
                                             ,
                                             
                                                a
                                                2
                                                2
                                             
                                             ,
                                             
                                                a
                                                3
                                                2
                                             
                                             ,
                                             
                                                2
                                             
                                             
                                                a
                                                1
                                             
                                             
                                                a
                                                2
                                             
                                             ,
                                             
                                                2
                                             
                                             
                                                a
                                                1
                                             
                                             
                                                a
                                                3
                                             
                                             ,
                                             
                                                2
                                             
                                             
                                                a
                                                2
                                             
                                             
                                                a
                                                3
                                             
                                             ,
                                             
                                                2
                                             
                                             
                                                a
                                                1
                                             
                                             ,
                                             
                                                2
                                             
                                             
                                                a
                                                2
                                             
                                             ,
                                             
                                                2
                                             
                                             
                                                a
                                                3
                                             
                                             ,
                                             1
                                          
                                       
                                       T
                                    
                                    .
                                 
                              
                           
                        
                     

The symmetric matrix Γ
                        =
                        q(n)q
                        T(n) is given by
                           
                              (12)
                              
                                 
                                    
                                 
                              
                           
                        
                     

Then, the right hand side of Eq. (9) becomes
                           
                              (13)
                              
                                 
                                    
                                       d
                                       i
                                       2
                                    
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                n
                                                T
                                             
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                          
                                       
                                       2
                                    
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                n
                                                T
                                             
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                       
                                       2
                                    
                                    =
                                    
                                       d
                                       i
                                       2
                                    
                                    
                                       q
                                       T
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                    
                                    Γ
                                    q
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

According to Eqs. (11) and (13), Eq. (9) can be rewritten as
                           
                              (14)
                              
                                 
                                    
                                       p
                                       T
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    Λ
                                    p
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    −
                                    
                                       d
                                       i
                                       2
                                    
                                    
                                       q
                                       T
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                    
                                    Γ
                                    q
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

The 6×6 symmetric matrix Λ contains 21 different elements. Let Λ
                        
                           i,j
                         be the element in the i-th row and the j-th column of Λ. It is noted that ω[n]×
                        T (i.e. the upper right 3×3 sub-matrix of Λ) has zero trace, which means Λ
                        3,6 is equal to −
                        Λ
                        1,4
                        −
                        Λ
                        2,5. Therefore, Λ can be linearly represented by the following 20 elements:
                           
                              (15)
                              
                                 
                                    λ
                                    =
                                    
                                       
                                          
                                             Λ
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          …
                                          
                                             Λ
                                             
                                                1
                                                6
                                             
                                          
                                          
                                             Λ
                                             
                                                2
                                                2
                                             
                                          
                                          …
                                          
                                             Λ
                                             
                                                2
                                                6
                                             
                                          
                                          
                                             Λ
                                             
                                                3
                                                3
                                             
                                          
                                          …
                                          
                                             Λ
                                             
                                                3
                                                5
                                             
                                          
                                          
                                             Λ
                                             
                                                4
                                                4
                                             
                                          
                                          …
                                          
                                             Λ
                                             
                                                4
                                                6
                                             
                                          
                                          
                                             Λ
                                             
                                                5
                                                5
                                             
                                          
                                          
                                             Λ
                                             
                                                5
                                                6
                                             
                                          
                                          
                                             Λ
                                             
                                                6
                                                6
                                             
                                          
                                       
                                       T
                                    
                                    .
                                 
                              
                           
                        
                     

There are 34 different monomials n
                        1
                        
                           i
                        
                        n
                        2
                        
                           j
                        
                        n
                        3
                        
                           k
                        (1≤
                        i
                        +
                        j
                        +
                        k
                        ≤4) in Γ, and all these monomials can form the following vector when sorted in the graded lexicographic order:
                           
                              (16)
                              
                                 
                                    γ
                                    =
                                    
                                       
                                          
                                             
                                                n
                                                1
                                                4
                                             
                                             ,
                                             
                                                n
                                                1
                                                3
                                             
                                             
                                                n
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                                3
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                                2
                                             
                                             
                                                n
                                                2
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                                2
                                             
                                             
                                                n
                                                2
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                                2
                                             
                                             
                                                n
                                                3
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                2
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                2
                                                2
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                2
                                             
                                             
                                                n
                                                3
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                3
                                                3
                                             
                                             ,
                                             
                                                n
                                                2
                                                4
                                             
                                             ,
                                             
                                                n
                                                2
                                                3
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                2
                                                2
                                             
                                             
                                                n
                                                3
                                                2
                                             
                                             ,
                                             
                                                n
                                                2
                                             
                                             
                                                n
                                                3
                                                3
                                             
                                             ,
                                             
                                                n
                                                3
                                                4
                                             
                                             ,
                                             
                                                n
                                                1
                                                3
                                             
                                             ,
                                             
                                             
                                                n
                                                1
                                                2
                                             
                                             
                                                n
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                                2
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                2
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                2
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                3
                                                2
                                             
                                             ,
                                             
                                                n
                                                2
                                                3
                                             
                                             ,
                                             
                                                n
                                                2
                                                2
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                2
                                             
                                             
                                                n
                                                3
                                                2
                                             
                                             ,
                                             
                                                n
                                                3
                                                3
                                             
                                             ,
                                             
                                                n
                                                1
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                2
                                                2
                                             
                                             ,
                                             
                                                n
                                                2
                                             
                                             
                                                n
                                                3
                                             
                                             ,
                                             
                                                n
                                                3
                                                2
                                             
                                             ,
                                             
                                                n
                                                1
                                             
                                             ,
                                             
                                                n
                                                2
                                             
                                             ,
                                             
                                                n
                                                3
                                             
                                          
                                       
                                       T
                                    
                                    .
                                 
                              
                           
                        
                     

Let 
                           
                              
                                 c
                                 λ
                              
                              
                                 
                                    
                                       
                                          X
                                          ˜
                                       
                                       pi
                                    
                                 
                                 
                                    
                                       
                                          Y
                                          ˜
                                       
                                       pi
                                    
                                 
                              
                           
                         and 
                           
                              
                                 c
                                 γ
                              
                              
                                 
                                    
                                       
                                          X
                                          ˜
                                       
                                       pi
                                    
                                 
                                 
                                    
                                       
                                          Y
                                          ˜
                                       
                                       pi
                                    
                                 
                              
                           
                         be the coefficient vectors of λ and γ in Eq. (14), and then the following linear equation in 54 variables (20 variables in λ and 34 variables in γ) is obtained from Eq. (14):
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   λ
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             
                                                γ
                                             
                                          
                                       
                                    
                                    =
                                    
                                       d
                                       i
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

Based on the derivations in Sections 3.1 and 3.2, the DLT-like algorithm (abbreviated as DLT-like) for Euclidean upgrading from segment lengths is performed as follows: From the projective reconstruction 
                           
                              
                                 
                                    
                                       X
                                       ˜
                                    
                                    pi
                                 
                              
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                    pi
                                 
                              
                           
                         of a set of segments of length d
                        
                           i
                        , a set of linear equations is established by Eq. (17):
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   λ
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         
                                                            p
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         
                                                            p
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         
                                                            p
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         
                                                            p
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                   λ
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pm
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pm
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pm
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pm
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             
                                                γ
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   1
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                   m
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Denote the coefficient matrix and the constant vector in Eq. (18) as C and d respectively, and then the least squares solution to Eq. (18) is
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             
                                                γ
                                             
                                          
                                       
                                    
                                    =
                                    
                                       C
                                       +
                                    
                                    d
                                    .
                                 
                              
                           
                        where C+ denotes the pseudo-inverse of C.

According to Eq. (16), the last three elements of γ=(γ1,γ2, …,γ34)T determine the normal vector of the plane at infinity:
                           
                              (19)
                              
                                 
                                    n
                                    =
                                    
                                       
                                          
                                             γ
                                             32
                                          
                                          
                                             γ
                                             33
                                          
                                          
                                             γ
                                             34
                                          
                                       
                                       T
                                    
                                    .
                                 
                              
                           
                        
                     

And according to Eqs. (16) and (30), the IAC is extracted from λ=(λ1,λ2, …,λ20)T by
                           
                              
                                 
                                    ω
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   1
                                                
                                             
                                             
                                                
                                                   λ
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                   2
                                                
                                             
                                             
                                                
                                                   λ
                                                   7
                                                
                                             
                                             
                                                
                                                   λ
                                                   8
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                   3
                                                
                                             
                                             
                                                
                                                   λ
                                                   8
                                                
                                             
                                             
                                                
                                                   λ
                                                   12
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Then, the intrinsic matrix K1 and the overall scale s are determined by the Cholesky decomposition of ω
                        −1
                        =
                        s
                        2K1K1
                        T.

After computing (n, sK1), the Euclidean camera projection matrices and the Euclidean reconstruction of the segments are obtained according to Eqs. (4), (5), and (6). The affine adjustment algorithm [20] is then performed to refine the obtained Euclidean structure and the camera projection matrices. Finally, the intrinsic matrices and extrinsic parameters (K
                           j
                        ,R
                           j
                        ,C
                        
                           j
                        ) (1≤
                        j
                        ≤
                        n) are obtained from the decompositions of P
                           ej
                         in the form of P
                           ej
                        
                        ∼K
                           j
                        R
                           j
                        [I−
                        C
                        
                           j
                        ].

It is noted that the coefficient matrix C in Eq. (18) is quartic in the coordinates of the end points and the large condition number of C may cause instability of the DLT-like algorithm [22]. Therefore, the end points need to be normalized to improve the stability. Similarly, the normalization step is also necessary to Ronda and Valdés's linear algorithms derived from the QoS [21]. A matter of concern is that some end points in the projective reconstruction of the segments may be near infinity and then the computation of the normalization matrix will be dominated by the influence of those points. A solution to this problem is to first transform the projective reconstruction to a quasi-affine reconstruction [5] and then construct the normalization matrix. This two-step transformation has another benefit. Because the resulting space points are not split across the plane at infinity [5] and the centroid of these points is at the origin of the coordinate frame [22], the plane at infinity will not pass through the origin. It is clear that the last coordinate of the plane at infinity will not be zero and therefore parametrizing the plane at infinity as π
                        ∞
                        =(n
                        1,n
                        2,n
                        3,1)T will not cause instability.

The DLT-like algorithm and the existing linear algorithms (C1S, C1A, and C2A) in [21] are all derived from the knowledge of segment lengths, and they all require at least 54 segments. Indeed, DLT-like is closely related to these linear algorithms.

As mentioned in [21], the constraint equation on the QoS in Eq. (1) can be rewritten as
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                pi
                                             
                                             ∧
                                             
                                                Y
                                                pi
                                             
                                          
                                       
                                       T
                                    
                                    Σ
                                    
                                       
                                          
                                             X
                                             pi
                                          
                                          ∧
                                          
                                             Y
                                             pi
                                          
                                       
                                    
                                    +
                                    
                                       
                                          d
                                          i
                                          2
                                       
                                       2
                                    
                                    
                                       σ
                                       T
                                    
                                    
                                       
                                          X
                                          pi
                                       
                                       
                                          Y
                                          pi
                                       
                                    
                                    
                                       C
                                       2
                                    
                                    σ
                                    
                                       
                                          X
                                          pi
                                       
                                       
                                          Y
                                          pi
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                        where (X
                        
                           pi
                        
                        ∧
                        Y
                        
                           pi
                        ) is the Plücker coordinates of the line containing the segment {X
                        
                           pi
                        ,Y
                        
                           pi
                        } and Σ is the 6×6 matrix representing the absolute quadratic complex [6]. The relationship between the involved vectors and matrices in Eqs. (14) and (20) is summarized as below:
                           
                              1.
                              According to the representation of the Plücker coordinates by Stan Birchfield [23], 
                                    
                                       p
                                       
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                       
                                    
                                  in Eq. (10) are exactly the Plücker coordinates (X
                                 
                                    pi
                                 
                                 ∧
                                 Y
                                 
                                    pi
                                 ) of the line passing through 
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                 . Besides, by writing Λ and Σ in terms of the elements of n and ω with the help of symbolic computation software, it is observed that Λ is the absolute quadratic complex Σ when the Plücker coordinates are defined as in Eq. (10). Therefore, it is obvious that
                                    
                                       (21)
                                       
                                          
                                             
                                                p
                                                T
                                             
                                             
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                             Λ
                                             p
                                             
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                             ∼
                                             
                                                
                                                   
                                                      
                                                         X
                                                         pi
                                                      
                                                      ∧
                                                      
                                                         Y
                                                         pi
                                                      
                                                   
                                                
                                                T
                                             
                                             Σ
                                             
                                                
                                                   
                                                      X
                                                      pi
                                                   
                                                   ∧
                                                   
                                                      Y
                                                      pi
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

As seen from Eq. (21), the first term in Eq. (14) is equivalent to the first term in Eq. (20) up to a scale factor.

It is easy to verify that
                                    
                                       (22)
                                       
                                          
                                             q
                                             
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             =
                                             
                                                H
                                                2
                                             
                                             σ
                                             
                                                
                                                   X
                                                   pi
                                                
                                                
                                                   X
                                                   pi
                                                
                                             
                                             ,
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             =
                                             
                                                H
                                                2
                                             
                                             σ
                                             
                                                
                                                   Y
                                                   pi
                                                
                                                
                                                   Y
                                                   pi
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 where
                                    
                                       
                                          
                                             
                                                H
                                                2
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

After writing Γ and C2 in terms of the elements of n, we can verify that Γ can be obtained by reordering the elements of C2 as
                           
                              (23)
                              
                                 
                                    Γ
                                    ∼
                                    
                                       H
                                       2
                                       
                                          −
                                          T
                                       
                                    
                                    
                                       C
                                       2
                                    
                                    
                                       H
                                       2
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     

According to Eqs. (22), (23), and σ
                        T(X
                        
                           pi
                        ,X
                        
                           pi
                        )C2
                        σ(Y
                        
                           pi
                        ,Y
                        
                           pi
                        )=
                        σ
                        T(X
                        
                           pi
                        ,Y
                        
                           pi
                        )C2
                        σ(X
                           pi
                        ,Y
                        
                           pi
                        ), it is obvious that the second term in Eq. (14) is equivalent to the second term in Eq. (20) up to a scale factor,
                           
                              (24)
                              
                                 
                                    
                                       q
                                       T
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                    
                                    Γ
                                    q
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    ∼
                                    
                                       σ
                                       T
                                    
                                    
                                       
                                          X
                                          pi
                                       
                                       
                                          Y
                                          pi
                                       
                                    
                                    
                                       C
                                       2
                                    
                                    σ
                                    
                                       
                                          X
                                          pi
                                       
                                       
                                          Y
                                          pi
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

From the results in Eqs. (21) and (24), we can see that Eq. (14) is equivalent to Eq. (20) up to a scale factor. In addition, since Eq. (20) is equivalent to Eq. (1), we see that Eq. (14) and Eq. (1) are also equivalent up to a scale factor. Actually, our DLT-like algorithm and the linear algorithms in [21] use different parametrization strategies to represent the same constraint equations. According to the proof in [21], C1 and C2 can be uniquely determined from enough number of segments, and therefore Λ and Γ in the DLT-like algorithm can be uniquely determined as well. Since the parametrizations of Eqs. (14) and (20) are related by a linear transformation, the computation results of (Λ,Γ) and (Σ,C2) will have the same first-order error propagation model [24]. Besides, data normalization on the end points can reduce the second-order and higher-order error terms. Therefore, these intermediate results will have similar accuracy.

It is worth pointing out that in spite of the mathematical equivalence between the constraint equations of the DLT-like algorithm and the existing linear algorithms in [21], the accuracies of Euclidean upgrading in these linear algorithms are different as shown in the experiments in Section 6 mainly because their strategies to extract (n,ω) from the intermediate results are different. Furthermore, since DLT-like, C1A, and C2A all use affine adjustment as the last step of Euclidean upgrading and the results of affine adjustment are dependent only on the estimations of n, the different accuracies among these three linear algorithms are mainly caused by their different estimations of n.

The computation result in Eq. (3) is a 4-dimensional vector composed of four elements of C2, where the positions of these four elements are dependent on the choices of α, β, and γ. Besides, we find that when α, β, and γ are all equal to 4, the positions of these four elements in C2 will correspond to the positions of (n
                        1,n
                        2,n
                        3,1) in Γ by the relationship in Eq. (23), and therefore this strategy to extract π
                        ∞ from C2 will be equivalent to our strategy to extract n from Γ in Eq. (19). As a result, the DLT-like algorithm has the same first-order error propagation model as the linear algorithm that extracts the plane at infinity from C2 by (3) with α
                        =4, β
                        =4, and γ
                        =4. However, the implementation of the DLT-like algorithm is easier and the parametrization in the DLT-like algorithm is more direct to show the relation between (n,ω) and the intermediate matrices.

If the plane at infinity is extracted from C2 using Eq. (3) with other choices of α, β, and γ, the estimation of the plane at infinity may be unstable. When at least one element of n is zero, if we choose the values of α, β, and γ such that n
                        
                           α
                        
                        n
                        
                           β
                        
                        n
                        
                           γ
                         is zero, then it is easy to verify that the estimation of the plane at infinity by Eq. (3) with noise-free C2 will be a 4-dimensional zero vector (0,0,0,0)T. As a result, n cannot be recovered by computing the inhomogeneous coordinates of this 4-dimensional zero vector, and therefore a degeneracy occurs. It is unavoidable that the computation result of C2 is influenced by noise in practice, and thus a 4-dimensional nonzero vector will be obtained by Eq. (3) with inaccurate C2. The estimation of n recovered by computing the inhomogeneous coordinates of this 4-dimensional nonzero vector is only determined by random noise, and therefore is a wrong estimation. After the original projective reconstruction is transformed to quasi-affine and then normalized, the magnitudes of the elements of n are usually small. When at least one element of n is close to zero, recovering n by computing the inhomogeneous coordinates of the result of Eq. (3) is close to a degeneracy for the referred choices of α, β, and γ, and therefore the resulting estimation of n has high sensitivity to noise.

The DLT-like algorithm is a least squares algorithm, where the cost function is the sum of squared residuals. This cost function is not statistically meaningful [5], and the different reliabilities of the constraint equations in the DLT-like algorithm are not taken into account. To further improve the accuracy of the DLT-like algorithm, we assign each constraint equation with a weight which reflects its reliability to some extent.

It is obvious that the accuracies of the end points 
                        
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                        
                      (i
                     =1, 2, …, m) have an important influence on the reliabilities of the constraint equations in Eq. (18). The more accurate the end points 
                        
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                        
                      are, the more reliably the corresponding constraint equation is used for Euclidean upgrading. Therefore, a natural idea to design weights on these constraint equations is to make use of the different accuracies of 
                        
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                        
                     . Unfortunately, the true errors of 
                        
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                        
                      cannot be known except in the case of synthetic data experiments. However, the covariance matrices of the end points can be used to represent their uncertainties. Thus, we design the weights on these constraint equations based on the covariance matrices of 
                        
                           
                              
                                 X
                                 ˜
                              
                              pi
                           
                        
                      and 
                        
                           
                              
                                 Y
                                 ˜
                              
                              pi
                           
                        
                     . Here, their covariance matrices 
                        
                           V
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                        
                      and 
                        
                           V
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                        
                      are computed using the first-order error propagation method [25,5], where the noise on the image points is supposed to be independent, identically distributed, and isotropic Gaussian. After computing the covariance matrices of the end points, we propose two methods to compute the weights on the constraint equations with and without a given initial value of (n,ω) respectively, resulting in two weighted DLT-like algorithms.

Suppose we already have an initial value of (n,ω) (e.g. the result calculated by the DLT-like algorithm), and then we weight the constraint equations in the DLT-like algorithm in a similar way to the well-known “iterative weighted least squares” [26], where the weights on the constraint equations are computed as the inverses of the standard derivations of their residuals.

According to Eqs. (14) and (17), the residual of the i-th constraint equation in Eq. (18) can be rewritten as
                           
                              
                                 
                                    
                                       ϵ
                                       i
                                    
                                    =
                                    
                                       p
                                       T
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    Σ
                                    p
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    −
                                    
                                       d
                                       i
                                       2
                                    
                                    
                                       q
                                       T
                                    
                                    
                                       
                                          
                                             X
                                             ˜
                                          
                                          pi
                                       
                                    
                                    Γ
                                    q
                                    
                                       
                                          
                                             Y
                                             ˜
                                          
                                          pi
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Then, the Jacobians of ϵ
                           i
                         with respect to 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                         and 
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                         are given by
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                ∂
                                                
                                                   ϵ
                                                   i
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                          
                                          =
                                          2
                                          
                                             p
                                             T
                                          
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          Σ
                                          
                                             
                                                ∂
                                                p
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          −
                                          
                                             d
                                             i
                                             2
                                          
                                          
                                             q
                                             T
                                          
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          Γ
                                          
                                             
                                                ∂
                                                q
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                ∂
                                                
                                                   ϵ
                                                   i
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          =
                                          2
                                          
                                             p
                                             T
                                          
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          Σ
                                          
                                             
                                                ∂
                                                p
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          −
                                          
                                             d
                                             i
                                             2
                                          
                                          
                                             q
                                             T
                                          
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                pi
                                             
                                          
                                          Γ
                                          
                                             
                                                ∂
                                                q
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where Λ and Γ are computed with the initial value of (n,ω), and the Jacobians of 
                           
                              p
                              
                                 
                                    
                                       
                                          X
                                          ˜
                                       
                                       pi
                                    
                                 
                                 
                                    
                                       
                                          Y
                                          ˜
                                       
                                       pi
                                    
                                 
                              
                           
                        , 
                           
                              q
                              
                                 
                                    
                                       
                                          X
                                          ˜
                                       
                                       pi
                                    
                                 
                              
                           
                        , and 
                           
                              q
                              
                                 
                                    
                                       
                                          Y
                                          ˜
                                       
                                       pi
                                    
                                 
                              
                           
                         are
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                ∂
                                                p
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     Y
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                         ×
                                                      
                                                   
                                                
                                                
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                p
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                         ×
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      I
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                ∂
                                                q
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               3
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               x
                                                               2
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               x
                                                               1
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               x
                                                               3
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               x
                                                               3
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               x
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                T
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                ∂
                                                q
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               y
                                                               1
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               y
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               y
                                                               3
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               y
                                                               2
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               y
                                                               1
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               y
                                                               3
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               y
                                                               3
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               y
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               y
                                                               2
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                T
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Then, the weight on ϵ
                           i
                         is computed as
                           
                              (25)
                              
                                 
                                    
                                       w
                                       i
                                    
                                    =
                                    
                                       1
                                       
                                          std
                                          
                                             
                                                ϵ
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ϵ
                                                      i
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                V
                                                
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  ϵ
                                                                  i
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  
                                                                     X
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   ∂
                                                   
                                                      ϵ
                                                      i
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                V
                                                
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               
                                                                  ϵ
                                                                  i
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  
                                                                     Y
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and the weighted DLT-like algorithm is given by
                           
                              (26)
                              
                                 
                                    WC
                                    
                                       
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             
                                                γ
                                             
                                          
                                       
                                    
                                    =
                                    W
                                    d
                                    ,
                                 
                              
                           
                        where W=diag(w
                        1,w
                        2, …,w
                        
                           m
                        ), and the computations of C and d are the same as in Eq. (18). The least squares solution to Eq. (26) is
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             
                                                γ
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          WC
                                       
                                       +
                                    
                                    
                                       
                                          W
                                          d
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

After computing the weights on the linear equations in the DLT-like algorithm, a set of weighted linear equations can be constructed and solved. To reduce the computational complexity, the weights in our algorithm are not recomputed and thus the set of weighted linear equations is solved only once. The Euclidean reconstruction is then obtained in the same manner as the DLT-like algorithm, and affine adjustment is also performed as the last step. The above weighted DLT-like algorithm is named as WDLT-Like1.

To avoid the requirement of an initial value of (n,ω) in the computation of weights in Eq. (25), some approximation must be made to replace the Jacobians of ϵ
                           i
                         with respect to 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                         and 
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                        . Without any prior information about (n,ω), it is intuitive to treat the six unknown variables in the Jacobians of ϵ
                           i
                         equally. We assume that the typical values of 
                           
                              ∂
                              
                                 ϵ
                                 i
                              
                              /
                              ∂
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                         and 
                           
                              ∂
                              
                                 ϵ
                                 i
                              
                              /
                              ∂
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                         are both (1,1,1) multiplied by an unknown and unimportant factor. Define e as the 3-dimensional vector of ones, e
                        =(1,1,1)T. Then, an approximation of Eq. (25) is given by
                           
                              (27)
                              
                                 
                                    
                                       w
                                       i
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                e
                                                T
                                             
                                             
                                                V
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                             e
                                             +
                                             
                                                e
                                                T
                                             
                                             
                                                V
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                             e
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

It is noted that the expression (Eq. (25)) is invariant under affine transformations on the projective reconstruction but Eq. (27) is not invariant even under orthogonal transformations. Therefore, the expression for the weights is not satisfactory and some further modifications are necessary. Since the covariance matrices 
                           
                              V
                              
                                 
                                    
                                       X
                                       ˜
                                    
                                    pi
                                 
                              
                           
                         and 
                           
                              V
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                    pi
                                 
                              
                           
                         are positively definite, their elements with the largest magnitude are on the diagonal. We approximate them with their diagonal matrices, and then 
                           
                              
                                 e
                                 T
                              
                              
                                 V
                                 
                                    
                                       X
                                       ˜
                                    
                                    pi
                                 
                              
                              e
                           
                         and 
                           
                              
                                 e
                                 T
                              
                              
                                 V
                                 
                                    
                                       Y
                                       ˜
                                    
                                    pi
                                 
                              
                              e
                           
                         are approximated with the traces of 
                           
                              V
                              
                                 
                                    
                                       X
                                       ˜
                                    
                                    pi
                                 
                              
                           
                         and 
                           
                              V
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                    pi
                                 
                              
                           
                        . The new approximation of Eq. (25) is given by
                           
                              (28)
                              
                                 
                                    
                                       w
                                       i
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             trace
                                             
                                                
                                                   V
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             +
                                             trace
                                             
                                                
                                                   V
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

It is easy to check that this expression is invariant under orthogonal transformations. This way of computing weights depends only on the covariance matrices of the reconstructed end points, and it is easier to compute than Eq. (25). After computing the weights using Eq. (28), a set of weighted linear equations can be constructed and then solved in a similar manner to the implementation in WDLT-Like1. And this new weighted DLT-like algorithm is named as WDLT-Like2.
                           Remark
                           It is noted that compared with WDLT-Like1, the computation of weights in WDLT-Like2 has lower computational cost and the initial value of (n,ω) is not needed in WDLT-Like2. However, WDLT-Like2 has a little lower accuracy as shown in our experimental results in Section 6.

As discussed in Section 3.1, the minimal number of segments required to recover the Euclidean structure by solving polynomial equations is 9 in theory, but the linear algorithms (C1A, C2A, DLT-like, WDLT-Like1, and WDLT-Like2) require at least 54 segments. In these linear algorithms, severe over-parametrizations are introduced to linearly represent C1, C2, Λ, and Γ. To avoid over-parametrization reducing the accuracy of Euclidean upgrading, we introduce a nonlinear optimization step (abbreviated as OS) to reinforce the length constraints, where the cost function to be minimized is the total squared residuals of the lengths of the reconstructed segments,
                           
                              (29)
                              
                                 
                                    f
                                    
                                       
                                          n
                                          ,
                                          s
                                          
                                             K
                                             1
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                    
                                    
                                    
                                       ϵ
                                       i
                                       2
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                        
                                                                           K
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        ˜
                                                                     
                                                                     pi
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                               +
                                                               
                                                                  n
                                                                  T
                                                               
                                                               
                                                                  
                                                                     X
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        s
                                                                        
                                                                           K
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     Y
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                            
                                                               1
                                                               +
                                                               
                                                                  n
                                                                  T
                                                               
                                                               
                                                                  
                                                                     Y
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   d
                                                   i
                                                
                                             
                                          
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The cost function (Eq. (29)) can be minimized by the Levenberg–Marquardt algorithm [5], and the initial value of (n, sK1) needed to start the iterative minimization is provided by a linear algorithm.

As discussed in Section 4, the reliabilities of the linear equations in the DLT-like algorithm are different. Similarly, the reconstruction residuals ϵ
                           i
                         (1≤
                        i
                        ≤
                        m) in Eq. (29) also have different reliabilities. Therefore, to further improve the accuracy of the basic optimization step, we assign different weights to the residuals ϵ
                           i
                        , resulting in a weighted optimization step (abbreviated as WOS) where the form of the cost function is
                           
                              (30)
                              
                                 
                                    f
                                    
                                       
                                          n
                                          ,
                                          s
                                          
                                             K
                                             1
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                                i
                                             
                                             
                                                ϵ
                                                i
                                             
                                          
                                       
                                       2
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   i
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              s
                                                                              
                                                                                 K
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           X
                                                                           ˜
                                                                        
                                                                        pi
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     +
                                                                     
                                                                        n
                                                                        T
                                                                     
                                                                     
                                                                        
                                                                           X
                                                                           ˜
                                                                        
                                                                        pi
                                                                     
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              s
                                                                              
                                                                                 K
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           Y
                                                                           ˜
                                                                        
                                                                        pi
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     +
                                                                     
                                                                        n
                                                                        T
                                                                     
                                                                     
                                                                        
                                                                           Y
                                                                           ˜
                                                                        
                                                                        pi
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         d
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Since it is necessary to give beforehand an initial value to start an iterative optimization procedure, the weights w
                        
                           i
                         (1≤
                        i
                        ≤
                        m) in Eq. (30) are computed with this initial value of (n, sK1) in the same manner as WDLT-Like1. Here, the weight on residual ϵ
                           i
                         is computed as
                           
                              
                                 
                                    
                                       w
                                       i
                                    
                                    =
                                    
                                       1
                                       
                                          std
                                          
                                             
                                                ϵ
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ϵ
                                                         i
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                V
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               ϵ
                                                               i
                                                            
                                                         
                                                         
                                                            ∂
                                                            
                                                               
                                                                  
                                                                     X
                                                                     ˜
                                                                  
                                                                  pi
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                T
                                             
                                             +
                                             
                                                
                                                   ∂
                                                   
                                                      ϵ
                                                      i
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         Y
                                                         ˜
                                                      
                                                      pi
                                                   
                                                
                                             
                                             
                                                V
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            ϵ
                                                            i
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                
                                                T
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where the Jacobians of ϵ
                           i
                         with respect to 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 pi
                              
                           
                         and 
                           
                              
                                 
                                    Y
                                    ˜
                                 
                                 pi
                              
                           
                         are
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   ϵ
                                                   i
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                d
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                ω
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               n
                                                               T
                                                            
                                                            
                                                               
                                                                  X
                                                                  ˜
                                                               
                                                               pi
                                                            
                                                         
                                                      
                                                      I
                                                      −
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      
                                                         n
                                                         T
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   ϵ
                                                   i
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      Y
                                                      ˜
                                                   
                                                   pi
                                                
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                d
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               X
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            n
                                                            T
                                                         
                                                         
                                                            
                                                               Y
                                                               ˜
                                                            
                                                            pi
                                                         
                                                      
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                ω
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               n
                                                               T
                                                            
                                                            
                                                               
                                                                  Y
                                                                  ˜
                                                               
                                                               pi
                                                            
                                                         
                                                      
                                                      I
                                                      +
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                      
                                                         n
                                                         T
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         n
                                                         T
                                                      
                                                      
                                                         
                                                            Y
                                                            ˜
                                                         
                                                         pi
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

The weighted cost function in Eq. (30) can be minimized in the same way as in the basic optimization step. Then, the Euclidean structure is recovered with the obtained estimation of (n, sK1). Similar to WDLT-Like1, the weights in the weighted optimization step are not recomputed with the refined result of (n, sK1) to reduce computational complexity.

@&#EXPERIMENTAL RESULTS@&#

In this experiment, a set of segments of unit length are randomly generated in a cube of width 4, where the center of the cube is at the origin of a predefined coordinate frame. The intrinsic parameter matrices of the two synthetic cameras are set to
                           
                              
                                 
                                    
                                       K
                                       
                                          1
                                          true
                                       
                                    
                                    =
                                    
                                       K
                                       
                                          2
                                          true
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                2000
                                             
                                             
                                                0
                                             
                                             
                                                1504
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                2000
                                             
                                             
                                                1000
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        and the extrinsic parameters of the two cameras are also randomly chosen such that images of the segments are in the range of [0,3008]×[0,2000]. Fig. 1
                         shows an example of the left and right images of 100 segments. Gaussian noise with mean zero and standard deviation σ is then added to the image of each end point. The projective reconstruction of the scene is computed by the following steps: First, a projective reconstruction is obtained from the point correspondences between the two images using the extended fundamental numerical scheme (EFNS) [27] and the optimal triangulation [28]. Then, a transformation matrix is computed to change the projective reconstruction to a quasi-affine reconstruction [5]. At last, the end points are normalized such that their centroid is at the origin of the coordinate frame and their average distance from the origin is equal to 
                           
                              3
                           
                         
                        [22].

The Euclidean upgrading algorithms C1A, C2A, DLT-like, WDLT-Like1, WDLT-Like2, OS, and WOS are evaluated. Here, C1S is not evaluated since it was reported to have lower accuracy than C1A in [21]. In the implementation of C2A, the plane at infinity is extracted as the polar plane of the center of a sphere with respect to the sphere, following the implementation in [21]. The initial values of (n, ω) required in WDLT-Like1, OS, and WOS are provided by DLT-like. Let 
                           
                              
                                 
                                    
                                       X
                                       ˜
                                    
                                    ei
                                 
                              
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                    ei
                                 
                              
                           
                         (i
                        =1, …, m) denote the Euclidean reconstruction of the segments, and let R
                           j
                         and C
                        
                           j
                         (j
                        =1, 2) denote the rotation matrices and the translations of the cameras. Then, let R=R2R1
                        T and C
                        =R1(C
                        2
                        −
                        C
                        1) denote the relative rotation matrix and the relative translation of the second view. The following items of errors are used to evaluate the accuracy of this Euclidean reconstruction: (i) The average error of reconstructed segment lengths is defined as 
                           
                              
                                 
                                    
                                       1
                                       m
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                 
                                 
                                    
                                       
                                          ∥
                                          
                                             
                                                
                                                   X
                                                   ˜
                                                
                                                ei
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   Y
                                                   ˜
                                                
                                                ei
                                             
                                          
                                          ∥
                                          −
                                          
                                             d
                                             i
                                          
                                       
                                    
                                    2
                                 
                              
                           
                        ; (ii) The ten error items of the ten intrinsic parameters (f
                        
                           u
                        
                        
                           j
                        ,γ
                        
                           j
                        ,f
                        
                           v
                        
                        
                           j
                        ,u
                        0
                        
                           j
                        ,v
                        0
                        
                           j
                        ) (j
                        =1, 2) are defined as the differences between them and their ground truths; (iii) ∥R−Rtrue∥Frob denotes the Frobenius norm of the difference between R and its ground truth Rtrue; and (iv) ∥C
                        −
                        C
                        true∥ denotes the norm of the difference between C and its ground truth C
                        true. The above items of errors of the seven algorithms are evaluated concerning the effects of the noise level σ, the number m of segments, and the length d of the segments. Under each configuration of σ, m, and d, 1000 independent trials of experiments are performed, and then we compute the root-mean-square (RMS) results of these error items as well as the failure percentages of the linear algorithms, where failure means an algorithm does not provide a positive definite estimation of the IAC.

Here, the length d of the segments is fixed at 1, the number m of the segments is fixed at 100, and the noise level σ varies from 0 to 5pixels with a step of 0.5pixel. The experimental results of the seven algorithms are shown in Fig. 2
                           .

As seen in Fig. 2(a)–(m), the errors of the evaluated algorithms approximately grow linearly with the increase of noise level. The proposed linear algorithm DLT-like consistently outperforms C1A and C2A. The two weighted algorithms WDLT-Like1 and WDLT-Like2 achieve higher accuracies than DLT-like, and WDLT-Like1 performs better than WDLT-Like2. In addition, OS provides more accurate results on both the reconstructed segment lengths and the camera parameters than all the linear algorithms. Moreover, the weighted nonlinear algorithm WOS estimates the intrinsic and extrinsic parameters more accurately than OS, which demonstrates the effectiveness of weighting in WOS. However, its performance on the reconstructed segment lengths is slightly worse than OS, which is because the used evaluation criterion on the reconstructed segment lengths in the experiments is the same as the designed cost function of OS. As seen from Fig. 2(n), C1A and C2A are prone to failure, whereas the other linear algorithms have zero failure rate in the experiments.

Here, the length d of the segments is fixed at 1, the noise level σ is fixed at 3pixels, and the number m of the segments varies from 65 to 120 with a step of 5. The experimental results of the seven algorithms are shown in Fig. 3
                           .

As seen in Fig. 3(a)–(m), the errors of the linear algorithms generally decrease with the increase of segment number m, and the errors of OS and WOS do not change significantly. The accuracy of DLT-like is consistently higher than those of C1A and C2A. It is also observed that the two weighted linear algorithms WDLT-Like1 and WDLT-Like2 successfully improve the accuracy of DLT-like, and the improvements on accuracy by the weighting in WDLT-Like1 and WDLT-Like2 become more obvious when more segments are used. Besides, the accuracy of WOS in terms of the intrinsic and extrinsic parameters is consistently higher than the accuracy of OS. Fig. 3(n) shows that C1A and C2A are prone to failure, and the proposed linear algorithms DLT-like, WDLT-Like1, and WDLT-Like2 have no case of failure in the experiments.

In this subsection, the effects of the segment lengths on the accuracies of all the referred algorithms are tested. The experimental configuration is constructed as follows: The noise level σ is fixed at 3pixels, the number m of the segments is fixed at 100, and the length d of the segments varies from 0.4 to 2 with a step of 0.2 while keeping the centers and orientations of the segments fixed. The experimental results of all the referred algorithms are shown in Fig. 4
                           .

As seen in Fig. 4(a)–(m), for all the referred algorithms, the errors of the reconstructed segment lengths do not change significantly with the increase of segment length d, whereas the errors of camera parameters decrease with the increase of d. Moreover, it has to be pointed out that in our experimental setup, the coordinates of the images of some segments exceed the range of [0,3008]×[0,2000] when d is larger than 1, and the images of these segments are still used for Euclidean upgrading. In addition, the proposed DLT-like algorithm consistently outperforms C1A and C2A. The two weighted linear algorithms WDLT-Like1 and WDLT-Like2 improve the accuracy of DLT-like further. The estimations on the intrinsic and extrinsic parameters by WOS are more accurate than those by OS. Fig. 4(n) shows that the failure rates of C1A and C2A decrease with the increase of d, whereas the proposed DLT-like, WDLT-Like1, and WDLT-Like2 have no case of failure in the experiments.

In this experiment, a stick with two balls is used as the calibration object, where the distance between the centers of the two balls is 0.505m. And the locations of two Nikon D40 cameras with resolution of 3008×2000 pixels are fixed during the experiment. The two cameras are calibrated with the 2D calibration algorithm [12], where the obtained ground truth of the two intrinsic matrices are
                           
                              
                                 
                                    
                                       K
                                       
                                          1
                                          true
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                5829.4
                                             
                                             
                                                0.1
                                             
                                             
                                                1554.2
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                5832.8
                                             
                                             
                                                1030.3
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       K
                                       
                                          2
                                          true
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                5038.2
                                             
                                             
                                                0.3
                                             
                                             
                                                1545.0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                5042.6
                                             
                                             
                                                1029.0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Define the world coordinate frame as the camera coordinate frame of the first view, and then the extrinsic parameters of the second view are
                           
                              
                                 
                                    
                                       R
                                       true
                                    
                                    =
                                    
                                       
                                          
                                             
                                                0.97492
                                             
                                             
                                                0.03328
                                             
                                             
                                                0.22005
                                             
                                          
                                          
                                             
                                                −
                                                0.02470
                                             
                                             
                                                0.99883
                                             
                                             
                                                −
                                                0.04163
                                             
                                          
                                          
                                             
                                                −
                                                0.22117
                                             
                                             
                                                0.03515
                                             
                                             
                                                0.97460
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       C
                                       true
                                    
                                    =
                                    
                                       
                                          
                                             
                                                0.6803
                                             
                                          
                                          
                                             
                                                0.0213
                                             
                                          
                                          
                                             
                                                0.0886
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

A total of 146 poses of the stick are randomly generated and the corresponding images of the stick are captured by the two cameras. Fig. 5
                         shows two example images of the stick under a pose. The centers of the two balls in each image are detected as the images of the end points of the segment. Then, we obtain the detected projections of the 146 segments, as shown in Fig. 6
                        . With the ground truth of the intrinsic and extrinsic parameters of the two cameras, the 146 segments are then reconstructed and shown in Fig. 7
                        .

The experiments on Euclidean upgrading from segment lengths are performed as follows. For each m in {65, 70, …, 120}, a subset of m segments is randomly selected from the total set of segments. The procedure to obtain the projective reconstruction of the m segments is the same as in the experiments on the synthetic data. Then, we test the accuracies of the algorithms: C1A, C2A, DLT-like, WDLT-Like1, WDLT-Like2, OS, and WOS. Here, the used criteria to evaluate the seven algorithms are the same as those in the experiments on the synthetic data. Fig. 8
                         shows the experimental results of the seven evaluated algorithms.

As seen from Fig. 8, the experimental results on the real image data are generally similar to those on the synthetic data, but there are also two slight differences. In the real image data experiments, no failure occurs for all the seven evaluated algorithms possibly because of the well-controlled experimental condition. Besides, the advantages of the nonlinear algorithms OS and WOS over the linear algorithms are more obvious with the real image data.

In addition, the bundle adjustment method that minimizes the reprojection error of a set of segments with exact lengths is tested. Here, three different initializations for the bundle adjustment method are provided by DLT-like, OS, and WOS respectively, and the resulting Euclidean upgrading methods are denoted as DLT-like+BA, OS+BA, and WOS+BA. The corresponding experimental results including the results by OS and WOS are shown in Fig. 9
                        . It is observed from Fig. 9(a) that OS has slightly lower error in terms of the reconstructed segment lengths than WOS, whereas DLT-like+BA, OS+BA, and WOS+BA have zero errors on the reconstructed segment lengths because the lengths of the segments are parametrized in the bundle adjustment method. As can be seen in Fig. 9(b)–(m): (i) WOS has higher accuracy than OS in estimating the intrinsic and extrinsic parameters. (ii) The accuracy of DLT-like+BA is lower than those of OS and WOS especially when the number of segments is small. (iii) OS+BA has slightly higher accuracy than OS, but its accuracy is still lower than that of WOS. (iv) The accuracy of WOS+BA is very close to that of WOS.

@&#CONCLUSION@&#

With a very simple mathematical treatment, we have presented a DLT-like algorithm for Euclidean upgrading from segment lengths. We have also shown that the intermediate results of the DLT-like algorithm are equivalent to the QoS, but the DLT-like algorithm has higher accuracy than the existing linear algorithms derived from the QoS because of a more accurate way to extract the plane at infinity. Two weighted DLT-like algorithms have also been proposed, which successfully achieve higher accuracy. Furthermore, we have developed a weighted nonlinear algorithm based on a basic nonlinear algorithm to refine the results of the linear algorithms. The experiments on both the synthetic data and the real image data have demonstrated the effectiveness of the proposed algorithms.

It is noted that although the proposed nonlinear algorithms require at least 9 segments, all the referred linear algorithms to provide initializations in this paper require at least 54 segments. In the future, we will investigate how to use fewer segments to perform Euclidean upgrading.

@&#ACKNOWLEDGMENTS@&#

This work was supported in part by the National Natural Science Foundation of China under Grants No. 61333015, No. 91120012, and No. 61375042.

@&#REFERENCES@&#

