@&#MAIN-TITLE@&#Growth optimal investment in discrete-time markets with proportional transaction costs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Achieving optimal expected growth in i.i.d. discrete-time markets.


                        
                        
                           
                           Efficient recursive calculation via an irreducible Markov chain formulation.


                        
                        
                           
                           Successful application to Brownian markets and historical data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Growth optimal portfolio

Threshold rebalancing

Proportional transaction cost

Discrete-time stock market

@&#ABSTRACT@&#


               
               
                  We investigate how and when to diversify capital over assets, i.e., the portfolio selection problem, from a signal processing perspective. To this end, we first construct portfolios that achieve the optimal expected growth in i.i.d. discrete-time two-asset markets under proportional transaction costs. We then extend our analysis to cover markets having more than two stocks. The market is modeled by a sequence of price relative vectors with arbitrary discrete distributions, which can also be used to approximate a wide class of continuous distributions. To achieve the optimal growth, we use threshold portfolios, where we introduce a recursive update to calculate the expected wealth. We then demonstrate that under the threshold rebalancing framework, the achievable set of portfolios elegantly form an irreducible Markov chain under mild technical conditions. We evaluate the corresponding stationary distribution of this Markov chain, which provides a natural and efficient method to calculate the cumulative expected wealth. Subsequently, the corresponding parameters are optimized yielding the growth optimal portfolio under proportional transaction costs in i.i.d. discrete-time two-asset markets. As a widely known financial problem, we also solve the optimal portfolio selection problem in discrete-time markets constructed by sampling continuous-time Brownian markets. For the case that the underlying discrete distributions of the price relative vectors are unknown, we provide a maximum likelihood estimator that is also incorporated in the optimization framework in our simulations.
               
            

@&#INTRODUCTION@&#

The problem of how and when an investor should diversify capital over various assets, whose future returns are yet to be realized, is extensively studied in various different fields from signal processing [1,2,12,28–30,33,35] and financial engineering [25,26] to machine learning [13,34] and information theory [9]. Naturally, this is one of the most important financial applications due to the amount of money involved. However, the recent financial crisis demonstrated that there is a significant room for improvement in this field by sound signal processing methods [12,30], which is the main goal of this paper. In this paper, we investigate how and when to diversify capital over assets, i.e., the portfolio selection problem, from a signal processing perspective and provide portfolio selection strategies that maximize the expected cumulative wealth in discrete-time markets under proportional transaction costs.

In particular, we study an investment problem in markets that allows trading at discrete periods, where the discrete period is arbitrary, e.g., it can be seconds, minutes or days [24]. Furthermore, the market levies transaction fees for both selling and buying an asset proportional to the volume of trading at each transaction, which accurately models a broad range of financial markets [3,24]. In our discussions, we first consider markets with two assets. Two-stock markets are extensively studied in financial literature and are shown to accurately model a wide range of financial applications [24] such as the well-known “Stock and Bond Market” [24]. We then extend our analysis to markets having more than two assets, i.e., m-stock markets, where m is arbitrary.

Following the extensive literature [9,19,24–26,33], the market is modeled by a sequence of price relative vectors, say 
                        
                           
                              {
                              X
                              (
                              n
                              )
                              }
                           
                           
                              n
                              ≥
                              1
                           
                        
                     , 
                        X
                        (
                        n
                        )
                        ∈
                        
                           
                              [
                              0
                              ,
                              ∞
                              )
                           
                           
                              m
                           
                        
                     , where each entry of 
                        X
                        (
                        n
                        )
                     , i.e., 
                        
                           
                              X
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                        ∈
                        [
                        0
                        ,
                        ∞
                        )
                     , is the ratio of the closing price to the opening price of the ith stock per investment period. Hence, each entry of 
                        X
                        (
                        n
                        )
                      quantifies the gain (or the loss) of that asset at each investment period. The sequence of price relative vectors is assumed to have an i.i.d. “discrete” distribution [24–26,33], however, the discrete distributions on the vector of price relatives are arbitrary. In this sense, the corresponding discrete distributions can approximate a wide class of continuous distributions on the price relatives that satisfy certain regularity conditions by appropriately increasing the size of the discrete sample space. We first assume that the discrete distributions on the price relative vectors are known and then extend our analysis to cover the case, where the underlying distributions are unknown. We emphasize that the i.i.d. assumption on the sequence of price relative vectors is shown to hold in most realistic markets [14,24].

At each investment period, the diversification of the capital over the assets is represented by a portfolio vector 
                        b
                        (
                        n
                        )
                     , where 
                        ∀
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        m
                        }
                     , 
                        
                           
                              b
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                      represents the ratio of the capital invested in the ith asset at investment period n, i.e., we have 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              m
                           
                        
                        
                           
                              b
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                        =
                        1
                     , where 
                        0
                        ≤
                        
                           
                              b
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                        ≤
                        1
                     . As an example, if we invest using 
                        b
                        (
                        n
                        )
                     , we earn (or lose) 
                        
                           
                              b
                           
                           
                              T
                           
                        
                        (
                        n
                        )
                        X
                        (
                        n
                        )
                      at the nth investment period, after 
                        X
                        (
                        n
                        )
                      is revealed. Given that we start with one dollar, after an investment period of N days, we have the wealth growth 
                        
                           
                              ∏
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              b
                           
                           
                              T
                           
                        
                        (
                        n
                        )
                        X
                        (
                        n
                        )
                     . Under this general market model, we provide algorithms that maximize the expected growth over any period N by using “threshold rebalanced portfolios” (TRPs), which are shown to yield optimal growth in general i.i.d. discrete-time markets [14].

In [9], Cover et al. showed that the portfolio that achieves the maximal growth is a constant rebalanced portfolio (CRP) in i.i.d. discrete-time markets, under certain assumptions on the sequence of price relatives and without any transaction costs. A CRP is a portfolio investment strategy, where the fraction of wealth invested in each stock is kept constant at each investment period. A problem extensively studied in this framework is to find sequential portfolios that asymptotically achieve the wealth of the best CRP tuned to the underlying sequence of price relatives. Several sequential algorithms are introduced to achieve the performance of the best CRP (such as [9,13,16,34]) with different convergence rates and different performances on historical data sets. In [3], sequential algorithms that achieve the performance of the best CRP under transaction costs are introduced. However, we emphasize that keeping a CRP may require extensive trading due to a possible rebalancing at each investment period which deems CRPs (even the best CRP) ineffective in realistic markets even under mild transaction costs [19].

In continuous-time markets, however, it has been shown that under transaction costs, the optimal portfolios that achieve the maximal wealth are certain class of “no-trade zone” portfolios [7,11,32]. In simple terms, a no-trade zone portfolio has a compact closed set and a rebalancing occurs if the current portfolio breaches this set, otherwise no rebalancing occurs. Clearly, such a no-trade zone portfolio may avoid hefty transaction costs since it can limit excessive rebalancing by defining appropriate no-trade zones. Analogous to continuous time markets, it has been shown in [14] that in two-asset i.i.d. markets under proportional transaction costs, compact no-trade zone portfolios are optimal such that they achieve the maximal growth under certain assumptions on the sequence of price relatives. In two-asset markets, the compact no-trade zone is represented by thresholds, e.g., if at investment period n, the portfolio is given by 
                        b
                        (
                        n
                        )
                        =
                        
                           
                              [
                              b
                              (
                              n
                              )
                              ,
                              
                              
                              (
                              1
                              −
                              b
                              (
                              n
                              )
                              )
                              ]
                           
                           
                              T
                           
                        
                     , where 
                        0
                        ≤
                        b
                        (
                        n
                        )
                        ≤
                        1
                     , then rebalancing occurs if 
                        b
                        (
                        n
                        )
                        ∉
                        (
                        α
                        ,
                        β
                        )
                     , given the thresholds α, β, where 
                        0
                        ≤
                        α
                        ≤
                        β
                        ≤
                        1
                     . Similarly, the interval 
                        (
                        α
                        ,
                        β
                        )
                      can be represented using a target portfolio b and a region around it, i.e., 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                     , where 
                        0
                        ≤
                        ϵ
                        ≤
                        min
                        ⁡
                        {
                        b
                        ,
                        1
                        −
                        b
                        }
                      such that 
                        α
                        =
                        b
                        −
                        ϵ
                      and 
                        β
                        =
                        b
                        +
                        ϵ
                     . Extension of TRPs to markets having more than two stocks is straightforward and explained in Section 3.2.

However, how to construct the no-trade zone portfolio, i.e., how to select the thresholds that achieve the maximal growth, has not yet been solved except in elementary scenarios [14]. In [15], a universal algorithm that asymptotically achieves the performance of the best TRP tuned to the underlying sequence of price relatives is introduced. This algorithm leverages Bayesian type weighting from [9] inspired from universal source coding and requires no statistical assumptions on the sequence of price relatives. In similar lines, various different universal algorithms are introduced that achieve the performance of the best expert in different competition classes in [1,2,17–20]. Although the performance guarantees in [1,2,15,18,19]) are derived without any stochastic assumptions, these methods are highly conservative due to the worst case scenario optimization, i.e., they are only optimal in an asymptotical sense. However, the order of such performance upper bounds may not be negligible in actual financial markets [6,20], even though they may be neglected in source coding applications (where these algorithms are inspired from). We demonstrate that our algorithm readily outperforms these universal methods over historical data.

Our main contributions are as follows. We first consider two-asset markets and recursively evaluate the expected achieved wealth of a threshold portfolio for any b and ϵ over any investment period. We then extend this analysis to markets having more than two-stocks. We next demonstrate that under the threshold rebalancing framework, the achievable set of portfolios form an irreducible Markov chain under mild technical conditions. We evaluate the corresponding stationary distribution of this Markov chain, which provides a natural and efficient method to calculate the cumulative expected wealth. Subsequently, the corresponding parameters are optimized using a brute force approach yielding the growth optimal investment portfolio under proportional transaction costs in i.i.d. discrete-time two-asset markets. We note that for the case with the irreducible Markov chain, which covers practically all scenarios in the realistic markets, the optimization of the parameters is offline and carried out only once. However, for the case with recursive calculations, the algorithm has an exponential computational complexity in terms of the number of states. However, in our simulations, we observe that a reduced complexity form of the recursive algorithm that keeps only a constant number of states by appropriately pruning certain states provides nearly identical results with the “optimal” algorithm. Furthermore, as a well studied problem, we also solve optimal portfolio selection in discrete-time markets constructed by sampling continuous-time Brownian markets [24]. When the underlying discrete distributions of the price relative vectors are unknown, we provide a maximum likelihood estimator to estimate the corresponding distributions that is incorporated in the optimization framework in the Simulations section. For all these approaches, we also provide the corresponding complexity bounds.

The organization of the paper is as follows. In Section 2, we briefly describe our discrete-time stock market model with discrete price relatives and symmetric proportional transaction costs. In Section 3, we start to investigate TRPs, where we first introduce a recursive update in Section 3.1 for a market having two-stocks. Generalization of the iterative algorithm to the m-asset market case is provided in Section 3.2. We then show that the TRP framework can be analyzed using finite state Markov chains in Section 3.4 and Section 3.5. The special Brownian market is analyzed in Section 3.6. The maximum likelihood estimator is derived in Section 4. We simulate the performance of our algorithms in Section 5 and conclude the paper with certain remarks in Section 6.

We consider discrete-time stock markets under transaction costs. We first consider a market with two stocks and then extend the analysis to markets having more than two stocks. We model the market using a sequence of price relative vectors 
                        X
                        (
                        n
                        )
                     . A vector of price relatives 
                        X
                        (
                        n
                        )
                        =
                        
                           
                              [
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              (
                              n
                              )
                              ,
                              …
                              ,
                              
                                 
                                    X
                                 
                                 
                                    m
                                 
                              
                              (
                              n
                              )
                              ]
                           
                           
                              T
                           
                        
                      in a market of m assets represents the change in the prices of the assets over investment period n, i.e., for the ith stock 
                        
                           
                              X
                           
                           
                              i
                           
                        
                        (
                        n
                        )
                      is the ratio of the closing to the opening price of the ith stock over period n. For a market having two assets, we have 
                        X
                        (
                        n
                        )
                        =
                        
                           
                              [
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              (
                              n
                              )
                              
                              
                                 
                                    X
                                 
                                 
                                    2
                                 
                              
                              (
                              n
                              )
                              ]
                           
                           
                              T
                           
                        
                     . We assume that the price relative sequences 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      are i.i.d. over with possibly different discrete sample spaces 
                        
                           
                              X
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              2
                           
                        
                     , i.e., 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                        ∈
                        
                           
                              X
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                        ∈
                        
                           
                              X
                           
                           
                              2
                           
                        
                     , respectively [14]. For technical reasons, in our derivations, we assume that the sample space is 
                        X
                        ≜
                        
                           
                              X
                           
                           
                              1
                           
                        
                        ∪
                        
                           
                              X
                           
                           
                              2
                           
                        
                        =
                        {
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              K
                           
                        
                        }
                      for both 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      where 
                        |
                        X
                        |
                        =
                        K
                      is the cardinality of the set 
                        X
                     . The probability mass function (pmf) of 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      is 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        (
                        x
                        )
                        ≜
                        
                           Pr
                        
                        (
                        
                           
                              X
                           
                           
                              1
                           
                        
                        =
                        x
                        )
                      and the pmf of 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      is 
                        
                           
                              p
                           
                           
                              2
                           
                        
                        (
                        x
                        )
                        ≜
                        
                           Pr
                        
                        (
                        
                           
                              X
                           
                           
                              2
                           
                        
                        =
                        x
                        )
                     . We define 
                        
                           
                              p
                           
                           
                              i
                              ,
                              1
                           
                        
                        =
                        
                           
                              p
                           
                           
                              1
                           
                        
                        (
                        
                           
                              x
                           
                           
                              i
                           
                        
                        )
                      and 
                        
                           
                              p
                           
                           
                              i
                              ,
                              2
                           
                        
                        =
                        
                           
                              p
                           
                           
                              2
                           
                        
                        (
                        
                           
                              x
                           
                           
                              i
                           
                        
                        )
                      for 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ∈
                        X
                      and the probability mass vectors 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    p
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                              
                              
                                 
                                    p
                                 
                                 
                                    2
                                    ,
                                    1
                                 
                              
                              
                              …
                              
                              
                                 
                                    p
                                 
                                 
                                    K
                                    ,
                                    1
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              2
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    p
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              
                              
                                 
                                    p
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                              
                              
                              …
                              
                              
                                 
                                    p
                                 
                                 
                                    K
                                    ,
                                    2
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                     , respectively. Here, we first assume that the corresponding probability mass vectors 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              2
                           
                        
                      are known. We then extend our analysis to the case, where 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              2
                           
                        
                      are unknown, and sequentially estimate 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              2
                           
                        
                      using a maximum likelihood estimator in Section 4.

An allocation of wealth over two stocks is represented by the portfolio vector 
                        b
                        (
                        n
                        )
                        =
                        
                           
                              [
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              (
                              n
                              )
                              ,
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              (
                              n
                              )
                              ]
                           
                           
                              T
                           
                        
                     , where 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              b
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      represents the proportion of wealth invested in the first and second stocks, respectively, at investment period n. In two stock markets, we have 
                        
                           
                              b
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                        =
                        1
                        −
                        
                           
                              b
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                     , thus 
                        b
                        (
                        n
                        )
                      is completely characterized by the proportion of the total wealth invested in the first stock, i.e., 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                     . For notational clarity, we use 
                        b
                        (
                        n
                        )
                      instead of 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      throughout the paper, hence our portfolio vector is denoted by 
                        b
                        (
                        n
                        )
                        =
                        
                           
                              [
                              b
                              (
                              n
                              )
                              ,
                              
                              1
                              −
                              b
                              (
                              n
                              )
                              ]
                           
                           
                              T
                           
                        
                     .

We denote a threshold rebalancing portfolio with an initial and target portfolio b and a threshold ϵ by 
                        
                           TRP
                        
                        (
                        b
                        ,
                        ϵ
                        )
                     . At each market period n, an investor rebalances the asset allocation only if the portfolio leaves the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                     . When 
                        b
                        (
                        n
                        )
                        ∉
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                     , the investor buys and sells stocks so that the asset allocation is rebalanced to the initial allocation, i.e., 
                        b
                        (
                        n
                        )
                        =
                        b
                     , where the investor has to pay transaction fees. We emphasize that the rebalancing can be made directly to the closest boundary instead of to b as suggested in [14], however, we rebalance to b for notational simplicity, whereas our derivations also hold for the rebalancing to the boundary case. We model the transaction cost of rebalancing by a fixed proportional cost 
                        c
                        ∈
                        (
                        0
                        ,
                        1
                        )
                      
                     [3,14,19]. As an example, if the investor buys or sells S dollars of stocks, then he pays cS dollars of transaction fees. Although we assume a symmetric transaction cost ratio, all the results can be carried over to markets with asymmetric costs [14,19].

We let 
                        S
                        (
                        N
                        )
                      denote the achieved wealth at investment period N and assume, without loss of generality, that the initial wealth of the investor is 1 dollar. Then, as an example, if the portfolio 
                        b
                        (
                        n
                        )
                      does not leave the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      and the allocation of wealth is not rebalanced for N investment periods, then the achieved wealth is given by 
                        S
                        (
                        N
                        )
                        =
                        b
                        
                           
                              ∏
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                        +
                        (
                        1
                        −
                        b
                        )
                        
                           
                              ∏
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      and the current proportion of wealth invested in the first stock is given by 
                        b
                        (
                        N
                        )
                        =
                        
                           [
                           b
                           
                              
                                 ∏
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           (
                           n
                           )
                           ]
                        
                        /
                        S
                        (
                        N
                        )
                     . On the other hand, if the portfolio leaves the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      at period N, i.e., 
                        b
                        (
                        N
                        )
                        ∉
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                     , then the investor rebalances the asset distribution to the initial distribution and pays 
                        c
                        S
                        (
                        N
                        )
                        |
                        b
                        (
                        N
                        )
                        −
                        b
                        |
                      dollars for transaction costs [3]. In the next section, we first derive a compact form for the expected achieved wealth 
                        E
                        [
                        S
                        (
                        N
                        )
                        ]
                      so that we can optimize b and ϵ to maximize 
                        E
                        [
                        S
                        (
                        N
                        )
                        ]
                     .

In this section, we first investigate TRPs in discrete-time two-asset markets under proportional transaction costs. We first introduce an iterative method to calculate the expected achieved wealth at a given investment period. We then present an upper bound on the complexity of this algorithm. We next calculate the expected achieved wealth of markets having more than two assets, i.e., m-asset markets for an arbitrary m. We then provide the necessary and sufficient conditions such that the achievable portfolios are finite such that the complexity of the algorithm does not grow at any period. We also show that the portfolio sequence converges to a stationary distribution and derive the expected achieved wealth. Based on the calculation of the expected achieved wealth, we optimize b and ϵ using a brute-force search. Finally, with these derivations, we consider the well-known discrete-time two-asset Brownian market with proportional transaction costs and investigate the asymptotic expected achieved wealth.

Before introducing the iterative algorithm, we first define the set of achievable portfolios at each investment period since the iterative calculation of the expected achieved wealth is based on the achievable portfolio set. We then introduce the portfolio transition sets and the transition probabilities of achievable portfolios at successive investment periods in order to iteratively find the probability of each portfolio state and to calculate 
                           E
                           [
                           S
                           (
                           N
                           )
                           ]
                        .

We define the set of achievable portfolios at each investment period as follows. As 
                           |
                           X
                           |
                           =
                           K
                           <
                           ∞
                        , the set of achievable portfolios at period N can only have finitely many elements. We define the set of achievable portfolios at period N as 
                           
                              
                                 B
                              
                              
                                 N
                              
                           
                           =
                           {
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 
                                    
                                       M
                                    
                                    
                                       N
                                    
                                 
                                 ,
                                 N
                              
                           
                           }
                        , where 
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                           ≜
                           |
                           
                              
                                 B
                              
                              
                                 N
                              
                           
                           |
                        . As illustrated in Fig. 1
                        , for each achievable portfolio 
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                           ∈
                           
                              
                                 B
                              
                              
                                 N
                              
                           
                        , 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        , there is a certain set of portfolios in 
                           
                              
                                 B
                              
                              
                                 N
                                 −
                                 1
                              
                           
                         that are connected to 
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 n
                              
                           
                        . At a given investment period N, the set of achievable portfolios 
                           
                              
                                 B
                              
                              
                                 N
                              
                           
                         is given by
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          {
                                          b
                                          }
                                          ∪
                                          
                                             {
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             :
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         k
                                                         ,
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   u
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         k
                                                         ,
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   u
                                                   +
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         k
                                                         ,
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                          ∈
                                          (
                                          b
                                          −
                                          ϵ
                                          ,
                                          b
                                          +
                                          ϵ
                                          )
                                          ,
                                          
                                          u
                                          ,
                                          v
                                          ∈
                                          X
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                         Since b is an achievable portfolio at each N (due to a possible rebalancing), without loss of generality, we let 
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                           =
                           b
                         for each 
                           N
                           ∈
                           N
                        . Note that in Fig. 1, the size of the set of achievable portfolios may grow as N increases.

Having constructed a state transition diagram, we next represent the transition probabilities from 
                           
                              
                                 b
                              
                              
                                 k
                                 ,
                                 N
                                 −
                                 1
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                         as follows
                           
                              (2)
                              
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       ,
                                       m
                                       ,
                                       N
                                    
                                 
                                 ≜
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    N
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          m
                                          ,
                                          N
                                       
                                    
                                    |
                                    b
                                    (
                                    N
                                    −
                                    1
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          k
                                          ,
                                          N
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                                 −
                                 1
                              
                           
                         and 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        . Given that 
                           b
                           (
                           N
                           )
                           =
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                        , for some 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        , there exists a corresponding set of portfolios 
                           
                              
                                 N
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                           ⊂
                           
                              
                                 B
                              
                              
                                 N
                                 −
                                 1
                              
                           
                         from which 
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                         is achievable, i.e.,
                           
                              (3)
                              
                                 
                                    
                                       N
                                    
                                    
                                       m
                                       ,
                                       N
                                    
                                 
                                 ≜
                                 {
                                 
                                    
                                       b
                                    
                                    
                                       k
                                       ,
                                       N
                                       −
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 :
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       ,
                                       m
                                       ,
                                       N
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 }
                              
                           
                         where 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        . Then, the probability of each portfolio state can be calculated as follows
                           
                              (4)
                              
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    N
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          m
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       
                                          
                                             b
                                          
                                          
                                             k
                                             ,
                                             N
                                             −
                                             1
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                             ,
                                             N
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       ,
                                       m
                                       ,
                                       N
                                    
                                 
                                 
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    N
                                    −
                                    1
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          k
                                          ,
                                          N
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        . By the definition of 
                           
                              
                                 B
                              
                              
                                 N
                              
                           
                         and using the law of total expectation [31], we can write
                           
                              (5)
                              
                                 E
                                 [
                                 S
                                 (
                                 N
                                 )
                                 ]
                                 =
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       
                                          M
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    N
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          m
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 E
                                 
                                    [
                                    S
                                    (
                                    N
                                    )
                                    |
                                    b
                                    (
                                    N
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          m
                                          ,
                                          N
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         To obtain an iterative formulation using (5), we next find the transition probabilities between achievable portfolios.

To accomplish this, we let 
                           
                              
                                 U
                              
                              
                                 k
                                 ,
                                 m
                                 ,
                                 N
                              
                           
                         denote the set of price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 k
                                 ,
                                 N
                                 −
                                 1
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                        , i.e.,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                k
                                                ,
                                                m
                                                ,
                                                N
                                             
                                          
                                       
                                       
                                          ≜
                                       
                                       
                                          
                                             {
                                             w
                                             =
                                             
                                                
                                                   [
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   T
                                                
                                             
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                1
                                                −
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                m
                                                ,
                                                N
                                             
                                          
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                         for 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                                 −
                                 1
                              
                           
                         and 
                           m
                           =
                           2
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        . We consider the price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 k
                                 ,
                                 N
                                 −
                                 1
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                           =
                           b
                         separately since, in this case, there are two subcases depending on whether the portfolio leaves the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         or not. We let 
                           
                              
                                 U
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                           =
                           
                              
                                 V
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                        , where 
                           
                              
                                 V
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                         is the set of price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 k
                                 ,
                                 N
                                 −
                                 1
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                           =
                           b
                         without rebalancing, i.e.,
                           
                              (6)
                              
                                 
                                    
                                       V
                                    
                                    
                                       k
                                       ,
                                       1
                                       ,
                                       N
                                    
                                 
                                 =
                                 
                                    {
                                    w
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    ∈
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    =
                                    b
                                    }
                                 
                                 ,
                              
                           
                         and 
                           
                              
                                 R
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                         is the set of price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 k
                                 ,
                                 N
                                 −
                                 1
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                         with rebalancing, i.e.,
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                k
                                                ,
                                                1
                                                ,
                                                N
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             w
                                             =
                                             
                                                
                                                   [
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   T
                                                
                                             
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                             :
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                1
                                                −
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          ∉
                                          (
                                          b
                                          −
                                          ϵ
                                          ,
                                          b
                                          +
                                          ϵ
                                          )
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                         With these definitions, we can obtain the transition probabilities as follows
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                k
                                                ,
                                                m
                                                ,
                                                N
                                             
                                          
                                       
                                       
                                          =
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             ∈
                                             
                                                
                                                   U
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      k
                                                      ,
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                                 −
                                 1
                              
                           
                         and 
                           m
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        .

Having derived a recursive formulation for the state probabilities, we can calculate the term in the sum in (5) by considering two separate cases as follows.


                        i) As the first case, we consider 
                           b
                           (
                           N
                           )
                           =
                           
                              
                                 b
                              
                              
                                 m
                                 ,
                                 N
                              
                           
                        , where 
                           m
                           =
                           2
                           ,
                           …
                           ,
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        , i.e., we know that the portfolio does not leave the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         at period N. Therefore, no transaction cost is paid and we have
                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          E
                                          [
                                          S
                                          (
                                          N
                                          )
                                          |
                                          b
                                          (
                                          N
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                m
                                                ,
                                                N
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             )
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             )
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             
                                                q
                                             
                                             
                                                k
                                                ,
                                                m
                                                ,
                                                N
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             )
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             ∈
                                             
                                                
                                                   U
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      k
                                                      ,
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             )
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          X
                                          (
                                          N
                                          )
                                          =
                                          w
                                          ]
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             |
                                             X
                                             (
                                             N
                                             )
                                             ∈
                                             
                                                
                                                   U
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             ∈
                                             
                                                
                                                   U
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where (9) and (12) follow from the law of total expectation [31], (10) follows from Bayes' theorem [31], and (11) follows from (2). As no rebalancing occurs, we also have
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          E
                                          
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   N
                                                
                                             
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          b
                                          (
                                          N
                                          −
                                          1
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ]
                                          .
                                       
                                    
                                 
                              
                           
                         Putting (13) back in (12), we obtain
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   m
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          E
                                          [
                                          S
                                          (
                                          N
                                          )
                                          |
                                          b
                                          (
                                          N
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                m
                                                ,
                                                N
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      k
                                                      ,
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          b
                                          (
                                          N
                                          −
                                          1
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             |
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      k
                                                      ,
                                                      m
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                         where the last line follows since 
                           
                              Pr
                           
                           
                              (
                              X
                              (
                              N
                              )
                              =
                              w
                              )
                           
                           =
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           )
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           )
                        .


                        ii) In the second case, we have 
                           b
                           (
                           N
                           )
                           =
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                        . For this case, if 
                           X
                           (
                           N
                           )
                           ∈
                           
                              
                                 V
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                        , then the portfolio is not rebalanced and no transaction fee is paid; whereas if 
                           X
                           (
                           N
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                        , then the portfolio is rebalanced and transaction cost is paid. Thus, we have
                           
                              (16)
                              
                                 
                                    
                                       
                                       
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          E
                                          [
                                          S
                                          (
                                          N
                                          )
                                          |
                                          b
                                          (
                                          N
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                1
                                                ,
                                                N
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             )
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             
                                                q
                                             
                                             
                                                k
                                                ,
                                                1
                                                ,
                                                N
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          {
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      k
                                                      ,
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          E
                                          
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   N
                                                
                                             
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          +
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                      ,
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          E
                                          
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   N
                                                
                                             
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             ]
                                          
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                         where (16) follows from (10) and the last line follows in similar lines to (14). Here, when 
                           X
                           (
                           N
                           )
                           =
                           w
                           ∈
                           
                              
                                 V
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                        , no rebalancing occurs. Thus, we have
                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                          E
                                          
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   N
                                                
                                             
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          b
                                          (
                                          N
                                          −
                                          1
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ]
                                          .
                                       
                                    
                                 
                              
                           
                         On the other hand, when 
                           X
                           (
                           N
                           )
                           =
                           w
                           ∈
                           
                              
                                 R
                              
                              
                                 k
                                 ,
                                 1
                                 ,
                                 N
                              
                           
                        , rebalancing occurs. Hence, we have
                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                          E
                                          
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   N
                                                
                                             
                                             |
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          (
                                          1
                                          −
                                          c
                                          
                                             |
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         k
                                                         ,
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         k
                                                         ,
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         k
                                                         ,
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             b
                                             |
                                          
                                          )
                                          
                                          |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          b
                                          (
                                          N
                                          −
                                          1
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ]
                                          .
                                       
                                    
                                 
                              
                           
                         Putting (18) and (19) back in (17), we obtain
                           
                              
                                 
                                    
                                       
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          E
                                          [
                                          S
                                          (
                                          N
                                          )
                                          |
                                          b
                                          (
                                          N
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                1
                                                ,
                                                N
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             {
                                             
                                                ∑
                                                
                                                   w
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         k
                                                         ,
                                                         1
                                                         ,
                                                         N
                                                      
                                                   
                                                
                                             
                                             
                                                Pr
                                             
                                             
                                                (
                                                X
                                                (
                                                N
                                                )
                                                =
                                                w
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          ×
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             |
                                          
                                       
                                    
                                    
                                       
                                          
                                          b
                                          (
                                          N
                                          −
                                          1
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          
                                          +
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                      ,
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             X
                                             (
                                             N
                                             )
                                             =
                                             w
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                          ×
                                          E
                                          [
                                          S
                                          (
                                          N
                                          −
                                          1
                                          )
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                    
                                    
                                       
                                          
                                          ×
                                          
                                             (
                                             1
                                             −
                                             c
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            ,
                                                            N
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            ,
                                                            N
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            ,
                                                            N
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                b
                                                |
                                             
                                             )
                                          
                                          
                                          |
                                          
                                       
                                    
                                    
                                       
                                          
                                          b
                                          (
                                          N
                                          −
                                          1
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ]
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                         After some algebra, we obtain
                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             )
                                          
                                          E
                                          [
                                          S
                                          (
                                          N
                                          )
                                          |
                                          b
                                          (
                                          N
                                          )
                                          =
                                          
                                             
                                                b
                                             
                                             
                                                1
                                                ,
                                                N
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      ,
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          
                                             Pr
                                          
                                          
                                             (
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          E
                                          
                                             [
                                             S
                                             (
                                             N
                                             −
                                             1
                                             )
                                             |
                                             b
                                             (
                                             N
                                             −
                                             1
                                             )
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          {
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      k
                                                      ,
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          
                                          +
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                      ,
                                                      1
                                                      ,
                                                      N
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                k
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             (
                                             1
                                             −
                                             c
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            ,
                                                            N
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            ,
                                                            N
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            k
                                                            ,
                                                            N
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                b
                                                |
                                             
                                             )
                                          
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Hence, we can iteratively calculate (5) 
                        i) using (15), for the case where 
                           b
                           (
                           N
                           )
                           =
                           
                              
                                 b
                              
                              
                                 l
                                 ,
                                 N
                              
                           
                         and 
                           l
                           =
                           2
                           ,
                           …
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        , ii) using (20), for the case where 
                           b
                           (
                           N
                           )
                           =
                           
                              
                                 b
                              
                              
                                 1
                                 ,
                                 N
                              
                           
                           =
                           b
                        . Since we have the recursive formulation, we can optimize b and ϵ by a brute force search as shown in the Simulations section. In the following section, we extend our analyses to the m-asset market case.

In this section, we generalize our iterative method introduced in Section 3.1 for a market with m assets where 
                           m
                           ∈
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        . We model the market as a sequence of i.i.d. price relative vectors 
                           X
                           (
                           n
                           )
                           =
                           [
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           (
                           n
                           )
                           ,
                           …
                           ,
                           
                              
                                 X
                              
                              
                                 m
                              
                           
                           (
                           n
                           )
                           ]
                        , where 
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           ∈
                           X
                         and the pmf of 
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                         is 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           (
                           x
                           )
                           =
                           
                              Pr
                           
                           (
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           =
                           x
                           )
                        . For the m-asset case, the portfolio vector is given by 
                           b
                           (
                           n
                           )
                           =
                           [
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           (
                           n
                           )
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                           (
                           n
                           )
                           ]
                        , where 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           =
                           1
                         and 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           ≥
                           0
                        , the target portfolio vector is defined as 
                           b
                           =
                           [
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                           ]
                         and the threshold vector is given by 
                           ϵ
                           =
                           [
                           
                              
                                 ϵ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ϵ
                              
                              
                                 m
                              
                           
                           ]
                        . Similar to the two-asset case, 
                           
                              TRP
                           
                           (
                           b
                           ,
                           ϵ
                           )
                         rebalances the wealth allocation 
                           b
                           (
                           n
                           )
                         to b only when 
                           b
                           (
                           n
                           )
                           ∉
                           
                              
                                 b
                              
                              
                                 ϵ
                              
                           
                           ≜
                           (
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 ϵ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 ϵ
                              
                              
                                 1
                              
                           
                           )
                           ×
                           (
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 ϵ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 ϵ
                              
                              
                                 2
                              
                           
                           )
                           ×
                           …
                           ×
                           (
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                           −
                           
                              
                                 ϵ
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                           +
                           
                              
                                 ϵ
                              
                              
                                 m
                              
                           
                           )
                        . In this case, if the wealth allocation is not rebalanced for N investment periods, then the achieved wealth is given by 
                           S
                           (
                           N
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 m
                              
                           
                           
                              
                                 b
                              
                              
                                 k
                              
                           
                           
                              
                                 ∏
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                           (
                           N
                           )
                         and the proportion of wealth invested in the ith asset becomes 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           (
                           N
                           )
                           =
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 N
                                 )
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 N
                                 )
                              
                           
                        . We define the set of achievable portfolios at period N as
                           
                              (21)
                              
                                 
                                    
                                       B
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 {
                                 b
                                 }
                                 ∪
                                 
                                    {
                                    
                                       
                                          b
                                       
                                       
                                          m
                                          ,
                                          N
                                       
                                    
                                    :
                                    
                                       
                                          b
                                       
                                       
                                          k
                                          ,
                                          N
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                m
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                          ∘
                                          x
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                m
                                                ,
                                                N
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          b
                                       
                                       
                                          ϵ
                                       
                                    
                                    ,
                                    
                                    x
                                    ∈
                                    
                                       
                                          X
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                         where 
                           b
                           ∘
                           x
                           ≜
                           
                              
                                 [
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                         is an elementwise multiplication operation. In accordance with the definitions given in two-asset market case, the definitions of the portfolio transition sets and the transition probabilities of achievable portfolios follow. Then, similar to the iterative algorithm introduced in Section 3.1, i.e., (15) and (20), we can iteratively calculate the following expected achieved wealth
                           
                              (22)
                              
                                 E
                                 [
                                 S
                                 (
                                 N
                                 )
                                 ]
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       
                                          M
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    N
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          l
                                          ,
                                          N
                                       
                                    
                                    )
                                 
                                 E
                                 
                                    [
                                    S
                                    (
                                    N
                                    )
                                    |
                                    b
                                    (
                                    N
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          l
                                          ,
                                          N
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         We emphasize that the complete iterations for the m-asset case can be obtained by changing the scalars in (15) and (20) by the corresponding vectors. For the rest of the paper, we consider two-asset markets for ease of exposition.

In this section, we investigate the number of achievable portfolios at a given market period to determine the complexity of the iterative algorithm. We show that the set of achievable portfolios at period N is equivalent to the set of achievable portfolios when the portfolio 
                           b
                           (
                           n
                           )
                         does not leave the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N investment periods. We first demonstrate that if the portfolio never leaves the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N periods, then 
                           b
                           (
                           N
                           )
                         is given by 
                           b
                           (
                           N
                           )
                           =
                           1
                           /
                           
                              (
                              1
                              +
                              
                                 
                                    1
                                    −
                                    b
                                 
                                 b
                              
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    Z
                                    (
                                    n
                                    )
                                 
                              
                              )
                           
                        , where 
                           Z
                           (
                           n
                           )
                           ≜
                           ln
                           ⁡
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 n
                                 )
                              
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 n
                                 )
                              
                           
                         with a sample space 
                           Z
                           ≜
                           
                              {
                              z
                              =
                              ln
                              ⁡
                              
                                 u
                                 v
                              
                              
                              |
                              
                              u
                              ,
                              v
                              ∈
                              X
                              }
                           
                         and 
                           |
                           Z
                           |
                           =
                           M
                        . Then, we argue that the number of achievable portfolios at period N, i.e., 
                           
                              
                                 M
                              
                              
                                 N
                              
                           
                        , is equal to the number of different values that the sum 
                           
                              
                                 ∑
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           Z
                           (
                           n
                           )
                         can take when the portfolio does not leave the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N investment periods. We then observe that we have 
                           M
                           ≤
                           
                              
                                 K
                              
                              
                                 2
                              
                           
                           −
                           K
                           +
                           1
                         as the price relative sequences 
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           (
                           n
                           )
                         and 
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                           (
                           n
                           )
                         are elements of the same sample space 
                           X
                         with 
                           |
                           X
                           |
                           =
                           K
                        . Using this inequality, we finally find an upper bound on the number of achievable portfolios.


                        
                           Lemma 1
                           
                              The number of achievable portfolios at period N, i.e., 
                              
                                 
                                    
                                       M
                                    
                                    
                                       N
                                    
                                 
                              
                              , is equal to the number of different values that the sum 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 Z
                                 (
                                 n
                                 )
                               
                              can take when the portfolio 
                              
                                 b
                                 (
                                 n
                                 )
                               
                              does not leave the interval 
                              
                                 (
                                 b
                                 −
                                 ϵ
                                 ,
                                 b
                                 +
                                 ϵ
                                 )
                               
                              for N investment periods and is bounded by 
                              
                                 (
                                 
                                    
                                       
                                          N
                                          +
                                          
                                             
                                                K
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          K
                                       
                                    
                                    
                                       
                                          N
                                       
                                    
                                 
                                 )
                              
                              , i.e., 
                              
                                 
                                    
                                       M
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 |
                                 
                                    
                                       B
                                    
                                    
                                       N
                                    
                                 
                                 |
                                 ≤
                                 
                                    (
                                    
                                       
                                          
                                             N
                                             +
                                             
                                                
                                                   K
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             K
                                          
                                       
                                       
                                          
                                             N
                                          
                                       
                                    
                                    )
                                 
                              
                              .
                           


                        
                           Proof
                           The proof is in Appendix A.  □


                        
                           Remark 1
                           Note that the complexity of calculating 
                                 E
                                 [
                                 S
                                 (
                                 N
                                 )
                                 ]
                               is bounded by 
                                 O
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                n
                                                +
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                K
                                             
                                          
                                          
                                             
                                                n
                                             
                                          
                                       
                                       )
                                    
                                    /
                                    N
                                    )
                                 
                               since at each period 
                                 n
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              , we calculate 
                                 E
                                 [
                                 S
                                 (
                                 n
                                 )
                                 ]
                               as a summation of 
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                               terms in (5) and 
                                 
                                    
                                       M
                                    
                                    
                                       n
                                    
                                 
                                 ≤
                                 
                                    (
                                    
                                       
                                          
                                             n
                                             +
                                             
                                                
                                                   K
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             K
                                          
                                       
                                       
                                          
                                             n
                                          
                                       
                                    
                                    )
                                 
                              .

As can be observed from Remark 1, the number of achievable portfolios tends to go to the infinity as N increases. However, in the next section, we show that the number of achievable portfolios is finite under mild technical conditions, hence the computational complexity of our algorithm is constant.

In this section, we investigate the cardinality of the set of achievable portfolios 
                           B
                           ≜
                           
                              
                                 ⋃
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 ∞
                              
                           
                           
                              
                                 B
                              
                              
                                 n
                              
                           
                         and demonstrate that 
                           B
                         is finite under certain conditions. Consequently, when 
                           B
                         is finite, we can derive a recursive update with a constant complexity to calculate the expected achieved wealth 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                         at any investment period. To show this, we demonstrate that the portfolio sequence forms a Markov chain with a finite state space and converges to a stationary distribution. Then, we investigate the limiting behavior of the expected achieved wealth using this update to optimize b and ϵ. Before providing the main theorem, we first state a couple of lemmas that are used in the derivation of the main result of this section.

We first show that the portfolio 
                           b
                           (
                           n
                           )
                         does not leave the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N periods iff the sum 
                           
                              
                                 ∑
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 k
                              
                           
                           Z
                           (
                           n
                           )
                           ∈
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                         for 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           N
                        , where 
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ≜
                           ln
                           ⁡
                           
                              
                                 b
                                 (
                                 1
                                 −
                                 b
                                 −
                                 ϵ
                                 )
                              
                              
                                 (
                                 1
                                 −
                                 b
                                 )
                                 (
                                 b
                                 +
                                 ϵ
                                 )
                              
                           
                           <
                           0
                         and 
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           ≜
                           ln
                           ⁡
                           
                              
                                 b
                                 (
                                 1
                                 −
                                 b
                                 +
                                 ϵ
                                 )
                              
                              
                                 (
                                 1
                                 −
                                 b
                                 )
                                 (
                                 b
                                 −
                                 ϵ
                                 )
                              
                           
                           >
                           0
                        . We then prove that the number of achievable portfolios is equal to the cardinality of the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                        , where
                           
                              (23)
                              
                                 Y
                                 ≜
                                 
                                    {
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             M
                                          
                                          
                                             +
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    :
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    Z
                                    ,
                                    
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          +
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                         
                        
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                           ≜
                           {
                           z
                           ∈
                           Z
                           :
                           z
                           ≥
                           0
                           }
                        , and 
                           
                              
                                 M
                              
                              
                                 +
                              
                           
                           ≜
                           |
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                           |
                        . Note that 
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                         is the set of positive elements of the set 
                           Z
                         and any value that the sum 
                           
                              
                                 ∑
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           Z
                           (
                           n
                           )
                         can take is an element of 
                           Y
                        . Hence, if we can demonstrate that the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                         is finite under certain conditions, then it yields that the cardinality of the set 
                           B
                         is also finite.


                        
                           Lemma 2
                           
                              The portfolio 
                              
                                 b
                                 (
                                 n
                                 )
                               
                              does not leave the interval 
                              
                                 (
                                 b
                                 −
                                 ϵ
                                 ,
                                 b
                                 +
                                 ϵ
                                 )
                               
                              for N investment periods iff the sum 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 Z
                                 (
                                 n
                                 )
                                 ∈
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                              , where 
                              
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                              .
                           


                        
                           Proof
                           The proof is in Appendix B.  □

In the following lemma, we demonstrate that the set of different values that 
                           
                              
                                 ∑
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           Z
                           (
                           n
                           )
                         can take for any 
                           N
                           ∈
                           N
                        , when the portfolio never leaves the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N investment periods is equivalent to the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                        , when 
                           |
                           z
                           |
                           <
                           min
                           ⁡
                           {
                           |
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           |
                           ,
                           |
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           |
                           }
                        . Hence, we show that the cardinality of the set of achievable portfolios is equal to the cardinality of the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                        .


                        
                           Lemma 3
                           
                              If 
                              
                                 |
                                 z
                                 |
                                 <
                                 min
                                 ⁡
                                 {
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                                 |
                                 ,
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 |
                                 }
                              
                              , 
                              
                                 ∀
                                 z
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                              , then 
                              
                                 ∀
                                 y
                                 ∈
                                 Y
                                 ∩
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                              , 
                              
                                 ∃
                                 
                                    
                                       {
                                       Z
                                       (
                                       n
                                       )
                                       =
                                       
                                          
                                             Z
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       }
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 ∈
                                 Z
                               
                              for some 
                              
                                 N
                                 ∈
                                 N
                               
                              such that 
                              
                                 y
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 ∈
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                              , 
                              
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                              .
                           


                        
                           Proof
                           The proof is in Appendix C.  □

This lemma illustrates that the set of different values that the sum 
                           
                              
                                 ∑
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           Z
                           (
                           n
                           )
                         can take for any 
                           N
                           ∈
                           N
                         when the portfolio does not leave the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N investment periods is equivalent to the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                        . Thus, the number of achievable portfolios is equal to the cardinality of the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                        . In the following theorem, we demonstrate that if 
                           |
                           z
                           |
                           <
                           min
                           ⁡
                           {
                           |
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           |
                           ,
                           |
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           |
                           }
                        , 
                           ∀
                           z
                           ∈
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        , and the set 
                           Y
                         has a minimum positive element, then 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                         is finite. Hence, the set of achievable portfolios is also finite under these conditions. Otherwise, we show that the set 
                           Y
                           ∩
                           (
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           )
                         contains countably infinite elements.


                        
                           Theorem 1
                           
                              If 
                              
                                 |
                                 z
                                 |
                                 <
                                 min
                                 ⁡
                                 {
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                                 |
                                 ,
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 |
                                 }
                              
                              , 
                              
                                 ∀
                                 z
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                              , and the set 
                              
                                 Y
                               
                              has a minimum positive element, i.e., 
                              
                                 ∃
                                 δ
                                 =
                                 min
                                 ⁡
                                 {
                                 y
                                 ∈
                                 Y
                                 :
                                 y
                                 >
                                 0
                                 }
                              
                              , then the set of achievable portfolios 
                              
                                 B
                                 =
                                 
                                    
                                       ∪
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                               
                              is finite. If such a minimum positive element does not exist, then 
                              
                                 B
                               
                              is countably infinite.
                           


                        
                           Proof
                           The proof is in Appendix D.  □

In Theorem 1 we present a sufficient and necessary condition for the achievable portfolios to be finite. We emphasize that the required condition, i.e., 
                           |
                           z
                           |
                           <
                           min
                           ⁡
                           {
                           |
                           
                              
                                 α
                              
                              
                                 −
                              
                           
                           |
                           ,
                           |
                           
                              
                                 α
                              
                              
                                 +
                              
                           
                           |
                           }
                        , 
                           ∀
                           z
                           ∈
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        , is a necessary required technical condition which assures that the TRP thresholds are large enough to prohibit constant rebalancings at each investment period. In this sense, this condition does not limit the generality of the TRP framework.

By Theorem 1, we establish the conditions for a unique stationary distribution of the achievable portfolios. With the existence of a unique stationary distribution, in the next section, we provide the asymptotic behavior of the expected wealth growth by presenting the growth rate. However, before proceeding further, we note that although Theorem 1 states that the number of achievable portfolios is finite under certain conditions, it does not specify the exact number. In the following corollary, we demonstrate that the number of achievable portfolios is 
                           ⌊
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                              
                              δ
                           
                           ⌋
                         if the set of achievable portfolios is finite.


                        
                           Corollary 1
                           
                              If 
                              
                                 |
                                 z
                                 |
                                 <
                                 min
                                 ⁡
                                 {
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                                 |
                                 ,
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 |
                                 }
                              
                              , 
                              
                                 ∀
                                 z
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                              , and 
                              
                                 ∃
                                 δ
                                 =
                                 min
                                 ⁡
                                 {
                                 y
                                 ∈
                                 Y
                                 :
                                 y
                                 >
                                 0
                                 }
                              
                              , then the number of achievable portfolios is 
                              
                                 ⌊
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             +
                                          
                                       
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             −
                                          
                                       
                                    
                                    δ
                                 
                                 ⌋
                              
                              .
                              
                                 1
                              
                              
                                 1
                                 Here, 
                                       ⌊
                                       x
                                       /
                                       y
                                       ⌋
                                     is the largest integer less than or equal to 
                                       x
                                       /
                                       y
                                     and 
                                       ⌈
                                       x
                                       /
                                       y
                                       ⌉
                                     is the smallest integer greater or equal to the 
                                       x
                                       /
                                       y
                                    .
                              
                           


                        
                           Proof
                           The proof is in Appendix E.  □

In Theorem 1, we introduce conditions on the cardinality of the set of all achievable portfolio states, 
                           B
                        , and showed that 
                           B
                         is finite under certain conditions. Using this result, we next analyze the asymptotic behavior of the expected achieved wealth, i.e., we demonstrate that when 
                           B
                         is finite, the portfolio sequence converges to a stationary distribution. Hence, we can determine the limiting behavior of the expected achieved wealth so that we can optimize b and ϵ. To accomplish this, we first present a recursive update to evaluate 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                        . We then maximize
                           
                              (24)
                              
                                 g
                                 (
                                 b
                                 ,
                                 ϵ
                                 )
                                 ≜
                                 
                                    lim
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 ⁡
                                 
                                    1
                                    n
                                 
                                 log
                                 ⁡
                                 E
                                 [
                                 S
                                 (
                                 n
                                 )
                                 ]
                              
                           
                         over b and ϵ with a brute-force search, i.e., we calculate 
                           g
                           (
                           b
                           ,
                           ϵ
                           )
                         for different 
                           (
                           b
                           ,
                           ϵ
                           )
                         pairs and find the one that yields the maximum expected wealth.

When 
                           B
                         is finite, it follows from Corollary 1 that there are exactly 
                           L
                           ≜
                           ⌊
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       +
                                    
                                 
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       −
                                    
                                 
                              
                              δ
                           
                           ⌋
                         achievable portfolios. Then, we let 
                           B
                           =
                           {
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 L
                              
                           
                           }
                        , where 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           =
                           b
                         without loss of generality. We define the probability mass vector of the portfolio sequence as 
                           π
                           (
                           n
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 n
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              
                                 T
                              
                           
                         where 
                           
                              
                                 π
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           ≜
                           
                              Pr
                           
                           
                              (
                              b
                              (
                              n
                              )
                              =
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . The portfolio sequence 
                           b
                           (
                           n
                           )
                         forms a homogeneous Markov chain with a finite state space 
                           B
                         since the transition probabilities between states are independent of period n. We observe that 
                           b
                           (
                           n
                           )
                         is irreducible since each state communicates with other states so that all states are null-persistent as 
                           B
                         is finite [31]. Then, it follows that there exists a unique stationary distribution vector 
                           π
                           =
                           
                              
                                 lim
                              
                              
                                 n
                                 →
                                 ∞
                              
                           
                           ⁡
                           π
                           (
                           n
                           )
                        . To calculate 
                           π
                        , we first observe that the set of portfolios from which 
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                         is achievable, i.e., 
                           
                              
                                 N
                              
                              
                                 m
                                 ,
                                 n
                              
                           
                        , and the set of price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 k
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                        , i.e., 
                           
                              
                                 U
                              
                              
                                 k
                                 ,
                                 m
                                 ,
                                 n
                              
                           
                        , are independent of the investment period n since the price relative sequences are i.i.d. 
                           ∀
                           k
                           ,
                           m
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           L
                           }
                        . Hence, we drop the subscript n from these terms for ease of exposition and write 
                           
                              
                                 U
                              
                              
                                 k
                                 ,
                                 m
                                 ,
                                 n
                              
                           
                           =
                           
                              
                                 U
                              
                              
                                 k
                                 ,
                                 m
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 m
                                 ,
                                 n
                              
                           
                           =
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                        , 
                           ∀
                           n
                           ∈
                           N
                        . We next note that the state transition probabilities are also independent of n, hence we also have 
                           
                              
                                 q
                              
                              
                                 k
                                 ,
                                 m
                                 ,
                                 n
                              
                           
                           =
                           
                              
                                 q
                              
                              
                                 k
                                 ,
                                 m
                              
                           
                        , 
                           ∀
                           n
                           ∈
                           N
                         and 
                           ∀
                           n
                           ∈
                           N
                        . Therefore, we can write 
                           
                              Pr
                           
                           
                              (
                              b
                              (
                              n
                              )
                              =
                              
                                 
                                    b
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         as follows
                           
                              (25)
                              
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    n
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       ,
                                       m
                                    
                                 
                                 
                                 
                                    Pr
                                 
                                 
                                    (
                                    b
                                    (
                                    n
                                    −
                                    1
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 q
                              
                              
                                 k
                                 ,
                                 m
                              
                           
                           =
                           0
                         if 
                           
                              
                                 b
                              
                              
                                 k
                              
                           
                           ∉
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                        . Now, by using the definition of 
                           π
                           (
                           n
                           )
                         and (25), we get 
                           π
                           (
                           n
                           +
                           1
                           )
                           =
                           P
                           π
                           (
                           n
                           )
                        , 
                           ∀
                           n
                           ≥
                           0
                        , where P is the state transition matrix, i.e., 
                           
                              
                                 P
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 q
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        .

In order to determine the limiting behavior of 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                        , we first define the vector 
                           e
                           (
                           n
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 n
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       L
                                    
                                 
                                 (
                                 n
                                 )
                                 ]
                              
                              
                                 T
                              
                           
                        , where 
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           ≜
                           
                              Pr
                           
                           
                              (
                              b
                              (
                              n
                              )
                              =
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ×
                           E
                           [
                           S
                           (
                           n
                           )
                           |
                           b
                           (
                           n
                           )
                           =
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           ]
                        . Then, from (5), we have 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 L
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           (
                           n
                           )
                           =
                           
                              
                                 1
                              
                              
                                 T
                              
                           
                           e
                           (
                           n
                           )
                        , where 1 is the vector of ones. Hence, according to the definition of 
                           e
                           (
                           n
                           )
                         and using (15) and (20), we can write 
                           e
                           (
                           n
                           +
                           1
                           )
                           =
                           Q
                           
                           e
                           (
                           n
                           )
                        , where
                           
                              (26)
                              
                                 Q
                                 ≜
                                 
                                    [
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   w
                                                   ∈
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   κ
                                                
                                                
                                                   1
                                                
                                             
                                              
                                          
                                          
                                             ⋯
                                              
                                          
                                          
                                             
                                                ∑
                                                
                                                   w
                                                   ∈
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         L
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   κ
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                              
                                          
                                          
                                             ⋱
                                              
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   w
                                                   ∈
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         1
                                                         ,
                                                         L
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   κ
                                                
                                                
                                                   1
                                                
                                             
                                              
                                          
                                          
                                             ⋯
                                              
                                          
                                          
                                             
                                                ∑
                                                
                                                   w
                                                   ∈
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         L
                                                         ,
                                                         L
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   κ
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         and 
                           
                              
                                 κ
                              
                              
                                 i
                              
                           
                           ≜
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              +
                              (
                              1
                              −
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           )
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           (
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           )
                        , where we ignore rebalancing for presentation purposes. If we take rebalancing into account, then only the first row of Q changes as follows
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                [
                                                Q
                                                ]
                                             
                                             
                                                1
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      m
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                          +
                                          
                                             ∑
                                             
                                                w
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      m
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                          ×
                                          
                                             (
                                             1
                                             −
                                             c
                                             
                                                |
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                b
                                                |
                                             
                                             )
                                          
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 m
                                 ,
                                 1
                              
                           
                         is the set of price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           =
                           b
                         without crossing the threshold boundaries and 
                           
                              
                                 R
                              
                              
                                 m
                                 ,
                                 1
                              
                           
                         is the set of price relative vectors that connect 
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                         to 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           =
                           b
                         by crossing the threshold boundaries.
                           2
                        
                        
                           2
                           Here, 
                                 
                                    
                                       [
                                       Q
                                       ]
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                               represents the entry of the matrix Q at its ith row and jth column.
                        
                     

Here, we analyze 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                         as 
                           n
                           →
                           ∞
                         as follows. We assume that the matrix Q is diagonalizable with eigenvalues 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 λ
                              
                              
                                 L
                              
                           
                        , where, without loss of generality, we assume that 
                           
                              
                                 λ
                              
                              
                                 L
                              
                           
                           ≤
                           …
                           ≤
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                        , which is the case for a wide range of transaction costs [31]. Then, there exists a nonsingular matrix B such that 
                           Q
                           =
                           B
                           Λ
                           
                              
                                 B
                              
                              
                                 −
                                 1
                              
                           
                         where Λ is the diagonal matrix with entries 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 λ
                              
                              
                                 L
                              
                           
                        . We observe that Q has nonnegative entries. Therefore, it follows from Perron–Frobenius Theorem [27] that Q has a unique largest eigenvalue 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           >
                           0
                         and any other eigenvalue is strictly smaller than 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                         in absolute value, i.e., 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           >
                           |
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                           |
                        , 
                           ∀
                           j
                           ∈
                           {
                           2
                           ,
                           …
                           ,
                           L
                           }
                        . Then, the recursion on 
                           e
                           (
                           n
                           )
                         yields 
                           e
                           (
                           n
                           )
                           =
                           
                              
                                 Q
                              
                              
                                 n
                              
                           
                           e
                           (
                           0
                           )
                        , and 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                         can be written as follows
                           
                              (27)
                              
                                 E
                                 [
                                 S
                                 (
                                 n
                                 )
                                 ]
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       n
                                    
                                 
                                 e
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 B
                                 
                                    
                                       Λ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 e
                                 (
                                 0
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                         where 
                           u
                           ≜
                           
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       L
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 B
                              
                              
                                 T
                              
                           
                           
                              1
                           
                         and 
                           v
                           ≜
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    L
                                 
                              
                              ]
                           
                           =
                           
                              
                                 B
                              
                              
                                 −
                                 1
                              
                           
                           e
                           (
                           0
                           )
                        . Then, it follows that
                           
                              (28)
                              
                                 
                                    
                                       
                                          g
                                          (
                                          b
                                          ,
                                          ϵ
                                          )
                                       
                                       
                                          =
                                          
                                             lim
                                             
                                                n
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          
                                             1
                                             n
                                          
                                          log
                                          ⁡
                                          
                                             {
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                L
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             lim
                                             
                                                n
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          log
                                          ⁡
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             lim
                                             
                                                n
                                                →
                                                ∞
                                             
                                          
                                          ⁡
                                          
                                             1
                                             n
                                          
                                          log
                                          ⁡
                                          
                                             {
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                L
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   n
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          log
                                          ⁡
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         since 
                           
                              
                                 lim
                              
                              
                                 n
                                 →
                                 ∞
                              
                           
                           ⁡
                           
                              
                                 (
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 )
                              
                              
                                 n
                              
                           
                           =
                           0
                        , 
                           ∀
                           i
                           ∈
                           {
                           2
                           ,
                           …
                           ,
                           L
                           }
                        . Hence, we can optimize b and ϵ as follows
                           
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   b
                                                
                                                
                                                   ⁎
                                                
                                             
                                             ,
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   ⁎
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   arg
                                                
                                                
                                                
                                                   max
                                                
                                             
                                             
                                                b
                                                ∈
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                                ,
                                                0
                                                <
                                                ϵ
                                             
                                          
                                          
                                          g
                                          (
                                          b
                                          ,
                                          ϵ
                                          )
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             
                                                
                                                   arg
                                                
                                                
                                                
                                                   max
                                                
                                             
                                             
                                                b
                                                ∈
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                                ,
                                                0
                                                <
                                                ϵ
                                             
                                          
                                          
                                          log
                                          ⁡
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                         To maximize 
                           g
                           (
                           b
                           ,
                           ϵ
                           )
                        , we evaluate it for different values of 
                           (
                           b
                           ,
                           ϵ
                           )
                         pairs and find the pair that maximizes 
                           g
                           (
                           b
                           ,
                           ϵ
                           )
                        , i.e., by a brute-force search in the Simulations section.

In the next section, we investigate the well-studied two-asset Brownian market model under transaction costs.

In this section, we consider the well-known two-asset Brownian market, where the stock price signals are generated from a standard Brownian motion [11,14,32]. Portfolio selection problem in continuous time two-asset Brownian markets with proportional transaction costs was investigated in [32], where the growth optimal investment strategy is shown to be a threshold portfolio. Here, as usually done in the financial literature [11], we first convert the continuous time Brownian market by sampling to a discrete-time market [14]. We then calculate the expected achieved wealth and optimize b and ϵ to find the best portfolio rebalancing strategy for a discrete-time Brownian market with transaction costs. We emphasize that although, the growth optimal investment in discrete-time two-asset Brownian markets with proportional transaction costs was investigated in [14], the expected achieved wealth and the optimal threshold interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         has not been calculated yet.

To model the Brownian two-asset market, we use the price relative vector 
                           X
                           =
                           
                              
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        , with 
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           =
                           1
                         and 
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 e
                              
                              
                                 a
                                 Z
                              
                           
                         where a is a constant and Z is a random variable with 
                           
                              Pr
                           
                           
                              (
                              Z
                              =
                              ±
                              1
                              )
                           
                           =
                           
                              1
                              2
                           
                        . This price relative vector is obtained by sampling the stock price processes of the continuous time two-asset Brownian market [14,32]. We emphasize that this sampling results a discrete-time market identical to the binomial model popular in asset pricing [14]. Under this framework, we next present the set of achievable portfolios and the transition probabilities between portfolio states.

Since the price of the first stock is the same over investment periods, the portfolio leaves the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         if either the money in the second stock grows over a certain limit or falls below a certain limit. If the portfolio 
                           b
                           (
                           n
                           )
                         does not leave the interval 
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         for N investment periods, then the money in the first stock is b dollars and the money in the second stock is 
                           (
                           1
                           −
                           b
                           )
                           
                              
                                 e
                              
                              
                                 a
                                 k
                              
                           
                         dollars for some 
                           −
                           N
                           ≤
                           k
                           ≤
                           N
                         so that the portfolio is 
                           b
                           (
                           N
                           )
                           =
                           
                              b
                              
                                 b
                                 +
                                 (
                                 1
                                 −
                                 b
                                 )
                                 
                                    
                                       e
                                    
                                    
                                       a
                                       k
                                    
                                 
                              
                           
                        . Note that 
                           b
                           (
                           N
                           )
                           ∈
                           (
                           b
                           −
                           ϵ
                           ,
                           b
                           +
                           ϵ
                           )
                         iff 
                           
                              
                                 k
                              
                              
                                 min
                              
                           
                           ≤
                           k
                           ≤
                           
                              
                                 k
                              
                              
                                 max
                              
                           
                        , where 
                           
                              
                                 k
                              
                              
                                 min
                              
                           
                           ≜
                           
                              ⌈
                              
                                 1
                                 a
                              
                              ln
                              ⁡
                              
                                 
                                    b
                                    (
                                    1
                                    −
                                    b
                                    −
                                    ϵ
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    b
                                    )
                                    (
                                    b
                                    +
                                    ϵ
                                    )
                                 
                              
                              ⌉
                           
                         and 
                           
                              
                                 k
                              
                              
                                 max
                              
                           
                           ≜
                           
                              ⌊
                              
                                 1
                                 a
                              
                              ln
                              ⁡
                              
                                 
                                    b
                                    (
                                    1
                                    −
                                    b
                                    +
                                    ϵ
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    b
                                    )
                                    (
                                    b
                                    −
                                    ϵ
                                    )
                                 
                              
                              ⌋
                           
                        . Hence, the set of achievable portfolios is given by
                           
                              (29)
                              
                                 B
                                 =
                                 
                                    {
                                    
                                       
                                          b
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       b
                                       
                                          b
                                          +
                                          (
                                          1
                                          −
                                          b
                                          )
                                          
                                             
                                                e
                                             
                                             
                                                a
                                                (
                                                k
                                                +
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      min
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    :
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          max
                                       
                                    
                                    −
                                    
                                       
                                          k
                                       
                                       
                                          min
                                       
                                    
                                    +
                                    1
                                    }
                                 
                                 .
                              
                           
                         For ease of exposition, we denote 
                           B
                           =
                           {
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 L
                              
                           
                           }
                        , where 
                           L
                           =
                           |
                           B
                           |
                           =
                           
                              
                                 k
                              
                              
                                 max
                              
                           
                           −
                           
                              
                                 k
                              
                              
                                 min
                              
                           
                           +
                           1
                         and 
                           
                              
                                 b
                              
                              
                                 1
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       min
                                    
                                 
                              
                           
                           =
                           b
                        , without loss of generality. We see that the portfolio is rebalanced to 
                           
                              
                                 b
                              
                              
                                 1
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       min
                                    
                                 
                              
                           
                           =
                           b
                         only if it is in the state 
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 e
                              
                              
                                 −
                                 a
                              
                           
                         or it is in the state 
                           
                              
                                 b
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 e
                              
                              
                                 a
                              
                           
                        . Therefore, the transition probabilities are given by
                           
                              (30)
                              
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             ,
                                          
                                          
                                             if 
                                             |
                                             k
                                             −
                                             m
                                             |
                                             =
                                             1
                                              or 
                                             k
                                             ∈
                                             {
                                             1
                                             ,
                                             L
                                             }
                                              and 
                                             m
                                             =
                                             1
                                             −
                                             
                                                
                                                   k
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 q
                              
                              
                                 k
                                 ,
                                 m
                              
                           
                         is the probability that we have 
                           b
                           (
                           n
                           )
                           =
                           
                              
                                 b
                              
                              
                                 m
                              
                           
                         given that 
                           b
                           (
                           n
                           −
                           1
                           )
                           =
                           
                              
                                 b
                              
                              
                                 k
                              
                           
                         at any period n. We then calculate 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                         using the recursions in Section 3.5 as follows. The sets of price relative vectors that connect portfolio states are given by
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       k
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   [
                                                   1
                                                   ,
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                          
                                          
                                             if 
                                             k
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             L
                                             −
                                             1
                                             }
                                             ,
                                             
                                             m
                                             =
                                             k
                                             +
                                             1
                                              or 
                                             k
                                             =
                                             L
                                             ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             m
                                             =
                                             1
                                             −
                                             
                                                
                                                   k
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   [
                                                   1
                                                   ,
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         a
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                          
                                          
                                             if 
                                             k
                                             ∈
                                             {
                                             2
                                             ,
                                             …
                                             ,
                                             L
                                             }
                                             ,
                                             
                                             m
                                             =
                                             k
                                             −
                                             1
                                              or 
                                             k
                                             =
                                             1
                                             ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             m
                                             =
                                             1
                                             −
                                             
                                                
                                                   k
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∅
                                             ,
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         Hence, we can calculate the matrix Q defined in (26) as follows
                           
                              
                                 
                                    
                                       [
                                       Q
                                       ]
                                    
                                    
                                       m
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             
                                                
                                                   e
                                                
                                                
                                                   a
                                                
                                             
                                             )
                                             ,
                                          
                                          
                                             if 
                                             m
                                             ∈
                                             {
                                             2
                                             ,
                                             …
                                             ,
                                             L
                                             }
                                              and 
                                             k
                                             =
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             
                                                
                                                   e
                                                
                                                
                                                   −
                                                   a
                                                
                                             
                                             )
                                             ,
                                          
                                          
                                             if 
                                             m
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             L
                                             −
                                             1
                                             }
                                              and 
                                          
                                       
                                       
                                          
                                          
                                             k
                                             =
                                             m
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where we ignore rebalancing. If we take rebalancing into account, then we can write
                           
                              
                                 
                                    
                                       [
                                       Q
                                       ]
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             i
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       a
                                    
                                 
                                 )
                                 
                                    (
                                    1
                                    −
                                    c
                                    
                                       |
                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                                
                                                   e
                                                
                                                
                                                   −
                                                   a
                                                
                                             
                                          
                                       
                                       −
                                       b
                                       |
                                    
                                    )
                                 
                                 ,
                              
                           
                         and
                           
                              
                                 
                                    
                                       [
                                       Q
                                       ]
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             i
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       L
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       S
                                    
                                 
                                 +
                                 (
                                 1
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       L
                                    
                                 
                                 )
                                 
                                    
                                       e
                                    
                                    
                                       a
                                    
                                 
                                 )
                                 
                                    (
                                    1
                                    −
                                    c
                                    
                                       |
                                       
                                          
                                             
                                                b
                                             
                                             
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   L
                                                
                                             
                                             +
                                             (
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   L
                                                
                                             
                                             )
                                             
                                                
                                                   e
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                       −
                                       b
                                       |
                                    
                                    )
                                 
                                 .
                              
                           
                         Then, using the recursions in Section 3.5, we can obtain 
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                           =
                           
                              
                                 Q
                              
                              
                                 n
                              
                           
                           e
                           (
                           0
                           )
                        . Then, we maximize 
                           g
                           (
                           b
                           ,
                           ϵ
                           )
                           =
                           
                              
                                 lim
                              
                              
                                 n
                                 →
                                 ∞
                              
                           
                           ⁡
                           
                              1
                              n
                           
                           log
                           ⁡
                           E
                           [
                           S
                           (
                           n
                           )
                           ]
                           =
                           log
                           ⁡
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                        , where 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                         is the largest eigenvalue of Q. Here, we optimize b and ϵ with a brute-force search, i.e., we find 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                         for different 
                           (
                           b
                           ,
                           ϵ
                           )
                         pairs and find the one that achieves the maximum.

In this section, we sequentially estimate the probability mass vectors 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              2
                           
                        
                      corresponding to 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                     , respectively, using a maximum likelihood estimator (MLE). In general, these vectors may not be known or may change in time, hence, they should be estimated at each investment period prior to the calculation of 
                        E
                        [
                        S
                        (
                        n
                        )
                        ]
                     . The MLE for a pmf on a finite set is well-known [31], but we provide the corresponding derivations here for completeness. We consider the price relative sequence 
                        
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              (
                              n
                              )
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                     , where 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                        =
                        
                           
                              w
                           
                           
                              n
                           
                        
                        ∈
                        X
                     , for 
                        n
                        =
                        1
                        ,
                        …
                        ,
                        N
                      is an arbitrary realization of this sequence. Here, our aim is to estimate 
                        
                           
                              p
                           
                           
                              1
                           
                        
                     , where we point out that similar derivations follow for the price relative sequence 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              p
                           
                           
                              2
                           
                        
                     .

As demonstrated in our simulations, the corresponding estimation can be carried out over a finite length window to emphasize the most recent data. We let 
                        w
                        ≜
                        
                           
                              [
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    w
                                 
                                 
                                    N
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      represent the realization vector and 
                        θ
                        ≜
                        
                           
                              [
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          K
                                       
                                    
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      represent the parameter vector, where 
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        
                        ≜
                        
                           
                              p
                           
                           
                              1
                           
                        
                        (
                        
                           
                              x
                           
                           
                              i
                           
                        
                        |
                        θ
                        )
                      is the conditional pmf for 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        K
                     . Then, the MLE of the 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      is given by
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ML
                                          
                                       
                                    
                                    
                                       =
                                       
                                          
                                             
                                                arg
                                             
                                             
                                             
                                                max
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             =
                                             1
                                             
                                             :
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       w
                                       |
                                       θ
                                       )
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             
                                                arg
                                             
                                             
                                             
                                                max
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             =
                                             1
                                             
                                             :
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                       
                                          Pr
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          1
                                          )
                                          =
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          N
                                          )
                                          =
                                          
                                             
                                                w
                                             
                                             
                                                N
                                             
                                          
                                          |
                                          θ
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        
                      Since the price relative sequence 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      is i.i.d., it follows that 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        (
                        w
                        |
                        θ
                        )
                        =
                        
                           
                              ∏
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              p
                           
                           
                              1
                           
                        
                        (
                        
                           
                              w
                           
                           
                              i
                           
                        
                        |
                        θ
                        )
                        =
                        
                           
                              ∏
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              θ
                           
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                        
                        =
                        
                           
                              ∏
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              ∏
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                           
                              I
                              (
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        
                     , where 
                        I
                        (
                        ⋅
                        )
                      is the indicator function. If we change the order of the product operators, then we obtain 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        (
                        w
                        |
                        θ
                        )
                        =
                        
                           
                              ∏
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              ∏
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                           
                              I
                              (
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        
                        =
                        
                           
                              ∏
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              I
                              (
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        
                        =
                        
                           
                              ∏
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                           
                              
                                 
                                    N
                                 
                                 
                                    j
                                 
                              
                           
                        
                     , where 
                        
                           
                              N
                           
                           
                              j
                           
                        
                        ≜
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        I
                        (
                        
                           
                              w
                           
                           
                              i
                           
                        
                        =
                        
                           
                              x
                           
                           
                              j
                           
                        
                        )
                      represents the number of realizations that are equal to 
                        
                           
                              x
                           
                           
                              j
                           
                        
                        ∈
                        X
                      for 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        K
                     . Noting that 
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              N
                           
                           
                              j
                           
                        
                        =
                        N
                     , we can write 
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ML
                           
                        
                        =
                        
                           
                              
                                 arg
                              
                              
                              
                                 max
                              
                           
                           
                              θ
                           
                        
                        
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                           N
                        
                        log
                        ⁡
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                     , since 
                        log
                        ⁡
                        (
                        ⋅
                        )
                      is a monotone increasing function. If we define the vector 
                        h
                        ≜
                        
                           
                              [
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          K
                                       
                                    
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                     , where 
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        ≜
                        
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                           N
                        
                      for 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        K
                     , then we observe that 
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        ≥
                        0
                      for 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        K
                      and 
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        =
                        1
                     . Since h and 
                        θ
                      are probability vectors, i.e., their entries are nonnegative and sum up to one, it follows that 
                        D
                        (
                        h
                        ‖
                        θ
                        )
                        ≜
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        log
                        ⁡
                        
                           (
                           
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                           )
                        
                        ≥
                        0
                      and 
                        D
                        (
                        h
                        ‖
                        θ
                        )
                        =
                        0
                      if and only if 
                        θ
                        =
                        h
                      
                     [10]. Therefore, we get that 
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        log
                        ⁡
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        =
                        −
                        D
                        (
                        h
                        ‖
                        θ
                        )
                        +
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        log
                        ⁡
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        ≤
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        log
                        ⁡
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                     , where the equality is reached if and only if 
                        θ
                        =
                        h
                     . Hence, it follows that 
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ML
                           
                        
                        =
                        
                           
                              
                                 arg
                              
                              
                              
                                 max
                              
                           
                           
                              θ
                           
                        
                        
                        
                           
                              ∑
                           
                           
                              j
                              =
                              1
                           
                           
                              K
                           
                        
                        
                           
                              h
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        log
                        ⁡
                        
                           
                              θ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                        
                        =
                        h
                     , i.e., we estimate the probability mass vector 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      with 
                        h
                        =
                        
                           [
                           
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              N
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    N
                                 
                                 
                                    K
                                 
                              
                              N
                           
                           ]
                        
                      at each investment period N.

In this section, we illustrate the performance of the proposed algorithm using historical data. We first compare the performance of the proposed algorithm with respect to the conventional methods using the historical data from [8,19], which is collected from the New York Stock Exchange (NYSE) over a 22-year period between 1963–1985. This NYSE data includes 34 stocks (where the Kin Ark stock is excluded) and 5651 investment periods (days). We then use the recent S&P 500 data to compare the performances of the our algorithm, state-of-the-art algorithms, and the conventional algorithms. In particular, we consider the Consol Energy Inc. (CNX) – Metlife Inc. (MET), Fidelity National Information Services (FIS) – United Parcel Service Inc. (UPS), Fluor Corporation (FLS) – Allegheny Technologies (ATI), Reynolds American Inc. (RAI) – eBay Inc. (EBAY) stock pairs over the period between June 20, 2001 and May 29, 2015 (i.e., 3505 days), and present the average wealth returns. These stocks are chosen since their cumulative returns over the corresponding time interval are between 1–4 dollars per one dollar investment. Finally, we consider the Dow Jones Industrial Average (DJIA) data. We use the alphabetically sorted stock pairs of the DJIA data over the period between July 1, 2009 and August 7, 2015, and present the average wealth returns. The proposed algorithms are assumed to be able to trade at the following approximated Volume Weighted Average Price (VWAP): 
                        0.4
                        ×
                        Open
                        +
                        0.6
                        ×
                        Close
                     , where “Open” and “Close” are the opening and closing prices of the stocks, respectively. For all our data sets, adjustments were made for splits and dividends.

Throughout the experiments, the proposed TRP algorithm is constructed as follows. The algorithm introduced in Section 3.1 requires the sample space of the price relative sequences. This sample space is constructed by quantizing the observed realizations into 11 different bins, where each bin is created according to Theorem 1. We then consider a sliding window of length 100 and approximate the probability mass vectors of the price relative sequences using the past data for each window. The proposed TRP algorithm constructs its trading rule by maximizing the expected achieved wealth over b and ϵ according to the discussions in Section 3.5, and we invest using this TRP for each window.

We compare the performance of the proposed TRP algorithm with respect to the state-of-the-art and conventional methods. These competitor algorithms can be briefly described as follows.
                        
                           •
                           
                              Cover is the Cover's universal portfolio algorithm in [8]. In this method, the wealth is distributed among various stocks according to their wealth returns.


                              SCRP is the semiconstant rebalanced portfolio algorithm of [19]. In this method, portfolio is rebalanced only on selected instants to mitigate the effects of transaction costs.


                              Iyengar is the universal threshold rebalanced portfolio algorithm of [15]. In this method, the wealth is distributed among various target portfolio and threshold pairs according to their wealth returns.


                              CWMR is the confidence weighted mean reversion algorithm of [22]. In this method, the portfolio is modeled as a Gaussian distribution and trading is performed using the mean reversion principle.


                              OLMAR is the online portfolio selection with moving average reversion algorithm of [23]. This method is based on a multiple-period mean reversion strategy.


                              Anticor is the anti-correlation algorithm of [5]. This method uses the predictable statistical relations between stocks to beat the best stock in the market.


                              M0 is the Markov of order zero algorithm of [4]. This method uses the add-beta prediction rule on the Kelly projections of the market vectors.

In Figs. 2 and 3
                     
                     , we present the average wealth returns of the TRP, Cover, SCRP, and Iyengar algorithms over 10 randomly chosen stock pairs from the NYSE data under 1% and 2% transaction costs, respectively. These figures illustrate that the proposed TRP algorithm significantly outperforms the competitor algorithms and achieve higher wealth returns. Since the TRP algorithm aims to mitigate the effects of hefty transaction costs, its performances is not significantly affected by a change in the commission rate. The proposed TRP algorithm achieves this robustness by avoiding excessive rebalancings. Although the SCRP and Iyengar algorithms are also robust against transaction costs, the TRP algorithm provides a better performance since it directly aims to maximize the expected achieved wealth.

We next compare the performance of the proposed TRP algorithm with respect to the state-of-the-art algorithms using the recent S&P 500 data. In Figs. 4 and 5
                     
                     , we have presented the wealth returns of the proposed algorithms for transaction costs of 0.03% and 0.1%, respectively. As shown in these figures, the proposed TRP algorithm significantly outperforms the state-of-the-art competitor algorithms and achieve the highest final wealth returns. For this experiment, we also provide the Sharpe, Calmar, and Sortino ratios of the proposed algorithms in Table 1
                     , where the values in the table are found according to the model described in [21,22]. This table illustrates that the proposed TRP algorithm achieves the highest reward-to-variability ratios. Furthermore, as the transaction cost increases, the Sharpe ratio of our algorithm does not significantly decrease, whereas the Sharpe ratios of the competitor algorithms notably decreases. This illustrates the robustness of the proposed algorithm against transaction costs. Since the proposed algorithm optimizes its trading model with respect to a given transaction cost, the risk of the algorithm does not vary excessively.

Although the transaction costs in Figs. 4 and 5 are realistic for institutional trading, the transaction costs for retail trading are around 1–3%. Since these state-of-the-art algorithms does not optimize their trading model according to the transaction cost, their returns tend to go to zero as the transaction cost exceeds 1%. Thus, we have compared the performance of our algorithm with respect to only the conventional trading algorithms for 3% transaction cost in Fig. 6
                     . For mild transaction costs (such as the ones in Figs. 4 and 5), the final wealth return of the TRP algorithm is around 5.25 dollars per one dollar investment. On the other hand, for a hefty transaction cost (such as the one in Fig. 6), the total wealth return of the TRP algorithm is around 4.75 dollars per one dollar investment. This illustrates that although the state-of-the-art trading algorithms cannot provide a reasonable wealth return for such hefty transaction costs, the performance of the proposed TRP algorithm is not significantly deteriorated as the transaction cost increases.

We also provide the wealth returns of the proposed TRP algorithm and the conventional algorithms under no transaction cost over the S&P 500 data for a fair comparison. Fig. 7
                      illustrates that the algorithms that consider the effects of transaction cost on the wealth return, namely the TRP, SCRP, and Iyengar algorithms, provide similar returns for different transaction costs. On the other hand, the performances of the algorithms that do not take transaction cost into account (e.g., the Cover algorithm) are highly volatile with respect to the transaction cost. Although the returns of the SCRP and Iyengar algorithms are not significantly affected by the transaction cost, the proposed TRP algorithm outperforms these methods for both no transaction cost and 3% transaction cost cases.

Finally, in Fig. 8
                     , we present the average wealth returns of the TRP, CWMR, M0, Anticor, and OLMAR algorithms under 
                        1
                        %
                      transaction cost. As can be seen from this figure, the TRP algorithm provides a superior performance with respect to the competitor algorithms that do not consider the effects of transaction costs. This result highlights the importance of designing portfolio optimization algorithms that avoid excessive number of rebalancings when the transaction cost is high. In Fig. 9
                     , we present the average wealth returns of the TRP, Iyengar, Cover, and SCRP algorithms under 
                        0.5
                        %
                      transaction cost. Although the performances of the proposed algorithms are comparable with one another since the transaction cost is small, the TRP algorithm still provides a marginally higher return with respect to the competitor algorithms.

@&#CONCLUSION@&#

We study growth optimal investment in i.i.d. discrete-time markets under proportional transaction costs. Under this market model, we study threshold portfolios that are shown to yield the optimal growth. We first introduce a recursive update to calculate the expected growth for a two-asset market and then extend our results to markets having more than two assets. We next demonstrate that under the threshold rebalancing framework, the achievable set of portfolios form an irreducible Markov chain under mild technical conditions. We evaluate the corresponding stationary distribution of this Markov chain, which provides a natural and efficient method to calculate the cumulative expected wealth. Subsequently, the corresponding parameters are optimized using a brute force approach yielding the growth optimal investment portfolio under proportional transaction costs in i.i.d. discrete-time two-asset markets. We also solve the optimal portfolio selection in discrete-time markets constructed by sampling continuous-time Brownian markets. For the case that the underlying discrete distributions of the price relative vectors are unknown, we provide a maximum likelihood estimator. In our simulations, we use the historical NYSE, S&P 500, and DJIA data and observe that the introduced TRP algorithm significantly improves the wealth return under both mild and hefty transaction costs.

Consider that an investor invests with a 
                        
                           TRP
                        
                        (
                        b
                        ,
                        ϵ
                        )
                      for N investment periods, where we denote a portfolio sequence realization by 
                        
                           
                              {
                              b
                              (
                              n
                              )
                              =
                              
                                 
                                    b
                                 
                                 
                                    n
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                     . Let us partition the set of N-period market scenarios according to the last time the portfolio leaves the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                     . Our claim is that any achievable portfolio at period N can be achieved by an N-period market scenario where the portfolio does no leave the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      for N periods. To illustrate this, with an abuse of notation, we let 
                        P
                      denote the set of N-period market scenarios, i.e.,
                        
                           (A.1)
                           
                              P
                              ≜
                              
                                 {
                                 
                                    
                                       {
                                       
                                          
                                             b
                                          
                                          
                                             n
                                          
                                       
                                       }
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 :
                                 
                                    
                                       b
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                                 
                                 ,
                                 n
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 }
                              
                              =
                              
                                 ⋃
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                    +
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              i
                           
                        
                      is the set of N-period market scenarios where the portfolio leaves the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      at period i for the last time, 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        N
                     , and 
                        
                           
                              P
                           
                           
                              N
                              +
                              1
                           
                        
                      is the set of N-period market scenarios where the portfolio does not leave the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      for N investment periods. We point out that 
                        
                           
                              P
                           
                           
                              i
                           
                        
                     's are disjoint, i.e., 
                        
                           
                              P
                           
                           
                              i
                           
                        
                        ∩
                        
                           
                              P
                           
                           
                              j
                           
                        
                        =
                        ∅
                      for 
                        i
                        ≠
                        j
                     , and their union gives the set of all N-period market scenarios, i.e., 
                        
                           
                              ⋃
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                              +
                              1
                           
                        
                        
                           
                              P
                           
                           
                              i
                           
                        
                        =
                        P
                     .

Let 
                        
                           
                              L
                           
                           
                              i
                           
                        
                      denote the last elements of the sequences in 
                        
                           
                              P
                           
                           
                              i
                           
                        
                     , i.e., 
                        
                           
                              L
                           
                           
                              i
                           
                        
                        ≜
                        {
                        
                           
                              b
                           
                           
                              N
                           
                        
                        :
                        
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    n
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        
                           
                              P
                           
                           
                              i
                           
                        
                        }
                     . Then, the set of achievable portfolios at investment period N, i.e., 
                        
                           
                              B
                           
                           
                              N
                           
                        
                     , can be found as follows 
                        
                           
                              B
                           
                           
                              N
                           
                        
                        =
                        
                           
                              ⋃
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                              +
                              1
                           
                        
                        
                           
                              L
                           
                           
                              i
                           
                        
                     . Hence, our aim is to show that 
                        
                           
                              L
                           
                           
                              i
                           
                        
                        ⊂
                        
                           
                              L
                           
                           
                              N
                              +
                              1
                           
                        
                     , 
                        ∀
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     . To prove this, consider an arbitrary portfolio sequence 
                        
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    n
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        
                           
                              P
                           
                           
                              i
                           
                        
                      for some 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        N
                     , thus we have 
                        
                           
                              b
                           
                           
                              i
                           
                        
                        =
                        b
                      and 
                        
                           
                              b
                           
                           
                              N
                           
                        
                        ∈
                        
                           
                              B
                           
                           
                              N
                           
                        
                     , i.e., this sequence results in an achievable portfolio 
                        
                           
                              b
                           
                           
                              N
                           
                        
                        ∈
                        
                           
                              L
                           
                           
                              i
                           
                        
                     . Now, let us consider another N-period market scenario 
                        
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        
                           
                              P
                           
                           
                              N
                              +
                              1
                           
                        
                     , where
                        
                           (A.2)
                           
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          b
                                          ,
                                       
                                       
                                          if 
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                       
                                       
                                          if 
                                          j
                                          =
                                          i
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                          ,
                                       
                                    
                                 
                              
                           
                        
                      i.e., we have 
                        
                           
                              X
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        (
                        n
                        )
                        =
                        
                           
                              X
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        (
                        n
                        )
                     , 
                        ∀
                        n
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        i
                        }
                     . Then, we have 
                        
                           
                              b
                           
                           
                              N
                           
                           
                              ′
                           
                        
                        =
                        
                           
                              b
                           
                           
                              N
                           
                        
                      and consequently 
                        
                           
                              b
                           
                           
                              N
                           
                        
                        ∈
                        
                           
                              L
                           
                           
                              N
                              +
                              1
                           
                        
                     . Therefore, we conclude that 
                        
                           
                              L
                           
                           
                              i
                           
                        
                        ⊂
                        
                           
                              L
                           
                           
                              N
                              +
                              1
                           
                        
                     , 
                        ∀
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     .

As 
                        
                           
                              L
                           
                           
                              i
                           
                        
                        ⊂
                        
                           
                              L
                           
                           
                              N
                              +
                              1
                           
                        
                     , 
                        ∀
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     , we have 
                        
                           
                              B
                           
                           
                              N
                           
                        
                        =
                        
                           
                              L
                           
                           
                              N
                              +
                              1
                           
                        
                     . Then, to determine 
                        |
                        
                           
                              B
                           
                           
                              N
                           
                        
                        |
                     , we consider that the portfolio never leaves the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      for N investment periods, where
                        
                           (A.3)
                           
                              b
                              (
                              N
                              )
                              =
                              
                                 
                                    b
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    n
                                    )
                                 
                                 
                                    b
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    n
                                    )
                                    +
                                    (
                                    1
                                    −
                                    b
                                    )
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              .
                           
                        
                      Let us consider the reciprocal of 
                        b
                        (
                        N
                        )
                      and write
                        
                           
                              
                                 
                                    
                                       
                                          1
                                          
                                             b
                                             (
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       =
                                       1
                                       +
                                       
                                          
                                             1
                                             −
                                             b
                                          
                                          b
                                       
                                       
                                          ∏
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             n
                                             )
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             n
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       1
                                       +
                                       
                                          
                                             1
                                             −
                                             b
                                          
                                          b
                                       
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             Z
                                             (
                                             n
                                             )
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        
                      where 
                        Z
                        (
                        n
                        )
                        ≜
                        ln
                        ⁡
                        
                           (
                           
                              
                                 X
                              
                              
                                 2
                              
                           
                           (
                           n
                           )
                           /
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           (
                           n
                           )
                           )
                        
                     . Then, we observe that the number of different values that the portfolio 
                        b
                        (
                        N
                        )
                      can take is the same as the number of different values that the sum 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                      can take. Since the price relative sequences 
                        
                           
                              X
                           
                           
                              1
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              X
                           
                           
                              2
                           
                        
                        (
                        n
                        )
                      are elements of the same sample space 
                        X
                      with 
                        |
                        X
                        |
                        =
                        K
                     , it follows that 
                        |
                        Z
                        |
                        =
                        M
                        ≤
                        
                           
                              K
                           
                           
                              2
                           
                        
                        −
                        K
                        +
                        1
                     . Since the number of different values that the sum 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                      can take is equal to 
                        (
                        
                           
                              
                                 N
                                 +
                                 M
                                 −
                                 1
                              
                           
                           
                              
                                 M
                                 −
                                 1
                              
                           
                        
                        )
                      and 
                        M
                        ≤
                        
                           
                              K
                           
                           
                              2
                           
                        
                        −
                        K
                        +
                        1
                     , it follows that the number of achievable portfolios at period N is bounded by 
                        (
                        
                           
                              
                                 N
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 K
                              
                           
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 K
                              
                           
                        
                        )
                     , i.e., 
                        |
                        
                           
                              B
                           
                           
                              N
                           
                        
                        |
                        =
                        
                           
                              M
                           
                           
                              N
                           
                        
                        ≤
                        
                           (
                           
                              
                                 
                                    N
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    K
                                 
                              
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    K
                                 
                              
                           
                           )
                        
                     .  □

If the portfolio does not leave the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      for N investment periods, then
                        
                           (B.1)
                           
                              b
                              (
                              n
                              )
                              =
                              
                                 
                                    b
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    i
                                    )
                                 
                                 
                                    b
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    i
                                    )
                                    +
                                    (
                                    1
                                    −
                                    b
                                    )
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    i
                                    )
                                 
                              
                              ∈
                              (
                              b
                              −
                              ϵ
                              ,
                              b
                              +
                              ϵ
                              )
                              ,
                           
                        
                      
                     
                        ∀
                        n
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     . Taking the reciprocal of 
                        b
                        (
                        n
                        )
                     , we obtain
                        
                           (B.2)
                           
                              
                                 
                                    b
                                    (
                                    1
                                    −
                                    b
                                    −
                                    ϵ
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    b
                                    )
                                    (
                                    b
                                    +
                                    ϵ
                                    )
                                 
                              
                              <
                              
                                 ∏
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    i
                                    )
                                 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    i
                                    )
                                 
                              
                              <
                              
                                 
                                    b
                                    (
                                    1
                                    −
                                    b
                                    +
                                    ϵ
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    b
                                    )
                                    (
                                    b
                                    −
                                    ϵ
                                    )
                                 
                              
                              .
                           
                        
                      Noting that 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    2
                                 
                              
                              (
                              i
                              )
                           
                           
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              (
                              i
                              )
                           
                        
                        =
                        
                           
                              e
                           
                           
                              Z
                              (
                              i
                              )
                           
                        
                      and taking the logarithm of each side, it follows that
                        
                           (B.3)
                           
                              
                                 
                                    
                                       ln
                                       ⁡
                                       
                                          
                                             b
                                             (
                                             1
                                             −
                                             b
                                             −
                                             ϵ
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             b
                                             )
                                             (
                                             b
                                             +
                                             ϵ
                                             )
                                          
                                       
                                    
                                    ︸
                                 
                                 
                                    :
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          −
                                       
                                    
                                 
                              
                              <
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              Z
                              (
                              i
                              )
                              <
                              
                                 
                                    
                                       ln
                                       ⁡
                                       
                                          
                                             b
                                             (
                                             1
                                             −
                                             b
                                             +
                                             ϵ
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             b
                                             )
                                             (
                                             b
                                             −
                                             ϵ
                                             )
                                          
                                       
                                    
                                    ︸
                                 
                                 
                                    :
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                              ,
                           
                        
                      i.e., 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                        Z
                        (
                        i
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , 
                        ∀
                        n
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     . Hence, if the portfolio leaves the interval 
                        (
                        b
                        −
                        ϵ
                        ,
                        b
                        +
                        ϵ
                        )
                      for the first time at period k for some 
                        k
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     , then we conclude that we have either 
                        b
                        (
                        k
                        )
                        ≤
                        b
                        −
                        ϵ
                      or 
                        b
                        (
                        k
                        )
                        ≥
                        b
                        +
                        ϵ
                     ; and consequently we have either 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              k
                           
                        
                        Z
                        (
                        i
                        )
                        ≤
                        
                           
                              α
                           
                           
                              −
                           
                        
                      or 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              k
                           
                        
                        Z
                        (
                        i
                        )
                        ≥
                        
                           
                              α
                           
                           
                              +
                           
                        
                     , i.e., 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              k
                           
                        
                        Z
                        (
                        i
                        )
                        ∉
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     .  □

In Lemma 1, we showed that for any investment period N, the number of different portfolio values that 
                        b
                        (
                        N
                        )
                      can take is equal to the number of different values that the sum 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                      can take where 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        Z
                        (
                        n
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      for 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        N
                     . Since this is true for any investment period N, it follows that the number of all achievable portfolios is equal to the number of different values that the sum 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                      can take for any 
                        N
                        ∈
                        N
                      such that 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     .

Here, we show that if 
                        m
                        ∈
                        M
                        ∩
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , then there exists a sequence 
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                      for some 
                        N
                        ∈
                        N
                      such that 
                        m
                        =
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                      and 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      for 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        N
                     .

Let 
                        y
                        ∈
                        Y
                        ∩
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      be an arbitrary element. Then, we have 
                        y
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              
                                 
                                    M
                                 
                                 
                                    +
                                 
                              
                           
                        
                        
                           
                              y
                           
                           
                              i
                           
                        
                        
                           
                              z
                           
                           
                              i
                           
                        
                      for some 
                        
                           
                              y
                           
                           
                              i
                           
                        
                        ∈
                        Z
                      and 
                        
                           
                              z
                           
                           
                              i
                           
                        
                        ∈
                        
                           
                              Z
                           
                           
                              +
                           
                        
                     , where 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              M
                           
                           
                              +
                           
                        
                     . We define 
                        S
                        (
                        k
                        )
                        ≜
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                      for 
                        k
                        ≥
                        1
                      and construct a sequence 
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                      for some 
                        N
                        ∈
                        N
                      such that 
                        y
                        =
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                      and 
                        S
                        (
                        k
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      for each 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        N
                      as follows. We first let 
                        S
                        (
                        0
                        )
                        =
                        0
                     , where we obviously have 
                        S
                        (
                        0
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      as 
                        
                           
                              α
                           
                           
                              −
                           
                        
                        <
                        0
                      and 
                        
                           
                              α
                           
                           
                              +
                           
                        
                        >
                        0
                     . Then, for any 
                        k
                        ≥
                        0
                     , we iteratively construct our sequence as follows:
                        
                           •
                           If 
                                 S
                                 (
                                 k
                                 )
                                 ≥
                                 0
                               and
                                 
                                    ∘
                                    
                                       
                                          ∃
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                        such that 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          <
                                          0
                                       , then we let 
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                        and increase 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                        by 1. Note that 
                                          S
                                          (
                                          k
                                          +
                                          1
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                        since 
                                          S
                                          (
                                          k
                                          )
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , 
                                          S
                                          (
                                          k
                                          )
                                          ≥
                                          0
                                       , and 
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                          <
                                          0
                                       .


                                       
                                          ∀
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                        we have 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          ≥
                                          0
                                       , then we consider set 
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                          ≜
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                          :
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          >
                                          0
                                          }
                                       . Using the elements of 
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                       , we construct an arbitrary sequence, in which each 
                                          
                                             
                                                z
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                          
                                        is repeated 
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                        times. We then set 
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                i
                                                )
                                             
                                          
                                        as the ith entry of this sequence. As we know from the previous step that 
                                          S
                                          (
                                          k
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                        and we also know that 
                                          y
                                          ∈
                                          Y
                                          ∩
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , i.e., 
                                          S
                                          (
                                          N
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , then we can conclude that 
                                          S
                                          (
                                          k
                                          +
                                          i
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , 
                                          ∀
                                          k
                                          +
                                          i
                                          ≤
                                          N
                                       .


                              
                                 S
                                 (
                                 k
                                 )
                                 <
                                 0
                               and
                                 
                                    ∘
                                    
                                       
                                          ∃
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                        such that 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          >
                                          0
                                       , then we let 
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                        and decrease 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                        by 1. Note that 
                                          S
                                          (
                                          k
                                          +
                                          1
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                        since 
                                          S
                                          (
                                          k
                                          )
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , 
                                          S
                                          (
                                          k
                                          )
                                          <
                                          0
                                       , and 
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                          ≥
                                          0
                                       .


                                       
                                          ∀
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                        we have 
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          ≤
                                          0
                                       , then we consider the set 
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      −
                                                   
                                                
                                             
                                          
                                          ≜
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                          :
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          <
                                          0
                                          }
                                       . Using the elements of 
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      −
                                                   
                                                
                                             
                                          
                                       , we construct an arbitrary sequence, in which each 
                                          
                                             
                                                z
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      −
                                                   
                                                
                                             
                                          
                                        is repeated 
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                        times. We then set 
                                          
                                             
                                                Z
                                             
                                             
                                                (
                                                k
                                                +
                                                i
                                                )
                                             
                                          
                                        as the ith entry of this sequence. As we know from the previous step that 
                                          S
                                          (
                                          k
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                        and we also know that 
                                          y
                                          ∈
                                          Y
                                          ∩
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , i.e., 
                                          S
                                          (
                                          N
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , then we can conclude that 
                                          S
                                          (
                                          k
                                          +
                                          i
                                          )
                                          ∈
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                −
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                +
                                             
                                          
                                          )
                                       , 
                                          ∀
                                          k
                                          +
                                          i
                                          ≤
                                          N
                                       .

We first let 
                        H
                      denote the set of values that the sum 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      can take for any 
                        N
                        ∈
                        N
                     , i.e., 
                        H
                        ≜
                        {
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        :
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                        ,
                        
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                        ,
                        ∀
                        k
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                        ,
                        ∀
                        N
                        ∈
                        N
                        }
                     . Then, assuming that the minimum positive element δ exists, we next show that 
                        ∀
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                     , we have 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        =
                        k
                        δ
                     , for some 
                        k
                        ∈
                        Z
                     .

Assume the contrary that 
                        ∃
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                      such that 
                        Z
                        =
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        ≠
                        k
                        δ
                      for any 
                        k
                        ∈
                        Z
                     . Then, if we divide the real line into intervals of length δ, then Z should lie in one of the intervals, i.e., 
                        ∃
                        k
                        ∈
                        Z
                      such that 
                        k
                        δ
                        <
                        Z
                        <
                        (
                        k
                        +
                        1
                        )
                        δ
                      so that we can write 
                        Z
                        =
                        k
                        δ
                        +
                        η
                      where 
                        0
                        <
                        η
                        <
                        δ
                     . According to the definition of 
                        Y
                     , 
                        ∀
                        y
                        ∈
                        Y
                      and 
                        ∀
                        c
                        ∈
                        Z
                     , we have 
                        c
                        y
                        ∈
                        Y
                     . Therefore, we can conclude that 
                        k
                        δ
                        ∈
                        Y
                      as 
                        δ
                        ∈
                        Y
                     . Furthermore, according to the definition of 
                        Y
                     , 
                        ∀
                        
                           
                              y
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              2
                           
                        
                        ∈
                        Y
                     , we have 
                        
                           
                              y
                           
                           
                              1
                           
                        
                        −
                        
                           
                              y
                           
                           
                              2
                           
                        
                        ∈
                        Y
                     . Then, as 
                        Z
                        ,
                        k
                        δ
                        ∈
                        Y
                     , we have 
                        η
                        =
                        Z
                        −
                        k
                        δ
                        ∈
                        Y
                     . However, this contradicts the fact that δ is the minimum positive element of 
                        Y
                      since 
                        0
                        <
                        η
                        <
                        δ
                      and 
                        η
                        ∈
                        Y
                     . Therefore, it follows that 
                        ∀
                        h
                        ∈
                        H
                     , 
                        ∃
                        k
                        ∈
                        Z
                      such that 
                        h
                        =
                        k
                        δ
                     . As we also have 
                        ∀
                        h
                        ∈
                        H
                     , 
                        h
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , then it follows that there are finitely many elements in 
                        H
                     . As 
                        |
                        B
                        |
                        =
                        |
                        H
                        |
                      according to Lemma 1, it follows that the set of achievable portfolios 
                        B
                      is also finite.

If a minimum element δ does not exist, our claim is that 
                        B
                      contains countably infinitely many elements. Since every finite set of real numbers has a minimum, there are either infinitely many positive elements in the set 
                        Y
                      or none. We know that there exists 
                        
                           
                              z
                           
                           
                              i
                           
                        
                        ≠
                        0
                      so that there are positive numbers in 
                        Y
                     . Therefore, there are infinitely many elements in 
                        Y
                     . Now assume that 
                        ∃
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        >
                        0
                      such that 
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        =
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                      for some 
                        N
                        ∈
                        N
                     , where 
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                      and 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     . Then, by Lemma 3, it follows that 
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        ∈
                        Y
                        ∩
                        (
                        0
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      and since there exists no positive minimum element of 
                        Y
                     , 
                        ∃
                        
                           
                              γ
                           
                           
                              2
                           
                        
                        >
                        0
                      such that 
                        
                           
                              γ
                           
                           
                              2
                           
                        
                        <
                        
                           
                              γ
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              γ
                           
                           
                              2
                           
                        
                        ∈
                        Y
                        ∩
                        (
                        0
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     . Continuing in this manner, we can construct a decreasing sequence 
                        {
                        
                           
                              γ
                           
                           
                              n
                           
                        
                        }
                      such that 
                        
                           
                              γ
                           
                           
                              n
                           
                        
                        ∈
                        Y
                        ∩
                        (
                        0
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , 
                        ∀
                        n
                        ∈
                        N
                     . Note that we have 
                        
                           
                              γ
                           
                           
                              n
                           
                        
                        ∈
                        H
                     , 
                        ∀
                        n
                        ∈
                        N
                      from Lemma 3, so that there are countably infinite elements in 
                        H
                     . Hence, it follows that 
                        B
                      has countably infinitely many elements.  □

Consider an arbitrary sequence 
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        ∈
                        Z
                      for some 
                        N
                        ∈
                        N
                      such that 
                        Z
                        =
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        >
                        0
                      and 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , 
                        ∀
                        k
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     . Then, by Lemma 3, it follows that 
                        Z
                        ∈
                        Y
                        ∩
                        (
                        0
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     . Since δ is the minimum positive element of 
                        Y
                     , it follows that 
                        0
                        <
                        δ
                        ≤
                        M
                      and 
                        δ
                        ∈
                        Y
                        ∩
                        (
                        0
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     . Hence, by Lemma 3, we conclude that 
                        δ
                        =
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              
                                 
                                    N
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                      for some 
                        
                           
                              N
                           
                           
                              ′
                           
                        
                        ∈
                        N
                      and 
                        
                           
                              {
                              
                                 
                                    Z
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              }
                           
                           
                              n
                              =
                              1
                           
                           
                              
                                 
                                    N
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        ∈
                        Z
                     , where 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              Z
                           
                           
                              (
                              n
                              )
                           
                        
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , 
                        ∀
                        k
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        
                           
                              N
                           
                           
                              ′
                           
                        
                        }
                     . As we showed in Theorem 1 that 
                        ∀
                        y
                        ∈
                        Y
                     , we have 
                        y
                        =
                        k
                        δ
                      for some 
                        k
                        ∈
                        Z
                     , then the number of elements in 
                        Y
                        ∩
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      is 
                        ⌊
                        
                           
                              
                                 
                                    α
                                 
                                 
                                    +
                                 
                              
                              −
                              
                                 
                                    α
                                 
                                 
                                    −
                                 
                              
                           
                           δ
                        
                        ⌋
                     . Hence, it follows that there are exactly 
                        ⌊
                        
                           
                              
                                 
                                    α
                                 
                                 
                                    +
                                 
                              
                              −
                              
                                 
                                    α
                                 
                                 
                                    −
                                 
                              
                           
                           δ
                        
                        ⌋
                      achievable portfolios since Lemma 3 implies that the set 
                        Y
                        ∩
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                      is equivalent to the set of different values that the sum 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              N
                           
                        
                        Z
                        (
                        n
                        )
                      can take 
                        ∀
                        N
                        ∈
                        N
                     , where 
                        Z
                        (
                        n
                        )
                        ∈
                        Z
                      for 
                        ∀
                        n
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                      and 
                        
                           
                              ∑
                           
                           
                              n
                              =
                              1
                           
                           
                              k
                           
                        
                        Z
                        (
                        n
                        )
                        ∈
                        (
                        
                           
                              α
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              +
                           
                        
                        )
                     , 
                        ∀
                        k
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     , and the cardinality of the latter set is equal to the number of achievable portfolios.  □

@&#REFERENCES@&#

