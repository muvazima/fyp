@&#MAIN-TITLE@&#Application of robust Generalised Cross-Validation to the inverse problem of electrocardiology

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Robust Generalised Cross-Validation (RGCV) is introduced to ECG Imaging.


                        
                        
                           
                           RGCV is compared to more common methods for two heart beat scenarios.


                        
                        
                           
                           Zero order Tikhonov regularisation is the basis for the comparison.


                        
                        
                           
                           Various levels of white noise and geometric noise are considered.


                        
                        
                           
                           RGCV produces accurate and consistent epicardial potential distributions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Inverse problems

Electrocardiology

Tikhonov regularisation

Generalised Cross-Validation

Electrophysiology

@&#ABSTRACT@&#


               
               
                  Robust Generalised Cross-Validation was proposed recently as a method for determining near optimal regularisation parameters in inverse problems. It was introduced to overcome a problem with the regular Generalised Cross-Validation method in which the function that is minimised to obtain the regularisation parameter often has a broad, flat minimum, resulting in a poor estimate for the parameter. The robust method defines a new function to be minimised which has a narrower minimum, but at the expense of introducing a new parameter called the robustness parameter.
                  In this study, the Robust Generalised Cross-Validation method is applied to the inverse problem of electrocardiology. It is demonstrated that, for realistic situations, the robustness parameter can be set to zero. With this choice of robustness parameter, it is shown that the robust method is able to obtain estimates of the regularisation parameter in the inverse problem of electrocardiology that are comparable to, or better than, many of the standard methods that are applied to this inverse problem.
               
            

@&#INTRODUCTION@&#

The inverse problem of electrocardiology is an important and vital element in understanding the relationship between heart surface and body surface electric potential distributions. It essentially answers the question: if the body surface electrical potential distribution is known, what heart surface potential distribution gave rise to this observed body surface distribution? However, there are other formulations of the inverse problem of electrocardiology, particularly in terms of current dipoles. For a full review of methods for solving that particular inverse problem consult the excellent reference [1].

To solve the inverse problem of electrocardiology as described above, one first needs to solve the forward problem of electrocardiology. That is, one needs to solve the partial differential equation for the electric potential in the torso, Φ, which is governed by
                        
                           (1)
                           
                              ∇
                              ·
                              σ
                              ∇
                              ϕ
                              =
                              0
                              ,
                           
                        
                     subject to the Dirichlet boundary condition on the heart surface,
                        
                           (2)
                           
                              ϕ
                              =
                              h
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    h
                                 
                              
                              ,
                           
                        
                     and the Neumann boundary condition on the body surface,
                        
                           (3)
                           
                              (
                              σ
                              ∇
                              ϕ
                              )
                              ·
                              n
                              =
                              0
                              
                              on
                              
                              
                                 
                                    Γ
                                 
                                 
                                    b
                                 
                              
                              ,
                           
                        
                     where Γ
                     
                        h
                      and Γ
                     
                        b
                      are the heart and body surfaces, respectively, 
                        h
                        (
                        x
                        ,
                        y
                        ,
                        z
                        )
                      represents some electric potential distribution on the heart surface, Γ
                     
                        h
                     , σ is the conductivity tensor within the torso and 
                        n
                      is the outward pointing surface normal. The first condition assumes that there is a known potential distribution on the heart surface and the second says that the torso surface is insulated. Equation (1) is based on a quasi-static assumption [2], implying that the electric field in the torso responds instantaneously to the boundary conditions with the consequence that each time point can be considered independently.

The governing Eq. (1) can be solved via a variety of numerical methods, including the finite difference method, the finite element method, the finite volume method and the boundary element method [3]. In each method, the forward problem can be reduced to the matrix–vector equation
                        
                           (4)
                           
                              Ax
                              =
                              b
                           
                        
                     where 
                        x
                      represents the vector of heart surface potentials on the mesh points representing an approximation to the heart surface, 
                        b
                      is a vector of body surface potentials and the forward transfer matrix [4] 
                     
                        A
                      is dependent on the numerical method chosen to solve the forward problem.

The inverse problem of electrocardiology uses Eq. (4) to find 
                        x
                     , given a measured set of potentials on the body surface 
                        b
                      (these are usually measured at a set of positions defined by a mapping system). Since the forward transfer matrix 
                        A
                      generally has a large condition number, and is often not square, and there is measurement noise in the vector 
                        b
                     , the inverse problem is ill-posed in the sense of Hadamard [1]. Hence, in order to solve Eq. (4), Tikhonov regularisation [5], which seeks to find
                        
                           (5)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                    
                                 
                              
                              {
                              
                                 ∥
                                 Ax
                                 −
                                 b
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ∥
                                 Lx
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                              }
                           
                        
                     is often used. Here 
                        L
                      is a matrix that controls the smoothing of the potentials on the heart surface. It can be an appropriately sized identity matrix (zero order Tikhonov regularisation), an approximation to the gradient of the potential on the heart surface (first order Tikhonov regularisation) or an approximation to the Laplacian of the potential on the heart surface (second order Tikhonov regularisation). Also, λ is called the regularisation parameter. The solution to the minimisation problem (5) is then given by
                        
                           (6)
                           
                              x
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             T
                                          
                                       
                                       L
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              b
                              .
                           
                        
                     
                  

The difficulty with finding 
                        x
                      is that the parameter λ is unknown. It is meant to represent some balance between the size of the residuals in the forward problem (the first term in Eq. (5) and the size of some form of smoothing of the solution (the second term in Eq. (5)). Over many years, a number of methods have been devised to find “optimal” values for λ for the inverse problem of electrocardiology. These include, but are not limited to, the L-curve method [7], the CRESO method [6], the zero-crossing method [9] and the Generalised Cross-Validation method [8]. Many other methods for determining λ have also been proposed and a review of these methods in a more general context can be found in [10].

There are also many other techniques for obtaining approximate solutions to the inverse problem of electrocardiology. The methods described above all utilise Tikhonov regularisation in some form, but generally ignore temporal variation. More general methods that include temporal variation have been developed [11–14], but these techniques still require some form of optimal regularisation parameter determination [15].

Other approaches to solve the inverse problem of electrocardiology that do not rely on the ideas of regularisation include: treating the boundary conditions as a Cauchy boundary value problem [16]; using genetic algorithms [17–19]; using partial differential equation constrained optimisation [20,21]; using Twomey regularisation for wave-front based ECG imaging [22], and using Bayesian estimation [23].

To motivate the Robust Generalised Cross-Validation (RGCV) method, it is instructive to consider the motivation behind the Generalised Cross-Validation (GCV) method itself. The original GCV method [8] can be interpreted as a weighted sum of squares of the prediction errors of the inversion procedure, leaving out each data point in turn. Analysis of this idea gives rise to the GCV function and will be discussed shortly. On the other hand, the RGCV method [24] uses a mean of the influence of leaving out each data point in turn. These means are then averaged to arrive at the RGCV function (also to be discussed shortly).

The remainder of this paper is structured as follows: in the next section, the above methods for finding the regularisation parameter will be discussed briefly and analysed in terms of the singular values of the matrix 
                        A
                     . It also describes the simulation protocols to be followed in this study. Section 3 will present results and comparisons between the different methods of choosing a regularisation parameter and Section 4 will discuss the advantages and disadvantages of the RGCV method.

@&#METHODS@&#

The most straight-forward way to analyse the various methods of selecting the “optimal” regularisation parameter in the inverse problem of electrocardiology is to use the singular value decomposition (SVD) of the forward transfer matrix 
                        A
                     . The singular value decomposition of an 
                        m
                        ×
                        n
                      matrix 
                        A
                      (with 
                        m
                        >
                        n
                     ), can be written as [25]
                     
                        
                           (7)
                           
                              A
                              =
                              U
                              Σ
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                           
                        
                     where 
                        U
                      is an 
                        m
                        ×
                        n
                      orthonormal matrix containing the left singular vectors of 
                        A
                     , 
                        V
                      is an 
                        n
                        ×
                        n
                      orthonormal matrix containing the right singular vectors of 
                        A
                      and 
                        Σ
                      is an 
                        n
                        ×
                        n
                      diagonal matrix with the singular values of 
                        A
                      on its main diagonal [26]. Also in Eq. (7), 
                        
                           
                              u
                           
                           
                              i
                           
                        
                      are the columns of 
                        U
                     , 
                        
                           
                              v
                           
                           
                              i
                           
                        
                      are the columns of 
                        V
                      and σ
                     
                        i
                      are the singular values of 
                        A
                      arranged so that 
                        
                           
                              σ
                           
                           
                              1
                           
                        
                        ≥
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        ≥
                        …
                        ≥
                        
                           
                              σ
                           
                           
                              n
                           
                        
                        ≥
                        0
                     . Generally, in the inverse problem of electrocardiology, the singular value spectrum of 
                        A
                      decays smoothly to zero [2], which reflects the difference between an ill-posed problem and a rank deficient problem where there is a non–zero number of zero singular values.

In terms of the singular value decomposition, the generalised inverse of 
                        A
                      can be defined as
                        
                           (8)
                           
                              
                                 
                                    A
                                 
                                 
                                    †
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                     Therefore when solving the matrix Eq. (4) in the least squares sense by minimising 
                        ∥
                        Ax
                        −
                        b
                        
                           
                              ∥
                           
                           
                              2
                           
                        
                     , the solution can be written as
                        
                           (9)
                           
                              x
                              =
                              
                                 
                                    A
                                 
                                 
                                    †
                                 
                              
                              b
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    b
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                     For 
                        x
                      to represent a reasonable solution to Eq. (4), the discrete Picard condition [27], that, on average, the absolute values of the coefficients 
                        
                           
                              u
                           
                           
                              i
                           
                           
                              T
                           
                        
                        b
                      decay to zero faster than the singular values, should be satisfied.

The focus of this study will be zero order Tikhonov regularisation; that is, we wish to find
                        
                           (10)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       x
                                    
                                 
                              
                              {
                              
                                 ∥
                                 Ax
                                 −
                                 b
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ∥
                                 x
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                              }
                              ,
                           
                        
                     the solution of which is [25]
                     
                        
                           (11)
                           
                              x
                              =
                              
                                 
                                    A
                                 
                                 
                                    #
                                 
                              
                              b
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       I
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              b
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                        
                     where 
                        
                           
                              α
                           
                           
                              i
                           
                        
                        =
                        
                           
                              u
                           
                           
                              i
                           
                           
                              T
                           
                        
                        b
                     .

It can be shown that the two terms in the zero order Tikhonov functional (10) can be written as [9], 
                        
                           (12)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    2
                                 
                              
                              (
                              λ
                              )
                              ≔
                              ∥
                              Ax
                              −
                              b
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              ∥
                              
                                 
                                    r
                                 
                                 
                                    ⊥
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                        
                     and
                        
                           (13)
                           
                              
                                 
                                    η
                                 
                                 
                                    2
                                 
                              
                              (
                              λ
                              )
                              ≔
                              ∥
                              x
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     where 
                        ∥
                        
                           
                              r
                           
                           
                              ⊥
                           
                        
                        
                           
                              ∥
                           
                           
                              2
                           
                           
                              2
                           
                        
                        =
                        ∥
                        
                           
                              Ax
                           
                           
                              LSS
                           
                        
                        −
                        b
                        
                           
                              ∥
                           
                           
                              2
                           
                           
                              2
                           
                        
                      is the residual from the least squares solution to Eq. (4) (that is, where 
                        λ
                        =
                        0
                     ).

We now consider several methods for determining the “optimal” regularisation parameter.

A plot on a log–log scale of 
                              ρ
                              (
                              λ
                              )
                            vs 
                              η
                              (
                              λ
                              )
                            is called the L-curve [7]. In other words, the curve is a parametric plot with λ as the parameter along the curve and the optimal regularisation parameter is estimated as the value of λ which simultaneously minimises both 
                              ρ
                              (
                              λ
                              )
                            and 
                              η
                              (
                              λ
                              )
                            in some sense. It is generally accepted that this value of λ occurs at the corner of the L-curve where the corner is defined as one of the two possibilities:
                              
                                 1.
                                 the point that is closest to the origin, or

the point of maximum curvature along the curve.

The Composite REsidual and Smoothing Operator (CRESO) method [6] predicts an estimate of the optimal regularisation parameter that corresponds to the first local maximum of the function
                              
                                 (14)
                                 
                                    C
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          d
                                          
                                       
                                       
                                          d
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       λ
                                       )
                                       −
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       λ
                                       )
                                    
                                    )
                                    ,
                                 
                              
                           where the derivative is with respect to λ
                           2. The function 
                              C
                              (
                              λ
                              )
                            is also an attempt to minimise both the norm of the solution and the size of the residual. In terms of the singular value decomposition, this can be rewritten as [9]
                           
                              
                                 (15)
                                 
                                    C
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             3
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The zero-crossing method [9] seeks to find a balance between the solution norm and the residual norm by estimating the optimal regularisation parameter as a zero of the function
                              
                                 (16)
                                 
                                    B
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          η
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    λ
                                    )
                                    −
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    λ
                                    )
                                    ,
                                 
                              
                           which, in terms of the SVD, can be rewritten as
                              
                                 (17)
                                 
                                    B
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    −
                                    ∥
                                    
                                       
                                          r
                                       
                                       
                                          ⊥
                                       
                                    
                                    
                                       
                                          ∥
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           It can be shown [28] that when the discrete Picard condition [25] is satisfied, the function 
                              B
                              (
                              λ
                              )
                            has only two zeros. In this case the smaller zero is chosen as the approximation to the optimal regularisation parameter.

The Generalised Cross-Validation (GCV) [8] method provides an estimate of the optimal regularisation parameter by seeking to minimise the function
                              
                                 (18)
                                 
                                    G
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          λ
                                          )
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   Tr
                                                   (
                                                   
                                                      I
                                                      −
                                                      
                                                         
                                                            AA
                                                         
                                                         
                                                            #
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    A
                                 
                                 
                                    #
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                       A
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       I
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                            is the regularised inverse of 
                              A
                            and 
                              Tr
                              (
                              
                                 B
                              
                              )
                            is the trace of some matrix 
                              B
                           . The function 
                              G
                              (
                              λ
                              )
                            can be expressed as a linear combination of the prediction errors 
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    λ
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                           , where 
                              
                                 
                                    x
                                 
                                 
                                    λ
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                            is the regularised solution found by leaving out the 
                              j
                              th
                            data point [8], j=1,…,n, and 
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                            is the 
                              j
                              th
                            row of 
                              A
                           . In terms of the SVD, it can be shown that
                              
                                 (19)
                                 
                                    G
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          ∥
                                          
                                             
                                                r
                                             
                                             
                                                ⊥
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   m
                                                   −
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The main drawback associated with the GCV method is that the curve 
                              G
                              (
                              λ
                              )
                            is often very flat, with no discernible minimum [8], which is often the case for the inverse problem of electrocardiology. To overcome this drawback, the Robust Generalised Cross-Validation (RGCV) method was introduced [24]. The estimate of the optimal regularisation parameter λ is the one that minimises the RGCV function:
                              
                                 (20)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    {
                                    
                                       γ
                                       +
                                       (
                                       1
                                       −
                                       γ
                                       )
                                       μ
                                       (
                                       λ
                                       )
                                    
                                    }
                                    G
                                    (
                                    λ
                                    )
                                 
                              
                           where 
                              G
                              (
                              λ
                              )
                            is given by Eq. (18) and 
                              μ
                              (
                              λ
                              )
                            is defined as
                              
                                 (21)
                                 
                                    μ
                                    (
                                    λ
                                    )
                                    =
                                    
                                       
                                          [
                                          
                                             Tr
                                             (
                                             
                                                
                                                   
                                                      AA
                                                   
                                                   
                                                      #
                                                   
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                             
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           using the SVD. The function 
                              μ
                              (
                              λ
                              )
                            is derived from the average influence 
                              (
                              1
                              /
                              n
                              )
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              ∥
                              A
                              
                                 
                                    x
                                 
                                 
                                    λ
                                 
                              
                              −
                              A
                              
                                 
                                    x
                                 
                                 
                                    λ
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                           , where 
                              ∥
                              A
                              
                                 
                                    x
                                 
                                 
                                    λ
                                 
                              
                              −
                              A
                              
                                 
                                    x
                                 
                                 
                                    λ
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              
                                 
                                    ∥
                                 
                                 
                                    2
                                 
                              
                            is a measure of the influence of the 
                              j
                              th
                            data point on the regularised solution. This function has the properties that 
                              μ
                              (
                              0
                              )
                              =
                              n
                            and 
                              μ
                              (
                              λ
                              )
                              →
                              0
                            as 
                              λ
                              →
                              ∞
                           . A consequence of this is that 
                              μ
                              (
                              λ
                              )
                            penalises smaller values of λ in the minimisation problem.

Eq. (20) also contains the so-called robustness parameter, γ, where 
                              γ
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           . It can be seen that, for values of γ near 1, the RGCV function behaves like the GCV function and that
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             lim
                                          
                                          
                                             γ
                                             →
                                             0
                                          
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    λ
                                    )
                                    =
                                    μ
                                    (
                                    λ
                                    )
                                    G
                                    (
                                    λ
                                    )
                                    .
                                 
                              
                           
                        

It would appear that the RGCV method has introduced another parameter, γ, which must be estimated in order to find an optimum value of λ. The purpose of this study is to demonstrate that for a particular problem, a fixed value of γ can be chosen a priori and near optimal values of λ can be determined as a consequence.

The simulation protocols used to compare the above methods for determining an approximation to the optimal regularisation parameter are essentially the same as those detailed in Johnston and Gulrajani [9]. The boundary element method [29] was used to solve the forward problem of electrocardiology and determine the forward transfer matrices. The model considered was that of a simple heart-torso system, similar to many tank experiments [30], where the heart surface is defined as the outside surface of the ventricles and atria. The torso model [31] was 550mm high, with a width of 326mm under the arms and 223mm from front to back and was created with 610 nodes and 1220 triangles, as shown in Fig. 1
                        . Two heart meshes [32], both 132mm from base to apex and approximately 90mm in diameter, were also used, one containing 610 nodes and the other with 114 nodes, where the 114 node mesh was subsampled from the 610 node mesh. The size of the mesh was chosen to reflect typical epicardial sock electrode numbers and is an attempt to determine realistically a discrete sample from what is essentially a continuous distribution.

A cellular automata model [32] was used to generate the epicardial potential distributions for a normal heart beat and an ectopic beat. These distributions were projected onto the two heart meshes at 1ms time intervals.

The boundary element method was used to create a 610×610 forward transfer matrix and this was used to create body surface potential maps at each time instant. The 610 body surface potential distributions were then subsampled to mimic measurements from a 168 electrode mapping jacket as shown in Fig. 2
                        . This high resolution heart mesh was used to create “true” body surface potential maps. The same boundary element software was also used to create forward transfer matrices from the 114 node heart mesh to the 610 node torso mesh, which were in turn reduced to 168×114 forward transfer matrices, via row deletion, mapping the potential at nodes on the heart surface to the jacket positions. These forward transfer matrices were created with the heart in the same position as for the original 610×610 forward transfer matrix, as well as with introduced geometry noise by moving the heart ±10mm in each of the three coordinate directions, as well as ±10 degree rotations of the heart around each of the coordinate axes.

In addition, “white” measurement noise was added to the body surface potential distributions using the root mean square values of the potential at noise levels of 1%, 2%, 5%, 10% and 20%. These noisy body surface potential maps along with the original and offset 168×114 forward transfer matrices were used with each inversion technique to obtain an estimate of the epicardial potential distribution. Each resulting epicardial potential distribution was then compared with the 114 node epicardial potential distribution as sampled from the original 610 node distribution.

Two heart beat scenarios were also considered. The first was a normal activation sequence over the QRS complex, covering the period from 175ms to 245ms after onset of the beat. The second scenario was due to an ectopic beat triggered in the lateral left ventricle of the heart model covering the period 90–160ms after pacing. Both simulations were studied at 10ms intervals.

When the epicardial potential distribution is known ahead of time (as occurs in simulation studies or in animal experiments), it is possible to gauge the correctness of the solution by either the relative error (RE), namely,
                           
                              (23)
                              
                                 RE
                                 (
                                 λ
                                 )
                                 =
                                 
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             λ
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             E
                                          
                                       
                                       ∥
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             E
                                          
                                       
                                       ∥
                                    
                                 
                              
                           
                        or the correlation coefficient (CC), given by
                           
                              (24)
                              
                                 CC
                                 (
                                 λ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       [
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      λ
                                                   
                                                
                                                )
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      λ
                                                   
                                                
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       ]
                                       [
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                                )
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      E
                                                   
                                                
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             λ
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   λ
                                                
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                       ∥
                                       ∥
                                       
                                          
                                             x
                                          
                                          
                                             E
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   E
                                                
                                             
                                          
                                          
                                             ¯
                                          
                                       
                                       ∥
                                    
                                 
                              
                           
                        In Eqs. (23) and (24), 
                           
                              
                                 x
                              
                              
                                 E
                              
                           
                         denotes the known epicardial potential distribution, and 
                           
                              
                                 x
                              
                              
                                 λ
                              
                           
                         the computed one. The quantities 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       E
                                    
                                 
                              
                              
                                 ¯
                              
                           
                         and 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       λ
                                    
                                 
                              
                              
                                 ¯
                              
                           
                         are, respectively, the mean values of 
                           
                              
                                 x
                              
                              
                                 E
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 λ
                              
                           
                         over the n epicardial sites.

For the remainder of the paper, a solution will be referred to as “optimal” if it is the solution that yields the minimum relative error over all values of λ.

@&#RESULTS@&#

As noted above, the RGCV method requires knowledge of the robustness parameter γ. The first study undertaken was to assess the sensitivity of the inverse solution to γ by comparing the relative error of the solutions obtained at various γ values with the optimal solutions.


                        Fig. 3
                         presents plots of the average relative error of the RGCV solutions for 10 simulations of the realistic heart-torso model. The figure shows plots when the heart surface distribution is at 195ms into a normal heart beat simulation. The lines on each plot show 2%, 5% and 10% noise added to the body surface potential distribution. Plots are shown for the forward transfer matrices generated by the heart being in its normal position (top), offset to the left 10mm (positive x direction, middle) and offset to the right 10mm (negative x direction, bottom). The ‘⁎’ signs on the figures indicate the values of γ which yield the minimum relative error.

It can be seen from this figure that, in all cases, the minimum relative error is obtained when 
                           γ
                           =
                           0
                        . Similar plots for hearts offset in the other coordinate directions and for heart rotations show similar behaviours. Hence, for the heart-torso model considered here, the value of γ will be taken to be zero.

Having determined appropriate values of γ, the next step is to compare the inverse solutions obtained from the RGCV method with those obtained from the other methods listed above and the optimal solution.

As mentioned above, two different heart beat scenarios were considered over a 70ms period at 10ms intervals. The resulting body surface potential maps all had five different levels of “white” noise added and these were combined with either the heart in its original position or displaced ±10mm in each of the coordinate directions (geometry noise). (Results for the rotation of the heart about the coordinate axes will not be presented as there is no real difference to the offset results presented.) Each combination of noisy body surface potential maps and corrupted forward transfer matrices was used with the five different methods for approximating the optimal regularisation parameter, resulting in a total of 1400 inverse determinations of the epicardial potential distribution for both heart beat scenarios. Each of these scenarios is the average of 20 realisations of a given noise level at each time point and heart offset.


                           Tables 1 and 2
                           
                            demonstrate how often each regularisation parameter determination method gives the lowest relative error at different noise levels for the normal and ectopic beats, respectively. Both tables show that at low and medium noise levels the RGCV method was most often the best performing method. At the highest noise level considered, the L-Curve method was the best performing method. Irrespective of the heart beat scenario, at lower noise levels the RGCV method was the best performing method. At higher noise levels, the L-Curve method was more dominant for the ectopic beat than it was for the normal beat, where it performed only slightly better than the RGCV approach. Also, the RGCV method was more accurate than the CRESO approach at all noise levels for the normal heart beat, and at all but the highest noise level for the ectopic beat. The performance of the GCV method improved with increasing noise levels, but is inferior to the other methods.


                           Tables 3 and 4 compare the regularisation parameter determination methods during the time course of the normal and ectopic beats, respectively. From Table 3
                           , with the normal beat, it can be seen that the RGCV method performs much better early in the QRS complex, but not so well towards the end of the complex. In fact, the RGCV method was the best performing method up to 225ms and beyond this the zero-crossing method performed best. For the ectopic beat, Table 4
                           , the L-Curve and RGCV methods perform similarly for most of the period studied, with the RGCV method performing much better at the earlier times and at the very end. These two methods dominate the performance of the other regularisation parameter determination methods.

Finally, Tables 5 and 6
                           
                            consider the effect of geometric noise (heart position offset) during the normal and ectopic beats. Both tables show that when the heart is in its correct position (or, in other words, its position is known accurately) then the RGCV method does not perform as well as the other methods. However, once some geometry noise is added, the RGCV method generally out-performs all the other methods. The one exception is where the heart is offset in the positive x direction (to the left) for the ectopic beat.

The study performed here generated a considerable amount of data. This has been summarised to some extent by the tables in the previous section. However, it is difficult to do justice to all the individual simulations performed. With this in mind it was decided to present one “good” (in the sense of a small relative error) and one “less good” instance of the RGCV method for both heart beat scenarios.

Firstly, Fig. 4
                            shows the 610 node (left column) and subsampled 114 node (right column) epicardial potential distributions at the time instants 205ms and 235ms from the start of the normal heart beat. Recall that the 610 node model was the epicardial potential source used to generate the body surface potential maps. The 114 node heart can be thought of as the epicardial potential distribution measured by a sock electrode and it was used as the “known” epicardial potential distribution in the relative error calculations. Notice that due to the subsampling, the points of maximum and minimum potential can change. Fig. 5
                            shows similar distributions for the ectopic beat at the time instants 130ms and 160ms after pacing.


                           Fig. 6
                            shows the reconstructed epicardial potential distributions for the various regularisation parameter determination methods at 205ms after the start of a normal heart beat with 1% RMS noise added to the body surface potentials and the heart offset 10mm to the left. Based on the values given in Table 1, 3 and 5, this is an example of a “good” scenario for the RGCV method, exhibiting a low relative error and a high correlation coefficient. The plots show that the RGCV method has the lowest relative error and the highest correlation coefficient of all the reconstructed epicardial potential distributions when compared with Fig. 4(b). In this example, most of the inverse solutions place the maximum of the distribution in the same place, which is close to the maximum of the original 610 node epicardial potential distribution. On the other hand, only the optimal solution and the RGCV solution place the minimum of the distribution, in a position that is close to the position of the minimum of the original 610 node epicardial potential distribution. Further, all but one of the regularisation parameter determination methods over regularise the inverse solution, with RMS values lower than the original distribution and the minimum potential higher than that in the original distribution. The maximum potentials are generally lower than those in the original distribution.


                           Fig. 7
                            shows the reconstructed distributions at 235ms into the normal heart beat with 20% added RMS noise and the heart offset 10mm in the positive z direction. Again, considering the values given in Tables 1 and 3, this is an example of a “less good” case for the RGCV method. Here the relative error for the RGCV method is higher than all other methods (except the zero-crossing method) and the correlation coefficient is lower. Also, most methods place the maximum potential in the same place, but this is some distance from the position of the maximum in the original distribution (Fig. 4(c)). However, the minimum for the distributions obtained from the zero-crossing and RGCV inverse methods is placed closer to the minimum of the original distribution than those obtained from the other inversion methods. Also, for this case, all inverse solutions are over regularised, producing epicardial potentials which have very little variation.


                           Fig. 8
                            shows reconstructed epicardial potential distributions from the indicated regularisation parameter determination methods at 130ms into an ectopic beat with 10% RMS noise with the heart offset 10mm in the negative z direction. From the values given in Tables 2 and 4, this is a “less good” example for the RGCV method, as indicated by the higher relative errors and lower correlation coefficients. In this example, all inverse solutions place the extrema of the potential distribution in the same place on the epicardium, and this is reasonably close to the actual extrema, shown in Fig. 5(a). However, all inverse solutions are again over regularised.

For Fig. 9
                           , the reconstructions are at 160ms into an ectopic beat with the heart offset 10mm in the positive x direction and 1% added RMS noise, another “good” example of the RGCV method, based on Tables 2 and 4. Here the RGCV method performs the best of the methods, yielding the minimum relative error and maximum correlation coefficient when compared to Fig. 5(d). All the regularisation parameter determination methods place the maximum in the same place, which is reasonably close to the position of the maximum in the original 610 node epicardial potential distribution (Fig. 5(c)). However, only the RGCV and zero-crossing methods put the minimum potential near the site of the original minimum. Again, all methods over regularise the inverse solutions.

Finally, Fig. 10
                            shows a summary of the means and standard deviations of the relative errors for 20 realisations across the QRS complex of the normal heart beat with 5% RMS noise added to the body surface potential map and the heart offset 10mm towards the back of the torso (10mm in the positive z direction). It can be seen that, not only does the RGCV method generally produce the lowest mean relative error, the standard deviation of this approach is generally the smallest also, meaning that this method is the most stable of the regularisation parameter determination methods.


                           Fig. 11
                            shows a similar plot with 20% added noise. Here a variety of methods produce the lowest relative error, but it is still generally true that the RGCV methods produces the smallest standard deviation of all the methods considered. Similar observations can be made regarding Figs. 12 and 13 which show the relative errors across the QRS complex of the ectopic beat with 10% added RMS noise and the heart moved 10mm towards the front of the torso (the negative z direction) (Fig. 12
                           ) and with 1% added RMS noise and no offset in the heart position (Fig. 13
                           ).

The four figures discussed above also show that, in general, the GCV method has the largest standard deviation, followed by the CRESO method. It is also often the case that these two methods have the highest relative errors.

@&#DISCUSSION AND CONCLUSION@&#

This paper has presented the application of the RGCV method to determine optimal regularisation parameters for the inverse problem of electrocardiology. The motivation for doing so comes from the fact that in the inverse problem of electrocardiology, the function to be minimised in the GCV method exhibits a wide flat basin when plotted on a log–log scale [24], which makes the determination of an optimal regularisation parameter difficult. The enhancement provided by the RGCV method is the introduction of a new function of the regularisation parameter λ that exhibits a more distinct minimum [24], thus producing a more reliable estimate of the optimal regularisation parameter.

A drawback to the RGCV method is that it introduces a new unknown parameter, γ, called the robustness parameter. Despite this drawback, with a value of γ specified, an estimate of the optimal regularisation parameter can be obtained. It has been shown here that the relative error corresponding to this estimate of λ generally gives rise to a curve with a broad flat minimum, indicating that for the inverse problem of electrocardiology, the RGCV method is relatively insensitive to the choice of γ. In particular, for the RGCV method applied to data using a realistic geometry, it is reasonable, and often best, to choose 
                        γ
                        =
                        0
                     .

Throughout this study all optimisation has been based on finding the minimum relative error between estimated and initial epicardial potential distributions. This was also the basis for choosing 
                        γ
                        =
                        0
                     . Minimum relative errors were chosen because they are a combined measure of the errors in magnitude of the estimated potential distribution as well as the shape of the distribution. On the other hand, the correlation coefficient only measures the shape of the distribution. It would be possible to repeat this study based on correlation coefficients, including using them as a basis for choosing γ.

Although it has been demonstrated here that 
                        γ
                        =
                        0
                      gives reasonable solutions to the inverse problem of electrocardiology for the heart beat examples considered, there is the possibility that other values of γ would be more appropriate for other heart beat types, eg arrhythmias. To answer this question several further simulation studies would be required.

This study only considered zero order Tikhonov regularisation. There would appear to be no reason why this method could not be applied to first and second order Tikhonov regularisation. Again, this is a possibility for further simulation studies. Also, the RGCV method could be applied to inversion techniques that use temporal data [11–14]. However, it would require further simulation studies to determine that 
                        γ
                        =
                        0
                      would be the appropriate choice in these cases. A further application for the RGCV is where the heart model consists of open ventricles and the electric potential distribution is sought on the endocardial and epicardial surfaces. In this case the inverse problem would be underdetermined (
                        m
                        <
                        n
                      in Eq. (7)) and there would appear no reason why the RGCV method would not be competitive for this inverse problem as well.

Results presented here have shown that at low noise levels the RGCV method most often yields the best solution, but as the noise levels increase the L-curve approach is often better. The performance of the methods during the QRS complex showed that the RGCV method was superior during the early stages of the normal beat and generally better all through the ectopic beat. Also, the RGCV method performed better for almost all offset positions of the heart. Similar conclusions can be drawn for the rotation of the heart and so the results are not presented. Finally, Figs. 10–13 show that of all the methods considered, the RGCV method generally shows the smallest standard deviation in relative error across the 20 realisations of a given simulation. Hence, although the RGCV method may not always yield the lowest relative error, its small standard deviation indicates that it does give consistent solutions to an inverse problem.

In summary, the RGCV method, with 
                        γ
                        =
                        0
                     , is worthy of consideration as a method for obtaining an approximation to the optimal regularisation parameter in the inverse problem of electrocardiology, especially when realistic potential distributions and geometries are under consideration.

None declared.

@&#ACKNOWLEDGEMENT@&#

The authors would like to thank the four anonymous reviewers for their comments and suggestions. These suggestions have resulted in a much more elegant paper.

@&#REFERENCES@&#

