@&#MAIN-TITLE@&#A fast approximation algorithm for solving the complete set packing problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new mathematical formulation for the complete set packing problem.


                        
                        
                           
                           We develop an efficient method for generating near-optimal packing (lower bounds).


                        
                        
                           
                           We develop a method for solving a large MILP for finding tighter upper bounds.


                        
                        
                           
                           The LP relaxation of the WDP in spectrum auctions can be solved efficiently.


                        
                        
                           
                           We test large problems in combinatorial auctions and cooperative games.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Set packing problem

Combinatorial auctions

Winner determination problem

Coalition structure generation

Large-scale MILP

@&#ABSTRACT@&#


               
               
                  We study the complete set packing problem (CSPP) where the family of feasible subsets may include all possible combinations of objects. This setting arises in applications such as combinatorial auctions (for selecting optimal bids) and cooperative game theory (for finding optimal coalition structures). Although the set packing problem has been well-studied in the literature, where exact and approximation algorithms can solve very large instances with up to hundreds of objects and thousands of feasible subsets, these methods are not extendable to the CSPP since the number of feasible subsets is exponentially large. Formulating the CSPP as an MILP and solving it directly, using CPLEX for example, is impossible for problems with more than 20 objects. We propose a new mathematical formulation for the CSPP that directly leads to an efficient algorithm for finding feasible set packings (upper bounds). We also propose a new formulation for finding tighter lower bounds compared to LP relaxation and develop an efficient method for solving the corresponding large-scale MILP. We test the algorithm with the winner determination problem in spectrum auctions, the coalition structure generation problem in coalitional skill games, and a number of other simulated problems that appear in the literature.
               
            

The set packing problem and its variants (the set covering and set partitioning problems) are among the most well-studied problems in combinatorial optimisation thanks to their wide ranges of applications, their elegant mathematical formulation, and their special structural properties. In the SPP, there are n objects which can be packed into a number of subgroups among m predefined feasible subsets labelled as 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    S
                                 
                                 
                                    m
                                 
                              
                           
                        . Each subset 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         has a payoff value of 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                        . The SPP aims to divide these n objects into non-overlapping subgroups such that their total payoff is maximised. The SPP can be formulated as an MILP as follows:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             SPP
                                             (
                                             A
                                             ,
                                             v
                                             )
                                             
                                             ≔
                                             
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   t
                                                
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             Ax
                                             ⩽
                                             e
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              x
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         is a vector of binary decision variables with 
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                         indicating whether subset 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         is selected in the packing, 
                           
                              A
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    m
                                 
                              
                           
                         is a matrix with element 
                           
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                           
                         in row i and column j indicating whether subset 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         contains object 
                           
                              i
                              ,
                              
                              v
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                 
                              
                           
                         is a vector of payoffs, and 
                           
                              e
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         is a vector with all elements being equal to one.

The SPP has many applications such as for routing and scheduling trains at intersections in railway operations Zwaneveld, Kroon, and Van Hoesel (2001), for selecting winning bids in combinatorial auctions (De Vries & Vohra, 2003), for surgical operations scheduling Velásquez and Melo (2006), and for packets scheduling and transmission in communication networks Emek et al. (2012). In the context of combinatorial auctions, the winner determination problem (WDP) is essentially a set packing problem. Sandholm (2002) develops an algorithm that utilises the graphical representation of the coalition structure search space for solving the WDP. Fujishima, Leyton-Brown, and Shoham (1999) develop an exact algorithm, where caching and pruning are used to speed up the search, and a heuristic algorithm for solving the WDP.

The tractability of the SPP depends on the structure of the underlying IP formulation. Specifically, Müller (2006) and Rothkopf, Pekeč, and Harstad (1998) summarise special cases where the corresponding LP relaxation solutions satisfy the integrality constraints and hence are also solutions of the SPP. These are, however, very restrictive cases and it is generally very difficult to solve the SPP. In fact, Karp (1972) shows that the SPP problem is NP-complete while Sandholm (2002) shows the inapproximability of the problem for general cases. Many methods, both exact and approximation, have been proposed for solving the SPP. Padberg (1973) and Cánovas, Landete, and Marın (2000) show different sets of facets of the set packing polyhedron which can be used to strengthen the LP relaxation solutions. Landete, Monge, and Rodríguez-Chía (2012) present an alternative formulation for the SPP in a higher-dimensional space where a set of facets can be identified.

Methods for solving the SPP often start with solving the corresponding LP relaxation problem. De Vries and Vohra (2003) survey different methods such as a constraint generation method for solving the LP relaxation problem and a sub-gradient method for solving the Lagrangian relaxation. The authors also provide interesting insights on how the numerical algorithm is interpreted in the auctioning process. These methods have actually been well-studied in the context of the set covering problem (SCP), a variant of the SPP where the objective is to minimise the total cost of covering all the objects (see Beasley (1987) and Beasley & Jörnsten (1992) for examples). Caprara, Toth, and Fischetti (2000) survey methods to solve the SCP and compare their numerical performance on test problems that appear in the literature.


                        Kochenberger, Glover, Alidaee, and Rego (2004) provide an unified framework for solving combinatorial optimisation problems by transforming them into unconstrained quadratic binary optimisation problems (UQBP). The authors then suggest the use of Tabu search, a metaheuristic method that employs local search and a ‘tabu’-list to keep track of the searched space, for solving the UQBP. Alidaee, Kochenberger, Lewis, Lewis, and Wang (2008) and Lewis, Kochenberger, and Alidaee (2008) apply these methods to the set packing and set partitioning problems and show that the algorithms outperform CPLEX (on the original MILP formulations) on many moderate-sized instances (with up to 
                           
                              n
                              =
                              5000
                           
                         objects and 
                           
                              m
                              =
                              15
                              ,
                              000
                           
                         feasible subsets for the SPP case).

There are also many other heuristic methods for solving the SPP. In fact, Hoffman and Padberg (2001) state that “virtually every heuristic approach for solving general integer programming problems has been applied to the set-covering, packing and partitioning problems.” Delorme, Gandibleux, and Rodriguez (2004) develops GRASP, a greedy randomised algorithm for solving the set packing problem. Beasley and Chu (1996) develop a genetic algorithm for solving the set covering problem and this method can be adapted to solve the SPP.

In this paper, we aim to solve the SPP for cases when 
                           
                              m
                              =
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                           
                        , i.e. any subset of objects can be grouped together in a packing, or when m is relatively large compared to n. This setting arises in applications such as combinatorial auctions where bidders submit their bids in the form of value functions on the objects selected. This bidding mechanism is favourable to auction designers and to bidders because the information can be communicated in a more compact way. Another application area is in multi-agent systems, e.g. in a sensor network (Dang, Dash, Rogers, & Jennings, 2006), where players are grouped into coalitions to maximise their total utility. As the number of possible subsets can grow exponentially, existing methods (such as Beasley & Jörnsten, 1992; Caprara et al., 2000; Fujishima et al., 1999; Sandholm, 2002) are not applicable due to the large number of binary decision variables involved.

Let 
                           
                              N
                              =
                              {
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         be the set of all objects and let 
                           
                              x
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              )
                           
                         be a vector of binary variables with 
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                         indicating whether subset 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         is selected in the packing. The CSPP can be formulated as an MILP as follows:
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             CSPP
                                             (
                                             N
                                             ,
                                             v
                                             )
                                             ≔
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   t
                                                
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   N
                                                
                                             
                                             x
                                             ⩽
                                             e
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    A
                                 
                                 
                                    N
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    
                                       
                                          2
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                           
                         is a matrix with element 
                           
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                           
                         in row i and column j indicating whether subset 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                         contains object i. For convenience in notation, let 
                           
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          1
                                          j
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          nj
                                       
                                    
                                    )
                                 
                                 
                                    t
                                 
                              
                           
                         be a column vector of binary indicators for each 
                           
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                              }
                           
                        . To avoid ambiguity in the ordering of 
                           
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                           
                        , we assign 
                           
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                           
                         to the binary representation of 
                           
                              (
                              j
                              -
                              1
                              )
                           
                        . Let us denote 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ≡
                              v
                              (
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                              )
                              ≡
                              v
                              (
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         as the payoff of subset 
                           
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                           
                        . For 
                           
                              n
                              ⩽
                              15
                           
                        , problem 
                           
                              CSPP
                              (
                              N
                              ,
                              v
                              )
                           
                         can be solved efficiently by CPLEX through a classical branch and bound technique. However, the size of the MILP problem grows exponentially as the number of objects increases and it is impossible for CPLEX to solve instances with more than 20 objects. We aim to develop an approximation method for solving this MILP.

Combinatorial auctions have been used in the procurement of London bus routes Cantillon and Pesendorfer (2006), radio spectrum Cramton (1997), and truckload transportation Caplice and Sheffi (2006), among many others. Combinatorial auctions arise in situations where bidders are interested in buying bundles of objects that inherit some level of synergies among themselves. One of the key problems in combinatorial auction is to find the best feasible combination of bids to maximise the total payoff. This problem is equivalent to a complete set packing problem where objects are those to be sold and the payoff of each subset is the maximum bid that the bidders offer. In the combinatorial auction literature, solution approaches such as Fujishima et al. (1999) and Sandholm (2002) often assume that the number of bids are relatively small compared to the number of objects, i.e. a few hundreds of objects and a few thousands of bids at most. However, in many real-life situations such as in spectrum auctions, bidders might be interested in buying any subset of their predefined frequencies. In this case, the bidders may express their interest through a compact value function that involves their objects of interest and their specific synergy parameters (Cramton, Ausubel, McAfee, & McMillan, 1997; De Vries & Vohra, 2003). Therefore, the set of feasible bids from all the bidders is an exponential function of the number of objects. We discuss about one such case in spectrum auctions in subSection 3.1.

Cooperative games with transferable utilities belong to a branch of game theory where groups of players can form coalitions in order to jointly achieve the groups’ objectives. Cooperative game theory has many applications in economics and business (e.g. for setting insurance premiums (Lemaire, 1991), and for setting interchange fees for ATM bank networks (Gow & Thomas, 1998)), in law and political science (e.g. for computing voting power (Leech, 2003)), and in artificial intelligence (e.g. for coalition structure formation in multi-agent systems (Chalkiadakis, Elkind, & Wooldridge, 2011)), among many others. One of the key problems in coalitional games is to find a coalition structure, i.e. to divide the set of all players into disjoint subsets called coalitions, such that the total payoff of these coalitions is maximised. This problem is equivalent to a CSPP where players are viewed as objects, coalitions are viewed as subgroups, and a coalition structure is equivalent to a packing. Sandholm, Larson, Andersson, Shehory, and Tohmé (1999) present a coalition structure graph to visualise the set of all possible coalition structures. The authors then show interesting results about the guaranteed bound on the best coalition structure within certain parts of the graph. Since then, new exact methods have been introduced to exploit the special search space of the coalition structures. However, these existing methods are only applicable for games with less than 30 players Rahwan, Michalak, and Jennings (2012).

In this manuscript, we develop an approximation method for solving the CSPP. Our contributions include the following:
                           
                              1.
                              We propose a new mathematical formulation for the CSPP that makes use of the subsets suggested by the LP solution (or any heuristic solution and their combination). The new formulation directly suggests an efficient method for generating near-optimal feasible packings.

We propose a method to find tighter upper bounds (compared to LP relaxation). This involves a constraint generation framework to solve the corresponding large-scale MILP problem.

We demonstrate the algorithm with the winner determination problem that arises in spectrum auctions. We show that the constraint generation problem can be solved in O(
                                    
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       log
                                       n
                                    
                                 ) and that the LP relaxation problem can be solved in polynomial time. We provide numerical results for spectrum auctions instances with up to 200 objects.

We also perform numerical tests on the optimal coalition structure generation problem that arises in large weighted coalitional skill games Bachrach, Meir, Jung, and Kohli (2010) and a number of other simulated combinatorial auction settings that are accompanied by underlying economical interpretations Leyton-Brown and Shoham (2006).

The structure for the rest of the paper is as follows. We provide an alternative formulation for the CSPP problem in subSection 2.1. This leads to an efficient method for finding feasible packings in subSection 2.2. The upper bounds are obtained by solving the LP relaxation and a large-scale MIP relaxation. These are done via constraint generation frameworks to be described in subSections 2.3 and 2.4. We demonstrate the algorithm through two applications in combinatorial auctions and cooperative games in subSections 3.1 and 3.2. We provide numerical results in Section 4 and finally conclude in Section 5.

The set packing problem essentially aims to choose columns in matrix 
                           
                              A
                           
                         to maximise the total value of the selected columns while still enforcing the packing constraints. Consider dividing these columns into two subsets; let 
                           
                              I
                           
                         be the indices of columns that we have a high expectation on where the optimal set of subsets will lie on, and let 
                           
                              J
                           
                         be the indices of the remaining columns. For now, we assume that 
                           
                              I
                           
                         and 
                           
                              J
                           
                         are given. Let 
                           
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                              
                           
                         be the sub-matrices of 
                           
                              A
                           
                         that are formed by columns in sets 
                           
                              I
                           
                         and 
                           
                              J
                           
                        , respectively. Suppose for the sake of convenience in notation that the columns of 
                           
                              A
                           
                         are rearranged such that 
                           
                              A
                              =
                              [
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                              
                              ]
                           
                        . Similarly, let 
                           
                              
                                 
                                    v
                                 
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    J
                                 
                              
                           
                         be the vectors of objective coefficients for columns in sets 
                           
                              I
                           
                         and 
                           
                              J
                           
                        , respectively, i.e. we have:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The CSPP then can be rewritten as:
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            J
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   I
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   J
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   J
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   J
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   J
                                                
                                             
                                             ⩽
                                             e
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             ∈
                                             
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                   |
                                                   I
                                                   |
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   J
                                                
                                             
                                             ∈
                                             
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                   |
                                                   J
                                                   |
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              x
                              =
                              [
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                              ]
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                           
                         are vectors of binary decision variables indicating whether columns in subsets 
                           
                              I
                           
                         and 
                           
                              J
                           
                         are selected in the packing, respectively.

For each fixed 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        , the remaining columns in 
                           
                              J
                           
                         need to be chosen according to the indicator vector 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                           
                         such that 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                              ⩽
                              e
                              -
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         and such that the total value of the remaining columns selected is maximised, i.e. we solve:
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             g
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             )
                                             
                                             ≔
                                             
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            J
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            {
                                                            0
                                                            ,
                                                            1
                                                            }
                                                         
                                                         
                                                            |
                                                            J
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   J
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   J
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   J
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   J
                                                
                                             
                                             ⩽
                                             e
                                             -
                                             
                                                
                                                   A
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here, we define 
                           
                              g
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                              =
                              -
                              ∞
                           
                         if problem (4) is infeasible. Let us denote 
                           
                              
                                 
                                    f
                                 
                                 
                                    IP
                                 
                                 
                                    ∗
                                 
                              
                              (
                              N
                              ,
                              v
                              )
                           
                         as the optimal value of 
                           
                              CSPP
                              (
                              N
                              ,
                              v
                              )
                           
                        . We also use a shorthand notation 
                           
                              
                                 
                                    f
                                 
                                 
                                    IP
                                 
                                 
                                    ∗
                                 
                              
                              ≡
                              
                                 
                                    f
                                 
                                 
                                    IP
                                 
                                 
                                    ∗
                                 
                              
                              (
                              N
                              ,
                              v
                              )
                           
                         where there is no confusion for not specifying 
                           
                              (
                              N
                              ,
                              v
                              )
                           
                        . For each choice of 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        , let 
                           
                              N
                              ⧹
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         be the set of remaining objects after subsets in 
                           
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                           
                         have been selected according to the indicator vector 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        . Let 
                           
                              v
                              ⧹
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         be the corresponding reduced vector of payoffs that subgroups of 
                           
                              N
                              ⧹
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         can obtain. Then problem (4) is equivalent to another complete set packing problem on the remaining objects,
                           1
                           This definition is similar to the value function of the packing game defined by Deng, Ibaraki, and Nagamochi (1999).
                        
                        
                           1
                         i.e. 
                           
                              g
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                              ≡
                              
                                 
                                    f
                                 
                                 
                                    IP
                                 
                                 
                                    ∗
                                 
                              
                              (
                              N
                              ⧹
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              ,
                              v
                              ⧹
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                        .

Problem (3) can be reformulated as a bi-level optimisation problem:
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         |
                                                         I
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         |
                                                         J
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                v
                                             
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          s
                                          .
                                          t
                                          
                                          
                                             
                                                A
                                             
                                             
                                                J
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ⩽
                                          e
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ⩽
                                          e
                                          ,
                                       
                                       
                                    
                                 
                              
                           
                        which is equivalent to the following mixed integer non-linear program (MINLP):
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            {
                                                            0
                                                            ,
                                                            1
                                                            }
                                                         
                                                         
                                                            |
                                                            I
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   I
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             +
                                             g
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             ⩽
                                             e
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It is interesting to note that the reformulation has a smaller number of binary variables, i.e. 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    |
                                    I
                                    |
                                 
                              
                           
                        , instead of 
                           
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                           
                         binary variables that appear in model (2). However, this comes at a cost of having an unknown non-linear term 
                           
                              g
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                        . Indeed, this quantity is the payoff of the optimal set packing problem on the remaining objects. This means the problem is still hard but this makes sense since two equivalent formulations should have the same level of complexity. Notice, however, that the reformulation can provide us an idea of how to find a near-optimal solution as will be described next.

Instead of maximising the entire quantity 
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             I
                                          
                                       
                                       +
                                       g
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             I
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        , let us approximate the problem by replacing the second term 
                           
                              g
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         with its linear approximation 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                              (
                              e
                              -
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                CSPP
                                             
                                             
                                                sub
                                             
                                          
                                          
                                          ≔
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          e
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ⩽
                                          e
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          x
                                          ∈
                                          
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                                |
                                                I
                                                |
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           
                              c
                           
                         is the vector of payoffs that individual objects can obtain and 
                           
                              (
                              e
                              -
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         is the indicator vector of the remaining objects. The corresponding formulation is an MILP with n linear constraints and with 
                           
                              |
                              I
                              |
                           
                         variables and could be solved efficiently by CPLEX, or some existing algorithms for solving the set packing problem (e.g. (Beasley & Jörnsten, 1992; Caprara et al., 2000; Fujishima et al., 1999; Sandholm, 2002)) for relatively small 
                           
                              |
                              I
                              |
                           
                        . We notice that the objective function is equivalent to 
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             I
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             I
                                          
                                       
                                    
                                 
                              
                           
                         is the corresponding reduced cost vector for 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        . After having found 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                                 
                                    ∗
                                 
                              
                           
                        , we can solve a new CSPP problem on the remaining objects to find 
                           
                              g
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             I
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                        . This can be done through an exact algorithm if the number of remaining objects is relatively small, or through an approximation method such as the one we are describing otherwise. Formally, this is described in Algorithm 1.
                           Algorithm 1
                           Approximation algorithm for finding near-optimal set packing (lower bound)
                                 
                                    
                                       
                                       
                                          
                                             
                                                Initialisation: Set 
                                                   
                                                      k
                                                      =
                                                      1
                                                      ,
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      =
                                                      N
                                                      ,
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            sub
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                .
                                          
                                          
                                             
                                                while 
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                1. Find the set of candidate subsets 
                                                   
                                                      I
                                                   
                                                 that is suggested by an LP relaxation solution.
                                          
                                          
                                             
                                                
                                                2. Solve 
                                                   
                                                      
                                                         
                                                            CSPP
                                                         
                                                         
                                                            sub
                                                         
                                                      
                                                   
                                                . Let 
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 be an optimal solution.
                                          
                                          
                                             
                                                
                                                3. Update:
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               sub
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               sub
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               I
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               I
                                                            
                                                            
                                                               ∗
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               (
                                                               k
                                                               )
                                                            
                                                         
                                                         ⧹
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               (
                                                               k
                                                               +
                                                               1
                                                               )
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               (
                                                               k
                                                               )
                                                            
                                                         
                                                         ⧹
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               I
                                                            
                                                         
                                                         ,
                                                         
                                                         k
                                                         =
                                                         k
                                                         +
                                                         1
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end while
                                             
                                          
                                          
                                             
                                                Return solution 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            sub
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           

In step (1) of Algorithm 1, we find an initial set of potential subsets that might appear in the optimal packing. We will use the set 
                           
                              I
                           
                         that is suggested by the LP relaxation solution. A possible method for solving the LP relaxation is described in subSection 2.4. Notice, however, that the algorithm is very flexible in choosing the candidate set. In fact, the set 
                           
                              I
                           
                         can also be obtained from any heuristic solution or from a combination thereof. In step (2) we solve problem 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    sub
                                 
                              
                           
                         to find a near-optimal solution to the reformulation of CSPP in model (6). In step (3) we update the approximated objective value, the set of remaining objects, and their reduced vector of the payoff values. The first result we can see immediately is that the algorithm provides us a feasible packing solution and a lower bound to the CSPP as formally stated in the Lemma 1.
                           Lemma 1
                           
                              Algorithm 1 
                              produces a lower bound on the CSPP, i.e. 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          sub
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          IP
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                              .
                           

Since Algorithm 1 selects no same object twice for different subsets, it produces a feasible packing solution with 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          sub
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               being the packing’s total payoff. Thus, 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          sub
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          IP
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              . □

Given the lower bound of CSPP, we are interested in judging how good the bound is. In theory, the quality of the approximated solution depends on how good the linear approximation 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                              (
                              e
                              -
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         is compared to 
                           
                              g
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             I
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                         around the truth optimum. In general, the linear approximation is more accurate if 
                           
                              ‖
                              e
                              -
                              
                                 
                                    Ax
                                 
                                 
                                    I
                                 
                              
                              ‖
                           
                         is small. In other words, the higher the accuracy of picking the right candidate subset 
                           
                              I
                           
                        , the smaller the size of the remaining set, and hence the more accurate the linear approximation is. It is important that the approximated function 
                           
                              
                                 
                                    f
                                 
                                 
                                    ̃
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         is close to the original objective function 
                           
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         around the optimum 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        . Notice also that, due to the discreteness of 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        , it is still possible for 
                           
                              
                                 
                                    f
                                 
                                 
                                    ̃
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         to have the same optimum as 
                           
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         even though the two functions differ at 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                                 
                                    ∗
                                 
                              
                           
                        . It is easy to extend the algorithm to use a quadratic approximation of 
                           
                              g
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             I
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                         and this would enhance the quality of the bound. However, this will come at a cost of having a more computationally expensive approximation and hence the choice would depend on how we want to trade off between the quality of the solution and the computation time. We will use the upper bounds found via LP and MILP relaxation (to be described in subSections 2.3 and 2.4) to estimate the optimality gap of the solutions found by Algorithm 1.

In LP relaxation, we relax the binary constraints on 
                           
                              x
                           
                         and this provides us with an upper bound to the CSPP. However, due to the excessive relaxation on all the 
                           
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                           
                         binary variables, the quality of the bound might not be good enough for some instances. With the expectation that the optimal columns are mostly in 
                           
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                           
                        , we develop a better relaxation strategy where only the vector 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                           
                         is relaxed while still enforcing 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                         to be binary as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                CSPP
                                             
                                             
                                                MIP
                                             
                                          
                                          
                                          ≔
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          +
                                          
                                             
                                                v
                                             
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          +
                                          
                                             
                                                A
                                             
                                             
                                                J
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ⩽
                                          e
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ∈
                                          
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                                |
                                                I
                                                |
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ⩾
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        where the constraint 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 
                                    |
                                    J
                                    |
                                 
                              
                           
                         has been relaxed to 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                              ⩾
                              0
                           
                        . Notice that we do not have to include 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                              ⩽
                              1
                           
                         because the packing constraint 
                           
                              {
                              
                                 
                                    A
                                 
                                 
                                    I
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                              +
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                              ⩽
                              e
                              }
                           
                         has already enforced this. We call this an MIP relaxation and notice that it has 
                           
                              |
                              I
                              |
                           
                         binary variables and 
                           
                              |
                              J
                              |
                           
                         continuous variables. We will choose 
                           
                              |
                              I
                              |
                           
                         relatively small, i.e. 
                           
                              |
                              I
                              |
                              ∼
                              n
                              ≪
                              
                                 
                                    2
                                 
                                 
                                    n
                                 
                              
                           
                        , and hence 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                 
                              
                           
                         is much easier to solve compared to the original MILP but still more difficult than the LP relaxation due to the presence of the binary variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        . Solving 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                 
                              
                           
                         will provide us a better upper bound to the CSPP compared to the LP relaxation, as stated in the following lemma.
                           Lemma 2
                           
                              The following inequalities hold: 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          LP
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          MIP
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          IP
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩾
                                    
                                       
                                          f
                                       
                                       
                                          sub
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                              .
                           

The first two inequalities are obvious since 
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          LP
                                       
                                    
                                 
                               is a linear relaxation of 
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          MIP
                                       
                                    
                                 
                               (on variable 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          I
                                       
                                    
                                 
                              ) and 
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          MIP
                                       
                                    
                                 
                               is a linear relaxation of 
                                 
                                    CSPP
                                 
                               (on variable 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          J
                                       
                                    
                                 
                              ). The last inequality was derived in Lemma 1. □

Despite the tighter bound obtained, solving 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                 
                              
                           
                         given its exponential size is very challenging. Due to the presence of the binary variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        , we cannot apply the classical column generation approach to handle the exponentially large number of columns. In what follows, we will present a new approach for solving 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                 
                              
                           
                        .

We notice that 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                 
                              
                           
                         can be reformulated as a bi-level optimisation problem as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         |
                                                         I
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          
                                          +
                                          
                                       
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                   ⩾
                                                   0
                                                
                                             
                                          
                                          
                                          
                                             
                                                v
                                             
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                J
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                J
                                             
                                          
                                          ⩽
                                          e
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ⩽
                                          e
                                          .
                                       
                                       
                                    
                                 
                              
                           
                        
                     

Due to the boundedness and the non-emptiness of the constraint set on 
                           
                              
                                 
                                    x
                                 
                                 
                                    J
                                 
                              
                           
                        , we can replace the LP in the second level with its dual:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         {
                                                         0
                                                         ,
                                                         1
                                                         }
                                                      
                                                      
                                                         |
                                                         I
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                v
                                             
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          
                                          +
                                          
                                       
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   β
                                                   ⩾
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          e
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                          β
                                          ⩾
                                          
                                             
                                                v
                                             
                                             
                                                J
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                I
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                I
                                             
                                          
                                          ⩽
                                          e
                                          .
                                       
                                       
                                    
                                 
                              
                           
                        
                     

Let 
                           
                              
                                 
                                    F
                                 
                                 
                                    J
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    
                                       β
                                       :
                                       
                                          
                                             A
                                          
                                          
                                             J
                                          
                                          
                                             t
                                          
                                       
                                       β
                                       ⩾
                                       
                                          
                                             v
                                          
                                          
                                             J
                                          
                                       
                                       ,
                                       β
                                       ⩾
                                       0
                                    
                                 
                              
                           
                        ; the bi-level problem can be further reformulated as:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            {
                                                            0
                                                            ,
                                                            1
                                                            }
                                                         
                                                         
                                                            |
                                                            I
                                                            |
                                                         
                                                      
                                                      ,
                                                      δ
                                                   
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   I
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             +
                                             δ
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             e
                                             -
                                             
                                                
                                                   A
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             )
                                             ⩾
                                             δ
                                             ∀
                                             β
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   J
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This reformulation is an MIP with 
                           
                              |
                              I
                              |
                           
                         binary variables and one continuous variable, and with a semi-infinite number of constraints (one for each 
                           
                              β
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    J
                                 
                              
                           
                        ). Due to the linearity of the constraints on 
                           
                              β
                           
                        , the semi-infinite constraints are equivalent to a finite set of constraints for all the extreme points and extreme rays 
                           
                              {
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    K
                                 
                              
                              }
                           
                         of 
                           
                              
                                 
                                    F
                                 
                                 
                                    J
                                 
                              
                           
                        . Model (7) can be reformulated as:
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   CSPP
                                                
                                                
                                                   MIP
                                                   2
                                                
                                             
                                             
                                             ≔
                                             
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            {
                                                            0
                                                            ,
                                                            1
                                                            }
                                                         
                                                         
                                                            |
                                                            I
                                                            |
                                                         
                                                      
                                                      ,
                                                      δ
                                                   
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   I
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             +
                                             δ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                   t
                                                
                                             
                                             (
                                             e
                                             -
                                             
                                                
                                                   A
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                             )
                                             ⩾
                                             δ
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             K
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The new MIP problem has 
                           
                              |
                              I
                              |
                           
                         binary variables, one continuous variable, and K linear constraints where K could be exponentially large. This means the reformulation is still as complex as the original MIP but this makes sense since the two are equivalent. However, the formulation defined by 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                    2
                                 
                              
                           
                         allows us to apply a constraint generation framework where only relevant extreme points and extreme rays of 
                           
                              
                                 
                                    F
                                 
                                 
                                    J
                                 
                              
                           
                         are introduced to the model, as described in Algorithm 2.
                           Algorithm 2
                           Constraint Generation Algorithm for Solving MIP relaxation
                                 
                                    
                                       
                                       
                                          
                                             
                                                Initialisation: Start with any initial relaxed constraint set 
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                      =
                                                      {
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                      }
                                                   
                                                , where 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                   
                                                 is a feasible point in 
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            J
                                                         
                                                      
                                                   
                                                 and set 
                                                   
                                                      k
                                                      =
                                                      0
                                                   
                                                .
                                          
                                          
                                             
                                                loop
                                             
                                          
                                          
                                             
                                                
                                                1. Set 
                                                   
                                                      k
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                 and solve the relaxed problem:
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        (
                                                                        k
                                                                        )
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        δ
                                                                     
                                                                     
                                                                        (
                                                                        k
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         =
                                                         arg
                                                         
                                                            
                                                               
                                                                  min
                                                               
                                                               
                                                                  x
                                                                  ,
                                                                  δ
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        I
                                                                     
                                                                  
                                                                  +
                                                                  δ
                                                                  :
                                                                  
                                                                     
                                                                        (
                                                                        e
                                                                        -
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              I
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              I
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     
                                                                        (
                                                                        j
                                                                        )
                                                                     
                                                                  
                                                                  ⩾
                                                                  δ
                                                                  ,
                                                                  ∀
                                                                  j
                                                                  ∈
                                                                  {
                                                                  0
                                                                  ,
                                                                  …
                                                                  ,
                                                                  k
                                                                  -
                                                                  1
                                                                  }
                                                               
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                2. Solve the constraint generation problem:
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               (
                                                               k
                                                               )
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  min
                                                               
                                                               
                                                                  β
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           e
                                                                           -
                                                                           
                                                                              
                                                                                 A
                                                                              
                                                                              
                                                                                 I
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 (
                                                                                 k
                                                                                 )
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  :
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  β
                                                                  ⩾
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                  
                                                                  ,
                                                                  β
                                                                  ⩾
                                                                  0
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  e
                                                                  -
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        I
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        (
                                                                        k
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      ⩾
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                Terminate the loop.
                                          
                                          
                                             
                                                
                                                else
                                             
                                          
                                          
                                             
                                                Update 
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      =
                                                      {
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            k
                                                            -
                                                            1
                                                            )
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      }
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                end loop
                                             
                                          
                                          
                                             
                                                Return optimal solution 
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                   
                                                 and set 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            MIP
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            I
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           

In step (1) of Algorithm 2, we solve a relaxed problem of 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                    2
                                 
                              
                           
                        . This is an MIP and can be handled by CPLEX for reasonably large n (up to a few hundred objects) as long as we keep track of the number of constraints generated, i.e. we keep k below some bound relative to n. In step (2) we solve the constraint generation problem. Notice the problem has exactly the same structure compared to the dual of 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    LP
                                 
                              
                           
                        . We describe a solution approach for solving this problem in subSection 2.4.

It is important to note that we cannot apply a column generation algorithm directly to the original MIP as that would not provide us a proof of optimality even when no further improving column can be found, i.e. we could be trapped in local optimum due to the presence of the binary variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    I
                                 
                              
                           
                        . However, with the reformulation in 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    MIP
                                    2
                                 
                              
                           
                        , we have a proof of optimality on the constraint generation algorithm once no further violating constraints are found.

Consider the dual of 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    LP
                                 
                              
                           
                        :
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                CSPP
                                             
                                             
                                                LPD
                                             
                                          
                                          
                                          ≔
                                          
                                          
                                             min
                                          
                                          
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                t
                                             
                                          
                                          y
                                          ,
                                       
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          y
                                          ⩾
                                          v
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ,
                                          
                                          ∀
                                          j
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                2
                                             
                                             
                                                n
                                             
                                          
                                          }
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          y
                                          ⩾
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        The dual problem contains a decision variable 
                           
                              y
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         and an exponentially large number of constraints. The optimal value of the dual LP relaxation problem, denoted as 
                           
                              
                                 
                                    f
                                 
                                 
                                    LP
                                 
                                 
                                    ∗
                                 
                              
                           
                        , provides us an upper bound on the optimal value of the original MILP. From this, we obtain 
                           
                              
                                 
                                    f
                                 
                                 
                                    sub
                                 
                                 
                                    ∗
                                 
                              
                              /
                              
                                 
                                    f
                                 
                                 
                                    LP
                                 
                                 
                                    ∗
                                 
                              
                           
                         as a guaranteed optimality bound of the feasible packing found in subSection 2.2. Although this upper bound is not as tight as the MIP upper bound, it is computationally less expensive and might be more appropriate to use in situations with limited computational resources. For 
                           
                              n
                              ⩽
                              20
                           
                        , we can solve 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    LPD
                                 
                              
                           
                         easily by using an LP solver like CPLEX. For 
                           
                              n
                              ⩾
                              30
                           
                        , the problem contains more than a trillion constraints and this makes it difficult to solve. However, it is interesting to observe that only a small number of constraints are tight at the optimal solution. This means the remaining non-binding constraints can be relaxed without changing the optimal solution. We can start with a relaxed problem of 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    LPD
                                 
                              
                           
                         with a small set of constraints and then keep introducing violating constraints to the relaxed problem until all the constraints are satisfied. At that point, the optimal solution of the relaxed problem is also the optimal solution of the original problem. Formally, the constraint generation method for solving 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    LPD
                                 
                              
                           
                         is described in Algorithm 3.
                           Algorithm 3
                           Constraint Generation Algorithm for Solving LP relaxation
                                 
                                    
                                       
                                       
                                          
                                             
                                                Initialisation: Start with any initial weight vector 
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                   
                                                 and initial relaxed constraint set 
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                   
                                                 and set 
                                                   
                                                      k
                                                      =
                                                      0
                                                   
                                                .
                                          
                                          
                                             
                                                loop
                                             
                                          
                                          
                                             
                                                
                                                1. Solve the constraint generation problem: 
                                                   
                                                      w
                                                      =
                                                      arg
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            z
                                                            ∈
                                                            
                                                               
                                                                  {
                                                                  0
                                                                  ,
                                                                  1
                                                                  }
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                      {
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      -
                                                      v
                                                      (
                                                      z
                                                      )
                                                      }
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      -
                                                      v
                                                      (
                                                      w
                                                      )
                                                      ⩾
                                                      0
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                Terminate the loop.
                                          
                                          
                                             
                                                
                                                else
                                             
                                          
                                          
                                             
                                                Update relax set: 
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            k
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      =
                                                      {
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      ,
                                                      w
                                                      }
                                                   
                                                .
                                          
                                          
                                             
                                                
                                                end if
                                             
                                          
                                          
                                             
                                                
                                                2. Set 
                                                   
                                                      k
                                                      =
                                                      k
                                                      +
                                                      1
                                                   
                                                 and solve the relaxed problem: 
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      =
                                                      arg
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                      {
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      y
                                                      :
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      y
                                                      ⩾
                                                      v
                                                      (
                                                      z
                                                      )
                                                      ,
                                                      
                                                      ∀
                                                      z
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                      }
                                                   
                                                .
                                          
                                          
                                             
                                                end loop
                                             
                                          
                                          
                                             
                                                Return optimal solution 
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            k
                                                            )
                                                         
                                                      
                                                   
                                                 and set 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            LP
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           

In step (1) of Algorithm 3, we find a subset 
                           
                              z
                           
                         that violates constraint 
                           
                              {
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ⩾
                              v
                              (
                              z
                              )
                              }
                           
                         mostly for the given proposal 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        . Here, a subset is characterised by a binary indicator vector 
                           
                              z
                           
                         with 
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                         if object i is in the subset and 
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                         otherwise. We then check the optimality condition. If the worst subset is not violated, then all other subsets satisfy this constraint and hence 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         is an optimal solution of 
                           
                              
                                 
                                    CSPP
                                 
                                 
                                    LPD
                                 
                              
                           
                        . Otherwise, we introduce the newly generated constraint 
                           
                              {
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              y
                              -
                              v
                              (
                              w
                              )
                              ⩾
                              0
                              }
                           
                         to the relaxed problem. In step (2), we solve the updated relaxed problem to obtain a new proposal 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         before going back to step (1).

Notice that the relaxed problem is an LP with smaller size and is easy to solve. The key, and often the difficult part, for a successful constraint generation algorithm is the ability to generate violating constraints efficiently. We will show that the CG problem in the spectrum auction application can be solved in O(
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              log
                              n
                           
                        ). We will also show that the constraint generation problem in the WCSG games with reasonable size (i.e. 
                           
                              n
                              ⩽
                              200
                           
                        ) can also be solved very efficiently. Some remarks on the constraint generation problem follow.
                           
                              •
                              The constraint generation problem does not have to be solved exactly at every step except for the last step. In fact, any violating constraint could be added to the relaxed problem. It is only in the last step before terminating the loop that we need to obtain an optimal solution 
                                    
                                       w
                                    
                                  and to check if 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       -
                                       v
                                       (
                                       w
                                       )
                                       ⩾
                                       0
                                       }
                                    
                                 .

In some instances, the constraint generation problem might turn out to be very difficult to be solved to optimality. In this case, we can still obtain an upper bound to the CSPP as stated in Theorem 1.


                              Let 
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                               
                              be the optimal solution of the relaxed problem at iteration k in 
                              
                                 Algorithm 3 
                              and let 
                              
                                 
                                    ∊
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ; then we have:
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ⩽
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             ∗
                                          
                                       
                                       ⩽
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       n
                                       ∊
                                       .
                                    
                                 
                              
                           

Since 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               is an optimal solution of 
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          LPD
                                       
                                    
                                 
                              , it is also a feasible solution of any LP relaxation problem at any iteration k. Thus, its objective value 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               should be at least the optimal value 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                               of the relaxed LP, i.e. 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    ⩽
                                    
                                       
                                          e
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              . We can also show that 
                                 
                                    x
                                    =
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    ∊
                                    e
                                 
                               is a feasible solution to the relaxed LP by verifying that both the constraints 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    x
                                    ⩾
                                    v
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          2
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                               and 
                                 
                                    x
                                    ⩾
                                    0
                                 
                               are satisfied. By the definition of 
                                 
                                    ∊
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   a
                                                
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                               and by the construction of the algorithm, we have 
                                 
                                    ∊
                                    ⩾
                                    0
                                 
                               before the loop in Algorithm 3 terminates. Thus, 
                                 
                                    x
                                    =
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    ∊
                                    e
                                    ⩾
                                    
                                       
                                          y
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    ⩾
                                    0
                                 
                              . For 
                                 
                                    j
                                    =
                                    1
                                 
                               we have 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    0
                                 
                               and 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    0
                                 
                               and hence the constraint 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    x
                                    ⩾
                                    v
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                               holds trivially. For 
                                 
                                    j
                                    ⩾
                                    2
                                 
                              , we have:
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       x
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       ∊
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       e
                                       ⩾
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       ∊
                                       ⩾
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       .
                                    
                                 
                              Thus, 
                                 
                                    x
                                 
                               is a feasible solution to 
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          LPD
                                       
                                    
                                 
                              . Therefore,
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             ∗
                                          
                                       
                                       ⩽
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       x
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       ∊
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       e
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       n
                                       ∊
                                       .
                                       
                                       □
                                    
                                 
                              
                           

The implication of Theorem 1 is that if 
                           
                              ∊
                           
                         is sufficiently small relative to 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        , we can stop the CG algorithm and use the upper bound 
                           
                              (
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              +
                              n
                              ∊
                              )
                           
                         instead of 
                           
                              
                                 
                                    e
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    ∗
                                 
                              
                           
                        .

In a spectrum auction, there are n frequencies (objects) and m bidders. Each bidder is interested in a subset of frequencies. Let 
                           
                              Φ
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                    ×
                                    n
                                 
                              
                           
                         be a 0–1 matrix where 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    ij
                                 
                              
                              =
                              1
                           
                         indicates whether bidder i has an interest in frequency j and 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    ij
                                 
                              
                              =
                              0
                           
                         otherwise. We follow the model suggested by Cramton et al. (1997) and De Vries and Vohra (2003) and assume that the individual object j has a payoff value of 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                        . Bidder i will value a subset 
                           
                              S
                           
                         of frequencies as 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             S
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             q
                                             ∈
                                             S
                                             ∩
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             q
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                           
                         is a parameter that models how strong bidder i views the complementarities (De Vries & Vohra, 2003). The largest bid on a subset 
                           
                              S
                           
                         is:
                           
                              (9)
                              
                                 v
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                   ∈
                                                   S
                                                   ∩
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                q
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Notice that 
                           
                              v
                              (
                              z
                              )
                           
                         is not given explicitly. To apply existing methods, we would have had to evaluate 
                           
                              v
                              (
                              z
                              )
                           
                         for all 
                           
                              z
                           
                         just to obtain the input to the CSPP. This is very expensive computationally. We will show that, by applying our constraint generation framework, we will eliminate this stage and only perform the calculation if needed. Specifically, we can combine the max operator in (9) into the max operator of the CG problem as follows:
                           
                              (10)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          z
                                       
                                    
                                 
                                 {
                                 v
                                 (
                                 z
                                 )
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 y
                                 }
                                 ⇔
                                 
                                    
                                       
                                          max
                                       
                                       
                                          z
                                          ,
                                          i
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                   ∈
                                                   S
                                                   ∩
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                q
                                             
                                          
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          y
                                       
                                    
                                 
                                 ⇔
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          z
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ,
                                                   q
                                                   ∈
                                                   S
                                                   ∩
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                q
                                             
                                          
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          y
                                       
                                    
                                 
                                 ⇔
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          z
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                t
                                             
                                          
                                          z
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          y
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ⊙
                                                      v
                                                      )
                                                   
                                                   
                                                      t
                                                   
                                                
                                                z
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ⇔
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          z
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      t
                                                   
                                                
                                                z
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                a
                                             
                                             
                                                t
                                             
                                          
                                          z
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              a
                              =
                              y
                              -
                              v
                           
                        , and 
                           
                              b
                              =
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ⊙
                              v
                              )
                           
                         is the element-wise production of the two vectors 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              v
                           
                        .

For each fixed i, the CG problem is a quadratic binary optimisation problem (QBP) which is NP-hard to solve except for special cases. Among these, Allemand, Fukuda, Liebling, and Steiner (2001) develop a polynomial time algorithm for solving unconstrained fixed-ranked homogeneous QBP, i.e. one with the form 
                           
                              
                                 
                                    max
                                 
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              {
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              Qz
                              }
                           
                         where 
                           
                              Q
                           
                         is a symmetric positive definite matrix with a fixed rank. Specifically, the authors show that there is an O(
                           
                              
                                 
                                    n
                                 
                                 
                                    d
                                    -
                                    1
                                 
                              
                           
                        ) algorithm for solving the QBP where d is the rank of 
                           
                              Q
                           
                        . We will extend this result to the case of nonhomogeneous fixed-ranked QBP and show an O(
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              log
                              n
                           
                        ) algorithm for solving the constraint generation problem.
                           Theorem 2
                           
                              The constraint generation problem described in 
                              
                                 (10)
                               
                              can be solved in 
                              
                                 
                                    O
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    n
                                    )
                                 
                              
                              .
                           

In the CG problem, we need to maximise 
                                 
                                    {
                                    
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                          z
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                    z
                                    }
                                 
                              . For each 
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          n
                                       
                                    
                                 
                              , let 
                                 
                                    P
                                    (
                                    z
                                    )
                                    =
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          t
                                       
                                    
                                    z
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          t
                                       
                                    
                                    z
                                    )
                                 
                               be the corresponding point in a 2-dimensional space, i.e. 
                                 
                                    P
                                    (
                                    z
                                    )
                                    :
                                    
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          n
                                       
                                    
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                              . Since there are 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          n
                                       
                                    
                                 
                               such points 
                                 
                                    z
                                 
                              , we have 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          n
                                       
                                    
                                 
                               corresponding points 
                                 
                                    P
                                    (
                                    z
                                    )
                                 
                               in 2-D. It is very interesting, however, that the convex hall of these points has at most 
                                 
                                    2
                                    n
                                 
                               extreme points Allemand et al. (2001). Since we are maximising a convex function 
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          z
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    z
                                    )
                                    }
                                 
                              , the maximum is attained at one of the extreme points. In addition, these extreme points can be listed out as follows:

Let 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               and let 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    arctan
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              . We first order 
                                 
                                    α
                                 
                               in an ascending order 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    ⩽
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ⋯
                                    ⩽
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                 
                              . The 
                                 
                                    2
                                    n
                                 
                               extreme points are given by the following equations:
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         if
                                                         
                                                         k
                                                         =
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  ⩽
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               (
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         if
                                                         
                                                         1
                                                         ⩽
                                                         k
                                                         ⩽
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                                  -
                                                                  n
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               (
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         if
                                                         
                                                         n
                                                         +
                                                         1
                                                         ⩽
                                                         k
                                                         ⩽
                                                         2
                                                         n
                                                         -
                                                         1
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Once these points have been found, we can compare the objective values 
                                 
                                    {
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          z
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          E
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    z
                                    )
                                    }
                                 
                               only among these 
                                 
                                    2
                                    n
                                 
                               extreme points to find the maximum. This takes O(n) operations and the sorting of vector 
                                 
                                    α
                                 
                               takes 
                                 
                                    n
                                    log
                                    (
                                    n
                                    )
                                 
                               operations. Since we have to solve this problem n times, one for each bidder, the complexity of the algorithm is O(
                                 
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    (
                                    n
                                    )
                                 
                              ). □


                        Fig. 1
                         demonstrates the algorithm for solving the CG problem for the case of 
                           
                              n
                              =
                              10
                           
                         for some fixed i. Crossed generator points 
                           
                              p
                              =
                              (
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         are generated randomly with 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                           
                         following a uniform distribution in 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         while 
                           
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    0.2
                                    u
                                 
                              
                           
                         with u also following a uniform distribution. These choices of these random points are only for the purpose of clearer demonstration in Fig. 1. The corresponding zonotope has 20 extreme points. The maximum of 
                           
                              {
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              }
                           
                         is attained at 
                           
                              
                                 
                                    E
                                 
                                 
                                    13
                                 
                              
                           
                        . This means 
                           
                              
                                 
                                    z
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              =
                              0
                           
                        , for 
                           
                              1
                              ⩽
                              j
                              ⩽
                              3
                           
                         and 
                           
                              
                                 
                                    z
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              =
                              1
                           
                         for 
                           
                              4
                              ⩽
                              j
                              ⩽
                              10
                           
                        .
                           Theorem 3
                           
                              The LP dual problem 
                              
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          LPD
                                       
                                    
                                 
                               
                              in spectrum auction can be solved in polynomial time.
                           

From Theorem 2, identifying a violating constraint for a given 
                                 
                                    y
                                 
                               can be done in O
                                 
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    n
                                    )
                                 
                              . This means we have an ‘oracle-polynomial time’ to solve the separation problem. Therefore, 
                                 
                                    
                                       
                                          CSPP
                                       
                                       
                                          LPD
                                       
                                    
                                 
                               can be solved in polynomial time using the ellipsoid method (see Theorem 6.4.9 in Grotschel, Lovász, & Schrijver (1993)). □

The weighted coalitional skill games (WCSG) were proposed by Bachrach and Rosenschein (2008). In this game, there are n players, T tasks and K skills. Each player has a subset of skills and each task requires a subset of skills. Let 
                           
                              Ψ
                           
                         be the player-skill matrix with 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    ik
                                 
                              
                           
                         indicating whether player i has skill k. Let 
                           
                              Φ
                           
                         be the task-skill matrix with 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    tk
                                 
                              
                           
                         indicating whether task t requires skill k. The players can form groups to work collectively and a group can perform a task if the skills required are available. Specifically, for each task t and the skill vector 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    t
                                 
                              
                           
                         that it requires, a coalition 
                           
                              z
                           
                         will be able to perform the task if, for all skill k, there exists at least one player in the coalition that has skill 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    tk
                                 
                              
                           
                        . Each task, if performed, returns some reward. The aim of the coalition structure generation problem in the WCSG game is to divide players into non-overlapping subgroups such that the total reward is maximised and this is equivalent to the CSPP problem. Bachrach and Rosenschein (2008) show that the problem is NP-hard except for some very restricted cases, such as with the bounded number of tasks and the bounded width of the tree that represent the skill-graph. In addition, even with these restrictions, the authors only provide a polynomial-time algorithm without any numerical result. We will apply our algorithm to find near-optimal CSPP of general WCSG games.

Let 
                           
                              Δ
                              (
                              z
                              ,
                              t
                              )
                           
                         be the binary indicator on whether coalition 
                           
                              z
                           
                         can perform task t and it is defined as:
                           
                              
                                 Δ
                                 (
                                 z
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         Ψ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   z
                                                   ⩾
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We consider a weighted average utility function defined as 
                           
                              v
                              (
                              S
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    ∈
                                    {
                                    1
                                    .
                                    .
                                    T
                                    }
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    t
                                 
                              
                              Δ
                              (
                              z
                              ,
                              t
                              )
                           
                        . In this case, the constraint generation problem 
                           
                              
                                 
                                    min
                                 
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              {
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              -
                              v
                              (
                              z
                              )
                              }
                           
                         can be reformulated as:
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          z
                                          ∈
                                          
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                t
                                             
                                          
                                          Δ
                                          (
                                          z
                                          ,
                                          t
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        This is equivalent to:
                           
                              (11)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          z
                                          ,
                                          δ
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                ω
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                                 z
                                 ⩾
                                 
                                    
                                       δ
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ∈
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                              
                           
                        
                        
                           
                              
                                 z
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       m
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              Δ
                              (
                              z
                              ,
                              t
                              )
                           
                         has been replaced by 
                           
                              
                                 
                                    δ
                                 
                                 
                                    t
                                 
                              
                           
                        . The set of constraints in (12) ensures that if the coalition 
                           
                              z
                           
                         does not have all the skills required in 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    t
                                 
                              
                           
                        , then 
                           
                              
                                 
                                    δ
                                 
                                 
                                    t
                                 
                              
                           
                         must be equal to zero. Otherwise, 
                           
                              
                                 
                                    δ
                                 
                                 
                                    t
                                 
                              
                           
                         should be equal to one to drive the objective function to the minimum. The constraint generation problem is a mixed-integer programming problem with 
                           
                              (
                              n
                              +
                              T
                              )
                           
                         binary variables and with 
                           
                              (
                              T
                              ∗
                              K
                              )
                           
                         constraints. Although the problem is NP-hard, we will show numerically that CPLEX can solve the game very efficiently for many instances with up to 200 players (with 20 tasks and 10 skills).

We perform numerical tests on spectrum auctions with the number of frequencies ranging from 
                           
                              n
                              =
                              25
                           
                         to 
                           
                              n
                              =
                              200
                           
                        . The number of bidders is set to be equal to the number of frequencies. Matrix 
                           
                              Φ
                           
                         is generated randomly using the Bernoulli distribution where each bidder has a 50% chance of having an interest in a frequency. The payoff vector 
                           
                              v
                           
                         and the synergy preference 
                           
                              μ
                           
                         are also generated randomly using the uniform distribution around 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        .


                        Table 1
                         shows the performance of Algorithms 1–3 when the number of objects varies between 25 and 200. Columns 2–5 show statistics for solving the LP dual problem, columns 6–7 show statistics for finding upper bounds, and column 8 shows the optimality bounds. In each column, the statistics shown are obtained by taking the average over 
                           
                              K
                              =
                              10
                           
                         random instances (using fixed random seeds between 1 and K in MATLAB for the purpose of convenient replication). By creating random instances, we can test the robustness of the algorithm when the input data vary.
                           2
                           All the numerical tests that appear in this manuscript are performed on a personal computer, Intel®Xeon®CPU W3520 @2.67GHz with 12GB RAM and under the Windows 7 operating system. The code was written and tested on MATLAB R2012a.
                        
                        
                           2
                         In general, there is an increasing trend with a cubic shape in the total time taken to solve the LP dual problem except for the case of 
                           
                              n
                              =
                              50
                           
                        .
                           3
                           Among 80 random instances generated, there were two outliers for the case of 
                                 
                                    n
                                    =
                                    50
                                 
                               with random seeds numbers 4 and 5.
                        
                        
                           3
                         The total time taken to solve the LP dual is around 85min for the largest instance. The number of iterations required by the constraint generation method to solve the LP dual is relatively small compared to the problem size. Specifically, to solve the LP dual with 
                           
                              
                                 
                                    2
                                 
                                 
                                    200
                                 
                              
                           
                         constraints for the case of 
                           
                              n
                              =
                              200
                           
                        , it took around 3273 iterations, on average, to identify the set of relevant constraints. This means we only need to solve around 3273 constraint generation problems and the same number of small-size LPs, each with 
                           
                              n
                              =
                              200
                           
                         columns and with the number of rows ranging between 1 and 3273. The time required to solve the constraint generation problem increases almost in a quadratic trend and this matches with the theoretical complexity of O(
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              log
                              n
                           
                        ) as derived in Theorem 2. The time taken to find feasible packings is relatively small compared to the time required to solve the LP relaxation with, at most, 20min for the largest instance. The optimality bounds between the feasible solutions and the LP upper bounds are around 91.1%, which are reasonably good given the very large problem size. Notice that this is the guaranteed bounds taken by 
                           
                              
                                 
                                    f
                                 
                                 
                                    sub
                                 
                                 
                                    ∗
                                 
                              
                              /
                              
                                 
                                    f
                                 
                                 
                                    LP
                                 
                                 
                                    ∗
                                 
                              
                           
                         as we have no knowledge of the optimal values. The actual optimality bounds could be higher.

We also perform numerical tests on large WCSG games with the number of players n ranging from 25 to 200 while fixing the number of tasks at 20 and the number of skills at 10. For each n, we generate 
                           
                              K
                              =
                              10
                           
                         random samples using random seeds between 1 and K. In each instance, the player-skill matrix is generated randomly using the Bernoulli distribution with a 25% chance for each player to have a skill. The task-skill matrix is also generated randomly with a 50% chance that each task requires a skill. The weighted vector is generated uniformly between 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        .


                        Table 2
                         shows the same statistics as Table 1 but for finding the optimal coalition structures of the WCSG with the number of players varying between 25 and 200 (i.e. columns 2–5 show statistics for solving the LP dual problem, columns 6–7 show statistics for finding upper bounds and column 8 shows the optimality bounds). In each column, the average performance over 
                           
                              K
                              =
                              10
                           
                         runs are recorded. There is an increasing trend in the total time taken to solve the LP dual problem (with less than 10min for the largest instance). Most of the time taken is for solving the constraint generation problems. The number of iterations to solve the LP dual is also relatively small with just over 300 iterations for the largest instances tested. The time required to find a feasible packing solution is less than 1 s and this is significantly small compared to the time taken to solve the LP dual problem. The optimality gap is around 99.5% which is quite impressive.

The main aim of this manuscript is to find an approximation algorithm for solving large-scale SPP where the number of feasible subsets is very large, and hence cannot be handled by existing methods. Our method is, however, applicable to any SPP game with 
                           
                              m
                              ≫
                              n
                           
                        . To demonstrate this, we test the algorithm with randomly generated problems that appear in the CATS library developed by Leyton-Brown and Shoham (2006). The value functions used in these instances have arisen in combinatorial auctions where the underlying bids are accompanied with economical interpretations. Tables 3 and 4
                        
                         summarise the optimality bounds and the computational time for various random distributions shown in the first columns. Columns 2–5 show the optimality bounds for 
                           
                              (
                              n
                              =
                              100
                              )
                           
                         objects while varying the number of feasible subsets between 2500 and 10000. Columns 6–7 show the same statistics but for fixed 
                           
                              (
                              m
                              =
                              5000
                              )
                           
                         while varying n between 50 and 150. The rows show different distributions from the CATS library for generating random instances. For each distribution and each pair of 
                           
                              (
                              n
                              ,
                              m
                              )
                           
                        , we generate 
                           
                              K
                              =
                              10
                           
                         random instances. The statistics are taken from the average performance among these K instances. In general, it is interesting to see that the optimality bounds increase with the increase of m. The optimality bounds are 100%, i.e. we obtain optimal solutions, for the ‘paths’ and ‘scheduling’ distributions. The average is 99.3% for all cases. The computational time is less than 1min for the worst instance tested.

@&#CONCLUSION@&#

We provide an approximation method for solving the complete set packing problem (CSPP) where the family of feasible subsets might be exponentially large. This includes a new mathematical formulation with a much fewer number of binary variables that allows the direct pursuit of near-optimal solutions. We also develop an algorithm for solving a large-scale MIP to obtain tighter upper bounds to the CSPP. We show that the method works very effectively, both in computational time and the quality of the bounds obtained, with the applications in combinatorial auctions and in cooperative game theory. Specifically, we show that recent results in fixed-rank quadratic binary programming can be extended to prove that the LP relaxation problem in spectrum auctions can be solved in polynomial time. The fast performance of the constraint generation algorithm for solving the LP relaxation problem of the coalitional skill games implies that the core and the least core in these games can also be computed efficiently by using the same method. Results from this research, particularly the new formulation for the CSPP, may stimulate future research to find alternative methods for solving large-scale SPP problems. Our algorithm for solving the large-scale MIP could also be applicable to other applications that involve an exponentially large number of continuous variables.

@&#ACKNOWLEDGEMENT@&#

Research support from the LANCS Initiative is gratefully acknowledged. The author also thanks Adam Letchford, Vinh Doan, Talal Rahwan, Long Tran-Thanh, and participants of the LANCS Workshop on Optimization 2013 and the coalitional structure generation group at the University of Southampton for helpful comments and discussions.

@&#REFERENCES@&#

