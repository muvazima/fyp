@&#MAIN-TITLE@&#Computer-aided diagnosis of plus disease via measurement of vessel thickness in retinal fundus images of preterm infants

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We present techniques for measurement of the width of the major temporal arcade.


                        
                        
                           
                           Gabor filters and morphological image processing methods are applied.


                        
                        
                           
                           The methods can detect plus disease and retinopathy of prematurity.


                        
                        
                           
                           Area under the receiver operating characteristic curve of 0.76 obtained.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computer-aided diagnosis

Gabor filters

Plus disease

Retinal blood vessels

Retinal fundus images

Retinopathy of prematurity

Temporal arcade

Vessel width

@&#ABSTRACT@&#


               
               
                  Changes in the characteristics of retinal vessels such as width and tortuosity can be signs of the presence of several diseases such retinopathy of prematurity (ROP) and diabetic retinopathy. Plus disease is an indicator of ROP which requires treatment and is signified by an increase in posterior venular width. In this work, we present image processing techniques for the detection, segmentation, tracking, and measurement of the width of the major temporal arcade (MTA), which is the thickest venular branch in the retina. Several image processing techniques have been employed, including the use of Gabor filters to detect the MTA, morphological image processing to obtain its skeleton, Canny׳s method to detect and select MTA vessel-edge candidates, least-squares fitting to interpolate the MTA edges, and geometrical procedures to measure the width of the MTA. The results, obtained using 110 retinal fundus images of preterm infants, indicate a statistically highly significant difference in MTA width of normal cases as compared to cases with plus disease 
                        (
                        p
                        <
                        0.01
                        )
                     . The results provide good accuracy in computer-aided diagnosis (CAD) of plus disease with an area under the receiver operating characteristic curve of 0.76. The proposed methods may be used in CAD of plus disease and timely treatment of ROP in a clinical or teleophthalmological setting.
               
            

@&#INTRODUCTION@&#

Digital imaging of the retinal fundus has become a valuable tool in noninvasive detection, diagnosis, and prognosis of diseases such as diabetic retinopathy (DR) [1–5], retinopathy of prematurity (ROP) [6–8], glaucoma [9,10], and cardiovascular complications [11,12] via computer-aided image-analysis methods. It has been shown that changes that occur in retinal vasculature can be indicative of the presence of DR [13–15], ROP [7,16–18], and hypertension [19], to name a few diseases. Physical attributes of arteriolar and venular vessels, such as their tortuosity and width, are changed in the presence of such diseases. In particular, the width of both the arterioles and venules increases in the presence of ROP, DR, and hypertension. Given the average vessel widths of 
                           86
                           
                           μ
                           m
                         and 
                           96
                           
                           μ
                           m
                         in premature infants with no ROP and those with threshold ROP, respectively [7], changes that occur in vessels in the presence of diseases such as ROP are not easily detected by the human eye, even when analyzed using a funduscope or fundus imaging devices. This limitation indicates the need for computer-aided methods to detect and quantify such small changes.

Plus disease is an indicator of the severity of ROP; it represents a stage that is progressing and requires immediate treatment [20]. It has been established that the presence of plus disease is strongly associated with the early detection and treatment of ROP [18,20–24]. Plus disease is defined as the presence of certain levels of abnormal venular thickness and arteriolar tortuosity [25]. There are several theories that attempt to explain the cause of the observed vascular changes in the presence of plus disease [26]. One theory relates the changes to increased levels of certain vascular growth factors [27,28]. In the case of changes in venular thickness, it has been theorized that increased levels of blood pressure, and the fact that venules are more distensible than arterioles, could lead to dilation of venules [29,30].

Plus disease is clinically diagnosed by qualitative comparison to a standard retinal fundus image [25] that exhibits abnormal levels of thickness and tortuosity. However, the standard image is considered to be atypical since it shows more vascular dilation and less tortuosity as compared to most retinas with plus disease [21]. Furthermore, the range of vascular changes is smaller and more challenging to distinguish in premature infants in the presence of plus disease even for experts, since the retinal vasculature is not fully developed as compared to the situation in adults. Indeed, it has been shown in a study that 22 recognized ROP experts agreed on diagnosis of plus disease only in 21% of the images analyzed [22]. Considering such facts, it can be concluded that there is a great need of methods for computer-aided diagnosis (CAD) of plus disease, which can lead to timely treatment of ROP.

The major temporal and nasal arcades (MTA and MNA) are the two thickest branches of blood vessels (venules) on the temporal and nasal sides of the retina with reference to the optic nerve head (ONH), respectively. It has been observed that the changes that occur in the width of venules in the presence of ROP and plus disease are predominantly or specifically seen in the MTA [23,18,17], but are also observed in the MNA [31,18,32].

Computer-aided methods used for measurement of vessel thickness typically fall into two categories. The first category of methods initially attempt to detect and segment vessels, then obtain the vessel center-line and edge pixels, and finally compute a thickness measure based on the distance between the associated edge and center-line pixels [13,7,33]. The second category of methods employ vessel detection techniques via a modeling approach. The models are mainly Gaussian-based since the intensity profile of a vessel at a given vessel center-line pixel resembles an inverted Gaussian curve [34,6,11]. As a result, the spread or standard deviation (STD) of the Gaussian model used to detect the vessel could be employed to estimate the width of the vessel. A brief review of a few such methods proposed for analysis of retinal fundus images of preterm infants is presented below.

Using semiautomated methods, Heneghan et al. [7] obtained a binary image of retinal vessels via multiscale analysis of the second-order derivative of the original intensity images combined with preprocessing and postprocessing morphological methods, as well as a two-level thresholding strategy. Heneghan et al. measured the vessel width by extending a line from the two opposite sides of a given vessel pixel until it reached the boundary of the vessel and noting the length of the line. This procedure was repeated for lines of various orientations originating from the same pixel. The vessel width at the given pixel was taken as the minimum distance obtained for all orientations.

Martínez-Pérez et al. [35,36] developed a semiautomated image analysis software called RISA for detection, segmentation, and measurement of vessel width in retinal images. RISA uses a region-growing algorithm in order to segment (binarize) blood vessels based on two features of edge-strength and ridge-strength. The edge-strength feature is derived as the gradient of the intensity image. The ridge-strength feature is based on the eigenvalue of the Hessian matrix of the intensity image. The resulting binary image is skeletonized and broken into several segments based on the detected branching points. RISA estimates the width of each vessel segment as the total area (in pixels) of the segment, divided by its length. RISA requires manual user correction at the stage of detection of branching points, as well as manual input regarding the vessel segment to analyze and to distinguish between venular and arteriolar branches.

Based on tracking and extraction of skeletons of manually selected vessels via multiscale ridge detectors, Wallace et al. [6] determined a vessel width estimate at each detected ridge point using the spread of a Laplacian-of-Gaussian model.

Fiorin and Ruggeri [33] used a web-based software package to draft manually the center-line of a retinal vessel segment. Canny׳s edge detection method was then used to obtain a set of vessel-edge pixels around the selected center-line. Two edge curves were then estimated on either side of the selected center-line by fitting a cubic spline to the previously detected edge pixels. The width of the selected vessel segment at each pixel was defined as the distance along the normal at a center-line pixel between the two estimated edge curves.

Using RISA, a few studies [31,23,18,32] have attempted to measure vessel width in retinal fundus images of premature infants and have correlated their findings to the presence of plus disease in the images. The results of these and two other studies [7,6] on CAD of plus disease are presented and compared with the results obtained using the proposed methods in Section 4.

Locating vessel edges based on binarization of the intensity image obtained using a vessel detection algorithm is prone to error due to sampling, the scale of the model used, as well as the threshold value used to binarize and segment vessels [7]. Furthermore, estimation of vessel width using the STD of Gaussian-based models is also prone to error since a Gaussian model is a continuous curve that does not contain a clear-cut point to indicate the exact location of the vessel edges. Such a method for estimation of width requires an assumption regarding suitable, yet arbitrary, weighting of the STD of the Gaussian model to estimate vessel width [37]. Methods that use a vessel׳s center-line for measurement of width are prone to error in case the center-line is not precisely in the middle of the vessel; it is especially challenging to guarantee such a requirement. Furthermore, such methods require accurate detection and subpixel representation of vessel edges. In addition, the methods available in the literature for measurement of vessel width in case of plus disease either manually distinguish between venular and arteriolar branches [31,23,18,32], or do not distinguish between them at all [7]; these methods also obtain the width measurement for only manually selected vessel segments.

In this paper, we present methods for detection, segmentation, and extraction of the MTA skeleton as well as detection and interpolation of the edges of the MTA, and ultimately, computation of the width of the MTA at several pixels along its skeleton in retinal fundus images of preterm infants. Gabor filters, which have been shown to be effective in detection of oriented patterns in biomedical applications [38–41], are used for the detection of vessels in the present work. Gabor filters have been applied for the detection of retinal blood vessels in previous works by Soares et al. [42] and Rangayyan et al. [43]. Furthermore, the methods include morphological image processing techniques to extract the MTA skeleton, Canny׳s method for selection of vessel-edge candidates, least-squares fitting to interpolate the vessel edges, and geometrical procedures to measure vessel width. The diagnostic performance of the average MTA width measure in distinguishing between cases with and without plus disease is analyzed in terms of sensitivity, specificity, area (A
                        
                           z
                        ) under the receiver operating characteristic (ROC) curve, and p-value. The obtained results are compared with results of similar studies in the literature. The present paper is an expanded and revised version of a related conference presentation [44].

The proposed methods were tested with retinal fundus images from the Telemedicine for ROP In Calgary (TROPIC) database [45]. The TROPIC images were captured using the RetCam II equipped with a wide-field (130°) lens and possess a size of 
                           640
                           ×
                           480
                         pixels. The spatial resolution of the RetCam images is estimated to be 
                           30
                           
                           μ
                           m
                           /
                         pixel [46]. RetCam images are considered to be low-resolution retinal fundus images. In total, 110 images from 41 patients, including 16 females and 25 males, were selected. In most cases, there are five different images available for each eye of each patient from each visit, representing different retinal fields to provide collectively a nearly full photographic documentation of the retina. In each case, the image with the highest visibility of two quadrants of the MTA was selected. Images were not selected based on overall quality and/or vessel-to-background contrast [47]. Patients corresponding to 90 of the 110 images were diagnosed with no ROP or with stages 1 or 2 ROP (30 images per category), and patients corresponding to 20 images were diagnosed with stage 3 ROP. Nineteen of the selected images were of patients diagnosed with plus disease (stages 2 and 3 of ROP) and 91 showed no signs of plus disease.

At most, two images of the same patient were included for the same stage of ROP, with one image from each eye. Images of the same eye from the same patient were included only if the ROP stages were different at the time of imaging, as diagnosed by an expert pediatric ophthalmologist and retinal specialist (A.L. Ells). The mean birth weight, gestational age, and chronological age of the patients at the time of imaging are 817.6g, 26.4 weeks, and 70.8 days, respectively. The project and protocol were approved by the Conjoint Health Research Ethics Board of the University of Calgary. The tenets of the Declaration of Helsinki were followed during the acquisition of the images. Written informed consent and approval were obtained from the parents of all children involved.

The procedure for extraction of the MTA skeleton consists of several stages: (1) preprocessing, (2) selecting the seed labels, (3) extracting the MTA skeleton segments, and (4) postprocessing. The algorithm requires the approximate location of the center of the ONH; for this purpose, the ONH centers in all images were manually marked by the user via a graphical user interface [48]. Note that this is the only manual input in the entire procedure used for vessel width measurement and will eventually be replaced by an automated procedure [49].


                           Fig. 1
                            shows a flowchart representation of the preprocessing steps for extraction of the skeleton of the MTA.

In order to detect the MTA, the previously published method of Rangayyan et al. [43], which uses Gabor filters, was employed. A large thickness value 
                              (
                              τ
                              =
                              10
                              
                              pixels
                              )
                            and elongation factor 
                              l
                              =
                              1.2
                           , determined empirically, were used to emphasize the magnitude response of the MTA. Using the responses from a bank of 45 Gabor filters spaced evenly over the angular range of 
                              [
                              −
                              π
                              /
                              2
                              ,
                              π
                              /
                              2
                              ]
                           , the Gabor-magnitude response at each pixel was defined as the largest response of the filters, and the Gabor-angle response was defined as the orientation of the corresponding Gabor function.

Given the fact that vascular changes have been observed to occur close to the ONH (posteriorly) in the presence of ROP [25], an average ONH width (ONHW) of 1.05mm in infants [46], and the spatial resolution of the TROPIC images, the skeleton extraction procedure and the subsequent analysis of each image were limited to the horizontal range from 
                              0.25
                              ×
                              ONHW
                            in the nasal direction to 
                              2
                              ×
                              ONHW
                            in the temporal direction with respect to the center of the ONH.

The algorithm is designed to detect the superior and inferior temporal arcades (STA and ITA) separately. The part of the image above the center of the ONH was taken as the superior part (STA), and the part below it was taken as the inferior part (ITA) and processed separately.

Each superior and inferior Gabor-magnitude-response image was normalized and gamma correction (with 
                              γ
                              =
                              1.5
                           ) [50] was applied to increase the high-intensity values (related to the MTA) and decrease the low-intensity values (related to choroidal vessels).

The moment-preserving thresholding method [51] was used to binarize the Gabor-magnitude-response images of the STA and ITA separately. This method finds a suitable threshold by assuming that, if the given gray-scale image is binarized, the first three moments of the gray-scale image must be preserved in the resulting binary image [51]. The resulting binary image was then skeletonized using the curvature-skeleton algorithm [52].

All vessels in the retina originate from the center of the ONH; hence, it is difficult to distinguish between the various branches of vessels within the ONH. Therefore, a circular region centered at the center of the ONH, with diameter equal to the average ONHW, was removed from the skeleton of the detected vessels.

In order to remove the pixels in the skeleton that represent the boundary of the ONH, the difference between the radial angle (originating from the center of the ONH) and the Gabor angle for skeleton pixels within an annular region (the area between two circles with diameters 
                              =
                              1
                              ×
                            and 
                              2
                              ×
                              ONHW
                           ) was obtained. If the angle difference was more than 
                              60
                              °
                           , the associated pixel was removed [53].

The horizontally restricted skeleton images were then pruned to remove short branches. Unconnected segments that are not part of the MTA were removed by using the morphological process of area open only if there were at least 10 different segments available in the image. The minimum number of connected pixels to be removed was automatically determined based on the mean and STD of the number of pixels in all available segments in the skeleton image, as mean 
                              +
                              0.5
                              ×
                              STD
                           .

Based on the orientation of each skeleton pixel, as indicated by the Gabor-angle response, pixels that do not belong to the STA and ITA were removed separately. When considering the STA/ITA of the right/left eye, respectively, pixels with orientation in the range 
                              [
                              0
                              ,
                              π
                              /
                              2
                              ]
                            were removed; similarly, when considering the STA/ITA of the left/right eye, pixels with orientation in the range 
                              [
                              −
                              π
                              /
                              2
                              ,
                              0
                              ]
                            were removed.


                           Fig. 2
                            illustrates a flowchart representation of the seed-label-selection algorithm for extraction of the skeleton of the MTA.

The branching points of the skeleton were determined using morphological image processing and by considering the number of neighboring pixels in an area of size 
                              3
                              ×
                              3
                            pixels. The segments resulting from breaking the skeleton were each labeled separately by numbering them. The average Gabor-magnitude response of each labeled segment of the skeleton was then calculated to obtain the seed label. The annular search area used to find seed label candidates was adaptively increased to ensure that there are at least two labels present for comparison for each of the STA and ITA parts; the procedure makes an exception to this criterion if only a single label is available in the image.


                           Fig. 3
                            shows a flowchart representation of the part of the algorithm for extraction of segments of the skeleton of the MTA.

When selecting the label with the highest average Gabor magnitude response as the next potential segment of the arcade being analyzed, the algorithm ensures that the distance between the ending point of the current label and the starting point of the next potential label is no more than 10 pixels. The algorithm checks the total length of the selected segments and how far they extend collectively, with respect to the horizontal size of the image, as the exit criteria; specific details are provided in the flowchart in Fig. 3.

The postprocessing steps after the selection of the segments of the skeleton of the MTA are stated below.
                              
                                 (a)
                                 Construct a binary image of the extracted arcade consisting of the selected labels in the previous stage.

Combine the extracted STA and ITA to obtain a binary image of the MTA (see Fig. 3).

It is possible that the extracted MTA skeleton consists of disconnected segments because of the removal of the branching points in the preprocessing stage. This design factor is advantageous to the measurement of width as explained in Section 5.

In the present work, the selected skeleton segments are analyzed in terms of their associated Gabor-angle information in order to determine whether each selected segment is approximately linear or not. If a segment is not linear, breaking points are determined to separate the given segment into a set of linear subsegments.

The first step in obtaining linear subsegments of each selected skeleton segment is to identify the pixels in the correct sequential order as follows:
                              
                                 (a)
                                 Locate the left-most end point of the current segment.

Start from the selected end point and sequentially move along the skeleton segment one pixel at a time in a 
                                       3
                                       ×
                                       3
                                    -pixel neighborhood.

Store the sequential position of each traversed pixel in the segment as well as its associated Gabor-angle response in vectorial format.

Repeat steps (b) and (c) until the right-most end point is reached.

In order to detect possible changes in the orientation of the extracted skeleton segments, the statistical measure of median absolute deviation (MAD) [54] was obtained in a window of length 7 pixels applied to the sequenced Gabor-angle response obtained in the previous step. Given a set of data points, M, 
                              MAD
                              =
                              median
                              [
                              |
                              M
                              −
                              median
                              (
                              M
                              )
                              |
                              ]
                           , where 
                              |
                              .
                              |
                            indicates the absolute value. The analysis was only performed on segments with a minimum length of 7 pixels. The steps involved in obtaining the MAD measure are:
                              
                                 (a)
                                 Obtain the MAD measure of the previously obtained Gabor-angle sequence.

Set all nonzero values in the MAD measure equal to unity.

All nonzero values in the MAD measure are set to be equal in order to avoid detection of local changes and emphasize the global variations in the orientation of the segment under analysis. Note that, given the angle increment of 
                              π
                              /
                              45
                           , due to the number of Gabor filters used (45), the MAD measure provides values of 0 or integral multiples of 
                              π
                              /
                              45
                           .

The obtained MAD measure needs to be analyzed further in order to detect any possible significant variations in the orientation of the segment being evaluated and subsequently any possible cutting points. The analysis is performed as follows:
                              
                                 (a)
                                 Obtain the forward and backward derivatives (d
                                    
                                       f
                                     and d
                                    
                                       b
                                    ) of the MAD measure.

Set values of 
                                       
                                          
                                             d
                                          
                                          
                                             f
                                          
                                       
                                       >
                                       0
                                     and 
                                       
                                          
                                             d
                                          
                                          
                                             b
                                          
                                       
                                       <
                                       0
                                     to 0.

Set 
                                       
                                          
                                             d
                                          
                                          
                                             combined
                                          
                                       
                                       =
                                       
                                          
                                             d
                                          
                                          
                                             f
                                          
                                       
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             b
                                          
                                       
                                    .

Analyze d
                                    
                                       combined
                                     based on possible patterns in the derivative values.

Determine the breaking points if any expected patterns are detected.

Break apart the segment only if any breaking point is determined.

Assume the entire segment to be linear if no breaking point is determined.

The forward and backward derivatives are combined to take advantage of the fact that a positive backward derivative value indicates the exact point of a positive change in the MAD measure; similarly, a negative forward derivative value indicates the exact point of a negative change in the MAD measure. Given a variation in the orientation of a segment, there are three possibilities and patterns to detect: (a) A change that starts and stops within a sequence, indicated by a leading positive and a trailing negative derivative. (b) A change that starts from the first pixel in a sequence and ends within it, indicated by only a negative derivative (no leading positive value). (c) A change that starts within a sequence, but does not end, indicated by only a positive derivative (no trailing negative value). Any one of these conditions indicates a possible cutting point on the segment under analysis. Any single index obtained from cases (b) and (c) was taken as a cutting point. The median point between the two indices obtained in case (a) was taken as a cutting point as well.

By the end of this step, each extracted MTA skeleton segment is either broken into piecewise linear subsegments or is considered to be a linear segment by itself.

In this work, Canny׳s edge detection method is used to detect initial edge-pixel candidates in the inverted green-channel of the original image. Canny׳s method detects edges by looking for local maxima in the gradient of the given gray-scale image. The gradient is obtained using the derivative of a Gaussian filter. The Canny method uses two threshold values to detect strong and weak edges. Pixels belonging to weak edges are included only if they are connected to strong edge pixels. As a result, the outcome of Canny׳s thresholding step is less prone to error due to noise as compared to other edge detection methods. However, given the low spatial resolution of the TROPIC images, the results of Canny׳s method provide vessel edges that are jagged and suffer from sampling errors. Considering the average width of vessels in pediatric cases of about 
                           90
                           
                           μ
                           m
                         
                        [7], the low spatial resolution of the TROPIC images, and small variations between normal and abnormal MTA width, it is crucial to detect and represent the vessel edges as accurately as possible and consequently obtain precise width measurements.

In order to represent vessel edges accurately, for every linear segment or subsegment of the extracted MTA, two separate sets of nearest edge pixels (in Canny׳s output) to each skeleton pixel on both sides were selected. Two first-order polynomials were fitted to the two sets of edge-pixel candidates in order to obtain accurate, continuous-form representations of the two edges as 
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           
                              
                                 X
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           +
                           
                              
                                 C
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                        , where the subscripts 
                           
                              
                                 e
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                         indicate edge lines 1 and 2, respectively, and the variables 
                           
                              
                                 m
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                         their corresponding slopes and y-intercepts. Such a continuous-form representation of vessel edges allows for subpixel measurement of MTA width.

In theory, the width of a vessel is defined as the distance along the normal to the skeleton between the two adjacent edges. Based on the Gabor-angle response, i.e., vessel orientation, the slope of the normal, n, at a given skeleton pixel, i, is obtained as 
                           
                              
                                 m
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           =
                           −
                           1
                           /
                           tan
                           [
                           ϕ
                           (
                           i
                           )
                           ]
                        , where 
                           ϕ
                           (
                           i
                           )
                         is the Gabor-angle response at the given skeleton pixel. The normal line is then obtained using the coordinates of the given skeleton pixel, 
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        , and its corresponding slope, as 
                           
                              
                                 Y
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              
                                 X
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           +
                           
                              
                                 C
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 C
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           =
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           −
                           (
                           
                              
                                 m
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                         is the y-intercept.

Given the continuous-form representation of the two edges (also in slope-and-y-intercept form) and the normal lines along a linear vessel segment/subsegment, it is possible to obtain the width at each skeleton pixel precisely as the theoretical definition of width based on the Euclidean distance between the two exact points of intersection between the normal line and each edge line. At a given skeleton pixel, i, the coordinates of the two points of intersection are defined as 
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           =
                           (
                           
                              
                                 C
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           −
                           
                              
                                 C
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           )
                           /
                           (
                           
                              
                                 m
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           −
                           
                              
                                 m
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           )
                         and 
                           
                              
                                 y
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           
                              
                                 x
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                           +
                           
                              
                                 C
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                              
                           
                        . The vessel width at the given pixel is computed as 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        .

@&#RESULTS@&#


                     Fig. 4
                      demonstrates the application of the proposed methods for measurement of the width of the MTA to a normal case from the TROPIC database. The procedure selects the skeletons of the STA and ITA separately as shown in parts (d)–(g) of the same figure. Even though both the extracted STA and ITA appear to be linear at first glance, it can be seen from the results in part (i) that the originally extracted arcades are, indeed, made of up of several linear segments and are not linear by themselves. The linear skeleton segments of the MTA [part (i)] and the vessel-edge image [part (j)] are used to obtain the interpolated edges and ultimately the width measurements of the STA and ITA as illustrated in parts (k)–(m) of the same figure.

On the average, it takes about seven seconds to obtain the width measurements for one image using the proposed methods on a Lenovo Thinkpad T510, equipped with an Intel Core i7 (Hyper-threaded-dual-core) 2.67-GHz processor, 8GB of DDR3 RAM, running 64-bit Windows 7 Professional, and using 64-bit MATLAB R2013a software.


                     Fig. 5
                      illustrates the application of the methods to a case diagnosed with plus disease. Visual comparison of the width lines illustrates that the MTA is thicker as compared to the normal case in Fig. 4; this observation is confirmed by the average MTA width measured for the two images (
                        101.2
                        
                        μ
                        m
                      for the normal case compared to 
                        146.8
                        
                        μ
                        m
                      for the plus case).


                     Fig. 6
                     (a) illustrates the steps used in statistical analysis of the Gabor-angle response in order to segment the extracted skeleton into linear parts as indicated in Section 2.3.2. The analysis is shown only for an extracted STA segment [part (b) of the same figure] corresponding to the image in Fig. 4. The resulting subsegments shown in part (c) are all considered to be linear. Note that the first/last two pixels in each resulting linear subsection are excluded from width measurement and are not shown in part (c) of the same figure.


                     Table 1
                      presents the statistics of MTA width measurements obtained for cases with and without plus disease in the TROPIC database. The average width of the MTA in the images that show signs of plus disease is about 
                        15
                        
                        μ
                        m
                      higher than the average width of the MTA in the normal cases. The median of the width measurements shows a larger difference between the two classes (about 
                        22
                        
                        μ
                        m
                     ); this is likely due to the fact that the median is less sensitive to the presence of outliers as compared to the mean. The differences between the mean and median MTA width measurements for all 91 normal images as compared to the mean and median measurements for the 19 images with plus disease were found to be statistically highly significant with 
                        p
                        =
                        0.002
                      and 0.001, respectively, using the t-test. A total of 13,878 width measurements were obtained over the 110 images, leading to 126 measurements per image on the average.

The MTA extraction algorithm failed to detect all or most of a half arcade (STA or ITA, but not both) in a total of seven images out of the 110 analyzed. This is mainly due to poor quality images and/or lack of contrast between vessels and the background. The arteriolar branch was not tracked in any instance. See Section 5 for more discussion on the quality of the TROPIC images.

The p-values indicating the statistical significance between the mean MTA width measurements for various stages of ROP, not including any case with plus disease, were obtained to test the hypothesis that there is a range of MTA width changes that occurs prior to the presence of plus disease [25]. The results are presented in Table 2
                     . The differences between the mean MTA width measurements of normal (stage 0, 
                        n
                        =
                        30
                     ), stage 
                        1
                        
                        (
                        n
                        =
                        30
                        )
                     , and stage 
                        2
                        
                        (
                        n
                        =
                        23
                        )
                      ROP cases as compared to stage 
                        3
                        
                        (
                        n
                        =
                        8
                        )
                      ROP were all found to be statistically highly significant 
                        (
                        p
                        <
                        0.01
                        )
                     .

It is common practice to obtain the most suitable sensitivity and specificity values using an ROC curve. The ROC curve provides the sensitivity and specificity of the diagnostic feature used by varying the threshold for classification and plotting the obtained sensitivity values against 1-specificity. The most suitable operating point is often taken as the point on the ROC curve that is closest to the point (0,1). Fig. 7
                      shows the ROC curve obtained using the mean MTA width measure as proposed in this work to distinguish between cases without and with plus disease. The mean and median width measurements obtained using the proposed methods both provided 
                        
                           
                              A
                           
                           
                              z
                           
                        
                        =
                        0.76
                     .


                     Table 3
                      presents comparative analysis of the results of studies in the literature that have performed CAD of plus disease using vessel width measurements in retinal images of preterm infants (see Section 1 for a review of the associated methodologies). It should be noted that the sensitivity and specificity values of other studies provided in Table 3 have been calculated using criteria and assumptions other than the common practice as defined in Section 3. The details of the results of each study are described in the following paragraphs.

Heneghan et al. [7] found the difference between the total average vessel width of cases without ROP as compared to cases that progressed to threshold ROP and required treatment to be statistically highly significant. Since distinguishing between venules and arterioles is a difficult task, Heneghan et al. combined the measurements from both arterioles and venules to obtain the average thickness values. The associated analysis was limited to an annular region between two circles of radii one and two ONHW centered at the center of the ONH. The methods required manual selection of two appropriate threshold values to be used for hysteresis thresholding, as well as manual selection of the vessel segments to be analyzed. The user was also required to correct manually the path indicating the vessel segment to be analyzed. The study did not indicate values of sensitivity and specificity using only the width measurements.

The study conducted by Wallace et al. [6] did not provide mean, STD, and p-values for the obtained measurements. The sensitivity and specificity values provided were based on a simple diagnostic decision-making criterion. Wallace et al. obtained measures of width for the standard image, and if an image had equal or greater width measures in at least two quadrants, the patient was diagnosed with plus disease. Their methods required manual correction and selection of the major vessel to be analyzed by the user. Wallace et al. did not provide an 
                        
                           
                              A
                           
                           
                              z
                           
                        
                      value.

The studies conducted by Gelman et al. [31,23], Koreen et al. [18], and Thyparampil et al. [32] used the software package RISA, as explained in Section 1. In all of the four studies, the center of the ONH was marked manually and the images were cropped to a circle centered at the center of the ONH with 
                        radius
                        =
                        2
                        ×
                        ONHW
                      as a preprocessing step. In studies where sensitivity and specificity are indicated in Table 3, the values were determined by finding the intersection point between the sensitivity and specificity curves, plotted separately as functions of the ratio of correctly identified vessels against the actual width measures. Note that such a measure does not classify the image, but classifies each single vessel. A drawback of RISA is that it requires the vessel segment to be analyzed to have at least one branching point. RISA requires manual correction of the detected branching points, as well as manual input regarding which vessels are to be analyzed and whether they are arterioles or venules. RISA provides a single estimated mean value for each selected segment of a vessel and not a width measure at each pixel on the vessel segment. Such computation of width does not allow for analysis of the associated statistics of the width of a vessel segment over its entire length. In all of the four studies, median values of mean width measures were used to compare the results in terms of statistical significance between the two classes.

@&#DISCUSSION@&#

We have presented methods for the detection, extraction, and measurement of the width of the MTA in retinal fundus images of preterm infants. The results indicate that there is a statistically highly significant difference between the MTA width of cases without plus disease as compared to those with plus disease. The obtained width measure shows good accuracy in CAD of plus disease with 
                        
                           
                              A
                           
                           
                              z
                           
                        
                        =
                        0.76
                     .

Retinal images of preterm infants vary substantially in terms of pigmentation, contrast, and quality. Many of the studies that have dealt with measurement of vessel dilation in ROP have selected only images with high quality and contrast, and hence have limited the number of available cases used in their analysis. In this work, we have used one of the largest sets of preterm retinal fundus images in the literature for such a study, which is not limited to only images with high quality and contrast. Fig. 8
                      shows examples of images from the TROPIC database illustrating a wide range of pigmentation, vessel-to-background contrast, and overall quality (sharpness). Our methods are robust and work well in the presence of large variations in the characteristics of the images used, as demonstrated by the results, which show a statistically highly significant difference in the width of the MTA between the two classes and good accuracy in the detection of plus disease. However, as can be seen in parts (e)–(h) of Fig. 8, image artifacts and low quality can cause the proposed algorithm either to miss parts of an arcade, or not detect vessel edges properly. Although such inaccuracies are not common or severe in the present study (see Section 3), methods need to be developed to address such challenges because, in real-world applications, it may not be possible to obtain only high-quality and sharp pediatric retinal fundus images. It would be of interest to test the present methods with more images, including more cases with plus disease, as well as against combined diagnosis of the same set of images by multiple experts.

The thresholding step has an effect on the skeleton selection step. The wide range of pigmentation and contrast that exists in retinal images of preterm infants could cause the thresholding step not to provide the best possible results as shown in parts (e) and (f) of Fig. 8. Analysis of various automatic thresholding methods and their combinations may lead to more suitable methods for this purpose [53].

In case there are local variations in the illumination or brightness of an image, by dividing the image into its superior and inferior parts and normalizing each image separately as done in the present work, it can be expected that both the STA and ITA will have the highest intensity values in their respective Gabor-magnitude-response images. Furthermore, in case the average intensity values of the two half-arcades are not close to each other, they will not affect each other when choosing an appropriate threshold.

The 
                        
                           
                              A
                           
                           
                              z
                           
                        
                      values obtained in various studies as listed in Table 3 are within a relatively small range 
                        (
                        0.76
                        –
                        0.82
                        )
                     . It is questionable whether such small differences 
                        (
                        maximum
                        =
                        0.06
                        )
                      are statistically significant. The proposed methods in this paper work as well as the state-of-the-art methods available in the literature without the need for user correction of the results and discrimination in selection of images to be analyzed based on quality, which all of the other mentioned methods require.

Except for the step requiring the location of the center of the ONH, the proposed methods are automated. In the future, the method of Rangayyan et al. [49], which performs phase portrait analysis of the Gaborangle information, will be adapted for pediatric retinal fundus images to detect automatically the center of the ONH, which will make the entire procedure of vessel width measurement fully automated.

The design factor to segment the extracted MTA into linear subsegments is especially advantageous in case of vessel edge interpolation. When interpolating data points, it is of importance to know the order of the required fit. MTA skeleton segments can vary from being linear to highly tortuous. Given a skeleton segment with varying orientation, or lack thereof, and consequently the same mirrored orientation in the corresponding vessel edges, it is not appropriate to use a single order for interpolation of all vessel edges, as done in previous studies [33]. By breaking a given skeleton segment into linear parts, it is expected that the edges of the resulting vessel subsegments are also linear; hence, the order of the fit used to interpolate the two vessel edges can always be set to unity.

The methods that use the center-line of a vessel in order to determine its width require the center-line to be precisely in the middle of the vessel, which is arguably improbable when using automated image processing techniques, and challenging even when manually drafting the center-line. The use of the skeleton of the vessel being analyzed, which does not need to be positioned at the exact center of the vessel, obviates the difficulties associated with the detection and use of the center-line. The use of the Gabor-angle response to determine the slope of the normal, and consequently compute vessel width measures, is advantageous since the Gabor-angle response provides the dominant orientation of a vessel at a given point, which does not need to be at the center of a vessel.

The design factor of the proposed algorithm that removes parts of the MTA at branching points may, at first, seem disadvantageous as it results in slightly fewer points on the MTA for width measurement; however, measuring the width of a vessel at branching points could lead to errors since such measures may not represent the width of a single branch but instead larger regions that include parts belonging to both branches of the vessel. Our design factor helps to reduce such errors in measurement of the width of the MTA.

If higher resolution and quality retinal fundus images are provided, we expect the proposed methods to work accurately, since the only shortcomings of the methods arise from poor image quality and contrast, which can affect the vessel segmentation and edge detection steps.

The average width measurements provided by Heneghan et al. [7] were obtained over all branches of venular and arteriolar vessels on the nasal side as well as the temporal side. The present study provides average width measurements over only the thickest branch (no child branches) of the temporal–venular vessel, which is expected to be, on the average, thicker than the average width of both venules and arterioles combined; this point is confirmed by the larger measurements provided in Table 1 as compared to the results of Heneghan et al.

The difference between the median widths of cases with and without plus disease was found to be less than one pixel in the present work, which is comparable to the median differences found in the work of Gelman et al. [31,23] and the mean differences provided by Heneghan et al. [7].

The range of changes in the width of retinal vessels that is observed in later stages of ROP prior to the presence of plus disease is designated as preplus [25]. Based on this observation, it can be expected that an increase in vessel width should be observed as the ROP stage progresses prior to the diagnosis of plus disease. Indeed, as indicated in Table 2, the differences in vessel width between stages 0 and 3 ROP, stages 1 and 3 ROP, and stages 2 and 3 ROP were found to be statistically highly significant, when excluding cases with plus disease. It would be of interest to test this observation further and strengthen the statistical analysis using more cases that show no signs of plus disease.

Most of the other available studies in the literature have quantified the changes in the width of both the MTA and the MNA in the presence of plus disease. It would be of interest to verify if the width of the MNA on its own shows significant changes in the presence of plus disease using the proposed methods.

Since the retina and its vasculature are not fully developed in preterm infants, it would be of interest to verify if there are any correlations between the gestational age and birth weight of the infants and the MTA width.

Methods for measurement of retinal vessel thickness have evolved from the use of manually operated devices on photographs [55] to sophisticated computer methods for various clinical and research applications. Using projection micrometry, Kristinsson et al. [13] showed that the differences in the width of retinal vessels of normal cases as compared to cases with diabetic macular edema are statistically highly significant. Given the center-line of the vessels in a retinal image, Lowell et al. [34] estimated the cross-section of the intensity profile of the vessels using a Gaussian model. Niemeijer et al. [11] detected retinal vessels using likelihood estimation of vessel presence based on the outputs of multiscale Gaussian filters and a k-nearest-neighbor classifier in high-resolution images of the retina. However, they noted that their method fails for low-contrast and narrow vessels. More recently, specialized algorithms have been developed for the analysis of the ratio of arteriolar to venular width [12], analysis of temporal variation of vessel width in video images [56], and measurement of vessel width in hand-drawn binary maps of retinal vasculature [57]. The methods referred to in the present paragraph may not be applicable to retinal fundus images of preterm infants due the associated low quality and poorly developed nature of the vessels.

@&#CONCLUSION@&#

Measures of vessel width using the proposed methods could be useful in CAD and clinical management of plus disease and ROP. Inclusion of additional measures related to the overall shape of the MTA [26] and tortuosity [58] should lead to better diagnostic performance than that obtained in the present work. Further work is in progress along these directions.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the Natural Sciences and Engineering Research Council of Canada. We thank Dr. Eliana Silva de Almeida for help with statistical analysis and April Ingram for help with the TROPIC images.

@&#REFERENCES@&#

