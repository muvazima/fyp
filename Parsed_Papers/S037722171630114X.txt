@&#MAIN-TITLE@&#Local matching of flexible load in smart grids

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a model of flexible loads and renewable supply in the smart grid.


                        
                        
                           
                           Supply and demand are matched locally via an incentive compatible online mechanism.


                        
                        
                           
                           Demand flexibility reduces payments and increases allocation probability.


                        
                        
                           
                           Increasing demand flexibility will increase suppliers profits.


                        
                        
                           
                           The cost of establishing incentive compatibility is decreasing in flexibility.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Smart grid

Load flexibility

Online mechanism design

@&#ABSTRACT@&#


               
               
                  Today’s power systems are experiencing a transition from primarily fossil fuel based generation toward greater shares of renewable energy sources. It becomes increasingly costly to manage the resulting uncertainty and variability in power system operations solely through flexible generation assets. Incorporating demand side flexibility through appropriately designed incentive structures can add an additional lever to balance demand and supply. Based on a supply model using empirical wind generation data and a discrete model of flexible demand with temporal constraints, we design and evaluate a local online market mechanism for matching flexible load and uncertain supply. Under this mechanism, truthful reporting of flexibility is a dominant strategy for consumers reducing payments and increasing the likelihood of allocation. Suppliers, during periods of scarce supply, benefit from elevated critical-value payments as a result of flexibility-induced competition on the demand side. We find that, for a wide range of the key parameters (supply capacity, flexibility level), the cost of ensuring incentive compatibility in a smart grid market, relative to the welfare-optimal matching, is relatively small. This suggests that local matching of demand and supply can be organized in a decentral manner in the presence of a sufficiently flexible demand side. Extending the stylized demand model to include complementary demand structures, we demonstrate that decentral matching induces only minor efficiency losses if demand is sufficiently flexible. Furthermore, by accounting for physical grid limitations we show that flexibility and grid capacity exhibit complementary characteristics.
               
            

@&#INTRODUCTION@&#

Today’s energy system is experiencing a transition from mainly fossil-fueled power generation toward greater shares of renewable energy sources (RES). While these new energy sources are clean and have quasi-zero marginal cost, they are highly fluctuating and feature a lower energy density than fossil fuels. This challenges conventional wisdom in power system planning: the future system topology will be much more decentralized with significant generation capacities being located on the distribution grid level. Furthermore, system operators need to be able to cope with much higher variability levels on the supply side. Recent experiences in power systems around the world suggest that traditional procedures will have to be adapted in light of these new challenges. For example, Subramanian, Garcia, Callaway, Poolla, and Varaiya (2013) note, that “the current operating paradigm […] works at modest penetration levels, but fails when 30 percent or more of total energy generation comes from renewables.” This observation is shared by the IEA (2014) who posit to reach renewable generation shares beyond 30 percent will “require a transformation of the system.” Similar observations were made in Germany where the share of power generation from renewables increased between 2009 and 2013 from 15.9 percent to 23.4 percent. However, over the same period the number of days with exceptional RES shedding events in Germany’s northeastern transmission grid increased from 4 to 142—what used to be a rare event has become the norm.
                        1
                     
                     
                        1
                        Sources: www.50hertz.com/en/file/50Hertz-Almanac-2012-EN.pdf, www.bdew.de.
                     
                  

Acknowledging the central role of the underlying stochastic dynamics of RES generation, Varaiya, Wu, and Bialek (2011) claim that power grid operations will need to fundamentally change in a similar manner as the manufacturing industry did when it adopted IT-based just-in-time supply chain management. IEA (2014) underline the superior cost benefit performance of demand side integration compared to other flexibility options. The research on demand side management (DSM) so far is generally based on variable, yet pre-announced, electricity prices. This resonates well with traditional forward power markets for conventional generators, but seems ill-suited to describe a RES-dominated power system which is characterized by quasi-zero marginal cost supply and limited reliability. A possible remedy is the introduction of quality differentiation with respect to reliability and adopt value-based pricing. Then, payments and realization of energy delivery are not specified a priori, instead arising endogenously from heterogeneous customer valuations and flexibility endowments. From a market design perspective, establishing such a quality-differentiated market requires the explicit consideration of incentive-compatibility with respect to load flexibility.

We consider a smart microgrid with distributed generation (Chen, Duan, Cai, Liu, & Hu, 2011). However, instead of optimally determining a central dispatch plan for flexible loads, we seek to establish a dynamic, decentral economic coordination approach. To this end, we consider a local market for direct and instant matching of flexible loads with volatile generation. We envision this market platform as a parallel, secondary marketplace for excess RES generation which can no longer be integrated into the primary wholesale market at reasonable costs. Consequently, demand side applications can choose which market to engage in, and highly flexible, non-mission-critical demand may be attracted by lower costs on the microgrid’s flexibility market. Alternatively, this may be interpreted as an additional quality-differentiated tariff offer by existing suppliers.

Similar to Bitar and Low (2012), we apply a generic model to explore the general implications of such a secondary marketplace with differentiated service quality. Unlike most prior research, we do not make a distinction between shiftable and sheddable loads but consider demand flexibility on a job level. This means that individual jobs have freedom with respect to their execution time (shifting characteristic) and furthermore may not be executed at all (shedding characteristic). We complement this micro-founded demand model by an online mechanism which yields truthful revelation of jobs’ preferences with respect to both value and temporal flexibility. Furthermore, the proposed mechanism is weakly budget-balanced under the mild assumption of homogeneous reservation prices on the supply side. Our analysis provides a quantitative assessment of the potentials to match renewable generation to a flexible demand side in a decentral smart grid.

@&#RELATED WORK@&#

The work at hand addresses decentral coordination of flexible loads to balance increasing levels of generation uncertainty in the power system. Recently, demand side management and flexible loads have attracted increased research activity both from a technical as well as an economic perspective. Besides these directly related research fields, this paper relates to the theory on (online) mechanism design and formal modeling of operational flexibility.

The smart grid is set to improve energy efficiency and to increase engagement of so far passive consumers (Farhangi, 2010). It aims toward establishing decentralized control and develop a robust infrastructure for a sustainable power system. At the same time, it should help to reduce over-investment into additional generation and transmission capacity, guaranteeing higher cost-efficiency (Joskow, 2012). The smart grid is based on ubiquitous information and communication technology as well as advanced metering and monitoring systems. Information is thus the backbone of the smart grid whereas automation activates the distribution network and taps into currently dormant flexibility potentials on the demand side. Ramchurn, Vytelingum, Rogers, and Jennings (2012) argue that one main objective of future smart grids is the mitigation of uncertainty arising from fluctuating generation by means of flexible loads. The umbrella terms demand side management and demand response summarize a variety of approaches to leverage demand flexibility potentials (see Palensky & Dietrich, 2011). Generally speaking, DSM aims to adapt current consumption to current generation. The notion of “energy services” is central in this context: Schweppe, Daryanian, and Tabors (1989) note, “[that] an end use device uses electric energy to provide a service to the customer.” This differentiated view on electricity consumption paves the way for DSM approaches that adapt energy consumption to external signals such as availability of renewable generation, prices, system frequency or even temperature (Albadi & El-Saadany, 2008). As of today, DSM implementations in practice are mostly limited to direct load control for industrial customers, heating control (night setback) and time-of-use rate structures (Wang, Kennedy, & Kirtley, 2010b). Going forward, smart homes and electric vehicle charging may emerge as novel flexible load types (Hu, Weir, & Wu, 2012; Ramchurn et al., 2012). The emergence of these new flexibility potentials will also foster the the notion of quality-of-service (QoS) in power markets in lieu of more traditional DSM categorizations like “shifting” or “shedding”: Retail electricity will no longer be a homogeneous good but will rather be differentiated with respect to reliability, delivery time or power quality (Faruqui, Hledik, & Sergici, 2010; Woo et al., 2014). This is underlined by Petersen, Edlund, Hansen, Bendtsen, and Stoustrup (2013) who complement prior research by introducing a rigorous classification approach for different forms of load flexibility.

Leveraging the potentials of flexible loads requires active dispatch of these assets. To this end, scheduling approaches for flexible loads have attracted significant research activity. Parvania and Fotuhi-Firuzabad (2010) schedule flexible loads as well as decentral generation assets to minimize wholesale electricity costs. Using a mixed-integer programming framework, Sou, Weimer, Sandberg, and Johansson (2011) determine cost-minimizing power profiles which satisfy complex constraints such as non-interruptible and sequential operations. Relying on different scheduling routines, Subramanian et al. (2013) show that efficient demand side coordination can already be achieved with modest load flexibility endowments. Scott, Thiébaux, Briel, and Hentenryck (2013) present a comprehensive framework for scheduling different flexible loads in the presence of multiple uncertainty sources. Similarly, intelligent scheduling of combined heat and power plant (CHP) fleets (Bosman, Bakker, Molderink, Hurink, & Smit, 2012; Fink & Hurink, 2015) and decentral optimization of integrated building energy systems (Hu et al., 2012) have been proposed to leverage demand-side flexibility in the smart grid. Recognizing the central connection of generation uncertainty and load deference, Papavasiliou and Oren (2014) develop solution techniques for large scale stochastic unit commitment problems in the presence of flexible loads.

The above presented research contributions confirm the value of flexible loads in the presence of fluctuating generation. Yet, due to the distributed nature of smart grid systems, the optimal dispatch as determined by a central scheduler cannot be directly implemented in practice. This is because the information required to determine the schedule (i.e. willingness-to-pay and flexibility endowments) are private information of individual system participants. Therefore, these inputs are not directly available to a central dispatcher but rather need to be elicited from the distributed agents. Price-based DSM programs facilitate a decentralized decision paradigm by directly incentivizing customer behavior changes (Albadi & El-Saadany, 2008). Purely price-based coordination (without feedback) typically cannot internalize hard operational constraints (Wang, Kennedy, & Kirtley, 2010a). A typical phenomenon is the occurrence of new load spikes due to herding effects (Ramchurn et al., 2012). Using simultaneous bidding over a complete planning horizon, Mohsenian-Rad, Wong, Jatskevich, Schober, and Leon-Garcia (2010) show that competing distributed agents can converge to an optimal schedule in a distributed fashion. However, this solution approach relies on full information over the set of all activities that will arise. Furthermore, every task needs to be scheduled, i.e. there is no consideration of quality-of-service differentiation. The combination of job admittance decisions, online decision-making and incentive-compatible pricing and allocation rules leads to the literature on online mechanism design: Friedman and Parkes (2003) outline the design challenges of such mechanisms and establishes the central assumptions like limited misreports. Gerding et al. (2011) apply this technique to the smart grid context addressing the coordination of plug-in hybrid vehicle charging decisions. They develop a model-free online mechanism for perishable goods in a setting with multi-unit demand with decreasing marginal valuation in a discrete time setting. Focusing on non-decreasing valuations, Stein, Gerding, Robu, and Jennings (2012) introduce the concept of pre-commitment in combination with model-based online scheduling techniques to create an online mechanism for coordination of charging requests of pure electric vehicles. Ströhle, Gerding, de Weerdt, Stein, and Robu (2014) use a similar framework to schedule non-preemptive jobs under uncertain supply. Their work is most closely related to the work at hand. However, while they rely on a rigid discrete time setting with a complex job structure, we focus on a truly continuous time setting under a simpler unit demand model.

Besides the literature on smart grids and online mechanism design, our work also connects to the literature on operational flexibility. In their seminal paper, Jordan and Graves (1995) already demonstrated that limited flexibility endowments can typically accrue a large share of maximal benefits achievable under full flexibility, i.e., complete bipartite graphs. Borenstein (2000) presents precedence constraints and corresponding process flexibility in the manufacturing domain via directed acyclic graphs, enabling efficient representation of routing flexibility at various levels of detail. Kranton and Minehart (2001) focus on issues in strategic network formation. They use bipartite graphs to model trade relationships. The more links an agent establishes, the more flexible he becomes in his sourcing decisions. Chou, Chua, and Teo (2010) highlight the importance of separating between range and response in process flexibility, modeled via bipartite graphs. They conclude that in most cases improving response, i.e., the rate at which a system is capable of reacting to change, is more valuable than improving range, “the extent to which a system can adapt”.

We consider a market mechanism for continuous matching of discrete supply and demand jobs in microgrids. Consequently, participants on both market sides are situated within spatial proximity of each other. Continuous matching, in contrast to fixed clearing intervals, fosters liquidity and efficiency on geographically bounded markets.

The presented marketplace aims to market uncertain excess quantities of local renewable energy output to flexible demand. We seek to establish a minimal characterization of the load flexibility product effectively constituting a flexibility commodity. Such commoditization can facilitate greater market participation. In general, electricity markets can be categorized according to their contracting time frame, geographical area, and market organization. Using the taxonomy presented by Ramos Gutierrez, De Jonghe, Six, and Belmans (2013), the market (mechanism) is situated on the intraday market without leadtimes in a restricted geographical area. The way the market decides on allocation is closely related to the generalized assignment problem, which (in contrast to the ordinary assignment problem) allows for unused supply and unserved demand to be discarded. Our primary contribution lies in solving this problem online and in the presence of strategic agents/ jobs on the demand side. Furthermore, we illustrate how the mechanism can be adapted to account for multi-unit demand and grid constraints.

In power markets with large shares of renewable generation capacity, market design may allow trading uncertain quantities of renewable generation on the regular market at a discounted price (due to its inherent unreliability). Alternatively, only a secure equivalent of the uncertain generation can be traded on the regular market, with excess quantities being shed or traded on specialized, complementary market venues. Our market mechanism serves as such a complementary market for energy available on short notice, where ad-hoc availability reflects local RES intermittency. Under traditional market rules this excess will be shed (Botterud, Wang, Monteiro, & Miranda, 2009) which reduces social welfare. Under the proposed market mechanism, however, excess renewable generation can be used to serve flexible demand waiting in a queue. This contrasts with related literature, where load is considered as an inflexible constraint and sophisticated RES forecasting is used to reduce uncertainty in unit commitment problems, while conventional generation is providing the sole source of flexibility. As local RES forecasting is highly uncertain, we focus on establishing incentives for the demand side to attract large amounts of rather inexpensive flexibility for local supply–demand matching. While such a market for commoditized load flexibility cannot replace traditional reserve markets, it should limit their usage.

Our demand model follows the canonical demand model used in the online mechanism design literature (Nisan, Roughgarden, Tardos, & Vazirani, 2007). Each job has a type θ which consists of the job value v, its arrival time a and the job-inherent temporal flexibility f. Furthermore, jobs are assumed to be of homogeneous size with each job requiring one unit of energy to be successfully completed.
                           2
                        
                        
                           2
                           The unit size assumption is relaxed in Section 6.1.1.
                         Jobs arrive at time a and remain available until their latest start date 
                           
                              a
                              +
                              f
                           
                        . Formally, we represent jobs through tuples 
                           
                              θ
                              =
                              〈
                              v
                              ,
                              a
                              ,
                              f
                              〉
                           
                        . The formulation of demand in discrete jobs is motivated by the idea of energy services (Schweppe et al., 1989): a consumer usually has limited information about the quantity of electrical energy consumed by a certain job, but she might be able to quantify utility she receives from a particular service that consumes electrical energy as its input. Additionally, the user may not be concerned when exactly a service is performed (in an unusable intermediate state) but when the service’s end product becomes available.

While this model is highly generic and cannot capture the peculiarities of quantities demanded, it lends itself to tractable analysis. Moreover, the generality of the model allows diverse demand such as energy storage, data centers, HVAC, agricultural pumping or others to be described within this model. Naturally, individual agents may require specific decision support to map their flexibility endowments into the bidding space (Liang & Huang, 2000; Reeves, Wellman, MacKie-Mason, & Osepayshvili, 2005). Again we want to reiterate the idea of commoditization which does not allow for highly differentiated market products accounting for heterogeneous ramping rates or availability agreements. Such custom contract items would still require OTC trading agreements.

For simplicity, it is assumed that the user’s utility from a service is independent of when the service is provisioned, provided it is before the end of the job’s deadline. Formally, if the job is allocated and thus matched between arrival and departure (ai
                         ≤ mi
                         ≤ di
                        ), resulting net utility is the difference between valuation and payment, i.e., 
                           
                              
                                 u
                                 i
                              
                              
                                 (
                                 
                                    m
                                    i
                                 
                                 )
                              
                              =
                              
                                 v
                                 i
                              
                              −
                              
                                 p
                                 i
                              
                              ,
                           
                         and zero otherwise.

In our supply model, offers are modeled as discrete energy “packets” of unit size matching the unitary energy demands of the jobs on the demand side. Supply jobs (offers) remain available in the supply queue only for a very limited timespan before they are matched or discarded (shed). We denote the period during which the supply jobs are available for matching with α, and set it to a constant value for all supply jobs. We instantiate our generic supply model with 2012 generation data from the Sotavento wind farm in Spain (cf. López et al., 2002). For the purpose of the discrete job model, we derive the arrival of supply jobs from hourly mean generation data g(t). We normalize generation data using the installed capacity C of the wind park, which we assume to equal the maximum mean hourly generation observed throughout the year, i.e. 
                           
                              C
                              =
                              
                                 max
                                 t
                              
                              
                                 (
                                 g
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                           
                        . Cumulated over time, the resulting utilization level of the wind park 
                           
                              
                                 g
                                 ′
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              g
                              
                                 (
                                 t
                                 )
                              
                              /
                              C
                           
                         forms a continuous, non-decreasing function G, defined in (1). For notational brevity we apply a linear interpolation.

                           
                              (1)
                              
                                 
                                    G
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          {
                                          
                                             t
                                             0
                                          
                                          ,
                                          .
                                          .
                                          ,
                                          
                                             ⌊
                                             t
                                             ⌋
                                          
                                          }
                                       
                                    
                                    
                                       g
                                       ′
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    +
                                    
                                       
                                          t
                                          −
                                          ⌊
                                          t
                                          ⌋
                                       
                                       
                                          ⌈
                                          t
                                          ⌉
                                          −
                                          ⌊
                                          t
                                          ⌋
                                       
                                    
                                    ·
                                    
                                       g
                                       ′
                                    
                                    
                                       (
                                       
                                          ⌊
                                          t
                                          ⌋
                                       
                                       )
                                    
                                 
                              
                           
                        The function G describes capacity-normalized generated energy in the period [t
                        0, t]. Different scaling factors regarding the supply side (i.e., installed capacities) are captured by the factor β. The arrival time of supply job k is then defined by the inverse function of G, in (2).

                           
                              (2)
                              
                                 
                                    
                                       a
                                       k
                                    
                                    =
                                    
                                       1
                                       β
                                    
                                    
                                       G
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                           
                        Parameter β is chosen such that total quantities demanded and supplied balance each other in the long run.
                           3
                        
                        
                           3
                           The capacity factor of the Sotavento wind farm in 2012 was approximately 20 percent, i.e., 
                                 
                                    β
                                    =
                                    5
                                 
                              .
                        
Based on empirical (hourly) measurements of wind speed and corresponding turbine output, we construct the arrival times of supply jobs. Intuitively, inter-arrival time of supply jobs is decreasing in wind speed. The generic supply model and the derivation of jobs’ arrival times easily generalize to other fluctuating power sources.

Having modeled the flexible demand side as well as the (renewable) supply side, we now turn to their economic interaction. Clearly, electrical flows are governed by the laws of physics and any economic mechanism needs to account for this. This especially means that once active in the grid, a load cannot be “shut out” or prioritized. This basic property precludes quality-of-service differentiation in a standard power grid. Our research addresses the special setting where a certain demand class (flexible loads engaged in a corresponding market segment) cannot directly draw from the grid but rather need to be authorized by the market platform before. This necessitates intelligent periphery in the smart grid environment (Bakken et al., 2011). If a waiting job j is assigned a unit of supply, j is considered served and both, the corresponding supply order and j are discarded from the system. Therefore, we do not consider demand that requires immediate service but rather excess demand that can be shed by the system operator. Unlike standard load interruption programs, such discarded demand arises endogenously from valuations and flexibility endowments. This setting offers a lever to more efficiently balance supply and demand. Clearly, this presents a major departure from conventional procedures in power systems operations. However, we argue that the ongoing radical changes to the system structure necessitate radical changes of operational paradigms.

By adopting the scenario outlined above we can apply the graph-theoretic approaches described in Section 2.4 to model economic matching of load flexibility in smart microgrids. We encode demand jobs and supply availability as nodes in a bipartite graphs. The presence of edges between supply and demand nodes indicates temporal overlap, i.e., possible assignments. Naturally, this representation is only valid to sharpen the economic intuition—these 1:1 assignments do not exist at the physical level. This way the technical smart grid environment is augmented by an economic layer (Shafie-khah & Catalão, 2015). The goal of maximizing social welfare (difference between valuations and cost) is equivalent to finding the maximal weighted matching, where weights represent marginal contribution to social welfare from the corresponding assignment. The task is complicated by the graph being successively revealed over time (online), and possibly being strategically misreported (valuation, edges). Starting from an offline formulation using full information, we address both challenges in the next section.

The goal of any dispatch lies in identifying welfare-maximizing assignments. While off-the-shelf solutions are available for the offline case of full information, partial information on the graph in an online setting and strategic misreporting by self-interested agents (mechanism design) add interesting facets to the problem.

In power systems, continuously retaining the balance of supply and demand and providing near-constant power quality (w.r.t. frequency and voltage) constrains the decision space available to any coordinating instance. As the contribution of RES to total generation grows larger, keeping the necessary conventional spinning reserve capacities online to react to its unexpected fluctuations becomes an increasingly costly effort (Bitar, Rajagopal, Khargonekar, Poolla, & Varaiya, 2012). Therefore, we develop an incentive-based approach that focuses on the demand side. This may foster demand side flexibility which in turn reduces the cost of power system operations through improved integration of RES.

A clairvoyant (offline) optimal central dispatch serves as an offline benchmark that, given true information about consumers’ preferences and suppliers’ costs, computes welfare-maximizing allocations. For the online case we present a greedy model-free online central dispatch. However, such allocation designs suffer from incentive problems (Sioshansi, Oren, & O’Neill, 2008) which we address through online mechanism design (Parkes, 2007). All three approaches ensure continuously balanced supply and demand. To this end, unmatched supply jobs are discarded from the system at the end of their availability period d. Furthermore, we assume that consumption rates of matched jobs are similar in a sense that individual disparities will not cause imbalances in the system during physical settlement.

Solving the NP-hard generalized assignment problem (Roth and Sotomayor, 1992, Chap. 8) yields the maximum social welfare if types θ are not misreported and there is access to perfect knowledge. It thus constitutes an intuitive benchmark for alternative allocation procedures that might operate online or take incentives into account. Technically, our formulation deviates from standard formulation of the GAP as not every job on either side is compatible with all jobs on the opposite side, i.e., some jobs do not overlap temporally.

                           
                              (3)
                              
                                 
                                    
                                       max
                                       
                                          x
                                          
                                             a
                                             b
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          B
                                       
                                    
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       (
                                       
                                          v
                                          b
                                       
                                       −
                                       
                                          v
                                          a
                                       
                                       )
                                    
                                    ·
                                    
                                       x
                                       
                                          a
                                          b
                                       
                                    
                                 
                              
                           
                        The objective in (3) is to maximize social welfare by selecting feasible matches between supply offers a ∈ A and demand requests b ∈ B. The decision variables xab
                         indicate whether supply job a and demand job b are matched. This optimization is subject to the following constraints:

                           
                              (4)
                              
                                 
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          B
                                       
                                    
                                    
                                       x
                                       
                                          a
                                          b
                                       
                                    
                                    ≤
                                    1
                                    
                                    ∀
                                    a
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       x
                                       
                                          a
                                          b
                                       
                                    
                                    ≤
                                    1
                                    
                                    ∀
                                    b
                                    ∈
                                    B
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       x
                                       
                                          a
                                          b
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    ∀
                                    a
                                    ∈
                                    A
                                    ,
                                    
                                    ∀
                                    b
                                    ∈
                                    B
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       r
                                       b
                                    
                                    ≤
                                    
                                       r
                                       a
                                    
                                    ≤
                                    
                                       d
                                       b
                                    
                                    ∨
                                    
                                       r
                                       b
                                    
                                    ≤
                                    
                                       d
                                       a
                                    
                                    ≤
                                    
                                       d
                                       b
                                    
                                 
                              
                           
                        
                     

Each request and offer can only be matched once at most (Eqs. (4)–(6)). Constraint (7) ensures that allocation takes place only between those requests and offers that have some overlap in time. In contrast to the ordinary assignment problem with balanced market sides, formulation as a generalized assignment problem allows a different numbers of jobs to be present on either market side. We use Gurobi 5.6 to solve these optimization problems.

Leaving the benchmark case behind, we are primarily interested in how well the generalized (flexibility) assignment problem can be solved in an online setting, i.e., under uncertainty regarding future arrivals of supply and demand jobs. For ease of exposition, we restrict ourselves to the model-free case without information on future arrivals of demand and generation. This is motivated by the choice of a small, local market scenario, where forecasting capabilities cannot leverage pooling and aggregation benefits and hence will be somewhat limited with respect to forecast quality.
                           4
                        
                        
                           4
                           
                              Monteiro et al. (2009) provide an extensive review of current wind power forecasting approaches and their capabilities.
                        
                     

In contrast to the offline optimal central dispatch, the online central dispatch has no information on future jobs (release, due date, valuation). Therefore, a heuristic matching approach is required. In order to utilize as much information as possible, supply and demand jobs are matched at the end of their respective active period, i.e., at the point in time when uncertainty is minimal while making decisions is still possible (see Fig. 1
                        ). In our case of unit quantities, this reduces to checking whether a job is available on the other side of the order book on the considered job’s due date.

When job j reaches its deadline 
                           
                              
                                 d
                                 j
                              
                              =
                              t
                              ,
                           
                         
                        virtual market clearing of all currently available jobs, formally expressed as 
                           
                              Ψ
                              =
                              {
                              j
                              |
                              j
                              ∈
                              A
                              ∪
                              B
                              ∧
                              
                                 j
                                 a
                              
                              ≤
                              t
                              ≤
                              
                                 j
                                 d
                              
                              ∧
                              
                                 j
                                 m
                              
                              =
                              ∅
                              }
                              ,
                           
                         is performed. To this end, first matching of a greedy (with respect to valuation) double auction is performed. If j is allocated in this virtual market clearing at the current time t, i.e., 
                           
                              
                                 j
                                 m
                              
                              =
                              t
                              ,
                           
                         it is effectively allocated and removed from Ψ.

If matching is not immediately possible, jobs are enqueued and either assigned at some later point in their active period or, in case of too fierce a competition on the respective side of the market, eventually discarded without assignment. Allocation and pricing decisions take place at two distinct points in time, i.e., payments are determined only at the end of the active period of the respective demand job (similar to Friedman & Parkes, 2003), while allocation decisions are made until the latest possible start date of the job. Formally, the assignment decisions on either side of the order book are given by

                           
                              
                                 
                                    a
                                    
                                       (
                                       
                                          b
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   arg
                                                   
                                                      min
                                                      
                                                         a
                                                         ∈
                                                         A
                                                         (
                                                         
                                                            b
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         v
                                                         a
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      v
                                                      a
                                                   
                                                   <
                                                   
                                                      v
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∅
                                             
                                             
                                                
                                                   e
                                                   l
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    b
                                    
                                       (
                                       
                                          a
                                          j
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   arg
                                                   
                                                      max
                                                      
                                                         b
                                                         ∈
                                                         B
                                                         (
                                                         
                                                            a
                                                            j
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         v
                                                         b
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      v
                                                      a
                                                   
                                                   <
                                                   
                                                      v
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∅
                                             
                                             
                                                
                                                   e
                                                   l
                                                   s
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where A(bi
                        ) is the set of supply jobs active on the release of demand job bi
                         and B(aj
                        ) is the set of demand requests active on release of supply request aj
                        . In case of equal valuations v, tie breaking is employed such that jobs with later deadlines, earlier arriving jobs and higher valued jobs receive preferential treatment. Under this greedy allocation rule, we can ensure ex-post incentive-compatibility by the use of critical value payments (Parkes, 2007).
                           5
                        
                        
                           5
                           We provide a complete characterization of the payment rule in the Appendix.
                        
                     

The online mechanism implements three of the four desired economic properties: Individual rationality, incentive compatibility (regarding the demand side), and budget balance (under an additional weak assumption). We rely on the standard assumption of online mechanism design that early release and late due dates cannot be reported (Friedman & Parkes, 2003).

                              Proposition 1
                              
                                 Participation in the online mechanism is individually rational for all jobs.
                              

Demand side jobs are either allocated or not: Due to the pricing rule, the job payment is always bounded by its reported valuation and thus a non-negative payoff in ensured. In case of non-allocation, the payment is zero and again, job payoff is non-negative.

Supply jobs (offers) are remunerated at a price greater or equal to (zero) marginal cost.□


                                 The online mechanism is IC with respect to job time reporting.
                              

Assume the true type of a job is characterized by a release date a and a due date d. We then consider two possible types of job time misreports—(i) reporting a later release 
                                    
                                       
                                          a
                                          ^
                                       
                                       >
                                       a
                                    
                                  and (ii) reporting an earlier due date 
                                    
                                       
                                          d
                                          ^
                                       
                                       <
                                       d
                                    
                                 .

                                    
                                       (i)
                                       If a job is not allocated under the true release report, it will neither be allocated under the misreported later release. When the job declares a release date later than the actual release, there can be three outcomes: (a) If the allocation under the true type takes place at 
                                             
                                                t
                                                >
                                                
                                                   r
                                                   ^
                                                
                                                ,
                                             
                                           the job is allocated under the misreported release date 
                                             
                                                r
                                                ^
                                             
                                           at the same price, or (b) if the original allocation took place in the interval 
                                             
                                                [
                                                r
                                                ,
                                                
                                                   r
                                                   ^
                                                
                                                )
                                                ,
                                             
                                           the job may no longer be allocated, or (c) if the original allocation took place in the interval 
                                             
                                                [
                                                r
                                                ,
                                                
                                                   r
                                                   ^
                                                
                                                )
                                                ,
                                             
                                           the job may no longer be allocated (no matching arises over the new active period), or the job may be allocated at a price greater or equal the price under truth-telling. Clearly, in none of these cases can the job improve its payoff.

The same reasoning applies for the reported due date: Declaring an earlier due date cannot result in reduced payments, but may induce non-allocation (original allocation takes places in the interval 
                                             
                                                
                                                   (
                                                   
                                                      d
                                                      ^
                                                   
                                                   ,
                                                   d
                                                   ]
                                                
                                             
                                          ) or payments greater or equal the payments under truth-telling (original allocation takes places in the interval 
                                             
                                                
                                                   [
                                                   r
                                                   ,
                                                   
                                                      d
                                                      ^
                                                   
                                                   ]
                                                
                                             
                                          ).

In summary, an agent cannot profit from misreporting arrival and departure times which proves the proposition.□


                                 The online mechanism is IC with respect to valuation reports.
                              

As noted above, payments are chosen such that they correspond to the jobs’ critical value. The combination of greedy allocation with critical values in our setting with single-item interesting sets ensures IC (Nisan et al., 2007, Chap. 16).□


                                 The online mechanism is budget-balanced under the restriction of homogeneous reservation prices.
                              

For the case of homogeneous reservation prices (all supply jobs are offered at the same price) the payments received from the demand side are exactly balanced by the payments made to the supply side. Thus, the mechanism does not require outside subsidies and is budget balanced in the strong sense, that is it neither runs a deficit nor generates a profit.□

Note that the mechanism’s property of budget-balance does not hold under heterogeneous reservation prices: Consider a demand job i which is matched to a supply offer with reservation price p at time t < di
                           . At a later point in time t′, t < t′ < di
                           , a supply offer becomes available with p′ < p. To retain the monotonicity property of the payment rule (and thus incentive compatibility with respect to demand job timing) the job’s payment obtains as p′ which is insufficient to cover the reservation price p. This problem arises from the online nature of our problem combined with heterogeneous reservation prices. However, we primarily focus on a setting where supply is provided by renewable generators for which marginal costs of supply close to zero seem warranted.
                              6
                           
                           
                              6
                              Furthermore, we investigate the impact of (homogeneous, constant) non-zero reservation prices on welfare later on.
                            In summary, the proposed online mechanism satisfies the IR, IC, and BB requirement under mild restrictions. To assess the applicability of the proposed mechanism, we evaluate the achievable efficiency through numerical simulation studies.

@&#EVALUATION@&#

Evaluating the mechanism, we isolate the role of flexibility in the context of both, economic efficiency and market power, from individual jobs’ incentives. To this end, results in Sections 5.1 and 5.2 are based on homogeneous demand flexibility. The value of flexibility is examined in a quality-of-service context in Section 5.3, naturally relying on heterogeneous flexibility.

Here, we introduce the main parameters used throughout our economic evaluation. The length of the period during which jobs on both sides of the market are available is central to the attainable quality of any assignment solution. For supply jobs we set this availability to the constant value of five minutes. For demand jobs, flexibility is one of the central evaluation criteria and therefore varies with average values between one and thirty minutes. Demand jobs’ valuations are drawn from a uniform distribution, i.e., v ∼ U[0, 1]. Furthermore, installed renewable generation capacity is selected such that hypothetical yearly demand and supply would be balanced. Note that this still allows for instances of scarce or excess supply. As we are also interested in the effect of supply side incentives, reservation prices are varied between 0.0 and 0.9 in steps of 0.1. In order to account for different market sizes (and respective liquidity), settings with 20 (small) and 120 (large market) demand jobs arriving per hour are evaluated for a period of 24 hours.

The central question of online matching of demand side flexibility in microgrids circles around the attainable economic efficiency, i.e., (relative) social welfare. We investigate both the effect of the market structure (size and flexibility) as well as the allocation procedure. In comparison to social welfare under the clairvoyant offline optimal central dispatch benchmark (Section 4.2), both, the online central dispatch and mechanism achieve, by design, only reduced results. To structure our analysis, we consider two efficiency gaps: (i) The cost of information given by the efficiency gap between offline and online central dispatch. (ii) The cost of decentralization, the welfare gap between online central dispatch and online mechanism. Clearly, these welfare gaps can be engineered to be arbitrarily large. Yet, for an assessment of the practical relevance of local matching of variable generation, we apply the scenario described in Section 3 and discuss the effects of allocation procedure, market size and demand side flexibility on social welfare. Using numerical evaluation, we can characterize and assess the magnitude under non-adversarial settings.
                           7
                        
                        
                           7
                           Generation from RES should be non-adversarial, i.e., driven by nature and not by a rational opponent.
                        
                        Fig. 2 depicts both normalized welfare (upper panel) as well as the welfare gaps arising from incomplete information and decentral decision-making.

Liquidity limitations are considered a central obstacle on the way toward more local, intraday electricity trading. Therefore, we are also interested in the effect of “localness” (i.e., liquidity or market size) on economic efficiency. Intuitively, the larger the market, the smaller the risk that orders remain unmatched due to a lack of temporal overlap between supply and demand jobs. However, physical grid limitations restrict possible market size. Interestingly, the results of our analysis indicate that demand flexibility can act as a substitute for market size: In the absence of demand side flexibility, small markets achieve the lowest relative welfare levels. For higher flexibility values, relative welfare approaches unity for all market sizes. At the same time, these results also suggest that in small markets larger flexibility endowments are necessary than in larger markets. In larger markets, already a minor amount of flexibility is sufficient to achieve near-maximum welfare. In small markets, marginal welfare from flexibility in low-flexibility scenarios is large, while the resulting welfare level is still significantly smaller relative to larger markets. More flexibility is required to secure significant total efficiency gains. This is a relevant finding for policy-makers who need to acknowledge that ensuring efficiency in heterogeneous market sizes will require sufficient levels of demand side flexibility.

The gap between the offline and the online central dispatch is primarily governed by the level of demand side flexibility. Generally speaking, situations with more demand flexibility enable the online central dispatch to make better decisions. This is due to the cost of poor allocation decisions being limited by a larger number of competing demand jobs. On the other hand, the cost of decentral decision-making is not only shaped by demand side flexibility, but also by market size and supply–demand imbalances, i.e., supply scenarios. Interestingly, the effect of demand side flexibility on the price of IC is not monotonous: In the small market considered, the average gap between online central dispatch and mechanism at zero flexibility amounts to approximately 3 percent. For increasing demand side flexibility, the gap widens and reaches its peak of 6 percent at five minutes of flexibility. For larger flexibility values this trend reverses and the gap again reduces to around 2 percent. Furthermore, the larger the market, the quicker the welfare gap’s decay over flexibility. Additionally, there is an interaction effect between flexibility and market size. For small markets with little demand side flexibility, the gap is small. Intuitively, this is a setting in which only few options are available and thus allocation decisions are easy to make. For larger markets the gap at zero flexibility is significantly larger and can exceed 12 percent in the examined settings. It is in such settings (large market, low supply) where the value of flexibility is highest.

In summary, our results suggest that incentive-compatible coordination of flexible loads can be achieved at little cost (in terms of social welfare). Most notably, for non-zero flexibility levels, the welfare gap between the central dispatch approaches and the IC mechanism never exceeds ten percent in total. Furthermore, for sufficiently flexible demand, market size becomes a factor of limited importance concerning the achievable social welfare. The mechanism offers a novel way for suppliers to share risk arising from generation fluctuations
                                 8
                              
                              
                                 8
                                 This is referred to as “quantity risk” by Bitar and Low (2012).
                               with customers. This contrasts traditional market designs where all demand needs to be served. Besides higher profits through increased flexibility, suppliers benefit from reduced shedding of renewable supply in cases of excess supply.

So far we assumed suppliers to post zero reservation prices, i.e., equal to their marginal cost of generation. We now depart from this assumption and examine the welfare effect of varying reservation prices for different demand flexibility levels, supply scenarios, and market sizes. Given the absence of clearing prices in the central dispatch scenarios, this profit vs. welfare analysis is only applicable in the context of the online mechanism. This analysis assists in exploring the economic viability of the proposed local marketplace. Strategic suppliers will set reservation prices in a profit-maximizing manner. A departure from zero reservation prices will reduce the allocated volume as low-valued demand cannot be matched to available generation despite zero marginal costs. At the same time, this may increase allocation rates for higher valued demand. Consequently, welfare effects of strategic generator pricing are ambiguous. Besides affecting the allocation results, strategic pricing of suppliers can also affect the mechanism’s budget balance. This would be the case if suppliers over time quoted heterogeneous reservation prices.


                        Fig. 3 illustrates the effects of homogeneous non-zero reservation prices quoted by suppliers. Even in scenarios of excess supply, suppliers benefit from increased demand flexibility as it increases demand side competition which in turn leads to higher critical value payments.
                           9
                        
                        
                           9
                           Besides greater flexibility, demand side competition can also be increased by serving a larger market—e.g., through grid expansion.
                         This may compensate for expected revenue reductions on traditional energy markets when previously high-valued inflexible demand is converted to low-cost flexible demand. While supplier profits are strictly positive under zero reservation prices, they can be enhanced by introducing non-zero reservation price. However, such prices will in most cases also reduce social welfare. The only exception are settings with scarce supply and little flexibility. Here, competition between demand jobs is particularly low and myopic decision making leads to lower economic efficiency. This is a surprising finding as usually market power is expected to be more detrimental on smaller markets. In any case, policy makers will have to carefully balance supplier incentives (i.e., profit opportunities from higher reservation prices) against aggregate welfare considerations when trying to regulate local flexibility markets.

Before, flexibility endowments were assumed to be homogeneous across all demand jobs. In this section, we focus on the effect of individual flexibility on probabilities of allocation and payments, and therefore introduce heterogeneous demand flexibility. More specifically, we draw the flexibility level f from an exponential distribution with parameter λ, i.e., f ∼ Exp(λ). The resulting job heterogeneity allows for detailed insights into the interplay of job valuation and flexibility on payments and allocation probabilities. On a job level, we are particularly interested in the corresponding payments and how they relate to a job’s flexibility. To this end we apply the notion of service levels and quality-of-service in the smart grid context (Oren & Smith, 1993). Different from most of the literature, where customers exogenously declare their preferred combination of service-level and price, we let service levels arise endogenously from job valuations and flexibility endowments. The binary decision for a job to be served or not depends on system state (demand and supply) and job valuation v and flexibility f. The notion of a service level, i.e., the probability of successful allocation given its flexibility and valuation, can only be meaningfully defined for a set of similar jobs. With similar, we refer to jobs that exhibit akin valuations and flexibility, and define QoS as the probability of successful allocation for similar jobs given v and f, i.e., 
                           
                              Q
                              o
                              S
                              (
                              v
                              ,
                              f
                              )
                              =
                              P
                              (
                              allocation
                              |
                              v
                              ,
                              f
                              )
                              ,
                           
                         a metric that is increasing in both valuation and flexibility. Accordingly, job flexibility facilitates service reliability under unreliable supply regimes. The individual agent benefits from flexibility in two ways: Higher flexibility both increases service levels and reduces payments (critical value payments have the property of decreasing monotonously in flexibility), thereby increasing job i’s expected utility 
                           
                              E
                              
                                 (
                                 
                                    u
                                    i
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    v
                                    i
                                 
                                 −
                                 
                                    p
                                    i
                                 
                                 )
                              
                              P
                              
                                 (
                                 allocation
                                 |
                                 
                                    θ
                                    i
                                 
                                 )
                              
                           
                         from allocation. Using this property, consumers can effectively choose in which currency, valuation or flexibility, to pay for reliable supply to jobs. Fig. 4 illustrates the relationship between flexibility, valuation and expected utility for reservation price 
                           
                              r
                              =
                              0
                           
                         and average job flexibility 
                           
                              
                                 1
                                 λ
                              
                              =
                              1
                           
                         minute. We focus on a large market as allocation results in the small market case are more susceptible to chance. The scarcer supply, the smaller the expected utility of a job. This is a natural consequence of critical value payments, which are increasing in competition on the demand side. For scenarios with rather limited supply, the complementary relationship of flexibility and valuation becomes evident.

For sake of analytical tractability, the stylized model described above is based on somewhat restrictive assumptions. In this section, we describe and evaluate two model extensions. First, we extend the mechanism to allow for non-unitary quantities and explore the corresponding welfare impact. Subsequently, we introduce grid constraints to explore the interplay between local flexibility matching and congestion of distribution networks. We isolate these extensions to retain better comparability with the main results section.

Above we modeled demand as homogeneous blocks of unit quantity. While this approach allows us to explore the dependencies between load properties (flexibility, willingness to pay) and the allocation characterization (quality of service, payment), it is unsuitable for the analysis of energy services with heterogeneous demand profiles.

In order to keep the alignment of the demand model with the supply model, we retain the base unit size and treat atomic jobs as unit size. Yet, we introduce activity as a new load concept. A demand activity j spans κj
                            atomic jobs with common due date. When modeling multi-unit demand, a key aspect is to characterize complementarity between the individual units of an activity. To this end, we apply a parsimonious modeling approach: We assume that overall utility of an activity is the weighted sum of the utility obtained from completing atomic jobs and a completion bonus which is accrued if all atomic jobs are completed (we use weights η and 
                              
                                 1
                                 −
                                 η
                              
                            with η ∈ [0, 1]).

Note that there are two polar cases—(i) independence and (ii) total complementarity.

In case (i), customer utility from an activity is the sum of the individual utility values obtained from each of the activity’s individual jobs, i.e. there is no completion bonus (
                              
                                 η
                                 =
                                 1
                              
                           ). Accordingly, partial execution of an activity does not affect utility negatively. This corresponds to the setting explored in the previous sections of this paper. Examples for such a utility structure include typical HVAC applications (each unit of energy contributes to the desired thermal level), sequences of independent production lots (each completed lot can be marketed), parallelizable computing task (missing jobs can be completed later), or charging of plug-in hybrid electric vehicles (each delivered unit of electricity allows to avoid fuel usage). In case (ii), the consumer only receives utility from service provision, if all individual jobs of an activity are served, i.e., total activity utility exclusively consists of the completion bonus. Examples for this situation are chemical process chains (continuous production is necessary), services with direct customer interaction, or battery electric vehicle charging (charging amounts of energy smaller than the energy necessary to achieve the corresponding range does not yield utility to the driver).

Revisiting our notation from Section 3.2, an activity 
                              
                                 a
                                 j
                              
                            can be described as a tuple 〈v, a, f, κ, η〉. Denoting the allocation indicator of each of 
                              
                                 a
                                 j
                              
                           ’s individual jobs by x
                           
                              j, i
                           , total utility of an activity is given by

                              
                                 (8)
                                 
                                    
                                       u
                                       
                                          (
                                          
                                             a
                                             j
                                          
                                          )
                                       
                                       =
                                       η
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      j
                                                   
                                                   
                                                      κ
                                                      j
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      κ
                                                      j
                                                   
                                                
                                                
                                                   x
                                                   
                                                      j
                                                      ,
                                                      i
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             atomic
                                             
                                             job
                                             
                                             utility
                                          
                                       
                                       +
                                       
                                          (
                                          1
                                          −
                                          η
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                   j
                                                
                                                
                                                   min
                                                   
                                                      i
                                                      ∈
                                                      
                                                         κ
                                                         j
                                                      
                                                   
                                                
                                                
                                                   x
                                                   
                                                      j
                                                      ,
                                                      i
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             completion
                                             
                                             bonus
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

@&#EVALUATION@&#

The allocation approaches described in Section 4 need to be adjusted to account for multi-unit activities. For the offline central dispatch, we introduce a linear decision variable yj
                            ∈ [0, 1] encoding activity completion. This allows to directly include the completion bonus in the objective function as 
                              
                                 
                                    y
                                    j
                                 
                                 
                                    (
                                    1
                                    −
                                    η
                                    )
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       κ
                                       j
                                    
                                 
                                 
                                    v
                                    i
                                 
                              
                           . The decision variable representing activity j is bounded by yj
                            ≤ xi
                            for all atomic requests i ∈ {1, .., κj
                           }.

Both, allocation decisions for incremental units in the online central dispatch and the online mechanism are identical to the procedure presented above, with allocation decisions still made on the job level. However, greedy allocation refers to entire activities instead of single jobs. Greedy allocation translates into sorting of activities in decreasing order of their corresponding current (at the time of allocation) value density ρ, i.e., the sum of valuations of the activity’s jobs normalized by the number of jobs so far unserved q′. Formally, 
                              
                                 
                                    
                                       ρ
                                       j
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   1
                                                   ,
                                                   .
                                                   .
                                                   ,
                                                   
                                                      κ
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             v
                                             i
                                          
                                       
                                       
                                          q
                                          ′
                                       
                                    
                                 
                              
                           .

Clearly, the introduction of non-unitary quantities may result in efficiency losses due to inefficient partial execution of activities relative to the case of single-unit demand. While the described re-ordering of activities based on value density does not establish economic performance guarantees, it generally fosters efficient allocation decisions and renders the modified mechanism applicable in the case of multi-unit demand. In order to reliably estimate the value of flexibility in constrained setting, we run 100 experiment iterations for each parameter combination. The results are illustrated in Fig. 5. Our results indicate that welfare suffers most in settings lacking flexibility (top row) combined with fully complementary demand (left column). Both online approaches decide myopically and their economic performance suffers from the exposure problem. At average flexibility of one minute, offline optimal central dispatch experiences a 22 percent welfare reduction in the case of activity size 
                              
                                 κ
                                 =
                                 5
                              
                            relative to the single-unit case. This is in contrast to a 30 percent reduction for the central online dispatch and 35 percent for the online mechanism, respectively. Both, a reduction in the degree of complementarity (increasing η, in Fig. 5 from left to right) and increasing flexibility f mitigate the adverse effect of increasing activity size on social welfare. For instance, retaining full complementarity and increasing job flexibility to 30 minutes on average (bottom left facet), offline optimal central dispatch experiences only a 9 percent reduction, while both online central dispatch and online mechanism suffer from a slightly larger reduction of approximately 12 percent. Interestingly, given a low degree of complementarity, e.g., 
                              
                                 η
                                 =
                                 0.75
                              
                            as well as low flexibility and large activity sizes, the online mechanism yields higher welfare than the online central dispatch. This effect is due to the mechanism’s “on arrival” matching: In the settings examined, this property appears more valuable than the wait-and-see approach employed in the online central dispatch.

In combination, these results illustrate that (i) flexibility is particularly valuable in the case of complementary demand, and (ii) flexibility mitigates the welfare gap between central (offline and online) dispatch and the online mechanism. However, in cases where job complementarity is extremely pronounced, pre-commitment (Ströhle et al., 2014) or other forms of advance coordination may become necessary to ensure satisfying efficiency while retaining the core concept of incentive compatibility.

Limited line capacities and grid constraints are a central characteristic of power systems. Given the non-routability of electric currents, physical grid properties can give rise to highly non-linear behavior. Historically, power flow considerations have primarily been incorporated in transmission planning and system operation. Starting off from submitted generation plans, system operators reschedule (redispatch) generation units to satisfy system constraints in light of fluctuating RES generation and inflexible demand. However, increasing amounts of distributed, renewable generation introduce acute grid constraints on the distribution grid level. Hence, future distribution grid planning may necessitate power-flow analysis on the distribution grid level. Given limited generation redispatch options on the local level, distribution regulation may also require “redispatching” of demand requests. To explore this idea, we extend our model by incorporating a (simple) power network model.

To explore the impact of grid constraints on the allocative properties of local flexibility matching, we extend our model by incorporating power flow calculations as provided by the MATPower package (Zimmerman, Murillo-Sánchez, & Thomas, 2011).
                              10
                           
                           
                              10
                              Specifically, we use the Python port PYPOWER available at pypi.python.org/pypi/PYPOWER/.
                            For evaluation purposes we apply the widely used IEEE 6-bus network (Wood and Wollenberg, 2012, p.104) depicted in Fig. 6. We opt for this network, as it is both simple in its structure and well documented in the literature and adopt the IEEE network configuration in its entirety. This allows us to compute power flows based on physical line resistance in a straight-forward manner.
                              11
                           
                           
                              11
                              We employ direct current (DC) power flow computation using Newton’s method.
                            For the purpose of matching integral jobs and supply units, we ignore the computed line losses—given distribution losses of around 5 percent (IEC, 2007) this is a fairly mild assumption. However, we do consider line limits. Furthermore, instead of selecting a specific network configuration, we assume homogeneous line limits and systematically vary the maximum flow relative to overall supply and demand to reflect more constrained networks.

To incorporate this grid in our model, we need to assign the origin of demand request and supply offers to network buses. We do so by allocating all supply offers to nodes one through three (top nodes in Fig. 6), while the corresponding demand requests are placed on nodes four through six. This approach is in line with the original configuration of the IEEE network. Besides the spatial configuration, we need to extend our previous demand model by a duration dimension since we can no longer simply remove matched orders from further consideration of the mechanism as they continue to affect later jobs by constraining grid capacity. Instead, we need to track the grid utilization induced by each job over its active period. This requires the introduction of job duration (as opposed to start flexibility) as a new parameter. To minimize the number of free parameters we assume a common duration of one hour for all jobs.

@&#EVALUATION@&#

The mechanism’s allocation decisions directly determine the corresponding power flows over the network. To achieve reliable estimates of the value of flexibility in constrained setting, we run 50 experiment iterations for each parameter combination. Fig. 7
                            illustrates the relationship between flow constraints and actual flows over the power network in one problem instance. Utilization varies widely between power lines. Lines (1–2, 1–4, and 1–5) are used most heavily, while the line connecting nodes 2 and 4 experiences only little load. Constraining the capacity of one line may result in a reduction of power flows on other parts of the network, too. This can be well observed on line 2–6: While the flow limit on this line never becomes binding, the corresponding flows reflect reduced capacity on other lines. Accordingly, selective grid expansion decisions may significantly increase welfare potential.

The left panel of Fig. 8
                            illustrates normalized average welfare over flow constraints grouped by job flexibility. Our results indicate that flexibility can effectively substitute network capacity. Vice versa, demand-side flexibility may play a central role, given a sufficient initial level of network capacity, in ensuring integration of increasing fluctuation in generation from RES at high penetration levels. Then, flexible, queued jobs can be employed to balance short-lived supply spikes. The right panel of Fig. 8 provides a condensed view on the complex interplay between network capacity and flexibility. Iso-mean-efficiency lines shed light on the marginal value of network capacity and job flexibility. At sufficient network capacity and low flexibility levels, expanding the network alone results in only very minor efficiency improvements. The addition of job flexibility promises to yield greater benefits. Consequently, in a fully renewables-based power system, grid capacity and load flexibility are complements.
                              12
                           
                           
                              12
                              This is in-line with the findings by Verzijlbergh, Martínez-Anido, Lukszo, and de Vries (2014).
                           
                        

The results of our computational experiments can be summarized as follows: minor reductions in grid transfer capacity can efficiently be mitigated through the use of demand flexibility. In highly constrained networks, the addition of flexibility does not improve economic welfare, as there exists no slack to enable more favorable decisions. In this case grid expansion measures ought to be prioritized. These recommendations reiterate the classic findings on capacity-flexibility trade-offs due to Jordan and Graves (1995).

@&#DISCUSSION@&#

Renewable energy sources are attaining crucial importance in electrical power systems around the globe. Given their volatile and unreliable nature, system operators need to cope with significant challenges and adapt new operational paradigms. Activating even limited amounts of demand side flexibility can play a vital role to facilitate grid integration of fluctuating generators. Demand side flexibility may limit network and storage expansion required for the grid integration of even higher RES amounts and this way assist the transition toward economically and ecologically more sustainable power systems. Previous research has mostly focused on applying optimization techniques to optimize the central dispatch of flexible loads. We argue that for the vision of flexible demand in smart grids to materialize, incentives regarding the provision of flexibility on the level of the individual consumer must be taken into account: Future grids can tap into demand side flexibility by establishing incentive-compatible allocation and pricing rules.

To this end, we present an online mechanism and apply it in a realistic smart grid setting with emphasis on local matching of flexible demand and uncertain supply from renewable generation. Under this mechanism, it is the dominant strategy for jobs to report their true type with respect to valuation and temporal flexibility, independent of other jobs’ reports. This is because individual agents benefit from their flexibility revelation through reduced expected payments and increased likelihood of allocation.


                        Value of flexibility: Demand side flexibility is not only valuable on the individual level: we show that load flexibility reduces shedding of excess supply and thus increases social welfare. Our evaluation indicates that in settings with reasonable flexibility levels, the price of information (i.e. the welfare gap between offline optimal and online central dispatch) is rather small. We surmise that demand flexibility can substitute market size, rendering even small markets surprisingly efficient. Going beyond online optimization and including incentives, our results, furthermore, indicate that the price of incentive compatibility (the welfare gap between the online central dispatch and the online mechanism) is even smaller. Surprisingly, suppliers can benefit from demand side flexibility as it not only reduces the amount of shed supply but, more importantly, also increases demand side competition and corresponding critical value payments.


                        Supplier profits and market power: Surprisingly, supplier profits are increasing in demand flexibility. This is because greater demand side flexibility increases demand side competition which in turn leads to higher critical value payments. While supplier profits are strictly positive under zero reservation prices, they can be enhanced by introducing non-zero reservation price. This will require policy makers to carefully assess strategic ramifications when regulating local energy markets.


                        Complementary demand: Demand complementarity (arising from greater activity sizes and smaller values of η) deteriorates social welfare obtained under online allocation schemes. However, we find that demand flexibility is able to markedly limit these negative effects. At sufficient demand flexibility (e.g., 30 minutes on average), the gap between offline optimal central dispatch and either of the two online approaches can be reduced to approximately 3–5 percent, irrespective of activity size and degree of complementarity. At lower values of flexibility, inclusion of a model of the future, in combination with further changes to the mechanism may offer further improvements.
                           13
                        
                        
                           13
                           However, any modification to the online mechanism requires careful inclusion of incentive issues.
                        
                     


                        Network constraints: Generally, network constraints may render valuable matchings infeasible and hence reduce efficiency. We find that demand flexibility is particularly well suited to cope with short-term supply bursts. Flexibility and grid capacity exhibit complementary character: for sufficient levels of network capacity, flexibility can substantially enhance social welfare. Furthermore, competition on either side of the market may be reduced as binding power flow constraints effectively reduce market size. Accordingly, issues of market power may be amplified in settings with highly constrained matching possibilities.

The research at hand offers several worthwhile avenues for future research. The first concerns the effect of different distributions of flexibility endowments over jobs on social welfare. Depending on the supply portfolio, different kinds of flexibility distributions (few highly flexible jobs vs. large quantities of only marginally flexible jobs) may yield markedly differing welfare potential. Extending the presented model framework, optimal investment trade-offs in generation capacity and demand side flexibility may yield interesting insights. This question is closely related to equilibrium prices on local smart-grid markets with quality-differentiated products. Here, it would be interesting to examine how matching on short-horizon markets affects outcomes on related markets.

A local market has interesting implications for grid expansion incentives: Under uniform reservation prices (especially for the case of zero reservation prices), generators will be highly interested in grid expansion as it intensifies demand side competition and thus provides a risk-less means to increase revenue. Effectively, suppliers seek stronger grids to avoid monopsony demand structures. However, under heterogeneous reservation prices, the opposite scenario may realize: suppliers may advocate local markets, while consumers can be expected to demand grid expansion measures in order to induce competition between generators to avoid monopoly supply situations. In either case, it becomes evident that grid expansion facilitates efficient outcomes, but the benefits may not be accrued by all parties involved. Consequently, socialization of grid investment costs seems to be unwarranted. This two-sided struggle for connections between buyers and sellers resembles the situation conceptualized in the strategic network formation literature (Kranton & Minehart, 2003). Future research should explore grid expansion incentives taking quality differentiation into account. If allocation decisions internalize transmission constraints, it will be interesting to examine where in the network flexible demand assets (e.g., storage) should be located. Some locations may be remunerating flexibility more than others. Potentially, strategic placement of flexibility can offer a powerful means to enable cascades of supply–demand matchings.

Furthermore, the trade-off between budget-balance and efficiency in conjunction with time-varying reservation prices is an interesting topic worthy of further exploration. We have demonstrated that non-zero reservation prices may sometimes improve social welfare. Similarly, there may be situations where foregoing strict budget balance can improve allocation efficiency. To this end, subsidies or participation fees may be used to support the market platform. Finally, the critical value payment scheme of our mechanism could be adapted to take grid constraints into account and thus provide insights and incentives for appropriate flexibility siting. Also, adaption of alternative pricing rules such as core pricing may be applied to ensure higher payments to the mechanism.

@&#ACKNOWLEDGMENT@&#

We thank the editor Immanuel Bomze and the reviewers for their helpful comments and suggestions which helped to greatly improve the paper.

For the definition of a payment rule that renders the above described allocation rule IC, we establish the sets of directly and indirectly competing demand jobs as well as non-competing supply jobs. These sets need to be defined to determine a demand job’s critical value, which ensures IC (Nisan et al., 2007, p. 229).

We name the set of demand jobs DCD(x) that are active (both matched and unmatched) at allocation time m of demand job x directly competing with x.

                                 
                                    (9)
                                    
                                       
                                          D
                                          C
                                          D
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          
                                             {
                                             b
                                             ∈
                                             B
                                             ∖
                                             {
                                             x
                                             }
                                             |
                                             r
                                             (
                                             b
                                             )
                                             ≤
                                             m
                                             (
                                             x
                                             )
                                             ≤
                                             d
                                             (
                                             b
                                             )
                                             }
                                          
                                       
                                    
                                 
                              Note that directly competing demand jobs can end up non-allocated.

We name a demand job b indirectly competing (ICD) with demand jobs x if it is being allocated during the active period of x; in order for a request b to be ICD, it does not have to be directly competing (at allocation time) with x.

                                 
                                    (10)
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                   C
                                                   D
                                                   (
                                                   x
                                                   )
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      {
                                                      b
                                                      ∈
                                                      B
                                                      ∖
                                                      {
                                                      x
                                                      }
                                                      |
                                                      (
                                                      r
                                                      (
                                                      x
                                                      )
                                                      ≤
                                                      m
                                                      (
                                                      b
                                                      )
                                                      ≤
                                                      d
                                                      (
                                                      x
                                                      )
                                                      )
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              We will see shortly, how the valuation of such indirectly competing demand jobs becomes relevant for determining the payment associated with the allocation of x. Indirectly and directly competing demand jobs differ in two aspects: Eventual allocation (ICD are allocated) and time of competition (DCD are competing at
allocation time, while IDC might be competing earlier or later). Accordingly, an element of DCD(x) may also belong to the set of ICD(x), i.e., the two sets are not necessarily subsets of each other.

We name a supply job non-competing (NCS) if it is either non-allocated or only allocated after its release date r(a) and if it is active at some point during the active period of x. The set of non-competing supply jobs is formally defined by

                                 
                                    (11)
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                   C
                                                   S
                                                   (
                                                   x
                                                   )
                                                   =
                                                
                                             
                                             
                                                
                                                   {
                                                   a
                                                   ∈
                                                   A
                                                   |
                                                   (
                                                   ∄
                                                   m
                                                   (
                                                   a
                                                   )
                                                   ∨
                                                   r
                                                   (
                                                   x
                                                   )
                                                   <
                                                   m
                                                   (
                                                   a
                                                   )
                                                   )
                                                   ∧
                                                   A
                                                   n
                                                   y
                                                   O
                                                   v
                                                   e
                                                   r
                                                   l
                                                   a
                                                   p
                                                   (
                                                   x
                                                   ,
                                                   a
                                                   )
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              where

                                 
                                    (12)
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                   n
                                                   y
                                                   O
                                                   v
                                                   e
                                                   r
                                                   l
                                                   a
                                                   p
                                                   (
                                                   x
                                                   ,
                                                   a
                                                   )
                                                   =
                                                
                                             
                                             
                                                
                                                   r
                                                   (
                                                   a
                                                   )
                                                   <
                                                   d
                                                   (
                                                   x
                                                   )
                                                   ∧
                                                   d
                                                   (
                                                   a
                                                   )
                                                   >
                                                   r
                                                   (
                                                   x
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Furthermore, we define an order on these sets of jobs, where the following holds:

                                 
                                    (13)
                                    
                                       
                                          
                                             b
                                             i
                                          
                                          ≺
                                          
                                             b
                                             j
                                          
                                          ≡
                                          
                                             (
                                             v
                                             
                                                (
                                                
                                                   b
                                                   i
                                                
                                                )
                                             
                                             <
                                             v
                                             
                                                (
                                                
                                                   b
                                                   j
                                                
                                                )
                                             
                                             )
                                          
                                          
                                          ∀
                                          
                                             b
                                             i
                                          
                                          ,
                                          
                                             b
                                             j
                                          
                                          ∈
                                          B
                                          
                                          ∀
                                          
                                             b
                                             i
                                          
                                          ,
                                          
                                             b
                                             j
                                          
                                          ∈
                                          A
                                       
                                    
                                 
                              
                           

The price a job eventually pays for successful allocation is formally determined by the job’s critical value:

                                 
                                    (14)
                                    
                                       
                                          p
                                          (
                                          x
                                          )
                                          =
                                          v
                                          (
                                          min
                                          {
                                          max
                                          (
                                          D
                                          C
                                          D
                                          (
                                          x
                                          )
                                          )
                                          ,
                                          min
                                          (
                                          I
                                          C
                                          D
                                          (
                                          x
                                          )
                                          )
                                          ,
                                          min
                                          (
                                          N
                                          C
                                          S
                                          (
                                          x
                                          )
                                          )
                                          }
                                          )
                                       
                                    
                                 
                              More specifically, the individual components are given by:

                                 
                                    •
                                    the highest valuation of directly competing demand jobs at allocation time v(max (DCD(x))) (this is always less than the valuation of the allocated request),

the lowest valuation of demand jobs allocated during the active period of the respective job x, i.e., v(min (ICD(x))),

the lowest reservation price observed during the active period if the demand job has remained without any competing job for any duration of the respective supply job during its active period, i.e., v(min (NCS(x))).

The critical value’s monotonicity renders the mechanism incentive compatible. Accordingly, the more flexible a demand job (i.e., the longer the active period between release and due date), the lower the payment.

@&#REFERENCES@&#

