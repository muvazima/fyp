@&#MAIN-TITLE@&#Infrared ship target segmentation through integration of multiple feature maps

@&#HIGHLIGHTS@&#


               
                  
                     
                        
                           
                           Proposing a saliency map detection method through multiple feature map integration.


                        
                        
                           
                           Proposing an adaptive thresholding method for local salient region segmentation.


                        
                        
                           
                           Achieving a better performance for both visual and quantitative evaluations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Infrared images

Ship target segmentation

Feature map integration

Thresholding

@&#ABSTRACT@&#


               
               
                  We investigate the issue of ship target segmentation in infrared (IR) images, and propose an efficient method based on feature map integration. It consists of mainly two procedures: salient region detection based on multiple feature map integration and salient region segmentation based on locally adaptive thresholding. Firstly, a saliency map is constructed by integrating multiple features of IR ship targets, including gray level intensity, local contrast, salient linear structures, and edge strength. Secondly, we propose an adaptive thresholding method to segment each local salient region, and a target selection procedure based on shape features is used to remove background and obtain the true target. Experimental results show that the proposed method performs well for IR ship target segmentation. The advantage of the proposed method is demonstrated in both visual and quantitative comparisons, especially for IR images with a bright background or a ship target close to port.
               
            

@&#INTRODUCTION@&#

In recent years, infrared (IR) imaging system has been widely used for maritime security, such as harbor surveillance, maritime search and rescue, and ship target tracking [1]. As a crucial step, IR ship target segmentation plays an important role in the above applications. It facilitates the detection of important features for subsequent imaging processing [2,3]. However, as the intensity values of an IR image depend on the temperatures of the imaged target and background, weather and atmospheric conditions, the image quality is sensitive to variations of the imaging scenario [4]. Generally, IR images are characterized by low resolution, low signal-to-noise ratio (SNR), and low target-to-background contrast [5]. Moreover, when the target is close to the background, it is difficult to separate the target from the background. All these challenges make ship target segmentation in IR images a tough task.

Many investigations have been conducted to solve this problem, and many methods have been proposed. For instance, the mean-shift based method, which is a feature-space analysis method, has been applied for image segmentation, clustering and tracking [6]. The mean shift method works well for IR ship target segmentation in a sea background [7]. However, the segmentation process is based on region merging, where some target regions may be eliminated when the size is small, or wrongly merged with the background when the contrast is low. Active-contour based method is also commonly used for image segmentation [8]. The traditional Chan–Vese (C–V) model [9] only works well for images with statistically homogeneous intensities [10]. To overcome this issue, some improved models combining the local and global information were proposed, such as methods in [10,11]. However, the segmentation results of these methods are sensitive to initialization and time consuming. To address these problems, several strategies have been applied to improve the efficiency. For example, to achieve fast auroral oval segmentation, shape knowledge based initialization procedure has been proposed to improve the segmentation accuracy and its convergence rate [12,13]. And to further accelerate the segmentation, a multi strategies method combining universal lattice Boltzmann method (LBM) and sparse field method (SFM) have been developed [13]. Moreover, based on the assumption that the energy function of a pixel is defined by both the pixel and its neighbors, a noise robust Markov random field (MRF) embedded level set model is proposed. And during the implementation of this method, an algebraic multigrid (AMG) and SFM are applied to reduce the computational time [14]. Another commonly used method is based on thresholding [15]. Thresholding is one of the most powerful tools for image segmentation. Classical thresholding methods have the advantages of simplicity and efficiency, such as Otsu's method [16], entropy based method [17], and thresholding based on clustering criteria [18]. However, as these methods only take into account of the intensity information and ignore the spatial information between pixels, they are sensitive to noises. To compensate for this, thresholding methods considering spatial information are introduced, such as the spatial fuzzy C-means [19], 2D Otsu [20], and 2D entropy based methods [21]. These methods are less prone to noise due to the use of spatial information. Nevertheless, their performances are affected by the ratio of pixel numbers on the background and the target regions, and they cannot achieve satisfactory results when the contrast is low or the target is too small.

In our previous work [22], we developed an iterative global thresholding (IGT) method. The IGT method can overcome several existing problems of IR ship target segmentation, such as low contrast, multiple targets, and uneven backgrounds. It has a good performance for IR images with different backgrounds. However, the IGT method assumes that the target region is much brighter than the background, it does not work well for images with bright backgrounds and large ship targets with non-uniform intensities. Moreover, in the region selection procedure, it will take a ship target obtained from front view as background and remove it.

Therefore, despite many methods have been developed, we are still far from solving the problem of IR image segmentation. In recent years, there has been a trend towards algorithms that integrate multiple features [23,24]. As each feature can capture part of the information contained in an image, it is possible to produce better results by taking advantage of complementary properties of various features. And due to the fact that a target can often attract attention in an IR image, saliency based method is becoming important for IR target detection [25] and other image analysis tasks [26]. In this paper, to deal with the problems encountered in [22] and other approaches, we propose an effective IR ship target segmentation method by integrating multiple feature maps. Firstly, we propose a saliency map detection method through multiple feature map integration. In this step, discriminative and robust feature maps are extracted independently, including image intensity, local contrast, salient linear structures, and edge strength. And then all the feature maps are integrated to obtain a saliency map. As a preliminary step, a pre-processing procedure based on fast bilateral filtering is used to remove noises and smooth complex backgrounds. Secondly, an adaptive thresholding method is developed to segment each local salient region, and a target selection procedure is applied to obtain the true ship target. Experimental results demonstrate that our method can achieve good segmentation results for IR images with low and high contrasts, and it can segment ship targets with different sizes. Comparison results indicate that our method achieves a better performance for both visual and quantitative evaluations, especially for IR images with bright backgrounds and ship targets closely connected with the background.

The flowchart of the proposed method is shown in Fig. 1
                      Details are given in the following sections.

The IR images are obtained from different maritime environments, and some samples are shown in Fig. 2
                         These images have different types of backgrounds and different contrasts, and the sizes of the ship targets vary considerably. So it is difficult to segment all the images using only one or two simple features. To achieve an effective segmentation, feature integration is an applicable approach. By combining multiple features, we can have more information of the target from different imaging angles [27]. Based on observations on these images, we can find that they have some common characteristics. For instance, the ship target is a connected region with a regular shape, and it appears as a bright salient region with a fuzzy contour comparing with its surrounding background; and the local contrast around the target region is much higher. Although for some images the ship target is connected with a port (e.g., the first and the second images in the first row of Fig. 2 , boundary of the port can be used to separate them. Therefore, we propose a feature map integration method for effective segmentation. By integrating complementary information of various features, we intend to highlight the target regions as well as to separate the target regions from the background.

IR images usually have high noise levels, and complex background will increase the difficulty of image segmentation. Therefore, effective pre-processing is necessary to improve the IR image quality. Various image pre-processing algorithms have been proposed to remove noises or enhance useful details and contrast [28]. Among the existing methods, bilateral filtering allows one to perform smoothing while preserving edges at the same time [29]. This filter has found widespread use in various image processing and computer vision applications. In this paper, we use the fast bilateral filtering method proposed in [30], which implements the bilateral filter in constant time using trigonometric range kernels. As shown in Fig. 3
                            (b), after the fast bilateral filtering, the background is effectively smooth, while the details of the ship target are well preserved. This is beneficial for the following ship target segmentation.

From Fig. 2 we can see that there are mainly three regions in the IR ship target images. These regions are sky or land background, ship target, and sea background. The intensity distributions vary according to each row. For the sky and sea background regions, their local contrasts are low; while for the ship target region, the local contrast is high. Therefore, local contrast can be used to distinguish the ship target from the background regions. To obtain the local contrast map, we use a block-based representation inspired by the work in [31]. Given an IR image I with size S
                           
                              r
                           
                           ×
                           S
                           
                              c
                           , the filtered image is denoted as I
                           
                              f
                           . First we divide the image I
                           
                              f
                            into M
                           ×
                           N non-overlapping blocks {P
                           11,…,P
                           1N
                           ;…;P
                           
                              i1,…,P
                           
                              iN
                           ;P
                           
                              M1,…,P
                           
                              MN
                           } with P
                           
                              ij
                            being a w
                           ×
                           w image block, 1 ≤ i ≤ M;1 ≤ j ≤ N. In the implementation, we set w
                           =5. The local row contrast measures the distinction between a given patch P
                           
                              ij
                            and an averaged patch from row i of the blocked image, defined as 
                              
                                 (1)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          
                                             l
                                             r
                                             c
                                          
                                       
                                    
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    )
                                    =
                                    sign
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    m
                                    R
                                    o
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ⋅
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   m
                                                   R
                                                   o
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           where sign(x) is a sign function with sign(x)=−1, if x < 0; sign(x)=1, if x > 0; and sign(x)=0, otherwise. ∥⋅∥2 represents the l
                           2 norm; mRow
                           
                              i
                            is the averaged patch of row i of the blocked image, i.e., 
                              m
                              R
                              o
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              /
                              N
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                    j
                                 
                              
                           . This local row contrast map can represent the local saliency of the ship target region, as shown in Fig. 3 (c).

A ship target region appears as a closed connected region with fuzzy contours, including important edge features. Therefore, we use edge strength as another feature to highlight the ship target region. To detect the edge strength map, a scale multiplication method is used as in [32]. Two detection filters in x and y directions are used, denoted as 
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                                 
                                    x
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            and 
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                                 
                                    y
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           , respectively. Here, s is the scale. Their responses to image I
                           
                              f
                            are 
                              
                                 
                                    H
                                 
                                 
                                    x
                                 
                                 
                                    s
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            and 
                              
                                 
                                    H
                                 
                                 
                                    y
                                 
                                 
                                    s
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           , respectively. Two scales are used, a small scale s
                           1 and a large scale s
                           2. The scale multiplication is defined as the product of the two scale responses, 
                              
                                 
                                    P
                                 
                                 
                                    I
                                 
                                 
                                    x
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    H
                                 
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ⋅
                              
                                 
                                    H
                                 
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                            and 
                              
                                 
                                    P
                                 
                                 
                                    I
                                 
                                 
                                    y
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    H
                                 
                                 
                                    y
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ⋅
                              
                                 
                                    H
                                 
                                 
                                    y
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           . The modulus of point (x,y) is defined as 
                              
                                 (2)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          e
                                          m
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                I
                                             
                                             
                                                x
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                P
                                             
                                             
                                                I
                                             
                                             
                                                y
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                    ⋅
                                 
                              
                           
                        

We take the modulus I
                           
                              em
                           (x,y) as the edge strength of the pixel at position (x,y). To remove some false edges, the edge strength map I
                           
                              em
                            is thresholded. The threshold is set as [33] 
                           
                              
                                 (3)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    m
                                    e
                                    a
                                    n
                                    M
                                    +
                                    ρ
                                    ⋅
                                    s
                                    t
                                    d
                                    M
                                 
                              
                           where meanM and stdM are the mean and standard variation of I
                           
                              em
                           , respectively; ρ is a control parameter, and the determination of ρ will be discussed later. The binarized edge strength map BW
                           
                              em
                            is obtained as follows 
                              
                                 (4)
                                 
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          e
                                          m
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         e
                                                         m
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ≥
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

By multiplying BW
                           
                              em
                            with I
                           
                              em
                           , we obtain the following new edge strength map 
                              
                                 (5)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          e
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          e
                                          m
                                       
                                    
                                    ⋅
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          e
                                          m
                                       
                                    
                                    .
                                 
                              
                           
                        

The edge strength map detection result is shown in Fig. 3 (d). Boundaries of the ship target are highlighted in the edge strength map, which is beneficial for the ship target extraction.

The contour of the ship target, coastline and the sea port show salient linear structures, and the coastline and the boundary of the port play important roles in separating the ship target from the background. We detect linear structures using a Hessian matrix [34]. Hessian matrix describes the second order structures of images. Assuming the two eigenvalues of the Hessian matrix of a pixel are λ
                           1 and λ
                           2, they represent the variation of the intensity in one linear structure's principal orientation and its perpendicular orientation, respectively. For bright structures, they satisfy |λ
                           1| < |λ
                           2|. The numerical relationship between λ
                           1 and λ
                           2 can be used for linear feature enhancement [35]. 
                              
                                 (6)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   >
                                                   0
                                                
                                             
                                             
                                                
                                                   exp
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  β
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      −
                                                      exp
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where (x,y) is the location of the filter, R
                           
                              β
                           
                           =|λ
                           1|/|λ
                           2| is a blobness measure, and 
                              Q
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                          ,
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            is a measure of the second order structureness. β and c are manually set constants. This linear feature measure H
                           
                              k
                           (x,y) is usually analyzed at different scales, k. Small scale operator is sensitive to detail signals but is also prone to noise, whereas large scale operator is robust to noise but could filter out fine details. In this work, we want to highlight the outer contour, not the details of the ship targets. Therefore, large scales are used, with k ∈{5,7,9}. The maximum of the responses over all the scales will match the size of the linear feature. The absolute value of |λ
                           2| shows the magnitude of the intensity variation in the orientation perpendicular to the principal orientation. It needs to be noted that the sign of the eigenvalues also play an important role in discriminating local patterns. To enhance the linear structure detection result, we add the sign of the eigenvalues to the original expression, and have the following 
                              
                                 (7)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          H
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    exp
                                    (
                                    sign
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    )
                                 
                              
                           where λ′
                           =
                           λ
                           1
                           +
                           λ
                           2. The enhanced linear structure map I
                           
                              ls
                            is obtained as follows 
                              
                                 (8)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          l
                                          s
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    max
                                    
                                       
                                          
                                             H
                                          
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       |
                                       k
                                       ∈
                                       {
                                       5
                                       ,
                                       7
                                       ,
                                       9
                                       }
                                    
                                 
                              
                           
                        

After obtaining the linear structure map, a post-processing procedure is needed to remove weak and small detailed features. First, we threshold the linear structure map with a threshold T
                           
                              ls
                           ; and the binarization result is obtained as 
                              
                                 (9)
                                 
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          o
                                          u
                                          t
                                          e
                                          r
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         l
                                                         s
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ≥
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         l
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

In this paper, to obtain adaptive thresholds, we propose to associate the threshold value with local region properties. Among the existing adaptive thresholding method, mean and standard variance are widely used for threshold determination and have been proved to be effective [36]. Therefore, we use flexible linear combination of mean and standard variance to determine the thresholds. Here, the threshold T
                           
                              ls
                            is set as 
                              
                                 (10)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          l
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          l
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          l
                                          s
                                       
                                    
                                 
                              
                           where μ
                           
                              ls
                            and σ
                           
                              ls
                            are the mean and standard deviation of the linear structure map I
                           
                              ls
                           . Then we remove small linear features by size selection, linear features with size smaller than S
                           
                              ls
                            are removed (with S
                           
                              ls
                           
                           =20). Thus we can obtain long salient linear features, indicating the outer contour of the ship target, the long coastline or the boundary of the sea port, as shown in Fig. 3 (e).

For different IR images, although their backgrounds are different, the ship targets generally appear as a bright region comparing with its surrounding background. So we detect bright regions by background subtraction, thus to remove most of the dark backgrounds. In the existing literatures, several models have been developed for background subtraction [37]. We intend to model the background in each single image, which requires a fixed background with much lower level of noise. In real images, this requirement cannot be rigorously satisfied, and a common method is to model each background pixel with a probability density function. As a single Gaussian model can account for noise [38] and it is much simple and efficient comparing with other complex models, we model each pixel with a Gaussian function with N(μ,σ
                           2).

The foreground I
                           
                              t
                            is obtained by comparing the input filtered image I
                           
                              f
                            with the estimated background I
                           
                              b
                           . Regions with brighter intensities than the corresponding estimated background are taken as bright foreground region, that is 
                              
                                 (11)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          f
                                       
                                    
                                    −
                                    
                                       
                                          I
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          b
                                          r
                                          i
                                          g
                                          h
                                          t
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ≥
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The threshold T
                           
                              D
                            is calculated in the following manner 
                              
                                 (13)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          D
                                       
                                    
                                    =
                                    τ
                                    ⋅
                                    (
                                    
                                       
                                          μ
                                       
                                       
                                          f
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          f
                                       
                                    
                                    )
                                 
                              
                           where μ
                           
                              f
                            and σ
                           
                              f
                            are the mean and standard variation values of the foreground image I
                           
                              t
                           , respectively; τ is a control parameter, and the determination of τ will be discussed later. The bright foreground region detection result is shown in Fig. 3 (f).

Different features describe different characteristics of the ship targets. To obtain a comprehensive description of the target region, we propose to integrate all the feature maps mentioned above together with the filtered image. As different feature maps have different ranges and extraction mechanisms, it is difficult to combine them into a unique scalar saliency map. Therefore, all the feature maps are first normalized to the same range of (0,1) with 
                              
                                 (14)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          z
                                       
                                    
                                    =
                                    
                                       
                                          f
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           where f
                           
                              max
                            and f
                           
                              min
                            are the maximum and minimum values of the image f. f can be the local row contrast map I
                           
                              lrc
                           , the edge strength map I
                           
                              em
                           
                           ′, the salient linear structure BW
                           
                              outer
                           , the bright foreground region I
                           
                              t
                           ,BW
                           
                              bright
                           , and the filtered image I
                           
                              f
                           . Thus we obtain the normalized form of each attribute, I
                           
                              lrcz
                           , I
                           
                              emz
                           , I
                           
                              tz
                           , and I
                           
                              fz
                           .

Then all the normalized feature maps are integrated into a unique saliency map. Here, as the salient ship target region appears strongly in all the feature maps, a simple integration strategy is used. We sum all the feature maps into the saliency map in a linear manner as follows, where the binary masks BW
                           
                              outer
                            and BW
                           
                              bright
                            are used as weights. 
                              
                                 (15)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          s
                                          a
                                          l
                                       
                                    
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          f
                                          z
                                       
                                    
                                    ⋅
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          t
                                          a
                                          r
                                          g
                                          e
                                          t
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          l
                                          r
                                          c
                                          z
                                       
                                    
                                    ⋅
                                    
                                       
                                          I
                                       
                                       
                                          e
                                          m
                                          z
                                       
                                    
                                    +
                                    
                                       
                                          I
                                       
                                       
                                          t
                                          z
                                       
                                    
                                    )
                                    ⋅
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          b
                                          r
                                          i
                                          g
                                          h
                                          t
                                       
                                    
                                 
                              
                           where BW
                           
                              target
                           
                           =
                           BW
                           
                              bright
                           
                           −
                           BW
                           
                              outer
                           . By subtracting salient outer contour regions from the bright foreground region, we can effectively remove the linear coastline or the boundary of the sea port, which is helpful to separate the ship target from its closely connected background. After combining all the feature maps, regions with bright intensity, strong edge strength, and high local row contrast will show great saliency, as shown in Fig. 3 (g).

In this part, we intend to segment each salient region using a local adaptive thresholding method. At first, the saliency map I
                           
                              sal
                            is coarsely segmented into n regions {S
                           1,…,S
                           
                              n
                           } using thresholding method. Firstly, for each pixel (x,y) in the saliency map I
                           
                              sal
                           , by comparing the value I
                           
                              sal
                           (x,y) with a given threshold T
                           
                              sal
                           , we obtain the binary mask BW
                           
                              sal
                            in the following way. 
                              
                                 (16)
                                 
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          s
                                          a
                                          l
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         s
                                                         a
                                                         l
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ≥
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         s
                                                         a
                                                         l
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Then, connected regions in the binary imageBW
                           
                              sal
                            are detected through connected component labeling. Finally, by assigning each connected region with the label {1,2,…,n}, we obtain the coarsely segmented regions {S
                           1,…,S
                           
                              n
                           }, as shown in Fig. 3 (h). From Fig. 3 (g) we can see that the saliency map is divided into several local regions by dark areas next to them. In fact, the saliency value of these dark areas is not 0. In other words, some of these dark regions still have weak saliency. In our experiments, the saliency values of these dark regions are generally smaller than 0.1. Therefore, to remove these dark regions, we set T
                           
                              sal
                           
                           =0.1.

For the coarsely segmented regions S
                           
                              i
                           , 1 ≤ i ≤ n, their intensity distributions are different. To obtain the final segmentation result, we develop a local adaptive thresholding method, which calculates the local threshold according to the properties of each region. A straightforward and simple way to describe local region properties is to use its mean and standard deviation values. Therefore, as mentioned above, the threshold for each region is determined using the linear combination of its mean and standard deviation value as follows 
                              
                                 (17)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          s
                                          i
                                       
                                    
                                    =
                                    m
                                    e
                                    a
                                    n
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    sign
                                    (
                                    α
                                    −
                                    1
                                    )
                                    ⋅
                                    α
                                    ⋅
                                    s
                                    t
                                    d
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           where meanS
                           
                              i
                            and stdS
                           
                              i
                            are the mean and standard deviation values of region S
                           
                              i
                           , respectively; sign(x) is the sign function as mentioned before. α is the parameter used to control the threshold, and the determination of α will be discussed later.

The segmentation result of region S
                           
                              i
                            is expressed as 
                              
                                 (18)
                                 
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          s
                                          i
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ≥
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         s
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

After the thresholding process, there are still some background regions which have great saliency; so it is necessary to perform a region selection to remove those non-target regions. We propose a target selection procedure which integrates region properties and shape features. Generally, ship target regions show stronger saliency and edge strength, so the region properties used are maximum region saliency M
                           
                              rs
                            and salient edge strength ratio E
                           
                              r
                           . The edge strength ratio measures the amount of salient edges contained in the local region. It is defined as the ratio between the area of the salient edges and the local region. Given a local salient region BW
                           
                              si
                           , the maximum region saliency 
                              
                                 
                                    M
                                 
                                 
                                    r
                                    s
                                 
                                 
                                    i
                                 
                              
                            and the salient edge strength ratio 
                              
                                 
                                    E
                                 
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            are 
                              
                                 (19)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          r
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    max
                                    
                                       
                                          
                                             I
                                          
                                          
                                             s
                                             a
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ,
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ∈
                                    B
                                    
                                       
                                          W
                                       
                                       
                                          s
                                          i
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          B
                                          
                                             
                                                W
                                             
                                             
                                                e
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ∑
                                          B
                                          
                                             
                                                W
                                             
                                             
                                                s
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             B
                                             
                                                
                                                   W
                                                
                                                
                                                   s
                                                   i
                                                
                                             
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             =
                                             0
                                             ,
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   r
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   r
                                                   s
                                                
                                             
                                             
                                             or
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   e
                                                   r
                                                
                                             
                                          
                                       
                                       
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    I
                                 
                                 
                                    s
                                    a
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    s
                                    a
                                    l
                                 
                              
                              ⋅
                              B
                              
                                 
                                    W
                                 
                                 
                                    s
                                    i
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           , and 
                              B
                              
                                 
                                    W
                                 
                                 
                                    e
                                    m
                                 
                                 
                                    i
                                 
                              
                              =
                              B
                              
                                 
                                    W
                                 
                                 
                                    e
                                    m
                                 
                              
                              ⋅
                              B
                              
                                 
                                    W
                                 
                                 
                                    s
                                    i
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           , specify the salient region and the binarized edge strength map overlapping with the local segmented region BW
                           
                              si
                           . As expressed in Eq. (21), regions with the maximum saliency less than t
                           
                              rs
                            or regions with the salient edge strength ratio less than t
                           
                              er
                            are taken as backgrounds and removed. In our experiments, the thresholds are set as t
                           
                              rs
                           
                           =0.8 and t
                           
                              er
                           
                           =0.2.

Shape is one of the basic features for image description, and it plays an important role for image retrieval and target recognition [39]. For regions with high saliency and high edge strength, a further region selection process based on shape features is performed. Due to the lack of uniform shape model descriptor for ship targets, the shape features are mostly chosen based on a series of empirical hypotheses, which is similar with [22]. The shape features are region area Area, compactness C
                           
                              p
                           , width to height ratio R
                           
                              wh
                           , and upper to bottom part ratio R
                           
                              ub
                           . Although these features are chosen empirically, they are based on the observation of the whole IR ship target dataset, representing common features of most of the ship targets. Except for the width to height ratio R
                           
                              wh
                           , we calculate the other shape features in the same way as in [22]. In this work, because the ship targets are obtained from different view angles, we replace the width to height ratio with the major axis length to minor axis length ratio R
                           
                              mm
                           , expressed as 
                              
                                 (22)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          m
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                M
                                                a
                                                j
                                                o
                                                r
                                                A
                                                x
                                                i
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                M
                                                i
                                                n
                                                o
                                                r
                                                A
                                                x
                                                i
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           where L
                           
                              MajorAxis
                            and L
                           
                              MinorAxis
                            are the lengths of the major and minor axis, respectively. The major (minor) axis of the target region specifies the major (minor) axis of the ellipse which has the same normalized second central moment as the corresponding target region.

The target region selection criterion based on shape features is as follows. Regions satisfying all these criteria are taken as true ship targets and preserved, while the others are regarded as backgrounds and removed. 
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   a
                                                   1
                                                
                                             
                                             <
                                             A
                                             r
                                             e
                                             a
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   a
                                                   2
                                                
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   p
                                                
                                             
                                             >
                                             
                                                
                                                   t
                                                
                                                
                                                   c
                                                
                                             
                                             
                                             and
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   m
                                                   1
                                                
                                             
                                             <
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                   m
                                                
                                             
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   m
                                                   2
                                                
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   u
                                                   b
                                                
                                             
                                             <
                                             
                                                
                                                   t
                                                
                                                
                                                   u
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The parameters in Eq. (23) are determined experimentally. In our dataset, sizes of the ship targets vary in a large range, so we set t
                           
                              a1
                           =50, t
                           
                              a2
                           =20000 to remove backgrounds with extremely small or large areas. As a ship target appears as a regular shape, the threshold for compactness is t
                           
                              c
                           
                           =0.1. Regions with compactness less than t
                           
                              c
                            will be discarded. For most of the IR images, the outline of the ship target appears as a rectangle. Taking into account the situations where the ship target is small and the major axis is almost the same or a bit longer than the minor axis, we set a lower limit of R
                           
                              mm
                            with t
                           
                              m1
                           =0.9. An upper limit t
                           
                              m2
                           =12 is set to remove stripe like backgrounds, such as long coastlines and sea-sky lines. Generally, the upper part is much narrower than the lower part. But for images not taken from the side or images with a small ship target, the upper part is almost the same as the lower part. Therefore, we set t
                           
                              ub
                           
                           =1.1. After the selection process, we obtain the final true ship target, as shown in Fig. 3 (i). To demonstrate the result clearly, boundary of the segmented ship target is overlaid on the original IR image, as shown in Fig. 3 (j), and the width of the overlaid boundary is set to three pixels.

As mentioned above, the backgrounds of different IR images are different. To make the threshold adaptive to different images, we associate the threshold control parameters α, τ, and ρ with the estimated background and corresponding image properties. Generally, for IR images with high contrasts, the target region is much brighter than the background, and the expected threshold is much lower. While for IR images with low contrasts, the difference between the target region and the background is not distinct; therefore the expected threshold is much higher. Based on this observation, we calculate the control parameter α in Eq. (17) using 
                              
                                 (24)
                                 
                                    α
                                    =
                                    m
                                    e
                                    a
                                    n
                                    b
                                    /
                                    (
                                    m
                                    a
                                    x
                                    b
                                    −
                                    m
                                    e
                                    a
                                    n
                                    b
                                    )
                                 
                              
                           where meanb, maxb are the mean and maximum values of the estimated background I
                           
                              b
                           , respectively. For images with high contrasts, the difference between the maximum and mean value of the background is large; while for images with low contrasts, the difference is small. So for images with high contrasts, the mean value meanb is much smaller than that of maxb
                           −
                           meanb, that is α < 1, and we have a lower threshold. While for images with low contrasts, the mean value meanb is close to maxb, so meanb is greater than maxb
                           −
                           meanb. Hence we have a higher threshold with α > 1. Consequently, by associating α with the estimated background, we can obtain the local threshold for each salient region adaptively.

The control parameters τ in Eq. (13) is closely related to α. The bright foreground detection result is affected by the estimated background, therefore the expected threshold T
                           
                              D
                            is similar to T
                           
                              si
                           . That means a high T
                           
                              D
                            is expected for an image with a low contrast, while a low T
                           
                              D
                            is expected for an image with a high contrast. Therefore, the value of τ is similar to that of α. In this work, we set τ
                           =
                           α.

Another control parameter ρ in Eq. (3), which is used for edge strength map detection, is also related to α. It is obtained by 
                              
                                 (25)
                                 
                                    ρ
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          sign
                                          (
                                          s
                                          t
                                          d
                                          M
                                          −
                                          b
                                          )
                                       
                                    
                                 
                              
                           where stdM is the standard deviation of the edge strength map I
                           
                              em
                           ; b is a constant, and we set b
                           =0.01. For IR images with low contrasts and small targets, few details are contained, so the edge strengths of the image are weak with a small standard deviation. When stdM is smaller than b, and sign(stdM
                           −
                           b) is −1, and α > 1 as mentioned above, we obtain a small ρ value. This is helpful for preserving the edge strengths of the ship targets. On the other hand, IR images with high contrasts and large targets contain many details structures. In this case, we obtain a large ρ value, which can preserve strong edge strengths while removing weak ones.

@&#EXPERIMENTAL RESULTS@&#

The proposed method is tested on an IR image dataset supplied by co-researchers. The dataset was acquired by fixed ship-borne cameras from different scenes, including 320 IR ship target images, with sizes ranging from 320×256 to 720×576pixels. This dataset not only includes IR images with bright ship target in sky and sea backgrounds, but also includes IR images with ship target in bright port background and ship target with uneven intensities, which is much complex than the dataset used in [22]. The images were processed using an Intel(R) Core(TM) i5-2400 processor, 3.10 GHz CPU, with 4.00 GB RAM. We tested the proposed method using fixed parameters given in Section 2, and parts of the experimental results are illustrated in Fig. 4
                        .


                        Fig. 4 (a) demonstrates some IR images from the test dataset. Fig. 4 (b) shows the pre-processing results using fast bilateral filtering. Fig. 4 (c)–(f) shows the feature maps, including the local row contrast, edge strength, salient outer linear structure, and bright foreground regions. Fig. 4 (g) illustrates saliency maps obtained by feature map integration. Fig. 4 (h) shows the local salient region thresholding results, and Fig. 4 (i) shows the final ship target segmentation result after region selection.


                        Fig. 4 (a) shows that these images have different backgrounds and ship targets, requiring that the segmentation method should be robust and adaptive. The filtering results in Fig. 4 (b) show that the complex background can be effectively smoothed and details of the ship targets are well preserved, which is helpful for the segmentation. From Fig. 4 (c)–(f) we can see that these feature maps effectively represent important information of the ship targets, which are useful for identifying the ship target region. However, as each feature map highlights a certain property of the ship target, it is difficult to effectively segment the whole ship target using each feature map separately. Fig. 4 (g) shows that with the proposed integration method, we can successfully highlight the ship target regions in the saliency map. Although there are some background regions with great saliency, they are successfully separated from the ship target regions. Finally with the region selection procedure, we can effectively remove background regions and obtain the ship targets, as shown in Fig. 4 (h) and Fig. 4 (i). As illustrated in Fig. 4 due to the integration of various features of the ship targets, the proposed method can effectively segment ship targets from IR images with dark or bright backgrounds. Even for images where the ship target is closely connected with the port, the proposed method can still successfully segment the ship target. In addition, the proposed method works well for images with multiple ship targets of different sizes.

To demonstrate the effectiveness of the proposed method, visual and quantitative comparisons are also made. We compared the proposed method with four other segmentation methods, including the maximum entropy based thresholding method (Entropy) [17], the mean-shift segmentation method (MS) [6], the improved active contour model driven by local image fitting energy (AC-LFE) [11], and the IGT [22]. The Entropy method is a widely used thresholding method for IR image segmentation. The MS method has a wide range of applications in IR image processing, including image smoothing, segmentation, and tracking. The AC-LFE method is an interactive active contour method which shows good performance on IR image segmentation, and the IGT method is an effective automatic thresholding method for IR ship target image segmentation. Moreover, these four methods have better performances in IR ship target segmentation comparing with other popular methods [22], such as Otsu's thresholding method [16], fuzzy C-means clustering method [18], and the Chan–Vese method [9]. Therefore we choose them as the comparison methods. To make the comparison fair and reasonable, we applied the same pre-processing operation to improve the IR image quality, and tried to obtain the best possible results from the other four methods by tuning the relevant parameters. The comparison results are presented in Fig. 5, Fig. 6 and Table 1
                        
                        
                        . To clearly demonstrate the results, the width of the overlaid boundaries in Fig. 5 and Fig. 6 are set to three pixels. To ensure a fair comparison and strengthen the superiority of the proposed method, for the AC-LFE method, we take the contour of the dilated binary result in step (h) of our method as the initial curve. To make it clearly displayed, the initial curve is overlaid on the original image,as shown in Fig. 5 (a) and Fig. 6 (a).


                           Fig. 5 shows some of the comparison results on IR images with bright backgrounds or large ship target with uneven intensities. The Entropy method works well for IR images with bright sea background (e.g., images from the fourth and fifth rows). As the ship target is much brighter than its surrounding background, the Entropy method can successfully segment the ship targets. However, for IR image where the ship target is surrounded by a bright background (e.g., image from the sixth row), the Entropy method cannot separate the ship target from the bright background. And for a large ship target with uneven intensities (e.g., images from the third and seventh rows), parts of the target with dark intensities are missed. From the first to the third rows we can see that for ship targets in a port, as the intensities of the ship target and the port are similar, and they are closely connected, the Entropy method fails to segment the ship target.

Similarly, the MS and the AC-LFE methods can also obtain satisfactory results for IR images with bright sea backgrounds. It needs to be noted that the AC-LFE method can segment one target successfully, which may not work well for images with multiple different targets using one initial curve. To get better segmentation results for the fair comparison of multiple targets, we use multiple initial curves for AC-LFE, that is, one curve for each target(e.g., image from the fourth row). On the other hand, the MS method can work with multiple targets, but it can only successfully segment the bright ship target (e.g., image from the fourth and the sixth rows). For the dark ship target (e.g., image from the fifth row), the MS method wrongly classify it as the background region. For a large ship target with uneven intensities or a ship target in the port, the performances of the MS and the AC-LFE methods are comparable. The AC-LFE method can remove most of the background regions, but it fails to segment the ship target exactly. And it is difficult for the AC-LFE method to converge properly. The MS method can extract the whole ship target, but it fails to remove the background regions. For ship targets in a port (e.g., images from the first to the third rows), the port is wrongly classified as target using the MS method.

The IGT method shows a bad performance for these images. For IR images with a bright sea background, due to the assumption that the target region is brighter than the background, the IGT method wrongly takes the brightest background region as a target and discards the true target region (e.g., images from the fourth to the sixth rows). For IR images with uneven intensities, some of the dark parts of the ship target are also missed during the iteration (e.g., image from the seventh row). The performance of the IGT method is even worse for ship targets with a bright port background (e.g., images from the first to third rows). The IGT method can hardly distinguish the ship target from the port background. Most of the bright port backgrounds are taken as target regions while the dark target regions are discarded as backgrounds.

The proposed method achieves a superior performance due to the effective combination of important features of the ship targets. It can successfully segment the ship targets with a bright background and uneven intensities, and effectively separate the ship target from the port (e.g., image from the first to the third rows). In addition, the proposed method can deal with images with multiple ship targets. From Fig. 5 it can be concluded that the proposed method can properly deal with the problems encountered by the other methods.

To demonstrate the advantages of the proposed method, more comparison results on IR images with high, low contrasts, and uneven backgrounds are shown in Fig. 6. For images with high contrasts (e.g., images from the first and second rows) and images with uneven background (e.g., images from the third and the fourth rows), the performance of the Entropy method is better than the MS and AC-LFE methods. The Entropy method can successfully separate the ship target from the background, while for the MS and AC-LFE methods, there are still parts of the background region which are classified as a target region. For images with low contrasts and small targets, the AC-LFE method is much better than the Entropy and MS methods (e.g., images from the fifth to the seventh rows). Both the Entropy and MS methods fail to segment the ship targets from images with low contrasts while the AC-LFE method can still work well. Similarly, to get better segmentation results for multiple targets, we use multiple initial curves for AC-LFE (e.g., image from the sixth row). However, from the sixth row of Fig. 6 (d) we can see that for the two small targets with low contrasts, the segmentation result is still not satisfying. The performance of the IGT method is promising for these images, as the ship targets are bright regions with fuzzy contours. However, due to the limitation of the target region selection criteria, some of the ship targets are discarded during the selection process (e.g., image from the third and the sixth rows), while for some other images (e.g., images from the first and the fourth rows), there are still some background regions need to be removed. By comparing with the results of the IGT method, we can see that the proposed method achieves a better performance, even for the images with low contrasts and uneven backgrounds.

However, although the proposed method can deal with most of the problems of IR ship target segmentation, there are still some situations the proposed method cannot work well, as shown in Fig. 7
                            The initial curves of the AC-LFE for these images are selected manually and overlaid on the original image (Fig. 7 (a)). As the intensities of the ship targets are uneven, and parts of the ship target are mixed with the background, all the listed methods cannot successfully segment the whole ship targets. For the images in the first row, the IGT method shows a better performance than the others, whereas for the image in the second row, which is taken from a downward looking view, the IGT method fails to obtain the ship target. For these situations, the proposed method can segment parts of the ship targets, more efforts are needed to obtain better results in future work.

Quantitative evaluation is performed to further verify the effectiveness of the proposed method. We take two measures for performance analysis, misclassification error (ME) and relative foreground area error (RAE) [40]. ME measures the percentage of pixels wrongly classified, defined as [40] 
                           
                              
                                 (26)
                                 
                                    M
                                    E
                                    =
                                    1
                                    −
                                    
                                       
                                          |
                                          
                                             
                                                B
                                             
                                             
                                                o
                                             
                                          
                                          ∩
                                          
                                             
                                                B
                                             
                                             
                                                T
                                             
                                          
                                          |
                                          +
                                          |
                                          
                                             
                                                F
                                             
                                             
                                                o
                                             
                                          
                                          ∩
                                          
                                             
                                                F
                                             
                                             
                                                T
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                B
                                             
                                             
                                                o
                                             
                                          
                                          |
                                          +
                                          |
                                          
                                             
                                                F
                                             
                                             
                                                o
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           where B
                           
                              o
                            and F
                           
                              o
                            are the background and foreground of the reference image, respectively; B
                           
                              T
                            and F
                           
                              T
                            are the background and foreground of the segmented image; |•| is the cardinality of a set. Note that as there is no ground-truth available, the reference image used for the evaluation is provided by manual segmentations, which were made by the researchers in our group.

RAE reflects the segmentation accuracy with respect to the reference image, defined as [40] 
                           
                              
                                 (27)
                                 
                                    R
                                    A
                                    E
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               o
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where A
                           
                              o
                            is the area of the target in the reference image; A
                           
                              T
                            is the area of the segmented target. The range for both the ME and RAE measures is [0,1], and a smaller value indicates a better segmentation results. That is, 0 for a perfect segmentation result and 1 for a totally wrong segmentation. The quantitative evaluation results with the average ME, average RAE, and average processing time are shown in Table 1.

From Table 1, we can see that the proposed method gives better performance than the other four methods with lower average ME and average RAE, indicating that the proposed method is effective and it can obtain much accurate segmentation results for most of the images. Currently, each of the feature map is obtained in a serial manner, the processing time is a bit longer comparing with the Entropy, the MS, and the IGT methods, but much shorter comparing with the AC-LFE method. The segmentation procedure can meet the requirement for non-real time ship target feature analysis, and parallel processing will be helpful to improve the processing efficiency.

@&#CONCLUSIONS@&#

IR image segmentation is an important technique in the field of IR image processing, and it has wide applications. To segment the IR ship targets, an effective segmentation method based on feature integration is presented in this paper. To make the method robust for different IR images, we take advantages of multiple features of the ship targets, including local contrast, edge strength, salient linear structures, and bright intensities. Firstly, we construct a salient region map by integrating these features, thus to highlight the ship target region as well as to separate the target from the background. Then, we develop a local adaptive thresholding method for each salient region segmentation, thus to segment all the ship targets in the IR image. Besides the two main steps, a pre-processing step using fast bilateral filtering and a target selection procedure based on region and shape features are used to improve the performance. Experimental results demonstrate that the proposed method works well for IR ship target segmentation with different backgrounds. Due to the integration of complementary properties of multiple features, this method is effective and robust. It can effectively segment IR ship targets, especially for ship target with bright port background and large ship target with uneven intensities. The visual and quantitative comparison results verify that the proposed method is superior to the other well known methods. Therefore, the proposed method would be useful for the applications of IR ship target detection and tracking.

Currently, the thresholds used are determined in a heuristic way, and the implementation is carried out in a serial mode. In our future work, we would investigate more theoretical guaranteed method for adaptive threshold determination, and some parallel processing technologies would be further considered to improve the efficiency.

@&#ACKNOWLEDGMENTS@&#

This work was performed under the sponsorship of National Natural Science Foundation of China (61271023), Program for New Century Excellent Talents in University (NCET-13-0020), China Postdoctoral Science Foundation (2015M580952) and China Scholarship Council (201306020106).

@&#REFERENCES@&#

