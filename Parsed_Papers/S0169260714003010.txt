@&#MAIN-TITLE@&#Detection of c, d, and e waves in the acceleration photoplethysmogram

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A robust algorithm to detect c, d, and e waves in the acceleration photoplethysmogram signals.


                        
                        
                           
                           To our knowledge, this is the first algorithm published for this purpose.


                        
                        
                           
                           The accurate detection of c, d, and e waves will enable researchers to monitor serious abnormalities and health problems.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ascular effects

Aging

Hypertension

Atherosclerosis

@&#ABSTRACT@&#


               
               
                  Analyzing the acceleration photoplethysmogram (APG) is becoming increasingly important for diagnosis. However, processing an APG signal is challenging, especially if the goal is to detect its small components (c, d, and e waves). Accurate detection of c, d, and e waves is an important first step for any clinical analysis of APG signals. In this paper, a novel algorithm that can detect c, d, and e waves simultaneously in APG signals of healthy subjects that have low amplitude waves, contain fast rhythm heart beats, and suffer from non-stationary effects was developed. The performance of the proposed method was tested on 27 records collected during rest, resulting in 97.39% sensitivity and 99.82% positive predictivity.
               
            

@&#INTRODUCTION@&#

The pulse wave analysis provides more precise information concerning blood pressure changes than systolic and diastolic pressures only [1]. It is a valuable method to assess aortic stiffness and elasticity [2–4], and to evaluate the vascular effects of aging, hypertension, and atherosclerosis [5–8]. Photoplethysmography (pulse oximeter) is the most common device used to measure pulse waves, which illuminates the skin and measures changes in light absorption. The measured signal has been referred to as photoplethysmogram (PTG/PPG) and digital volume pulse (DVP); however, the acronym PPG will be used exclusively within this study, according to the recommendations in [9]. Fingertip PPG mainly reflects the pulsatile volume changes in the finger arterioles, as shown in Fig. 1
                     .

For more accurate recognition of the inflection points and easier interpretation of the pulse wave, the second derivative of the original plethysmogram wave was introduced [10]. The acronym of the second derivative PPG is SDPPG or APG; however, the acronym APG will be used exclusively in this study, according to the recommendations in [9].

As shown in Fig. 1, the waveform of the APG consists of four systolic waves (a, b, c, and d waves) and one diastolic wave (e wave) [11]. The height of each wave was measured from the baseline, with the values above the baseline being positive and those under it negative. The relative heights of these waves (b/a, c/a, d/a, and e/a ratios), particularly the c/a ratio has been related to arterial stiffness and aging [7,12] and essential hypertension [13]. All these ratios were used in calculating the ‘ageing index’ (b
                     −
                     c
                     −
                     d
                     −
                     e)/a 
                     [7]. Recently, the detection of a waves in APG signals has been used to calculate heart rate [14–16] and heart rate variability indexes [17,18]. Moreover, Homma et al. [19] categorized the APG into seven types depending on the waveforms. The clinical description of these categories has been demonstrated in Fig. 2
                     .

Although the clinical significance of APG measurement has been well investigated, there is still a lack of studies focusing on the automatic detection of c, d and e waves in APG signals. However, there was an attempt by Matsuyama [20] to determine which of the nine QRS algorithms of Friesen's ECG algorithms [21] suits the detection of a waves in APG signals. However, up to the present, there has been no attempt to detect c, d, and e waves in APG signals; therefore, this investigation aimed to develop an algorithm to detect c, d, and e waves in APG signals. To test the robustness of the developed algorithm, noisy PPG signals (measured after exercise) were used.

The PPG data were collected as a minor part of a joint project between Charles Darwin University (Darwin, Northern Territory, Australia), the Defence Science and Technology Organisation (DSTO), and the Department of Defence and was initiated by the Department of Defence [20]. The main aim of the project was to assess the effect of varying degrees of airconditioning exposure in hot environments [20]. The project has been granted human research ethic clearance from Charles Darwin University [20]. Only de-identified numerical data, representing PPG signals as vectors, are stored on the database. The database is available upon request at Charles Darwin University: http://www.cdu.edu.au/ehse.

There are currently no standard PPG databases with annotated c, d and e waves available to evaluate the developed algorithms. One annotated PPG database is available at Charles Darwin University. The data were collected during rest (before exercise) and after 1h of exercise (walking) on a treadmill in the climate control chamber at Northern Territory Institution of Sport (Darwin, Australia). The speed of treadmill was set to 5km/h with a 1% increment corresponding to the effort required to walk with 8kg of webbing. The exercise was considered to be of moderate intensity, and the background of the entire project can be found in [20].

PPGs of 27 healthy volunteers (males) with a mean±SD age of 27±6.9 were measured using a photoplethysmography device (Salus APG, Japan), with the sensor located at the cuticle of the second digit of the left hand, in which all subjects were included. Measurements were taken while the subject was at rest on a chair. PPG data were collected at a sampling rate of 200Hz and the duration of each recording was 20s. For signal conditioning and wave detection, MATLAB 2010b (The MathWorks, Inc., Natick, MA, USA) was used.

The PPG signals collected after 1h of exercise were used for training as they includes different shapes of PPG waveforms and noise. Moreover, they contained fast rhythm PPG signals, with a total of 885 heart beats, which had an impact on the detection accuracy.

PPG signals measured during rest (before exercise), with a total of 584 heart beats, were used for testing as they contain different morphologies of the c, d, and e waves. They also include different types of noises, such as power-line interferences (50Hz and its harmonics, see Fig. 3
                           (a)), low amplitude signals (see Fig. 3(b)), as well as low-frequency baseline fluctuations (see Fig. 3(c–e)) and irregular heart beats (see Fig. 3(e)).

@&#METHODOLOGY@&#

In this study, a novel algorithm, adapted from the framework proposed by Elgendi to detect systolic waves in PPG signals [22] and QRS complexes in ECG signals [23], will be evaluated. The same approach will be used here to detect the c, d, and e waves. The method consists of three main stages: pre-processing (bandpass filtering, second derivative, and cancellation of a and b waves), feature extraction (generating blocks of interest using two moving averages), and classification (thresholding). The structure of the algorithm is given in Fig. 4
                        .

A zero-phase second-order Butterworth filter, with a bandpass of 0.5–7Hz based on a brute force search that will be discussed later in Section 2.3.6, was implemented to remove unwanted noise and possible movement artefacts (cf. Fig. 3). The output of the zero-phase Butterworth filter applied to the PPG signal produced a filtered signal S[n]. The code line of this step is line 2 in the pseudocode of the c, d, and e waves detection algorithm (Algorithm 1
                           ).

To obtain the APG signals, the second derivative was applied to the filtered PPG in order to analyse the APG signals. Eqs. (1) and (2) represent a non-causal filter; the three-point center derivative was created with a delay of only two samples.


                           
                              
                                 (1)
                                 
                                    
                                       S
                                       ′
                                    
                                    [
                                    n
                                    ]
                                    =
                                    
                                       dS
                                       dt
                                    
                                    
                                       |
                                       
                                          t
                                          =
                                          nT
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          2
                                          T
                                       
                                    
                                    (
                                    S
                                    [
                                    n
                                    +
                                    1
                                    ]
                                    −
                                    S
                                    [
                                    n
                                    −
                                    1
                                    ]
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    APG
                                    [
                                    n
                                    ]
                                    =
                                    
                                       
                                          
                                             dS
                                             ′
                                          
                                       
                                       dt
                                    
                                    
                                       |
                                       
                                          t
                                          =
                                          nT
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          2
                                          T
                                       
                                    
                                    (
                                    
                                       S
                                       ′
                                    
                                    [
                                    n
                                    +
                                    1
                                    ]
                                    −
                                    
                                       S
                                       ′
                                    
                                    [
                                    n
                                    −
                                    1
                                    ]
                                    )
                                    ,
                                 
                              
                           where T is the sampling interval and equals the reciprocal of the sampling frequency, and n is the data sample. Fig. 5
                           (a) shows the second derivative of the filtered PPG signal measured. The code line of this step is line 3 in the pseudocode of the proposed detector (Algorithm 1).

At this stage, the cde segment of the APG needs to be emphasized to distinguish it clearly for detection. This can be done by removing the a and b waves from the APG signal, as follows:


                           
                              
                                 (3)
                                 
                                    APG
                                    (
                                    
                                       a
                                       waves
                                    
                                    (
                                    i
                                    )
                                    −
                                    cutoff
                                    :
                                    
                                       a
                                       waves
                                    
                                    (
                                    i
                                    )
                                    +
                                    cutoff
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                           where i is the number of a waves (the peaks of a waves), while the cutoff represents the area before or after the peak of the a wave. The exact value for a cutoff of 30ms (6 samples for a sampling frequency of 200Hz) is determined after a brute force search, which will be discussed later in Section 2.3.6. The code line of this step is line 4 in the pseudocode of the proposed detector (Algorithm 1).

Blocks of interest are generated using two moving averages that demarcate the c and e waves and cde segment areas. The particular method used to generate blocks of interest has been mathematically shown to detect systolic waves [22] and QRS complexes [23].

In this procedure, the first moving average (MA
                              peak
                           ) is used to emphasize the c and e waves area, as the dotted signal shows in Fig. 5(b), and is given by


                           
                              
                                 (4)
                                 
                                    
                                       
                                          MA
                                          peak
                                       
                                    
                                    [
                                    n
                                    ]
                                    =
                                    
                                       1
                                       
                                          
                                             W
                                             1
                                          
                                       
                                    
                                    (
                                    y
                                    [
                                    n
                                    −
                                    (
                                    
                                       
                                          W
                                          1
                                       
                                    
                                    −
                                    1
                                    )
                                    /
                                    2
                                    ]
                                    +
                                    ⋯
                                    +
                                    y
                                    [
                                    n
                                    ]
                                    +
                                    ⋯
                                    +
                                    y
                                    [
                                    n
                                    +
                                    (
                                    
                                       
                                          W
                                          1
                                       
                                    
                                    −
                                    1
                                    )
                                    /
                                    2
                                    ]
                                    )
                                    ,
                                 
                              
                           where W
                           1 represents the window size of c or e wave duration. The resulting value is rounded to the nearest odd integer. The exact value for W
                           1 of 5ms is determined after a brute force search, which will be discussed later in Section 2.3.6.

The second moving average (MAcde) is used to emphasize the beat area to be used as a threshold for the first moving average, shown as a dashed signal in Fig. 5(b), and is given by


                           
                              
                                 (5)
                                 
                                    
                                       
                                          MA
                                          cde
                                       
                                    
                                    [
                                    n
                                    ]
                                    =
                                    
                                       1
                                       
                                          
                                             W
                                             2
                                          
                                       
                                    
                                    (
                                    y
                                    [
                                    n
                                    −
                                    (
                                    
                                       
                                          W
                                          2
                                       
                                    
                                    −
                                    1
                                    )
                                    /
                                    2
                                    ]
                                    +
                                    ⋯
                                    +
                                    y
                                    [
                                    n
                                    ]
                                    +
                                    ⋯
                                    +
                                    y
                                    [
                                    n
                                    +
                                    (
                                    
                                       
                                          W
                                          2
                                       
                                    
                                    −
                                    1
                                    )
                                    /
                                    2
                                    ]
                                    )
                                    ,
                                 
                              
                           where W
                           2 represents a window size of approximately the duration of the cde segment that contains the c, d, and e waves. Its value is rounded to the nearest odd integer. The exact value for W
                           2 of 15ms is determined after a brute force search, which will be discussed later in Section 2.3.6. Applying the MAcde as a threshold for the MApeak generates blocks of interest. The code lines of this step are lines 5–14 in the pseudocode of the proposed detector (Algorithm 1).

In this stage, the blocks of interest were generated, some of which will contain the c and e waves and some of which will primarily contain noise. Therefore, the next step is to reject blocks that result from noise. Rejection is based on the peak width and its relative distance to the a peak. Regarding the peak width (the duration of c, d, or e wave), it was determined in the previous step, during the calculation of MApeak; thus, the width threshold is


                           
                              
                                 (6)
                                 
                                    
                                       THR
                                       1
                                    
                                    =
                                    
                                       
                                          W
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        

In order to determine whether the detected blocks contain c or e waves, the number of blocks in each consecutive aa interval is first counted. Two thresholds (or search areas) are then applied based on the relative distance between the detected blocks and its current a wave, as shown in Fig. 6
                           . The minimum search distance for c wave is defined as


                           
                              
                                 (7)
                                 
                                    
                                       AC
                                       min
                                    
                                    =
                                    
                                       aa
                                       
                                          
                                             f
                                             s
                                          
                                       
                                    
                                    *
                                    
                                       ac
                                       min
                                    
                                    ,
                                 
                              
                           while the maximum search distance for e wave is defined as referred to as


                           
                              
                                 (8)
                                 
                                    
                                       AE
                                       max
                                    
                                    =
                                    
                                       aa
                                       
                                          
                                             f
                                             s
                                          
                                       
                                    
                                    *
                                    
                                       ae
                                       max
                                    
                                    ,
                                 
                              
                           where f
                           s refers to the sampling frequency, and the aa is the interval between the current a wave and the next a wave. The value of ac
                           min and ae
                           max is fixed; however, the value of AC
                           min and AE
                           max is the adapted to the heart rate (aa interval). The code lines of this step are lines 17–20 in the pseudocode of the proposed algorithm (Algorithm 1). The exact values of ac
                           min and ae
                           max are determined after a brute force search, which will be discussed later in Section 2.3.6.

By applying the width threshold (W
                           1) along with the two search thresholds (AC
                           min and AE
                           max), there will be two possibilities for the number of detected blocks:
                              
                                 1.
                                 More than one block: the first block (maximum value within the first block) is considered a c wave, while the second block (maximum value within the second block) is considered a e wave, as shown in cases 1 and 2 in Fig. 5(b). Moreover, the minimum value that lies between the detected c wave and the detected e wave is considered d wave. The code lines of this step are lines 30–33 in the pseudocode the proposed algorithm (Algorithm 1).

One block: the c, d and e waves are most likely merged within one block, as shown in case 3 in Fig. 5(b). The c, d, and e waves are usually merged in APG signals measured after exercise. The code lines of this step are lines 35–37 in the pseudocode of the proposed algorithm (Algorithm 1).

The detected waves were compared to the annotated waves, within a search range of ±5ms for all waves.

Performance of c, d, and e waves detection algorithms is typically evaluated using two statistical measures: SE=TP/(TP+FN) and +P=TP/(TP+FP), where TP is the number of true positives (c/d/e wave detected as c/d/e wave), FN is the number of false negatives (c/d/e wave has not been detected), and FP is the number of false positives (non-c/d/e wave detected as c/d/e wave). The sensitivity SE reported the percentage of true c/d/e waves that were correctly detected by the algorithm. The positive predictivity +P reports the percentage of the detected c/d/e waves that were true c/d/e waves. Similarly, the same statistical measures were used to evaluate the b waves.

The function of the c, d, and e waves detector (cf. pseudocode of Algorithm 1) has ten inputs: the PPG signal (PPGsignal), frequency band (F
                           1–F
                           2), and event-related durations W
                           1, W
                           2, cutoff, ac
                           min, ae
                           max, a
                           waves, b
                           waves, and f
                           s. Any change in these parameters will affect the overall performance of the proposed algorithm. These parameters are interrelated and cannot be optimized in isolation. A rigorous optimization, brute-force search based on the knowledge-based information, over all parameters, is conducted, as shown in Algorithm 2
                           . This is time consuming, as the complexity of the algorithm is O ((
                              
                                 Max
                                 
                                    
                                       F
                                       1
                                    
                                 
                              
                              −
                              
                                 F
                                 1
                              
                           )×
                           
                              
                                 Max
                                 
                                    
                                       F
                                       2
                                    
                                 
                              
                              −
                              
                                 F
                                 2
                              
                           )×(
                              
                                 Max
                                 
                                    
                                       W
                                       1
                                    
                                 
                              
                              −
                              
                                 W
                                 1
                              
                           )×(
                              
                                 Max
                                 
                                    
                                       W
                                       2
                                    
                                 
                              
                              −
                              
                                 W
                                 2
                              
                           )×(Max
                           
                              cutoff
                           
                           −
                           cutoff)×(
                              
                                 Max
                                 
                                    
                                       ac
                                       min
                                    
                                 
                              
                              −
                              
                                 ac
                                 min
                              
                              )
                           
                           ×(
                              
                                 Max
                                 
                                    
                                       ae
                                       max
                                    
                                 
                              
                              −
                              
                                 ae
                                 max
                              
                              )
                           ), but it is required before making any claims.

The data used in this training phase were the PPG signals measured at after 1h of exercise. All possible combinations of parameters (26,000 iterations) have been investigated and sorted in descending order according to their overall accuracy (the average value of SE and +P), as shown in Table 3
                           . Note, the parameters were optimized separately for each subject within the training data.

Optimization of the beat detector's spectral window for the lower frequency resulted in a value within 0.5–1Hz with the higher frequency within 4–10Hz. The window size of the first moving average (W
                           1) varied from 5 to 25ms, whereas the window size of the second moving average (W
                           2) varied from 10 to 15ms. The cutoff was tested over the range 30–70ms, and ac
                           min was tested over the range 0–40ms, while the ae
                           max was tested over the range 300–600ms. It is clear from Table 3 that the optimal frequency range for the detection algorithm over the database was 0.5–7Hz. Moreover, the optimal values for the moving-average window sizes and offset were W
                           1
                           =5ms, W
                           2
                           =15ms, cutoff
                           =30ms, ac
                           min
                           =10ms, and ae
                           max
                           =500ms. The c, d, and e detection algorithm was adjusted with these optimal parameters. The detector was then tested on PPG measured during rest without any further adjustment.

@&#RESULTS AND DISCUSSION@&#

The algorithm was tested on 27 subjects with PPG signals measured at two time points: before exercise and after exercise, with a total number of 54 recordings. The main objective is to evaluate the robustness of the algorithm against the non-stationary effects, low SNR, and high heart rate exhibited after exercise. Under controlled conditions (e.g., hospital and clinic), analyzing stationary APG signals is easier [24]; as c, d, and e waves have similar amplitudes, the statistical characteristics of the signals (i.e., mean and standard deviation) do not change appreciably with time, and a simple threshold level can effectively detect systolic peaks. Fig. 7
                     (a) represents the APG signals with stationarity effects for volunteer G3 (before exercise) with c, d, and e peaks that are almost straight-lined. Also, Fig. 7(c) represents the APG signals with stationarity effects in a fast heart rate for volunteer G2 (before exercise); however, in this case the c, d, and e peaks are almost merged. By contrast, non-stationary APG signals makes analysis difficult since the standard deviation changes with time (c, d, and e wave amplitudes vary with time, and simple level thresholds cannot optimally detect them). This has a negative effect on detection algorithm performance, especially PPG signals collected during rest.

PPG signals collected after exercises suffered from low and high frequencies because of the sweat and exhaustion of the volunteer; however, the bandpass filter succeeded in removing these artifacts. It is worth noting that the detection accuracy of any algorithm will increase for PPG signals collected after exercise. This is because of the fast rhythm caused by the stress test, which decreases the time duration between two consequent heart pulses. This will cause a merge of the c, d, and e peaks, and therefore, the detection of the merged waves will be easier (cf. Fig. 7(c)). It is important to mention that the merging of c, d, and e peaks in the case of fast heart rhythm is not caused by filtering, as shown in Fig. 8
                     .

The results show that the proposed detector is able to detect c, d, and e peaks correctly in non-stationary APG signals before exercise, as shown in Fig. 7(a and c). The proposed algorithm succeeded in detecting c, d, and e in APG signals with irregular heart beats (cf. Fig. 7(b)) and APG signals with low amplitude (cf. Fig. 7(d)). The detector scored an SE of 99.8% and +P of 99.82% in detecting c waves, an SE of 92.7% and +P of 100% in detecting d waves, and an SE of 99.64% and +P of 99.64% in detecting e waves, as shown in Table 4
                     . However, in the case of non-stationary APG signals, the algorithm did incur a few instances of failure; see Figs. 9–11
                     
                     
                     . The detector incurred one FP and one FN for detecting c waves, 18 FNs for detecting d waves, and two FPs and two FNs for detecting e waves. The cause of the failure to detect c waves is due to the extremely low amplitude c waves in APG signals during rest (cf. Fig. 9), which also caused indirect failure to detect d waves. In other words, the d waves do not have a clear minimum value between the c and e waves. Developing a robust d waves detection algorithm needs more investigation. In such cases, applying a simple level threshold to detect c, d, or e waves is not an effective approach. The proposed method, however, handles varying amplitudes, as shown Fig. 7. In fact, it is clear that the proposed algorithm is more amplitude-independent and is able to detect the c, d, and e waves in various voltage ranges.

The analysis of a regular heart rhythm is simple, as the systolic peaks are repeated with an equally spaced pattern. This regularity helps the time-domain threshold methodologies to detect c, d, and e peaks successfully. The regular heart rhythm is called the normal sinus rhythm in APG signals [25], which means the rhythm is constant and the occurrence of the next beat is predictable. The proposed algorithm easily detects systolic peaks correctly in PPG signals with a regular heart rhythm, as shown in Fig. 7(a). The sensation of an irregular heart rhythm is usually related to either premature beats or atrial fibrillation. The proposed algorithm is able to detect c, d, and e peaks with premature beats, as shown in Fig. 7(b).

The proposed method only tested on healthy subjects. The physiology of the photoplethysmogram significantly changes according to the health status. As such, the robustness of the proposed method needs to be verified by a study in unhealthy subjects. One of the next steps regarding the results of this study is to examine the c/a, d/a, and e/a ratios (based on the accurately detected c, d, and e waves) using APG signals in diagnosis and monitoring abnormality such as arrhythmia, hypertension, diabetes and hyperlipidemia. It is important to note that the PPG signals were collected from 27 healthy male subjects, a larger sample size and a more diverse data set are needed in order to generalize the findings of this study. Moreover, sampling the PPG signals at a higher rate (above 200Hz) is required to capture the c, d, and e waves more clearly. The evaluation of c and d wave detection was challenging in this study because the database did not contain all possible morphologies found in APG signals, especially for unhealthy subjects. To our knowledge, there is no available APG database with annotated c, d, and e waves that would allow a more thorough assessment and comparison of the tested algorithm.

@&#CONCLUSION@&#

Currently, a full understanding of the diagnostic value of the different features of the APG signal is still lacking, and more research is needed. Moreover, the detection algorithm of c, d, and e waves in APG signals has not been previously addressed in the literature. However, a robust algorithm has been proposed to detect c, d, and e waves simultaneously in APG signals with high-frequency noise, low amplitude, non-stationary effects, and irregular heart beats. The detection errors arose mainly from low amplitude c and e peaks relative to the d peak. The algorithm was evaluated using 27 records, containing 584 heart beats, with an overall sensitivity of 97.39% and an overall positive predictivity of 99.82%.

@&#ACKNOWLEDGMENTS@&#

I would like to gratefully acknowledge the Australian government and Charles Darwin University, as their generous scholarships facilitated this research. I appreciate the support of Prof. Friso De Boer, who provided access to the PPG database and valuable comments, and I acknowledge Dr. Gari Clifford for the helpful discussions.

@&#REFERENCES@&#

