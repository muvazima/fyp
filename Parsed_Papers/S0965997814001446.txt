@&#MAIN-TITLE@&#A combined DEM–FEM numerical method for Shot Peening parameter optimisation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel combined DEM–FEM method for Shot Peening optimisation is presented.


                        
                        
                           
                           The model provides a rapid method to investigate the effect of the peening parameters.


                        
                        
                           
                           A new algorithm was implemented accounting for impact dependent coefficients of restitution.


                        
                        
                           
                           The minimum area required in the analyses to obtain true residual stresses was determined.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Shot Peening

Residual stresses

Discrete Element Method

Finite Element Method

Optimisation

Numerical simulation

@&#ABSTRACT@&#


               
               
                  A numerical modelling approach capable of simulating Shot Peening (SP) processes of industrial interest was developed by combining the Discrete Element Method (DEM) with the Finite Element Method (FEM).
                  In this approach, shot–shot and shot–target interactions as well as the overall shot flow were simulated efficiently using rigid body dynamics. A new algorithm to dynamically adapt the coefficient of restitution (CoR) for repeated impacts of shots on the same spot was implemented in the DEM code to take into account the effect of material hardening. Then, a parametric study was conducted using the Finite Element Method (FEM) to investigate the influence of the SP parameters on the development of residual stresses.
                  Finally, a two-step coupling method is presented to combine the output of DEM simulation with FEM analyses to retrieve the Compressive Residual Stresses (CRS) after multiple impacts with the aim to evaluate the minimum area required to be modelled to realistically capture the field of residual stresses. A series of such coupled analyses were performed to determine the effect of peening angle and the combination of initial velocity and mass flow rate on CRS.
               
            

@&#INTRODUCTION@&#

Shot Peening (SP) is common industrial cold working process that is applied to induce a field of Compressive Residual Stresses (CRS) on the surface of a metallic component [1]. Compressive stresses are beneficial in increasing resistance to fatigue failures, corrosion fatigue, fretting, wear, etc. In the process, a huge number of tiny spherical particles impact the treated surface. The overall process is ruled by multiple parameters, which need to be controlled and monitored in order to induce an appropriate CRS distribution providing additional resistance to the treated component [2]. The treatment surface is impacted by a large amount of round metallic particles, the so called ‘shots’, at high velocities. Each shot acts as a tiny peen hammer, causing the surface to yield in plastic deformation and leaving a concave depression, termed dimple, on the surface of the target component. The stress field of the depression is similar to the field of a flat bar being bent. The concave side of the bar is in compression and the convex side is in tension. The normal stress along the cross section of the bar varies from a maximum compressive stress on the concave surface, to zero stress at the neutral axis up to a maximum tensile stress on the convex surface.

Several parameters have a direct influence on the CRS. The most important ones are: shot density, shot shape and material, impact angle, air pressure (shot velocity), nozzle geometry (diameter, peening angle and distance to the treated surface), and exposure time. Fig. 1
                      provides a succinct conceptual visualisation of how the peening parameters affect the peening quality.

Currently section of the optimal SP parameters is carried out empirically by performing several peening tests. The current empirical procedures are time – consuming and very expensive. An efficient numerical method for the simulation of SP processes is needed to provide a faster procedure for the selection of the optimal parameters for SP requiring the use of far less experimental tests which would be employed as validation of the numerical method rather than as a tool to search for the optimal values of the parameters. Moreover, an efficient numerical model can also help improve quality control and increase confidence in the SP process.

In this paper a novel combined DEM–FEM numerical approach was developed to simulate the SP process. Modelling SP processes is very complex since it involves the interaction of a metallic surface with an enormous number of shots. Experimental studies are normally extremely costly, especially when aiming to optimise the set of peening parameters. Numerical simulations allow for the understanding of the influence of the individual peening parameters on the field of residual stresses to be improved and for a prescribed peening target to be achieved. SP parameters are customarily chosen on the basis of either empirical laws or past practice. The relationship between the desired peening effect, particularly the residual stress distribution of the treated surface, and the peening parameters is still unknown and needs to be investigated. In fact, different values of peening parameters may give rise to very different fields of residual stress distribution.

Single and multiple shot impacts have been analysed by Al-Hassani [3], Deslaef et al. [4], Majzoobi et al. [5], Meguid et al. [6], Han et al. [7], Hong et al. [8], and Bhuvaraghan et al. [9]. Al-Hassani et al. [3] investigated the single shot impacts at various angles. Deslaef et al. [4] examined the effect of rigid and deformable shots. Majzoobi et al. [5] conducted a three dimensional numerical study where multiple shots impact on a target surface at different velocities. They concluded that the obtained residual stress distribution highly depends on impact velocity and number of impacts and that the maximum CRS rises as the velocity increases only up to a point and thereafter it begins to decline. Meguid et al. [6] performed dynamic finite element analyses of single shot impacts investigating the effects of shot velocity, size and shape and target characteristics on CRS concluding that the effects of shot parameters were more significant than the strain-hardening rate of the target material.

Most of the SP studies performed in the literature do not model the shot–shot interaction occurring during the travel from the nozzle to the target surface and the shot rebounds from the target surface. Discrete element models were proposed by Han et al. [7], Hong et al. [8] and Bhuvaraghan et al. [9] to analyse the shot–shot and shot–target interaction in more detail, assuming both shot and target surface being rigid bodies. Later on, Bhuvaraghan et al. [9] coupled the DEM with FEM. However, the relationship between the peening parameters employed as input data in the DEM and the resulting CRS in FEM has not been established.

Cao et al. [10] proposed an approximate model able to relate Almen intensity to shot velocity, however the relationship with the residual stresses in the shot peened object was not investigated. Many approaches recorded in published research deal with the prediction of residual stresses due to SP but do not relate them with Almen intensity and are therefore of limited practical interest. In contrast, Guagliano [11] employed the FEM to predict the residual stresses induced by SP on a metal target surface and related these stresses to Almen intensity simulating the impact of a few shots on a flat plate.

An explicit dynamic algorithm for modelling up to 1000 impacts was described by Wang et al. [12] who showed that the FEM is able to investigate macroscopic effects (e.g. curvature) of SP as well as microscopic effects (e.g. local plasticity and residual stresses). The study, however, did not include any shot–shot interaction.

On the other hand, this paper focuses on the development of an appropriate numerical model that can be used to optimise the peening process and the in turn the material response. In the following section, first the peening process is expounded. The proposed SP numerical model for the analysis of the shot stream in DEM and single shot impact analysis run by FEM are discussed next. A section describing the obtained results is followed by conclusions.

The Discrete Element Method (DEM) records the motion of each single particle and its interaction with other particles and surfaces using Newton’s laws of motion. The state of the system is updated incrementally, at short time intervals using explicit time integration based on a leap-frog central difference scheme. At every time step, particle accelerations, velocities and positions are calculated. Contact mechanics laws relate the inter-particle elastic force with the particle deformation through the physical and geometrical properties of the particles. Damping is employed at contacts in order to account for the loss of kinetic energy during shot interaction.

Shots are modelled as elastic isotropic bodies. The Hertz–Mindlin non-slip contact law was employed to model the shot–shot interaction and the shot–target surface interaction. The model is based on the work of Mindlin [13].

In the normal direction, the exact analytical solution for the pressure and therefore the force upon the contact is given by the Hertz law. According to this law, the normal force–displacement (N–δ) relationship is non-linear. Considering a collision between 2 particles with elastic modulus E, Poisson’s ratio ν and radii R
                           1 and R
                           2
                           
                              
                                 (1)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          4
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          n
                                       
                                       
                                          
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where the equivalent Young’s Modulus E
                           ∗, the equivalent radius R
                           ∗ are defined as
                              
                                 (2)
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3)
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           with Ei
                           , vi
                           , Ri
                            and Ej
                           , vj
                           , Rj
                            being the Young’s Modulus, Poisson ratio and radius of each sphere in contact. Additionally there is a damping force, 
                              
                                 
                                    
                                       F
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                              
                           , given by:
                              
                                 (4)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          n
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                5
                                             
                                             
                                                6
                                             
                                          
                                       
                                    
                                    β
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       m
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                            is the equivalent mass, vn
                            is the normal component of the relative velocity, the parameter β and Sn
                            (the normal stiffness) are given by:
                              
                                 (5)
                                 
                                    β
                                    =
                                    
                                       
                                          ln
                                          e
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ln
                                                   
                                                   
                                                      2
                                                   
                                                
                                                e
                                                +
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          E
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           where e is the CoR.

The tangential force, Ft
                           , depends on the tangential overlap δt
                            and the tangential stiffness St
                           .
                              
                                 (7)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           with
                              
                                 (8)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    8
                                    
                                       
                                          G
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           with G
                           ∗ being the equivalent shear modulus.
                              
                                 (9)
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Additionally, tangential damping is given by:
                              
                                 (10)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          t
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    -
                                    2
                                    
                                       
                                          
                                             
                                                5
                                             
                                             
                                                6
                                             
                                          
                                       
                                    
                                    β
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           where vt
                            is the relative tangential velocity.

As in the normal direction, we assume that the plastic dissipation can be expressed by a CoR. However, it is important to note that dissipation can also occur due to friction. Therefore, unlike the normal case, the contact law is made by a linear spring, a dashpot and a slider. The CoR will be assumed equal to the normal case: et
                           
                           =
                           en
                           . In the same way the tangential damping force will be calculated according to Eqs. (3) and (4).

Metal spheres do not behave elastically but undergo permanent deformations during collisions at high speed, when the contact tractions exceed their elastic limits. This means that the particle kinetic energy is dissipated by the occurrence of plastic strains, heat transfer and elastic wave propagation. According to the study by Wu et al. [14], the latter phenomenon is negligible in comparison with the energy dissipated via plastic deformations and heat transfer. To use a contact law characterised by an elasto-visco-plastic model such as those typical of continuum mechanics would be overly complex and unaffordable from a computational point of view. As a result, the adopted model simulates the shots interaction by approximating the energy and momentum lost by the colliding shot by means of the so-called coefficient of restitution.

Hertz–Mindlin law applies to purely elastic bodies whereas CoR was derived from experiments on elasto-plastic. The approximation introduced by our law is to separate out the elastic and plastic deformations. The relationships among the CoR, the incoming velocity, the collision time and the contact force/displacement, were discussed in [15] and the FE analysis agreed closely with the results produced by applying the Hertz theory. The coefficient expresses the total amount of energy dissipated and momentum loss during an impact without calculating the permanent local deformations undergone by the interacting surfaces. It is defined as:
                              
                                 (11)
                                 
                                    e
                                    =
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           with vr
                            and vi
                            the rebound and impact velocities respectively.

The CoR is likely to affect significantly the final CRS, therefore it should be determined as accurately as possible for the various types of interactions. The CoR depends on both the impact velocity, and the impact angle θi
                           . Therefore, ideally values of en
                            and et
                            should be experimentally determined for a set of values of Vi
                            initial velocity and θi
                            the angle of impingement. The CoR for the shot–surface interaction will substantially vary depending on the history of previous collisions on the shot and plastic deformation occurred by the component. In Table 1
                           , experimental data about the values of the CoR for shot–surface interaction for successive hits are reported. Keeping track of the location of each impact on the target surface over time, it is possible to implement values of CoR in the DEM code which change over time as a function of the number of previous impacts at the same location. In this way, it is possible to assess the effect of an impact dependent CoR on the obtained CRS and whether a value of the CoR averaged out of the number of collisions per spot could be applied instead.

The CoR for sphere–sphere interaction, es
                           
                           –
                           
                              s
                            is different from the sphere–flat plate interaction es
                           
                           –
                           
                              p
                           . In the absence of experimental data, es
                           
                           –
                           
                              p
                           
                           =0.4 was assumed for both normal and tangential direction independent of the angle of impact and of the relative velocity between colliding shots.

To assign a prescribed a viscous damping force, Fd
                           , was applied to the two shots involved in the collision:
                              
                                 (12)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    -
                                    η
                                    v
                                 
                              
                           with η being the damping coefficient and v the relative velocity between the two colliding particles. The relationship here employed to work out the damping coefficient corresponding to the desired CoR is from Tsuji et al. [16]. They numerically integrated the differential equation of motion (single degree of freedom system) for various values of the viscous coefficients, then evaluated the CoR as ratio between initial and final velocity to obtain the relationship of CoR vs. viscous coefficient.
                              
                                 (13)
                                 
                                    η
                                    =
                                    α
                                    
                                       
                                          
                                             
                                                mK
                                             
                                             
                                                H
                                             
                                          
                                       
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    
                                    with
                                    
                                    α
                                    =
                                    
                                       
                                          
                                             
                                                5
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    
                                       
                                          2
                                          ln
                                          (
                                          e
                                          )
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      (
                                                      ln
                                                      (
                                                      e
                                                      )
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

3D DEM analyses were performed using the commercial discrete element code EDEM [17]. The input data for the simulations consists of: the nozzle inner diameter dn
                            and the distance d, between nozzle and target surface, the angle between nozzle and treated surface, the so-called angle of attack θ. Spherical shots of equal size were randomly generated at the nozzle cross section using the Particle Factory function in EDEM. The number of shots delivered from the nozzle in a given time period is a function of the presented mass flow rate used in the peening process. The initial velocity of the shots, Vi
                           , is a function of the air pressure of the peening system. In this simulation a variation of 5% around the initial velocity was applied. SP quality is determined by the generated CRS pattern within the target component derived by the energy transfer and plastic deformation. The impact energy can be easily extracted from the DE simulation. One way to evaluate the impact energy is to determine the velocity of the shot just before impact. In the DEM simulation, the shots impacting on the target were continuously monitored and recorded along with time of impact, impact position and the components of this velocity along three coordinates are Vox
                           , Voy
                            and Voz
                            respectively.

An algorithm to change the CoR for repeated impacts for the same location was implemented using the User Defined Library (UDL) in EDEM. The EDEM application triggers the UDL module for every shot–shot and shot–target collision. Once a shot–target collision is detected, the contact location of the target surface is retrieved and for every new contact the facets falling within the predefined impact diameter is recorded. The corresponding CoR data for the impact number is then retrieved from Table 1 and applied to compute the contact forces. Fig. 2
                               shows the process flow diagram. The results depend on the mesh size, the number of impacts per geometry face and the values of the CoR data. The shot–shot, shot–target interaction including the resulting CRS were compared and analysed for the constant CoR case and for the case of variable CoR which progressively increases with number of impacts.

The DEM is unable to model the plastic deformations and residual stresses induced on the treated surface. Hence, a FE analysis is needed to determine the compressive residual stresses of the surfaces. In our system a User Defined Library (UDL) is created within the EDEM application to log locations and impact velocities. This information is then used to create the Abaqus input files. Depending on the target geometry size and number of impacts, the input file can become very large. Since running a set of programs to generate a computable FE input from the DEM output can be very time consuming, we implemented an algorithm to generate the Abaqus input files within the DEM code.

In the simulation, the DEM application uses a coarse mesh while the FEM analyses require a finer mesh to capture the CRS. This would require the coupling algorithm to match the meshes in DEM and FEM according to the impact location. Previously, Bhuvaraghan et al. [9] coupled DEM and FEM by recording the forces, location and indentation information to apply the equivalent pressure to retrieve the CRS. They retrieved the indentation information from simulations of single shot impacts. The circular pressure zone was modelled as an octagonal zone to follow the mesh pattern. However, in this study shots were assumed to impact the target surface in the normal direction only. Hence, this method is unable to replicate the different indentations produced by shots impacting the treated surface at different angles. Moreover, the subsequent shots impacting the intended area will rebound differently.

In our approach instead, the shots are modelled in FEM as rigid particles and placed right above the location recorded in DEM. A new step is created with initial conditions using the shot impact velocity from DEM. In the next step, the impact is performed and excluded in future steps. In this way, we retrieve the exact indentation for different shots sizes impacting at various angles and velocities. The advantage of the proposed method lies in the fact that there is no need to employ the same mesh for the DEM and FEM analyses. Fig. 3
                         illustrates the algorithm via a flow diagram detailing the coupling between the DEM code EDEM and the FEM code Abaqus [16,17]. The coupling can be outlined in the following steps:
                           
                              1.
                              The ∗.stl geometry file is loaded into Abaqus and the material properties are selected. The input file is created and separated into dynamic and static parts. These are parts of the main input file that need to be populated and parts of the file that will remain unchanged regardless of the number of impacts, location, etc. The main input file is divided into four separate files. The dynamic parts are discarded and the static parts are saved to be used later in step 6.

The same ∗.stl file is loaded into the commercial EDEM program along with a file containing the geometry surface data from FEM.

The SP model is set up with the individual peening parameters.

The DEM SP simulation is run, applying the CoR for repeated impacts. For each new shot–target contact the impact location and velocity are recorded.

When the simulation ends, two separate files are created containing the ∗Nset, ∗Step and ∗Loads parts of the Abaqus file. Impacts that are further away from each other are grouped together and are computed simultaneously in the same time step. This reduces the computation time and the output size of the file.

The two output files created from the EDEM simulations are then merged together with the two files from step one to generate the main Abaqus input file.

The input file is then loaded into Abaqus to obtain the residual compressive stresses.

@&#RESULTS@&#

First, the number of impacts after which the system reaches a steady sate was investigated. Impact velocities just before the shot–target collision were recorded and analysed. Fig. 4
                            shows the distribution of normalised impact velocities for the considered reference case: mass flow rate rm
                           
                           =9.25m/s, initial velocity vimp
                           
                           =75m/s, angle of attack θ
                           =67.5°, distance d
                           =20mm and shot diameter dshot
                           
                           =0.58mm. These parameters were adopted from Hong et al. [8]. It emerges that in the first 50 impacts about 64% of shots hitting the target surface with a velocity within 10% from the initial velocity (vimp
                           
                           =0.9vo
                           
                           ∼1.0vo
                           ). This indicates that these shots had only little or no interaction with other shots before hitting the target surface. The remaining 36% of shots (18 shots) had energy dissipation due to interaction with others shots. Steady state is reached after an initial period of 4000 impacts, with 33.65% of impacts hitting the surface with initial velocity. The longest transient state occurs with the highest mass flow rate of 13kg/min and lowest initial velocity 50m/s and angle of attack θ
                           =90° and distance d
                           =20mm. Since the steady state is reached after 4000 impacts, the impact number of 10,000 can be taken as the steady state for all combination of parameters used in this study.

Next, the effect of the distance between the nozzle and target surface was investigated. Distances ranging from 5mm to 30mm were investigated. Fig. 5
                            shows the total number of interactions for different distances d. Fig. 6
                            shows the total energy loss for different distances d. The effect of distance on the peening quality was not found to be significant when d greater than 20mm is employed and shot diameter is 0.58mm and therefore 20mm was chosen as the peening distance between nozzle and component.

A matrix simulation covering various mass flow rates and initial velocities was carried out next. Table 2
                            shows the different parameters for different mass flow rates. For simplicity a dimensionless flow rate parameter ε is introduced:
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                m
                                             
                                          
                                          ∗
                                          
                                             
                                                d
                                             
                                             
                                                50
                                             
                                          
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                o
                                             
                                          
                                          ∗
                                          
                                             
                                                m
                                             
                                             
                                                shot
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

where rm
                            is the mass flow rate of the nozzle, d
                           50 the average particle diameter, vo
                            initial velocity and mshot
                            the shot mass.


                           Fig. 7
                            shows the number of shot–shot and shot–target interactions for the different initial velocities. It can be concluded that the number of shot–shot and shot–target interaction increases with lower initial velocity. Compared to the shot–target collisions, the shot–shot interactions nearly doubles from 75m/s to 200m/s.

The effect of mass flow rate and initial velocity on the distribution of normalised impact velocity for θ
                           =90° and θ
                           =62.5° was investigated next. Fig. 8
                            shows the percentage of shot retaining their normalised initial velocity higher than 90% for different mass flow rate and initial velocity for =62.5°. It can be seen that the parameter ε is significant.

For a lower ε value, more shots hit the surface with initial velocity than in the simulation with a higher value. The key parameters rm
                           
                           =5.5, θ
                           =62.5° and vo
                           
                           =100m/s corresponds to the lowest value of ε
                           =0.667 where at which point about 56% of impacts maintained their initial velocity at impact (vimp
                           
                           =0.9vo
                           
                           ∼1.0vo
                           ). This indicates that the shots had little or no energy dissipation from the nozzle to the surface. Fig. 9
                            confirms that for a lowest value of ε, case H9, the energy loss due to shot–target interaction is the lowest.

The lowest percentage of normalised impact velocity was encountered with the highest value ε
                           =3.154, corresponding to case H1 with the mass flow rate rm
                           
                           =13 and vo
                           
                           =50m/s where only 3.89% of shots maintained their initial velocity.

Highest energy loss was encountered in case H7, corresponding to rm
                           
                           =9.25 and vo
                           
                           =100m/s. The second highest was H4 with parameters s rm
                           
                           =13 and vo
                           
                           =100m/s. This indicates that velocity is an important factor for shot–target energy dissipation.

In can be concluded that with a higher mass flow rate rm
                            the energy dissipation increases due to the large number of shot–shot interactions. A lower mass is therefore more suitable for the peening process with smaller shot–shot interactions associated with lower energy dissipation. With a lower initial velocity the shots do not move quickly enough and the likelihood of interactions with rebounding shots increases. With a much higher initial velocity the shots move quicker and the probability of interactions between the shots decreases. Lower mass flow rate implies less energy dissipation for shot interaction but also less transferred energy. However this could be countered by longer peening time. The optimal combination depends on the cost of peening time and how the industry chooses this parameter.

Looking at results from θ
                           =90° and θ
                           =62.5° it can be concluded that the angle of attack has a significant influence on the outcome. Hence, the angle of attack needs to be investigated next.

The effect of angle of attack was investigated with the following parameters; mass flow rate rm
                           
                           =9.25m/s, initial velocity vo
                           
                           =100m/s, distance d
                           =20mm and shot diameter dshot
                           
                           =0.58mm. Fig. 10
                            shows the percentage of shots retaining their initial velocity for different angles of attack, where impact velocity is 90–100% of initial velocity. Analysing the velocity at impact, for θ
                           =35°, about 74% of shot retained their initial velocity and had fewer interactions between shots. Shot–shot interactions increased significantly when θ
                           =90° and only 50% of shots retained their initial velocity. This is explained by the large number of rebounding shots coinciding with incoming shots. The percentage of shots retaining their initial velocity decreases with the angle of attack increasing. To measure CRS, the normal impact velocity is more significant than the tangential component. Fig. 11
                            shows the effect of angle of attack on the percentage of particles retraining their normal impact velocity (vo
                           
                           =100m/s). Looking at the normal impact velocity it can be shown that θ
                           =62.5° provides the highest percentage of shots retaining initial velocity at impact (62.83%). No shots retraining their normal impact velocity when θ
                           <45°. This is a useful information for the industry providing the target inclination for the process.

The distribution of impact velocities for differ shot diameters was examined. Specially, five different shot diameters dshot
                           
                           =0.4, 0.58, 0.75, 1.0 and 1.5mm with the process parameters rm
                           
                           =9.25kg/min, vo
                           
                           =75m/s, θ
                           =62.5° and d
                           =20mm were studied. The total mass and mass flow rate are kept constant such that when the shot size is decreased, the overall peening time is increased. Fig. 12
                            shows the number of shots per second delivered from the nozzle for the different shot diameters. For dshot
                           
                           =0.4mm a high number of shots (590, 000) are delivered from the nozzle compared to 11, 200 shots for dshot
                           
                           =1.5mm. The shot–shot collision decreased almost linearly for dshot
                           
                           =0.4mm (18, 057) towards dshot
                           
                           =1.5mm (2, 174). Fig. 13
                            shows the shot–shot and shot–target interaction numbers for the different shot diameters.

CoR and the energy dissipation for shot–target interaction with changing CoR. In practice the region of influence will depend on the impact velocity, angle of impact and the shot size. The indentation area is affected by shot size, the impact velocity (the higher the velocity the larger the dimple) and the angle of impingement (an oblique angle generates an elliptical dimple). For simplicity, the region of influence was chosen as the average shot diameter (0.58mm). When applying the CoR dynamically the energy dissipation decreases with the increase of indentation radius. Table 3
                            shows the results for constant and variable CoR for 10,000 impacts. A target location that is being hit for the first time has a low CoR, resulting in high energy dissipation. The next shot hitting a location that was hit previously and plastically deformed the target surface has a higher CoR, resulting in lower energy dissipation. Subsequent shots hitting the target surface will rebound with a higher velocity than the first shot and retaining more of their kinetic energy. Fig. 14
                            shows the energy dissipation for shot–target with a constant CoR 0.4 and the energy dissipation for shot–target interaction with changing the CoR for the case with indentation radius 0.58mm.

Results show that shot–shot interaction decreases and shot–target interaction number increases. More importantly the average normal velocity at impact increases, which is important for the generation of compressive residual stress. Changing the CoR for repeated impacts will result in a more intense compressive residual stress distribution.

Coverage is defined as the percentage of a given surface that is obliterated by dents or dimples. Coverage beyond 100% is referred to as full coverage or multiples of time to achieve 100% coverage. However, in practice, the size of impressions will vary due to the shot size variation, shot velocity, impact angle and peened material properties. The current model only considers the shot size. Other relevant parameters can be assigned as a function taking into account a more realistic size of indentation.

The imported target geometries consist of a triangular mesh. The UDL implemented within the DE application counts the number of impacts for every single mesh element, providing a rapid way to analyse the individual peening parameters and peening quality. Visualising the impact location in the DE simulation can give a good indication of the peening coverage. Figs. 15 and 16
                           
                            show the shot impact location in DEM. Surface location coloured in brown shows the concentration of the number of impacts. The number of impacts for a particular location can be extracted and analysed in more detail. This allows analysing SP processes with multiple nozzles and complex geometries to comprehend more complex conditions.

The three-dimensional FE model was developed to investigate single shot impacts on the circular plate. A comparison was made with the numerical study of Meguid et al. [6] and Hong et al. [8]. The circular plate was given the following geometric properties; R
                           =4dshot
                           , height H
                           =3dshot
                            where dshot
                            is the shot diameter, mass density=7800kg/m3, elastic modulus E
                           =200GPa, initial yield stress σ
                           =600MPa and linear strain hardening parameter H
                           1
                           =800MPa. The plate was retrained against all displacements and rotations on the bottom end and was modelled using eight-node linear brick elements with reduced integration (C3D8R) with element size 0.05dshot
                           
                           ×0.05dshot
                           
                           ×0.05dshot
                           . The shot was modelled as rigid sphere with a mass positioned at its centre. The diameter of the shot was dshot
                           
                           =1mm and mass mshot
                           
                           =4.085mg. Additionally, coulomb law with friction μ
                           =0.25 was applied during the contact. The results are plotted in a normalised manner with the residual stress σxx
                            normalised with σo
                            the initial yield stress of the component. The stresses distribution plotted with the normalised deformed depth along the centre line of the component. Fig. 17
                            shows the material model and Fig. 18
                            shows three-dimensional finite element mesh. Numerical validation of single shot impact with Meguid et al. [6] is shown in Fig. 19
                           .

A number of coupled analyses were performed with 4000 shots impacting a flat surface. The plate was given the following 5mm×5mm×3mm, mass density=7800kg/m3, elastic modulus E
                        =200GPa, initial yield stress σ
                        =600MPa and linear strain hardening parameter H
                        1
                        =800MPa. All displacements and rotations of the plate bottom were restrained. The diameter of the shot was dshot
                        
                        =1mm and mass mshot
                        
                        =4.085mg. A friction coefficient of μ
                        =0.25 was applied during the contact. The CRS distribution over time was measured at the midpoint of the flat surface to evaluate the saturation time. Fig. 20
                         the dimensional finite element numerical simulation model of the multi shot impact in Abaqus.

Analyses were performed to evaluate the minimum area size required to be modelled to retrieve the true residual stresses. Three different simulations were performed to evaluate the effect of standard, average and variable CoR in DEM on the resulting CRS in FEM. Further a coupled analysis was performed to access the effect of the peening angle on the resulting CRS and the influence of mass flow rate and velocity on CRS. Fig. 20 shows the coupled analysis in FEM.

Analyses were performed to evaluate the size of the area required to be modelled to retrieve the true residual stresses. The impact area diameter were defined as 1×
                           R, 2×
                           R, 3×
                           R and 4×
                           R from the midpoint where R is the radius of the shot. Fig. 21
                            shows the minimum area 3×
                           R. The CRS is measured at the midpoint and at 3 different points (midpoint (0,0,0), point1 (0.1,0,0.1) and point2 (−0.1,0,−0.1) and point3 (0.1,0,−0.1) around the midpoint. The three measurement points lie within the distance of the smallest minimum area 1×
                           R. The plastic strain generated by the high velocity impacts of the shots varies on the surface layer. Since the surface residual compression progressively relaxed with increased SP coverage condition [18], the depth of the CRS layer is consider as the suitable factor to be considered for the different cases. To determine a precise CRS state of the peened material, an average CRS is determined from the four measurements. Figs. 22 and 23
                           
                            show the CRS resulting from analysing different area from the same simulation for peening angle θ
                           =90° and 35°. Evaluating the CRS for different area, it can be noted that the depth of the compressive zone only changes very little when the peening area is greater than 3×
                           R. The compressive stress at the surface layer various for the different areas. Table 4
                            shows the depth of the CRS zone for different impact area.

Three different simulations were performed to evaluate the effect of standard (0.4), average (0.57) and variable CoR in DEM on the resulting CRS in FEM. Only little variation of the depth of the compressive zone was encountered in the different simulations. Fig. 24
                            shows the effect of CoR in DEM on the CRS in FEM. Table 5
                            shows the depth of the CRS zone for different CoR in FEM.

Coupled analyses were performed to investigate the effect of peening angle on CRS. Simulations were performed with the peening angle θ
                           =90°, 75°, 67.5°, 62.5°, 45° and 35°. The peening angle θ has an effect of the coverage. A lower penning angle will cover a larger area than peening the component at angle θ
                           =90°. Fig. 25
                            shows the impact location for different peening angles in DEM. CRS results in Fig. 26
                            show that the CRS zone is large when the angle θ
                           =75° and 90°. Table 6
                            shows the depth of the CRS zone for different peening angle.

The DEM analyses have shown that for a lower value of ε more shots retain their initial velocity. For the circular area 3×R, a lower value of ε results in a lower number of shot–target interactions and the number of impacts increases when ε increases. When peening with a lower mass flow rate and lower initial velocity, the shots are delivery more precisely onto the surface. The resulting CRS are analysed for the nine different cases and shown in Fig. 27
                           . Analysing the resulting CRS graphs for the nine different cases show that for the case where ε is small the CRS zone is the largest and the CRS zone is small when ε is large. Results also show that when using a higher initial velocity like in cases H4, H7 and H9 the CRS zone is deeper than in cases where a lower initial velocity is applied such as in case H1, H2 and H6. Table 7
                            shows the number of impacts for area 3×
                           R for different values of ε adopted from Table 2 and corresponding depth of CRS zone.

@&#CONCLUSIONS@&#

A new computational framework for SP processes based on both the discrete element and the Finite Element Methods has been presented. The introduced framework allowed to run an extensive parametric analysis of the influence of the several mechanical parameters involved in the SP process. Visualising the shot impact locations in DEM can help to investigate the coverage build-up when peening a mechanical component of complex geometry with very little computational effort: for instance a simulation with 10,000 impacts can be simulated in only a few minutes on a single computer with an Intel i7 870 processor (4 cores) with 8MB cache and 16GB of memory running Linux CentOS.

The current model can be used to analyse the shot flow and assist in improving current nozzle designs and develop new ones. In the DEM simulations, the shot flow reached steady state after 4000 impacts with the parameters used in this study. From the parametric analyses it emerged that the air pressure in the nozzle (vo
                     ) is the most important factor, followed by the mass flow rate rm
                      and the duration of the peening process.

The new DEM–FEM coupling proposed in this paper provides a convenient way to couple the commercial DEM and FEM applications. A routine manages the interface between EDEM and Abaqus. The EDEM application generates an Abaqus input file, which is then used to analyse the treatment surface and resulting CRS. Analyses were performed to evaluate the minimum size of the area required to be modelled to retrieve the true residual stresses, which was found to be 3×
                     R where R is the radius of the shot.

Investigating the angle of attack and the normal impact velocity, it emerged that the normal impact velocity can be quite large and in some cases up to 60% of the initial velocity. For the cases considered in this study, the optimal angle of attack in DEM was found to be θ
                     =62.5°. However analysing the peening angle in the combined analysis showed that the depth of the CRS zone is largest when θ
                     =70° followed by θ
                     =90°.

A novel algorithm was implemented to change the CoR for repeated impacts accounting for work hardening and the impact area. Results showed that changing the CoR decreases the number of shot–shot collisions and increases shot–target collisions. The average impact velocity increases compared to the case where the CoR of first impact or the average of the CoRs of successive impacts is employed. Instead only a very small variation in CRS was encountered in the different cases. A higher number of impacts resulted in a deeper CRS zone.

Energy transfer per unit time is a significant factor that has to be evaluated. Similar amounts of energy can be transferred onto the target surface using different peening parameters in short time. It was found that for a higher mass flow rate and lower initial velocity fewer shots retain their initial velocity at impact but the number of impacts is larger. Results from the coupled analysis showed that the initial velocity is more important than the mass flow rate and that when the initial velocity is high (100m/s) the CRS depth zone is deeper than in the cases where a lower velocity was used. However, a relation between CRS and mass flow rate could not be established.

The existing computational SP model can be adopted such that Almen strips can be virtually placed onto the peening component. Future work will investigate the peening of more complex geometries with curved surfaces and edges, where Almen strips cannot be used during the peening process. Using the proposed computational model it will be then possible to predict the percentage of coverage and Almen intensity reducing the need for expensive experimental testing.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to acknowledge the funding provided by an Industrial CASE EPSRC award, Rolls Royce and DEM Solutions.

@&#REFERENCES@&#

