@&#MAIN-TITLE@&#Dehydration of core/shell fruits

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A unified physically-based approach for modeling the deformation in a general dehydration process.


                        
                        
                           
                           A nonlinear finite element method to simulate the dehydration-induced morphological transformation.


                        
                        
                           
                           Simple parameters based on the geometry and material of the fruits to control the evolution of surface patterns.


                        
                        
                           
                           A looking-up table for efficient simulation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dehydration

Buckling and wrinkling

Computer animation

Core/shell fruits

Morphological transformation

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

A core/shell fruit consists of a surface thin exocarp, a middle thick sarcocarp and a central hard stone. On the surface of some dehydrated core/shell fruits, such as jujubes, wolfberries, raisins, etc., rough and undulating patterns can be noticed comparing with their fresh states. The dehydration process is often related to a dramatic morphological transformation from an initial smooth and full configuration to a final rough one with many random, intricate and reticular undulations, as shown in Fig. 2 for the morphological evolution of a jujube at different dehydrated stages. To model such patterns in animations or movies seems to be a big challenge for an artist. On one hand, the artist can manually add the complicated details to a fruit model through classical texture mapping techniques (normal mapping or displacement mapping). However, it seems difficult, even for an experienced artist, to model the surface pattern evolution for an arbitrary realistic fruit using an empirical mathematical tool, since the buckles may merge together to a bigger one or divide into smaller ones during dehydration. On the other hand, the data driven methods rely on carefully captured images and measurements [1] and need to build up a mathematical model by studying the dehydration process of real fruits. However, the buckling morphology in each fruit may differ from each other because of the differences in their geometry and material. Also, it is an expensive and labor intensive work to collect morphological data via experiments.

In animation production, physically-based methods have been proven to be very successful in simulating the phenomena, such as fire [2], fluid [3] and, even fruit senescence [4]. In the physical view, dehydration is related to many complex processes, such as water transport, evaporation and material remodeling, and the mechanism for inducing the final morphology roots from the local material instabilities. Comparing with traditional instability problems, which are mostly induced by mechanical loadings, the dehydration-induced buckling should be attributed to the internal volume shrinkage due to the water loss. So the volumetric growth theory developed in recent years, which aims to handle the deformation and stress for solids with a growing mass, could be adopted to model the phenomena. The related work will be briefly reviewed in the next section. Following the idea in the growth mechanics, a general continuum theory aiming to characterize morphogenesis of dehydrated core/shell fruits is elaborated and the corresponding FE model is also introduced with aim to simulate the dehydration-induced morphological transition for general core/shell fruits. The model offers the users several parameters to control the shape and material of the core/shell fruits, such as the material ratio, the exocarp thickness, the stone size and the overall shape parameters. The parameter effects on the final buckling patterns are also summarized from a broad range of surface deformations. An artist could adjust the above mentioned physical parameters to control the surface patterns of dehydrated fruits. Experiments on several kinds of fruits, such as jujubes, wolfberries, raisins and plums, demonstrate the visual accuracy of the simulation. 
                     Fig. 1 shows a preview of the results.

@&#RELATED WORK@&#

Modeling the evolution of wrinkles in animation is not a new problem. Until now, there are many works centering on this subject, such as the energy-based method to model the distinct wrinkle shapes [5], the approach using the stretch tensor of coarse animation output to model the wrinkles of cloth objects [6] and the combination model of embedded thin shell with coarse finite element lattice [7]. However, little research works exist for the modeling of dehydration-induced deformation of fruits in animation, which shows unique characteristics compared with the wrinkles on clothes and faces. First of all, the driving force to initiate the surface wrinkles in dehydration is the volumetric shrinkage, rather than the mechanical pressure, which seems unable to be embedded into the animation model in the traditional methods. Meanwhile, the surface wrinkles on a dehydrated fruit could be random with different sizes and orientations as indicated earlier in 
                     Fig. 2 and no physically-based methods have been proved to be efficient to handle such complicated patterns in animation. In addition, in some traditional methods, such as the embedded thin shell model [7], a lot of nonintuitive parameters should be prescribed, which could prevent an artist from making an animation efficient. The continuum-based model presented in the current work could be a choice to overcome the above problems.

The dehydration process shows large similarities with the growth of biological tissue which has been intensively investigated in recent years. Comparing with traditional engineering materials, such as steel and concrete, the deformation of biomaterials could be actively induced by the redistribution of internal materials, such as the Venus flytrap [8] and ice plant seed capsules [9]. The dehydration process intrinsically belongs to such kinds of phenomena, which is related to a mass loss due to the water evaporation. Several methods have been developed to model the morphological evolution due to the mass or volume growth in soft solids. Most of them inherited the general framework developed by Rodriguez et al. [10], where a multiplicative decomposition of the deformation gradient into an elastic part and a growth part was introduced and found to be effective for stress-dependent finite mass growth. Now, the method has been applicable to characterizing the morphological evolution of biomaterials. Dervaux et al. [11] studied the morphogenesis of thin hyperelastic plates, where the cockling of paper and surface instabilities of grass blades were explained theoretically. Ben Amar and coworkers [12,13] investigated the wavy morphologies on the inner surface of tubular organs, such as airway and intestine, which shows that the multiplicative approach is effective to handle the growth-induced instabilities. In the numerical aspect, Feng and coworkers utilized the finite thermal strain to replace the growth deformation tensor and investigated the surface wrinkling of core–shell soft structures [14,15] and the morphological folding of esophageal mucosa [16]. In their work, the buckling modes obtained by numerical results show good agreement with the analytical results and the influence of geometrical and material parameters on the surface buckling patterns is also investigated. The methodology offers a practical tool to simulate the volumetric growth of biomaterials. However, their work is limited to consider some simple cases and most details about the simulation are omitted. For instance, the fruit shape is not always spherical and some fruits, such as jujubes and plums, contain stones inside the sarcocarp, which have considerable influence on the final wrinkling patterns. In addition, the length and depth of the buckles in a high-stress state need more examination in order to characterize the process of dehydration for animation production.

In addition, other physically-based methods were also proposed to deal with morphological evolution. For example, to simulate the deformation in the biological aging and decay process of fruits, Kider et al. [4] introduced equivalent springs with decreasing lengths and stiffness to replace the volumetric shrinkage in fruit meat due to water loss, so that the surface layer simulated using the nCloth solver in Maya could produce the effects that occur during decay. Their model is based on several assumptions on the surface layer and internal volume and whose justification to produce the complicated deformation during dehydration is not elaborated. In addition, Yin et al. [17,18] investigated the stress driven buckling patterns of several spherical core/shell fruits and vegetables, such as Korean melons, ridged gourds and pumpkins. Their work gave the prediction of the ridge number and qualitatively reproduced the overall shape features of several fruits and vegetables. Another relevant method is the non-Euclidean theory proposed by Sharon and coworkers [19,20], which is feasible to explain the morphogenesis of thin sheets and biological membranes. Similar works by Liang and Mahadevan [21] and Koehl et al. [22] are effective to characterize the shape evolution of long leaves and kelp blades. However, the materials in these works are elastic with a small strain and only the buckling patterns at a low stress level could be considered, which do not authentically reflect the material behavior. In our work, the finite strain arising in the dehydration is naturally introduced in the theoretical framework and evolution of buckles and wrinkles could be well simulated.

The remaining paper is organized as follows. In Section 3, a general theoretical framework for modeling the dehydration-induced deformation and its FE formulation are elaborated within the framework of the multiplicative decomposition. Then, the specific algorithm details for animating the morphological evolution of dehydrated core/shell fruits are discussed in detail in Section 4. In Section 5, the geometrical and material parameter effects on the wrinkling patterns are investigated. Several representative examples are also given in this section. Finally, conclusions and future directions are made in Section 6.

In this section we present a continuum-based theory and its numerical implementation based on the multiplicative decomposition of the deformation gradient to handle various non-linear mechanical features in the dehydration process.

To describe the large incompatible deformation of dehydrated fruits, the well-known multiplicative decomposition of the deformation gradient tensor, 
                           F
                        , is introduced as follows:
                           
                              (1)
                              
                                 F
                                 =
                                 
                                    
                                       ∂
                                       x
                                    
                                    /
                                    
                                       ∂
                                       X
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        where 
                           x
                         and 
                           X
                         are the location of a material point in the initial fresh configuration and the final dehydrated configuration, and 
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                         are the deformation tensors induced by dehydration and residual stress, respectively. This description of deformation has been widely used for the problems such as finite thermal-stress analysis [23], elasto-plasticity in finite deformation [24], electro-elasticity [25], etc. Its applications in morphogenesis of growing biomaterials have been summarized in [26].

In the current work, 
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                         is assumed to be isotropic, i.e., 
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                           =
                           d
                           i
                           a
                           g
                           (
                           ϑ
                           ,
                           
                           ϑ
                           ,
                           
                           ϑ
                           )
                        , which means that the dehydration-induced shape change in the material point is the same in all three directions. Its determinant 
                           
                              
                                 J
                              
                              
                                 d
                              
                           
                           =
                           det
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 ϑ
                              
                              3
                           
                         represents the volume ratio of the material point after and before the dehydration takes place. Therefore, when 
                           ϑ
                           <
                           1
                        , water permeates out of the material point and its volume shrinks. On the contrary, the case 
                           ϑ
                           >
                           1
                         means the absorption of water and the material point swells. It should be noted that an anisotropic 
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                         with different dehydration deformations in the three directions is also usable in the current model. The dehydration factor 
                           ϑ
                         could be either homogeneous or inhomogeneous across the domain, which means that the material may show different degrees of shrinkage at different locations. In this way, incompatible deformation appears in the material and the residual stress arises to keep the final deformation continuous. As dehydration proceeds, buckles may emerge in the surface areas with a large residual pressure to keep the total energy minimal. For the core/shell fruits, such as wolfberries, raisins and jujubes, as dehydration proceeds, the volumetric reduction in the sarcocarp is larger than that in other locations, since it contains richer water. Such incompatible shrinkage will induce residual pressure in the exocarp, similar to that of the non-uniform growth phenomenon [17,27]. For a thin exocarp, the out-of-plane bending seems to be the favorable deformation, since the developed pressure could be released via buckling and wrinkling and the total strain energy will also reach its minimum [28]. So the inhomogeneity of the dehydration deformation tensor 
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                         acts as the driving force creating wrinkles and buckles modes during dehydration.

The fruits during dehydration should be in a state of self-equilibrium, since there are no external forces applied. Though fluids transport through the solid skeleton from the internal part to external environments, the diffusion force arising from the interaction between the solid and the fluid could be ignored for a steady response [29]. Therefore, the classical equilibrium equation should also be applicable [30]
                        
                           
                              (2)
                              
                                 ∇
                                 σ
                                 =
                                 0
                              
                           
                        where 
                           σ
                         is the symmetric Cauchy stress, 
                           ∇
                         is the divergent operator, and the body force of the material can be safely ignored. In addition, only rigid displacements should be constrained during dehydration.

Biological materials generally exhibit hyperelastic properties, which means that they are ductile for a small deformation and become hard at a large deformation. For simplicity, the materials in the current study are assumed to be the incompressible Neo-Hookean material with the strain energy function
                           
                              (3)
                              
                                 W
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 3
                                 )
                                 −
                                 p
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       e
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                        where 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         is the shear modulus at the ground state, 
                           p
                         is the Lagrangian multiplier representing the volumetric stress, and 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                         are three main stretches of the elastic deformation gradient, 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                        , and satisfy 
                           
                              
                                 J
                              
                              
                                 e
                              
                           
                           =
                           det
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                           =
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                           =
                           1
                         due to the incompressibility. Then, the Cauchy stress could be expressed as
                           
                              (4)
                              
                                 σ
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       ∂
                                       W
                                    
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 −
                                 p
                                 1
                              
                           
                        
                     

So far, the basic equations describing the drying process of a general fruit are given as Eqs. (1)–(4). The mechanical principles in the dehydration process are very similar to that of solids with a growing mass or thermal expansion, readers are referred to [12–15,27,30] for the details.

The equation set (1)–(4) governs the configuration evolution in the dehydration process. Discretizing the weak integration form of the equilibrium equation, i.e., Eq. (2), a nonlinear discretized equation representing the self-equilibrium state of the dehydrated fruits could be obtained (see the details in [31, Chapter 12])
                           
                              (5)
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              
                           
                        where 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                         is the nonlinear internal force vector, which is dependent on the configuration and stress state. The external force is vanished, since the fruit is in the state of self-equilibrium during dehydration. To solve the displacement unknowns in Eq. (5), a Newton–Raphson iterative scheme is adopted and the dehydration tensor 
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                         is accumulated step by step in the scheme, similar to mechanical load. In each iteration step, a linearized equation should be solved
                           
                              (6)
                              
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       m
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       σ
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 
                                    
                                       
                                          u
                                          ̇
                                       
                                    
                                    t
                                 
                                 =
                                 
                                    
                                       
                                          f
                                          ̇
                                       
                                    
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        in which, 
                           
                              
                                 K
                              
                              
                                 m
                              
                              
                                 t
                              
                           
                         and 
                           
                              
                                 K
                              
                              
                                 σ
                              
                              
                                 t
                              
                           
                         are the material and geometric tangent stiffness matrix at time 
                           t
                        , and 
                           
                              
                                 
                                    f
                                    ̇
                                 
                              
                              
                                 d
                              
                              
                                 t
                              
                           
                         is the change rate of the body force induced by dehydration, which drives the material to shrink. The details to construct above equation can be found in [31]. Solving Eq. (6), the location of material point 
                           X
                         at time 
                           t
                           +
                           Δ
                           t
                         could be updated by
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       +
                                       Δ
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    t
                                 
                                 +
                                 
                                    
                                       
                                          x
                                          ̇
                                       
                                    
                                    t
                                 
                                 Δ
                                 t
                              
                           
                        where 
                           
                              
                                 
                                    x
                                    ̇
                                 
                              
                              t
                           
                         is the velocity of the point extracted from the vector 
                           
                              
                                 
                                    u
                                    ̇
                                 
                              
                              t
                           
                        . Using 
                           
                              
                                 x
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         in Eq. (1), 
                           F
                         and 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                         at 
                           t
                           +
                           Δ
                           t
                         can be calculated. Then, the Cauchy stress could also be obtained from Eq. (4) using 
                           
                              
                                 F
                              
                              
                                 e
                              
                           
                        , see [12,13,15,16] for the details.

In this section, the general theoretical model and its numerical implementation presented in Section 3 are applied to model the surface patterns of core/shell fruits and the algorithm details are introduced in detail.

To keep things simple, a core/shell fruit is assumed to be composed of three parts: a hard non-deformable inner stone, a thin and hard surface exocarp and a middle soft and watery sarcocarp. To describe the model with as few parameters as possible, we assume that the fruit could be approximated as a revolution solid which is generated by rotating a generatrix along a close ellipse (the equator). As shown in 
                        Fig. 3, the generatrix of the sarcocarp outer surface is represented with a smooth cubic spline curve in the plane 
                           x
                           oy
                        . The spline curve is determined by seven red control points with following parametric equations:
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                    
                                       f
                                    
                                 
                                 
                                 cos
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                    
                                       f
                                    
                                 
                                 
                                 sin
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 ..
                                 .
                                 ,
                                 7
                              
                           
                        where 
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           
                           2
                           ,
                           
                           ..
                           .
                           ,
                           
                           7
                         are uniformly distributed in the range of 
                           [
                           
                              
                                 −
                                 π
                              
                              /
                              2
                           
                           ,
                           
                           
                              π
                              /
                              2
                           
                           ]
                         with 
                           
                              
                                 φ
                              
                              
                                 1
                              
                           
                           =
                           −
                           
                              π
                              /
                              2
                           
                         and 
                           
                              
                                 φ
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           −
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           =
                           
                              π
                              /
                              3
                           
                        . To ensure a smooth surface at the two polar points (
                           φ
                           =
                           
                              
                                 ±
                                 π
                              
                              /
                              2
                           
                        ), the end slopes of the cubic spline are set to 
                           (
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 f
                              
                           
                           ,
                           
                           −
                           
                              
                                 r
                              
                              
                                 7
                              
                              
                                 f
                              
                           
                           )
                         and 
                           (
                           0
                           ,
                           
                           0
                           )
                        , respectively. The radius of the first point, 
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 f
                              
                           
                        , is set to one as a reference size, and other six parameters, 
                           
                              
                                 r
                              
                              
                                 i
                              
                              
                                 f
                              
                           
                           ,
                           
                           2
                           ≤
                           i
                           ≤
                           7
                        , should be assigned to determine the final shape. As shown in 
                        Fig. 4, the generatrix shapes for several groups of 
                           
                              
                                 r
                              
                              
                                 i
                              
                              
                                 f
                              
                           
                           ,
                           
                           1
                           ≤
                           i
                           ≤
                           7
                         are plotted, which indicates that many kinds of fruits could be generated in the current model, from plump to oblate, short to tall and thin to fat. The equator is an ellipse which is determined by 
                           
                              
                                 r
                              
                              
                                 4
                              
                              
                                 f
                              
                           
                         on the generatrix and a new parameter 
                           
                              
                                 r
                              
                              
                                 8
                              
                              
                                 f
                              
                           
                        , as marked in Fig. 3. The sarcocarp for most fruits has a circular section, i.e., 
                           
                              
                                 r
                              
                              
                                 4
                              
                              
                                 f
                              
                           
                           =
                           
                              
                                 r
                              
                              
                                 8
                              
                              
                                 f
                              
                           
                        , while some fruits, such as plums, may present an elliptical section with 
                           
                              
                                 r
                              
                              
                                 4
                              
                              
                                 f
                              
                           
                           ≠
                           
                              
                                 r
                              
                              
                                 8
                              
                              
                                 f
                              
                           
                        .

The exocarp has two surfaces: the inner one coincides with the outer surface of the sarcocarp discussed above and the outer one is directly determined by 
                           
                              
                                 r
                              
                              e
                           
                           =
                           
                              
                                 r
                              
                              f
                           
                           +
                           
                              
                                 t
                              
                              e
                           
                        , where 
                           
                              
                                 r
                              
                              f
                           
                         is the spline defined in Eq. (8) and the constant 
                           
                              
                                 t
                              
                              e
                           
                         is the exocarp thickness. The central stone often shows a simple shape, whose generatrix can be approximated by an ellipse determined by two axes 
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 r
                              
                              
                                 2
                              
                              
                                 s
                              
                           
                        . The equator for generating the stone׳s surface is also an ellipse with the axes 
                           
                              
                                 r
                              
                              
                                 2
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 r
                              
                              
                                 3
                              
                              
                                 s
                              
                           
                        , where the dependent parameter 
                           
                              
                                 r
                              
                              
                                 3
                              
                              
                                 s
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       8
                                    
                                    
                                       f
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                              /
                              
                                 
                                    
                                       r
                                    
                                    
                                       4
                                    
                                    
                                       f
                                    
                                 
                              
                           
                        . In conclusion, to determine the core/shell fruits׳ geometry, 10 parameters are used
                           
                              (9)
                              
                                 q
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                          
                                             f
                                          
                                       
                                       ,
                                       
                                       2
                                       ≤
                                       i
                                       ≤
                                       8
                                       ;
                                       
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                          
                                             s
                                          
                                       
                                       ;
                                       
                                       
                                          
                                             t
                                          
                                          e
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

The values of the parameters and their influence on the buckling modes are discussed in Section 5.

As indicated in Section 3, the continuum description of the dehydration process shows the same governing equations as that of the solids with increasing mass or a thermal expansion. Therefore, the module for the finite thermal analysis in the commercial FE software Abaqus [32] could be adopted to simulate the dehydration process, similar to the works of Cao et al. [27]. Following their work, the analogy between the dehydration-induced deformation 
                           ϑ
                         and the thermal expansion leads to
                           
                              (10)
                              
                                 ϑ
                                 =
                                 1
                                 +
                                 α
                                 θ
                              
                           
                        where 
                           α
                         is the thermal expansion coefficient, and 
                           θ
                         represents the variation of temperature from a reference value. The dehydration always gives rise to a volume shrinkage, so the dehydration deformation 
                           ϑ
                         should be less than one. Then, the temperature variation 
                           θ
                         should be negative, which means that a temperature decrease induces a volumetric shrinkage. Therefore, the dehydration deformation could be controlled by adjusting the quantity and the distribution of 
                           θ
                        . For a core/shell fruit, water is lost mainly in the sarcocarp, so its thermal expansion parameter is set to 0.01 and the corresponding thermal variation 
                           
                              
                                 θ
                              
                              f
                           
                         should be negative to initiate the volumetric shrinkage. The surface exocarp and the inner stone are assumed to have no water loss, so their thermal expansion parameters are set to zero.

The solid geometrical model is discretized by tetrahedral elements C3D4H [32]. Here, two rules about choosing the element size should be noted: 1) the outer exocarp is very thin compared with the sarcocarp and the complex wrinkling morphology also focuses on the surface layer. Therefore, the corresponding element size should be approximate to its thickness 
                           
                              
                                 t
                              
                              e
                           
                        . 2) A variable element size is adopted in the sarcocarp, which increases from the outside to the inside, to avoid a sudden change of the mesh size at the interface between the sarcocarp and the exocarp. Meanwhile, the deformation of the inner stone is negligible comparing with the other parts, since the stone is much stiffer than the sarcocarp and the exocarp and there is almost no water loss in it. Therefore, it is reasonable to treat the stone as a rigid body. From the numerical aspect, the stone is equivalent to a fixed boundary condition and it just needs to constrain the nodes on its surface to reflect the boundary effects.

The material properties of the core/shell fruits could be characterized by the ratio 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                           =
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                    
                                       p
                                    
                                 
                              
                              /
                              
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                    
                                       f
                                    
                                 
                              
                           
                         
                        [15,16], where 
                           
                              
                                 C
                              
                              
                                 0
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 0
                              
                              
                                 f
                              
                           
                         are the shear moduli of the surface exocarp and the middle sarcocarp, as given in Eq. (3). Generally, 
                           
                              
                                 C
                              
                              
                                 0
                              
                              
                                 p
                              
                           
                         is larger than 
                           
                              
                                 C
                              
                              
                                 0
                              
                              
                                 f
                              
                           
                        , since the surface exocarp is stiffer than the middle sarcocarp.

This section presents two essential techniques to avoid the possible numerical deficiencies in the buckling and wrinkling analysis of the dehydrated fruit: the geometric imperfection and the stabilization.

The geometrical and material flaws are unavoidable in a realistic fruit, which has a considerable influence on initiating surface buckles and wrinkles and could be helpful to keep the algorithm stable at the bifurcation points. The imperfections could be introduced to the original perfect configuration before the simulation starts. Here, the buckling mode calculated by the linear buckling analysis [33] is introduced as the initial geometric imperfection. The linear buckling analysis comes down to a generalized eigenvalue problem
                              
                                 (11)
                                 
                                    
                                       
                                          K
                                       
                                       
                                          m
                                       
                                       
                                          0
                                       
                                    
                                    p
                                    =
                                    
                                       
                                          ϑ
                                       
                                       
                                          cr
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          σ
                                       
                                       
                                          0
                                       
                                    
                                    p
                                 
                              
                           where 
                              
                                 
                                    K
                                 
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    K
                                 
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                            are material and geometric stiffness matrices with respect to the initial configuration [31], 
                              
                                 
                                    ϑ
                                 
                                 
                                    cr
                                 
                              
                            is the critical dehydration deformation factor when the surface layer begins to buckle, and 
                              p
                            is the corresponding critical buckling mode. Then, the perturbed configuration after introducing the geometric imperfection 
                              p
                            could be expressed as 
                              X
                              ′
                              =
                              X
                              +
                              χ
                              p
                           , where 
                              X
                            is the original perfect configuration and 
                              χ
                            is a small number ranging 0.001–0.01. In this paper, the Block Lanczos method in the finite element package Abaqus [32] is adopted to extract eigenmode 
                              p
                           , and the imperfection parameter 
                              χ
                            is set to 0.001.

In the buckling analysis, negative eigenvalues may appear in the global stiffness matrix close to a bifurcation point, which could lead to a singular solution with a very large magnitude. In such cases, a large number of iterations are always needed to reach equilibrium. For some extreme cases, the results are not convergent even for a small dehydration increment. To avoid such numerical difficulties, a stabilization technique is adopted and Eq. (5) is revised as
                              
                                 (12)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    0
                                 
                              
                           where 
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                              
                            is the viscous force which could prevent the iteration from divergence at the bifurcation points. The viscous force satisfies 
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                              
                              =
                              c
                              M
                              
                                 u
                                 ̇
                              
                           , where 
                              c
                            is the damping factor, 
                              
                                 u
                                 ̇
                              
                              =
                              
                                 
                                    Δ
                                    u
                                 
                                 /
                                 
                                    Δ
                                    t
                                 
                              
                            is the vector of nodal velocities and 
                              M
                            is an artificial mass matrix calculated with a unity density. The damping factor should be neither too small, thus not controlling the instability, nor too large, thus leading to inaccurate results. Our experiments suggest that an appropriate value for the damping factor is around 0.02, see [32] for more details about prescribing the damping factor.


                        
                        Fig. 5 shows the flowchart of the algorithm for a spherical core/shell fruit with 
                           
                              
                                 r
                              
                              
                                 i
                              
                              
                                 f
                              
                           
                           =
                           1
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           .
                           .
                           .
                           ,
                           8
                        , 
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 s
                              
                           
                           =
                           
                              
                                 r
                              
                              
                                 2
                              
                              
                                 s
                              
                           
                           =
                           0.4
                        , 
                           
                              
                                 t
                              
                              e
                           
                           =
                           0.04
                         and 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                           =
                           10
                        , which includes three parts: preprocessing, mechanical analysis and postprocessing. In the preprocessing, the solid model is generated by rotating the generatrix described in Section 4.1 and then meshed into the FE model according to the criteria in Section 4.2. Then, the algorithm proceeds to the mechanical analysis discussed in Section 3 to obtain the discretized morphological evolution during dehydration. In the postprocessing, the interesting surface patterns are extracted from the converged FE results to accelerate the rendering speed. Readers could refer to the Implementation guide in Appendix for a detailed explanation.

@&#EXPERIMENTS@&#

The morphological evolution for a spherical core/shell fruit with respect to different shrinkage factors 
                           
                              ϑ
                              ¯
                           
                           =
                           1
                           −
                           ϑ
                         is depicted in 
                        Fig. 6, where 
                           ϑ
                         is defined in Eq. (10). The red and blue areas denote the concave and convex regions of the wrinkles, respectively. When shrinkage factor 
                           
                              ϑ
                              ¯
                           
                         increases, the initial small buckles begin to grow up, then merge and transit to the reticular big one. Finally, random buckles with different orientations are generated at 
                           
                              ϑ
                              ¯
                           
                           =
                           0.3
                        . The geometric and material parameters have a considerable influence on the morphological evolution. Here, four representative quantities are chosen: the ratio of exocarp/sarcocarp shear modulus 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                        , the exocarp thickness 
                           
                              
                                 t
                              
                              c
                           
                        , the stone size 
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 r
                              
                              
                                 2
                              
                              
                                 s
                              
                           
                        , the generatrix shape 
                           
                              
                                 r
                              
                              
                                 i
                              
                              
                                 f
                              
                           
                           ,
                           
                           2
                           ≤
                           i
                           ≤
                           8
                        . Next, we mainly concentrate on the parameter effects on instability patterns at a relatively large shrinkage factor 
                           
                              ϑ
                              ¯
                           
                           =
                           0.3
                        .

The morphological map for different shear modulus ratios and exocarp thickness is shown in 
                           Fig. 7. The spherical core/shell configurations are chosen with 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    f
                                 
                              
                              =
                              1
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              .
                              .
                              .
                              ,
                              8
                            and 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                                 
                                    s
                                 
                              
                              =
                              0.4
                           . All the configurations exhibit random reticular patterns with non-uniform shapes and irregular orientations on the surface. For a fixed material ratio 
                              
                                 
                                    γ
                                 
                                 
                                    C
                                 
                              
                           , as 
                              
                                 
                                    t
                                 
                                 e
                              
                            increases, the buckle number decreases and their sizes increase, which indicates that thicker exocarp makes a larger wave than a thin one. For example, when 
                              
                                 
                                    γ
                                 
                                 
                                    C
                                 
                              
                              =
                              10
                            and 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.01
                           , dense and small buckles are disorderly distributed on the surface, while coarse undulating patterns emerge as 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.04
                           . For a fixed 
                              
                                 
                                    t
                                 
                                 e
                              
                           , the buckle size also increases with 
                              
                                 
                                    γ
                                 
                                 
                                    C
                                 
                              
                           , which means that a relative soft exocarp tends to create small buckles and vice versa. In summary, a soft and thin exocarp tends to generate a pattern with small and dense buckles and vice versa.

The stone size and its shape also show a considerable effect on the undulation pattern. Two stone effects are considered with respect to different exocarp thickness: 1) a spherical stone with different sizes 
                              
                                 
                                    r
                                 
                                 s
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                                 
                                    s
                                 
                              
                            and 2) an ellipsolid stone with different longitudinal axis 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                            and a constant 
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                                 
                                    s
                                 
                              
                           .

The buckling map for the spherical stone with different sizes is shown in 
                           Fig. 8 with 
                              
                                 
                                    r
                                 
                                 s
                              
                            in the range of 0.3–0.6. For 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.01
                           , small and random buckles emerge on the surface at 
                              
                                 
                                    r
                                 
                                 s
                              
                              =
                              0.3
                           , while long and narrow strips prevail for 
                              
                                 
                                    r
                                 
                                 s
                              
                              =
                              0.6
                           . It is indicated that a big stone tends to combine small and short buckles together to form a big and long one. This feature is more evident for a thin exocarp than a thick one, since the buckling modes do not change evidently with the stone size at 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.04
                           .

In the second case, four longitude stone sizes, 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                           , are chosen in the range of 0.4–0.7 and the corresponding buckling map is shown in 
                           Fig. 9 with respect to different 
                              
                                 
                                    t
                                 
                                 e
                              
                           . It can be inferred that the size and depth of the buckles at the two poles are smaller than those around the equator and this tendency is more obvious as the longitude axis of the stone, 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                           , gets larger. For example, for 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.01
                            and 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                                 
                                    s
                                 
                              
                              =
                              0.4
                           , random buckles are uniformly distributed on the exocarp surface, while more and more buckles at the two poles disappear and larger buckles emerge at the equator when 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                            increases. The non-uniform buckling pattern is caused by the ellipsoid stone, which leads to a larger sarcocarp thickness at the equator than that at the two poles. Therefore, the volume shrinkage at the equator should be larger than that at the two poles, which results in the final anisotropic stress and buckling patterns. The anisotropic patterns become less evident for a larger 
                              
                                 
                                    t
                                 
                                 e
                              
                           , since no obvious changes of buckle sizes could be observed as 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.04
                            for a large range of 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    s
                                 
                              
                           .

The fruit shape also has a significant effect on buckling patterns. Here, we consider several kinds of ellipsoids, whose generatrice in the plane 
                              x
                              o
                              y
                            is ellipses with longitude axis 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    f
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    7
                                 
                                 
                                    f
                                 
                              
                              =
                              1
                            and 
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                                 
                                    f
                                 
                              
                            varying within 0.6–0.9, as shown in 
                           Fig. 10. For a prolate shape (
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                                 
                                    f
                                 
                              
                              =
                              0.6
                           ), longitude ribs emerge around the equator for all 
                              
                                 
                                    t
                                 
                                 e
                              
                            and when 
                              
                                 
                                    t
                                 
                                 e
                              
                            becomes large enough (
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.04
                           ), the ridges extend to the poles. Such longitudinal ridged buckles are created to release the high stress in the equatorial direction. It can also be found that the anisotropic pattern becomes stronger as 
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                                 
                                    f
                                 
                              
                            becomes smaller. For a podgy shape with a larger 
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                                 
                                    f
                                 
                              
                           , most buckles appear to be reticular as the spherical fruits shown in Figs. 7 and 8. This is due to the isotropic stress in the surface layer arising in these cases, which tends to make the reticular patterns. To summarize, with a large 
                              
                                 
                                    t
                                 
                                 e
                              
                            and a small 
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                                 
                                    f
                                 
                              
                           , ridged buckles dominate, otherwise, reticular buckling patterns prevail. In addition, for 
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                                 
                                    f
                                 
                              
                              =
                              0.7
                           , reticular and ridged buckles coexist for 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.01
                           , while ridged buckles take over in the case of 
                              
                                 
                                    t
                                 
                                 e
                              
                              =
                              0.04
                           . Therefore, the ridged modes seem more stable for a thicker exocarp. Although new buckling patterns appear for a prolate shape, the buckle size still increases with 
                              
                                 
                                    t
                                 
                                 e
                              
                            just as the spherical cases in Figs. 7–9.

Following the above discussions, the parameter effects on the buckling patterns are summarized as follows. 1) A fruit with a thin and soft exocarp and a small stone tends to make smaller buckles than that with a thick and hard exocarp and a large stone. 2) Both fruit and stone shapes show remarkable effects on the surface morphology. The prolate fruit tends to generate ridged buckles, while the pudgy one favors reticular patterns. For the fruit with an ellipsoid stone, the buckles are inclined to localize in the area with a thick sarcocarp.

This section aims to model the surface morphological evolution for some realistic core/shell fruits during dehydration. Several types of fruits are selected and their shape sizes, stone sizes are shown in 
                        Table 1, which are mathematically similar to their actual size. Dehydrated jujubes always show various buckling patterns mainly induced by their shape, so two representative configurations are chosen: one is prolate and the other one is pudgy. For the wolfberry or raisin, it has a prolate shape, a small stone and a relative thin exocarp. The rotated curve of a plum is not always a circle, that is, 
                           
                              
                                 r
                              
                              
                                 4
                              
                              
                                 f
                              
                           
                           ≠
                           
                              
                                 r
                              
                              
                                 8
                              
                              
                                 f
                              
                           
                        , as explained in Section 4.1. Meanwhile, plums always contain large stones in the center, which also significantly affect the buckling patterns. The material ratio, 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                         are empirically prescribed as 10 for all cases, since no physical experiments seem to be found to determine them. The exocarp thickness for each fruit is determined according to the buckling maps given in Sections 5.1.1–5.1.3 and the related conclusions in Section 5.1.4.

The real fruits and the numerical results at different dehydration stages are shown in 
                        Fig. 11. It can be found that ridged buckles clearly appear on the prolate jujube (Fig. 11a and Video S1), while for the pudgy one (Fig. 11b and Video S1), reticular buckles prevail, in accordance with the numerical experiments in Section 5.1.3. For the prolate raisin (Fig. 11c and Video S1) and wolfberry (Fig. 11d and Video S1), they both show small longitudinal ridged buckles on the surface due to their shapes and the relatively thin exocarp. For the plum with a big stone (Fig. 11e and Video S1), it is interesting that not much buckles emerge in the areas with a thin sarcocarp, while localized ridged buckles appear around these areas with a relatively thick sarcocarp. As for the rounder plum with a small stone and a thick exocarp, reticular buckles are the dominating visible feature (Fig. 11f and Video S1). The numerical simulations show good accordance with the experiments.

Supplementary material related to this article can be found online at doi:10.1016/j.cag.2014.11.003.

The following is the Supplementary material related to this article 
                        Video 1.
                           
                              Video 1
                              
                                 The morphology evolution of the fruits in Fig. 11. Implementation guide, including a manual ‘implementation guide.docx’, all source programs and some input and output files.
                              
                              
                           
                        
                     

The generated geometry of the fruit models was rendered using Maya 2013׳s Mental Ray Sub Surface Scattering shader. The color is empirically derived from the photos of real fruits. A noise map to diffuse color was produced to highlight the roughness of the material.

It takes about 2h to finish each FE simulation for the above chosen fruits, which seems too long if an animator wants to see the buckling configuration for a specific group of parameters in real time. To improve the simulation efficiency, we could build an example-based look-up table [34] for a group of geometrical and material parameters, which allow the animator to obtain the interpolated dehydrated configuration in real time based on the exact FE results in the table. Here, we adopt an interpolation scheme in the frequency domain since the buckling waves show a periodic pattern on the surface. To build up the looking-up table, we first choose 
                           N
                         sample points 
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           ..
                           .
                           ,
                           N
                         where each point 
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                         contains a group of geometric and physical parameters, i.e., 
                           q
                         in Eq. (9) and 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                        . For each sample point, the frequency spectra of displacements 
                           
                              
                                 U
                              
                              
                                 i
                              
                           
                           =
                           {
                           
                              
                                 U
                              
                              
                                 x
                                 i
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 y
                                 i
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 z
                                 i
                              
                           
                           }
                        , are calculated in advance using Fourier Transformation (FT) of the FE results as follows:
                           
                              (13)
                              
                                 
                                    
                                       U
                                    
                                    
                                       ν
                                       i
                                    
                                 
                                 =
                                 F
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ν
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                 ν
                                 =
                                 x
                                 ,
                                 y
                                 ,
                                 z
                              
                           
                        where 
                           F
                           (
                           
                              
                           
                           )
                         denotes Fourier transformation of a discretized sequence and 
                           u
                           =
                           x
                           −
                           X
                         is the total displacement vector. Next, the distance of two sample points could be introduced as 
                           
                              
                                 d
                              
                              
                                 i
                                 j
                              
                           
                           =
                           |
                           |
                           
                              
                                 
                                    ξ
                                    ¯
                                 
                              
                              
                                 i
                              
                           
                           −
                           
                              
                                 
                                    ξ
                                    ¯
                                 
                              
                              
                                 j
                              
                           
                           |
                           |
                        , where 
                           |
                           |
                           
                              
                           
                           |
                           |
                         is 2-norm of a vector and 
                           
                              
                                 
                                    ξ
                                    ¯
                                 
                              
                              
                                 i
                              
                           
                         is the normalized 
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                         whose 
                           k
                           th
                         element is defined as 
                           
                              
                                 
                                    ξ
                                    ¯
                                 
                              
                              
                                 i
                                 ,
                                 k
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       ξ
                                    
                                    
                                       k
                                    
                                    
                                       min
                                    
                                 
                                 )
                              
                              /
                              
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       k
                                    
                                    
                                       max
                                    
                                 
                                 −
                                 
                                    
                                       ξ
                                    
                                    
                                       k
                                    
                                    
                                       min
                                    
                                 
                                 )
                              
                           
                        . Here, 
                           
                              
                                 ξ
                              
                              
                                 min
                              
                           
                         and 
                           
                              
                                 ξ
                              
                              
                                 max
                              
                           
                         contain the minimum and maximum values for the geometrical and material parameters in the looking-up table, respectively. Then, the frequency spectrum for a given specific group of parameters 
                           ξ
                         is interpolated using Inverse Distance weighting
                        
                           
                              (14)
                              
                                 U
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                          
                                             −
                                             η
                                          
                                       
                                    
                                    D
                                 
                                 
                                 and
                                 
                                 D
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          j
                                       
                                       
                                          −
                                          η
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           =
                           |
                           |
                           
                              ξ
                              ¯
                           
                           −
                           
                              
                                 
                                    ξ
                                    ¯
                                 
                              
                              
                                 i
                              
                           
                           |
                           |
                         and 
                           
                              
                                 U
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           ..
                           .
                           ,
                           M
                         are the spectrum data of displacements with respect to the 
                           M
                         closest points to 
                           ξ
                        . In our simulation, 
                           η
                           =
                           2
                         and 
                           M
                         is in the range of 5–8. The final displacement for the chosen parameters 
                           ξ
                         could be restored by the inverse FT of the interpolated spectrum 
                           U
                        .

To validate the scheme, several interpolated results are shown in the dashed box in 
                        Fig. 12, which are based on the six configurations in Fig. 7 with 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                           =
                           10
                           ,
                           
                           30
                           ,
                           
                           50
                         and 
                           
                              
                                 t
                              
                              e
                           
                           =
                           0.03
                           ,
                           
                           0.04
                        . It can be seen that the interpolated configurations show a smooth transition between the corresponding original exact configurations. The surface buckles on the interpolated configuration are also well generated. Comparing the interpolated results for 
                           
                              
                                 γ
                              
                              
                                 C
                              
                           
                           =
                           10
                         and 
                           
                              
                                 t
                              
                              e
                           
                           =
                           0.032
                           –
                           0.038
                         with the corresponding simulated results shown in the last row of the figure, it can be found that the overall shapes of two groups of results show considerable similarities and the interpolated results should be acceptable as our aim is to achieve fast simulations. We can also expect that the interpolated results will be precise enough if more and more FE samples are added into the look-up table. Therefore, to obtain a new configuration based on the look-up table, only a linear interpolation and an inverse FT are required. It should be also noted that the first seven geometrical parameters in Eq. (9) are not fully independent since the surface of the fruit should be smooth and should not show concave and convex shape. This would help to decrease the sampling points and computation efforts when constructing the look-up table. Meanwhile, if the animators want to get really accurate result, they can still follow the FE algorithm developed in the paper.

@&#CONCLUSIONS AND FUTURE WORK@&#

The morphological evolution of core/shell fruit in dehydration is a complex mechanical process. Due to the irregular distribution of surface buckles and their complicated evolution over time, dehydration induced morphologies are difficult to predict in an empirical way. This paper presents a unified numerical framework to simulate the morphological evolution of general core/shell dehydrated fruits based on a physically-based continuum model. The method is based on the multiplicative decomposition of the deformation into a dehydration-induced part and an elastic part, which allows to prescribe the dehydration deformation conveniently. The model is realized in the framework of the finite element method by an analogy between the deformation induced by dehydration and thermal expansion, which is proved to be efficient to generate rich buckling and wrinkling patterns and avoids a large amount of computation in the direct simulations. The effects of various parameters, such as the shear modulus ratio, the exocarp thickness, the stone size and the overall shape, on the final morphologies are investigated. The morphological evolutions for some realistic fruits such as jujubes, wolfberries, raisins and plums, are also given, which demonstrates the efficacy of the model. The method also works for other fruits and vegetables, such as potatoes, bananas, etc., only if their geometrical and material parameters are appropriately defined.

In addition, other physical and/or chemical factors, such as light, humidity, pressure etc. could also be introduced in the model if their influence on the dehydration deformation 
                        ϑ
                      is clarified. For example, a fruit will show faster dehydration speed and loss of more water (i.e., a smaller 
                        ϑ
                     ) in the environment with strong light than that in the dark condition, which means that 
                        ϑ
                      is inversely proportional to the illumination intensity. Similarly, the effects of other factors on 
                        ϑ
                      could also be built according to the experience or experiment.

@&#ACKNOWLEDGMENTS@&#

Y. Liu, B. Chen and H. Zhang are grateful for the supports of the National Natural Science Foundation (11232003 and 91315302), the Ph.D. Programs Foundation of Ministry of Education (20130041110050), the 111 Project (B08014) and the National Key Basic Research Special Foundation of China (2010CB832704). X. Yang, Z. Wang and J. Zhang acknowledge the grant of the Sino-UK Higher Education Research Partnership for PhD Studies Project funded by the Department of Business, Innovation and Skills of the British Government and Ministry of Education of China.

Supplementary data associated with this article can be found in the online version at doi:10.1016/j.cag.2014.11.003.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

