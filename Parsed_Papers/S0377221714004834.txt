@&#MAIN-TITLE@&#Likelihood estimation of consumer preferences in choice-based conjoint analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An estimation method is proposed for value functions in choice based conjoint analysis.


                        
                        
                           
                           The method employs a likelihood function based on three sources of uncertainty.


                        
                        
                           
                           For individual choices we adopt multinomial logit with heterogeneous scale parameters.


                        
                        
                           
                           Interdependence of preferences is modeled using a multivariate normal distribution.


                        
                        
                           
                           The method exceeds average prediction performance of HB in 12 field data sets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Conjoint analysis

Utility function

Preference estimation

Maximum likelihood

Marketing research

@&#ABSTRACT@&#


               
               
                  In marketing research the measurement of individual preferences and assessment of utility functions have long traditions. Conjoint analysis, and particularly choice-based conjoint analysis (CBC), is frequently employed for such measurement. The world today appears increasingly customer or user oriented wherefore research intensity in conjoint analysis is rapidly increasing in various fields, OR/MS being no exception. Although several optimization based approaches have been suggested since the introduction of the Hierarchical Bayes (HB) method for estimating CBC utility functions, recent comparisons indicate that challenging HB is hard. Based on likelihood maximization we propose a method called LM and compare its performance with HB using twelve field data sets. Performance comparisons are based on holdout validation, i.e. predictive performance. Average performance of LM indicates an improvement over HB and the difference is statistically significant. We also use simulation based data sets to compare the performance for parameter recovery. In terms of both predictive performance and RMSE a smaller number of questions in CBC appears to favor LM over HB.
               
            

@&#INTRODUCTION@&#

In marketing research the measurement of preferences and assessment of utility functions have long traditions. Often conjoint analysis (CA) is employed as the utility measurement instrument and the estimation takes place on segment or individual level. The world today seems increasingly customer or user oriented. In October 2013 ISI Web of Knowledge found 2758 hits for “conjoint analysis” (within title, abstract or keywords) with a significant share devoted to Operations Research/Management Science. References from the past five years indicate that research intensity in conjoint analysis is rapidly increasing in various fields, management science being no exception.

This paper concerns choice based conjoint analysis (CBC) which appears the most popular type of CA today. For revealing individual preferences, estimation approaches and software for CBC analysis have developed significantly during past decades. The Hierarchical Bayes HB method for estimating individual utility functions (e.g., Allenby & Ginter, 1995) remains most popular, it is found to perform well and there is commercial easy-to-use software.
                        1
                        If segment-wise utility functions are adequate then latent class approaches also have turned out promising (DeSarbo, Ramaswamy, & Cohen, 1995).
                     
                     
                        1
                      Estimation results are frequently used to predict, for instance, market shares; see e.g., Natter and Feurstein (2002). The fine qualities of CBC analysis combined with HB estimation are acknowledged, for instance, by Karniouchina, Moore, van der Rhee, and Verma (2008) who compare CBC analysis with the ratings-based conjoint analyses, another commonly used method.

The performance of alternative estimation approaches for CBC analysis (without adaptive question design) is compared in Halme and Kallio (2011) with HB as a benchmark. The study indicates that challenging HB is hard. However, based on likelihood maximization we propose in this article a new and highly promising method called LM (for Likelihood Maximization).

The log-likelihood function in LM is based on three sources of uncertainty as follows. First, considering the choices of a respondent in individual questions of CBC we adopt the likelihood for each choice from the multinomial logit model (McFadden, 1974). Second, in terms of valuation errors the respondents are heterogeneous and we assume that the individual standard deviations of such errors are independent random draws from an inverse-gamma distribution. Third, as in HB, considering the interdependence of preferences among respondents we assume that parameter vectors defining individual utility functions are random draws from a multivariate normal distribution (e.g. Allenby & Ginter, 1995).

Using twelve sets of field data LM achieves a statistically significant average improvement over HB in terms of predictive power. In these tests, some of the respondent’s questions are left for holdout. Having estimated the individual utility functions we attempt to validate the choices in the holdout question, i.e. test if the utility functions produced confirm the choices made by respondents. Predictive power is then measured by the share of confirmed choices among all holdout questions.

Furthermore, we employ simulated data sets to compare utility function parameter recovery as well. With a small number of questions per respondent, LM outperforms HB in terms of RMSE (the root mean square error).


                     Halme and Kallio (2011) also propose for CBC estimation an optimization based method CP with some similarities with LM: (i) both assume that individual part-worth vectors may be interpreted as random draws from a multivariate normal distribution; and (ii) in terms of valuation errors the respondents are heterogeneous. However, CP and LM differ in the methods of determining individual error levels (cross validation vs. likelihood maximization) as well as in choice models (projective penalty vs. multinomial logit). Numerical tests in Halme and Kallio (2011) indicate that average performance of CP is neither superior nor inferior to HB.

Next, Section 2 introduces the CBC model and the likelihood method LM, Section 3 presents performance comparisons of LM and HB, and Section 4 concludes.

We begin this section by introducing the choice model employed in preference estimation. Then the log-likelihood problem for estimation of part-worth vectors is defined. Finally, the approach is operationalized in a computer implementation.


                        CBC analysis is a multi-attribute method where the value of a product or service stems from a given set of attributes which may only attain a small number of possible levels. Product concepts or profiles are defined by levels for each attribute. The utility function for a concept is assumed additive separable in attributes.

In CBC analysis each respondent is presented a questionnaire including a set of Q questions (tasks). In each question, a set of P concepts (product/service profile specifications) is presented for evaluation and the respondent indicates the best one. Typically Q is in the range from 5 to 20 and P from 2 to 6. The questions often are different for each respondent or group of respondents, and they are defined employing, for example, fractional factorial, random experimental, or orthogonal question design (see Chrzan & Orme, 2000; Nair, 2013). In this article, we exclude adaptive question designs assuming that each task in the questionnaire is independent of responses to preceding tasks.

We adopt additional notation from Halme and Kallio (2011) as follows:
                           
                              •
                              
                                 
                                    
                                       i
                                       =
                                    
                                  respondent, 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       N
                                    
                                 
                              


                                 
                                    
                                       j
                                       =
                                    
                                  question, 
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       Q
                                    
                                 
                              


                                 
                                    
                                       k
                                       =
                                    
                                  profile alternative in a question, 
                                    
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       P
                                    
                                 
                              


                                 
                                    
                                       l
                                       =
                                    
                                  profile index to attribute levels, 
                                    
                                       l
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       L
                                    
                                  (see example below)


                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ijk
                                          
                                       
                                       =
                                    
                                  profile of alternative k in question j (row vector in 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             L
                                          
                                       
                                    
                                 ) for person i
                              


                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                             1
                                          
                                       
                                       =
                                    
                                  preferred profile to person i in question j
                              


                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             ijk
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             ijk
                                          
                                       
                                       =
                                    
                                  
                                 preferred direction for all 
                                    
                                       i
                                       ,
                                       j
                                    
                                  and k.

For notational convenience and without loss of generality, given data concerning the preferred choices, the alternatives of each question are reordered so that 
                           
                              k
                              =
                              1
                           
                         refers to the preferred one.

For example, a profile 
                           
                              x
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    L
                                 
                              
                           
                         with three attributes and 
                           
                              L
                              =
                              5
                              +
                              5
                              +
                              4
                              =
                              14
                           
                         is depicted as follows:
                           
                              
                                 
                                    
                                       
                                          x
                                          =
                                       
                                       
                                          (
                                          
                                             
                                                0
                                                
                                                1
                                                
                                                0
                                                
                                                0
                                                
                                                0
                                             
                                             
                                                ︸
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                
                                                0
                                                
                                                1
                                                
                                                0
                                                
                                                0
                                             
                                             
                                                ︸
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                
                                                1
                                                
                                                0
                                                
                                                0
                                             
                                             
                                                ︸
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          attribute
                                          
                                          1
                                       
                                       
                                          attribute
                                          
                                          2
                                       
                                       
                                          attribute
                                          
                                          3
                                       
                                    
                                 
                              
                           
                        In this example, there are five possible levels of attribute 1, and the second level is chosen for this profile.

For each respondent i and profile x, assume a utility function that is additive in attributes. Let part-worth vector 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    L
                                 
                              
                           
                         be a column vector of weights such that the respondent’s utility function of profile x is 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              =
                              x
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        . Given preferred directions 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ijk
                                 
                              
                           
                         of question j, the value margin of the preferred profile 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    1
                                 
                              
                           
                         with respect to a non-preferred profile 
                           
                              
                                 
                                    x
                                 
                                 
                                    ijk
                                 
                              
                           
                         is 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    1
                                 
                              
                              )
                              -
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ijk
                                 
                              
                              )
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    ijk
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        . For person i, let 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    ijk
                                 
                              
                           
                         be a random profile valuation error. Then profile 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    1
                                 
                              
                           
                         is conceived the most preferred profile by person i in question j, if 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    1
                                 
                              
                              )
                              +
                              
                                 
                                    ∊
                                 
                                 
                                    ij
                                    1
                                 
                              
                              ⩾
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ijk
                                 
                              
                              )
                              +
                              
                                 
                                    ∊
                                 
                                 
                                    ijk
                                 
                              
                              
                              for
                              
                              all
                              
                              k
                              >
                              1
                           
                         or equivalently, if 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ijk
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              
                                 
                                    ∊
                                 
                                 
                                    ijk
                                 
                              
                              -
                              
                                 
                                    ∊
                                 
                                 
                                    ij
                                    1
                                 
                              
                              
                              for
                              
                              all
                              
                              k
                              >
                              1
                           
                        . In the multinomial logit model (McFadden, 1974) we assume that the profile valuation errors 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    ijk
                                 
                              
                           
                         are independent and Gumbel distributed with location parameter zero, scale parameter 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           
                        . Then the standard deviation of 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    ijk
                                 
                              
                           
                         is given by
                           
                              (1)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             6
                                          
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        and the probability of person i choosing profile 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                    1
                                 
                              
                           
                         is
                           
                              (2)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                       1
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       1
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 /
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 exp
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ijk
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 1
                                 /
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 exp
                                 (
                                 -
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       ijk
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

In this section we formulate the log-likelihood function of LM to be used for estimation of the part-worth vectors. We employ a three-level hierarchy: (i) as in HB, we assume that the vectors 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                         are independent random realizations from a multivariate normal distribution; (ii) the standard deviations of the profile valuation errors are independent draws from an inverse-gamma distribution; and (iii) the likelihood of choices made by respondents follows from (2). Given suitable independence assumptions below, the total log-likelihood is the sum of the log-likelihoods of the realizations of vectors 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        , the standard deviations of profile valuation errors, and individual choices. Next, we discuss the log-likelihood functions for each three levels.
                           
                              (i)
                              Given that individual data tends to be scarce in the estimation of relatively many part-worth components in 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , we aim to borrow data from other respondents similarly as in HB. We take into account that the part-worth vectors among the respondents are correlated. For example, people generally prefer a low price to high and a high quality to low. In order to account for the interdependence of the respondents’ part-worths, we proceed as follows. Let 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  be an L dimensional random vector with multivariate normal distribution 
                                    
                                       N
                                       (
                                       α
                                       ,
                                       V
                                       )
                                    
                                  where 
                                    
                                       α
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             L
                                          
                                       
                                    
                                  is the expected value of 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  and 
                                    
                                       V
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             L
                                             ×
                                             L
                                          
                                       
                                    
                                  is the covariance matrix with 
                                    
                                       ∣
                                       V
                                       ∣
                                       =
                                       1
                                    
                                 .
                                    2
                                    Normalizations 
                                          
                                             ∣
                                             V
                                             ∣
                                             =
                                             κ
                                             
                                             ≠
                                             
                                             1
                                          
                                        could be used equally well. This would just lead to rescaling the part-worth vectors as well as the standard deviations of the profile valuation errors.
                                 
                                 
                                    2
                                  We interpret part-worth vectors 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , as independent realizations of the random vector 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 . The log-likelihood 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  for a realization 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                  (omitting a constant term) is
                                    
                                       (3)
                                       
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          α
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          V
                                          )
                                          =
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                α
                                                )
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          α
                                          )
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          log
                                          ∣
                                          V
                                          ∣
                                          .
                                       
                                    
                                 
                              

Recall that profile valuation errors 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             ijk
                                          
                                       
                                    
                                  are Gumbel distributed with location parameter zero and scale parameter 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , for respondent i. We assume that the parameters 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                  are independent realizations of a random variable 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  with a probability density function 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                       exp
                                       (
                                       -
                                       γ
                                       /
                                       θ
                                       )
                                       /
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                       
                                       Γ
                                       (
                                       k
                                       )
                                    
                                  of a gamma distribution where k and 
                                    
                                       θ
                                    
                                  are positive parameters. Hence, omitting a constant term which depends on k and 
                                    
                                       θ
                                    
                                 , the log-likelihood function of realization 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is
                                    
                                       (4)
                                       
                                          
                                             
                                                g
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          =
                                          -
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                             
                                          
                                          /
                                          θ
                                          +
                                          (
                                          k
                                          -
                                          1
                                          )
                                          log
                                          (
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 Because the standard deviation 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                  of the profile valuation error in (1) is inversely proportional to 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                  represents a random draw from an inverse gamma distribution of a random variable 
                                    
                                       σ
                                    
                                 . In a representative example of the test runs reported in Section 3 below, Fig. 1
                                  depicts such inverse gamma distribution corresponding to 
                                    
                                       k
                                       =
                                       1
                                    
                                  and 
                                    
                                       θ
                                       =
                                       0.25
                                    
                                  in (4). To illustrate the relative importance of the error term, in the horizontal axis 
                                    
                                       σ
                                    
                                  is scaled by a constant v, which represents an average absolute value of profile utility function. In this example, the average of the estimated standard deviations 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is 
                                    
                                       0.9
                                       ×
                                       v
                                    
                                  revealing the significance of the profile valuation errors.

Employing the multinomial logit model (2) the log-likelihood for the choices of respondent i is

Using definitions (3)–(5) and given parameters k and 
                           
                              θ
                           
                         in (4), the likelihood problem is to find vectors 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    L
                                 
                              
                              ,
                              α
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    L
                                 
                              
                           
                        , a matrix 
                           
                              V
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    L
                                    ×
                                    L
                                 
                              
                           
                         and scale parameters 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                              ∈
                              R
                           
                         to
                           
                              (6)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          α
                                          ,
                                          {
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   {
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          [
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                γ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                          +
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   V
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          α
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          V
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 s
                                 .
                                 t
                                 .
                                 
                                 log
                                 ∣
                                 V
                                 ∣
                                 =
                                 0
                                 .
                              
                           
                        
                     

Note that the outer maximization over 
                           
                              α
                           
                         and part-worth vectors 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                         is a convex optimization problem if parameters 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           
                         and V are fixed, and optimality conditions imply
                           
                              (8)
                              
                                 α
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 .
                              
                           
                        The inner problem is separable: maximizations over scale parameters 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           
                         and over the covariance matrix V. Given fixed vectors 
                           
                              α
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        , the former is a convex optimization problem and the latter is a non-convex problem with a globally optimal solution
                           
                              (9)
                              
                                 V
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       λ
                                    
                                 
                                 H
                                 ,
                              
                           
                        where
                           
                              (10)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 α
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       α
                                       )
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        and 
                           
                              λ
                           
                         is the geometric mean of the eigenvalues of H; for a proof, see Appendix A.

Our interest in this article is in the predictive performance of the part-worth vector estimates 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        . Next, as a measure for predictive power of the method we define the holdout hit-rate. We also introduce a cross-validation procedure for finding a suitable value for the parameter 
                           
                              θ
                           
                         of the gamma distribution in (4). Finally, we discuss a single iteration towards the solution of (6), (7) and specify the computer implementation of LM.

Predictive performance of the part-worth vector estimates 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            is measured in terms of the holdout hit-rate. For this purpose, assume that we have one or more holdout questions in addition to the Q questions used for estimating the part-worth vectors 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           . Given vectors 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           , for all i, we define the confirmed holdout questions. Then the holdout hit-rate is the proportion of confirmed choices of holdout questions among all respondents.

Cross validation aims to finding a suitable level for the parameters 
                              
                                 θ
                              
                           . We try several candidate values for 
                              
                                 θ
                              
                            in (4). The performance of a candidate is measured following the leave-one-out procedure: For each question 
                              
                                 j
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 Q
                              
                           , estimate 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            excluding question j, and check whether the preferred choice 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                       1
                                    
                                 
                              
                            is confirmed by 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           . The cross-validation hit-rate is the share of confirmed choices among all respondents and all leave-one-out cases. We choose candidate 
                              
                                 θ
                              
                            which yields the best cross-validation hit-rate.

Given parameters k and 
                              
                                 θ
                              
                            in (4), consider an iteration of problem (6), (7)
                           
                              3
                              In the case there is only one attribute (brand) and ‘none’ alternative is present we proceed as follows. While iterating for the part-worth vectors 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , we append sign constraints for components 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             il
                                          
                                       
                                    
                                 : for any task j of respondent i, if alternative l (a brand or ‘none’) is chosen then 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             il
                                          
                                       
                                       ⩾
                                       0
                                    
                                 , and if ‘none’ is chosen then 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             il
                                          
                                       
                                       ⩽
                                       0
                                    
                                  for all levels l in task j.
                           
                           
                              3
                            starting with some values for 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 α
                              
                           , 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 V
                              
                           . The iterations proceed in two alternating steps:


                           
                              
                                 Step
                                 1
                              
                           : With scale parameters 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                              
                            and covariance matrix V fixed to current levels, solve the convex problem (6), (7) for optimal 
                              
                                 α
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           , for all i. For the initial iteration, we omit the covariance term (3), and for all i, set 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              
                            and 
                              
                                 ∣
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 ∣
                                 ⩽
                                 10
                              
                            to ensure existence of an optimum.


                           
                              
                                 Step
                                 2
                              
                           : With vectors 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 α
                              
                            fixed to current levels, solve the convex problem (6), (7) for optimal parameters 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                              
                           . Thereafter compute H in (10), find Cholesky factorization 
                              
                                 H
                                 =
                                 
                                    
                                       CC
                                    
                                    
                                       T
                                    
                                 
                              
                           , determine the geometric mean 
                              
                                 λ
                                 =
                                 ∣
                                 C
                                 
                                    
                                       ∣
                                    
                                    
                                       2
                                       /
                                       L
                                    
                                 
                              
                            and update V using (9).

Our primary interest is the predictive performance of the part-worth vector estimates. Therefore, we do not necessarily aim to find a global maximum for the non-convex log-likelihood problem (6), (7). After updating parameters 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                              
                            and V in 
                              
                                 Step
                                 2
                              
                           , local optimality conditions for (6), (7) hold in 
                              
                                 Step
                                 1
                              
                            if the gradients of the objective function (after substituting 
                              
                                 α
                              
                            using (8)) with respect to all part-worth vectors 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            are zero. However, we only iterate as long as the sum of squared Euclidean norms of such gradients decreases or an iterations limit is met.

The computational procedure involves two phases: cross-validation providing the best 
                              
                                 θ
                              
                            and final iterations for the part-worth vectors 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            to be used for holdout hit-rate evaluation. The phases are implemented using AMPL (Fourer, Gay, & Kernighan, 2003) with solver option MOSEK for the convex optimization problems. For the parameter k of the gamma distribution used in (4), a suitable value is 1, and the resulting inverse gamma distribution of the standard deviation of profile valuation errors is illustrated in Fig. 1 above.


                           Cross-validation. Try ten candidate values for 
                              
                                 θ
                              
                            with 
                              
                                 θ
                                 Q
                              
                            in the range 
                              
                                 [
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 6
                                 ]
                              
                            and determine cross-validation hit-rate for each candidate 
                              
                                 θ
                              
                           . Fix 
                              
                                 θ
                              
                            to the value yielding the best cross-validation hit-rate.


                           Final iterations. With 
                              
                                 θ
                              
                            from the cross-validation step, carry out iterations until the termination criterion holds. Thereafter, determine the holdout hit-rate.

We illustrate the performance of LM by comparisons with HB using Sawtooth Software 
                        
                           CBC
                           /
                           HB
                        
                      4.2 (The HB/CBC System for Hierarchical Bayes estimation, 2009). Numerical comparisons are given in Section 4. However, we discuss first similarities and differences of the two approaches as well as the computational ideas used by HB.


                     HB and LM share two features: first, the part-worth vectors are assumed to be random draws from a multivariate normal distribution with a covariance matrix accounting for the interdependence of preferences and the procedures pushing the parameter estimates towards the population mean; second, both methods employ the multinomial logit choice model. As for the differences HB produces a sample of estimates of the 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                      vectors whose average is employed as final estimate whereas LM produces a point estimates 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                     . The HB uses priors in the calibration of estimates and LM employs cross-validation for one parameter. The main difference is that HB employs the Bayes principle and uses MCMC (Markov Chain Monte Carlo) for computations while LM seeks to search for maximum likelihood estimates of the parameters. Furthermore, unlike HB, LM employs an inverse gamma distribution for the standard deviation of respondents’ profile valuation error.

To understand HB, we now review its basic ideas. Consider a Markov chain in a continuous state space
                        4
                        The state space S in HB can be interpreted as an Euclidean space of suitable dimension. However, for convenience we define points in S by a set of vectors and a square matrix.
                     
                     
                        4
                      
                     S where single step transition probability density function (pdf, transition kernel) from state z to 
                        
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                        
                      is defined by an ordinary continuous pdf except possibly a spike at 
                        
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           =
                           z
                        
                     ; i.e.,
                        
                           (11)
                           
                              P
                              (
                              z
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              p
                              (
                              z
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              +
                              r
                              (
                              z
                              )
                              δ
                              (
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              -
                              z
                              )
                              ,
                           
                        
                     where 
                        
                           r
                           (
                           z
                           )
                        
                      is the probability for 
                        
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           =
                           z
                           ,
                           δ
                           (
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           )
                        
                      is the Dirac delta function and 
                        
                           p
                           (
                           z
                           ,
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           )
                        
                      with 
                        
                           p
                           (
                           z
                           ,
                           z
                           )
                           =
                           0
                        
                      is the transition pdf for 
                        
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           
                           ≠
                           
                           z
                        
                     . Then 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                        
                      is a stationary pdf for the Markov chain if
                        
                           (12)
                           
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 ∫
                                 
                                    S
                                 
                              
                              P
                              (
                              z
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              z
                              )
                              dz
                              =
                              
                                 ∫
                                 
                                    S
                                 
                              
                              p
                              (
                              z
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              z
                              )
                              dz
                              +
                              r
                              (
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              .
                           
                        
                     In MCMC simulation 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                        
                      is given (at least up to a constant multiplier which cancels out in (12)), and we determine 
                        
                           P
                           (
                           z
                           ,
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           )
                        
                      to satisfy (12). While such 
                        
                           P
                           (
                           z
                           ,
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           )
                        
                      need not be unique, a sufficient condition for (11) to satisfy (12) is the reversibility condition
                     
                        
                           (13)
                           
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              z
                              )
                              p
                              (
                              z
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              ,
                              z
                              )
                              
                              ∀
                              (
                              z
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∈
                              S
                              ×
                              S
                              .
                           
                        
                     For a simple proof, see Chib and Greenberg (1995). Using such kernel 
                        
                           P
                           (
                           z
                           ,
                           
                              
                                 z
                              
                              
                                 ′
                              
                           
                           )
                        
                      
                     MCMC simulates a single trajectory 
                        
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       ν
                                    
                                 
                                 }
                              
                              
                                 ν
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        
                      in n steps starting with any given initial point 
                        
                           
                              
                                 z
                              
                              
                                 0
                              
                           
                        
                     . In step 
                        
                           ν
                           ⩾
                           1
                        
                     , 
                        
                           
                              
                                 z
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                        
                      is given and we draw 
                        
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                        
                      randomly from pdf 
                        
                           P
                           (
                           
                              
                                 z
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                           )
                        
                      using Monte Carlo simulation. Then under mild regularity condition (of irreducibility) for any function 
                        
                           f
                           :
                           S
                           →
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     , 
                        
                           (
                           1
                           /
                           n
                           )
                           
                              
                                 ∑
                              
                              
                                 ν
                                 =
                                 0
                              
                              
                                 n
                              
                           
                           f
                           (
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                           )
                        
                      converges to 
                        
                           
                              ∫
                              
                                 S
                              
                           
                           f
                           (
                           z
                           )
                           
                              
                                 π
                              
                              
                                 ¯
                              
                           
                           (
                           z
                           )
                           dz
                        
                      as 
                        
                           n
                           →
                           ∞
                        
                      where 
                        
                           
                              
                                 π
                              
                              
                                 ¯
                              
                           
                        
                      is the pdf of the stationary distribution; i.e., 
                        
                           
                              
                                 π
                              
                              
                                 ¯
                              
                           
                        
                      is 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                        
                      scaled. (see e.g., Asmussen & Glynn, 2011). For example, for any integer k and a small 
                        
                           Δ
                           >
                           0
                        
                     , let 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           (
                           z
                           )
                           =
                           
                              
                                 I
                              
                              
                                 {
                                 k
                                 Δ
                                 ⩽
                                 z
                                 ⩽
                                 (
                                 k
                                 +
                                 1
                                 )
                                 Δ
                                 }
                              
                           
                        
                      be an indicator function. Then 
                        
                           (
                           1
                           /
                           n
                           )
                           
                              
                                 ∑
                              
                              
                                 ν
                                 =
                                 0
                              
                              
                                 n
                              
                           
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                           )
                        
                      converges to 
                        
                           
                              
                                 π
                              
                              
                                 ¯
                              
                           
                           (
                           k
                           Δ
                           )
                           Δ
                        
                      as 
                        
                           n
                           →
                           ∞
                        
                      and 
                        
                           Δ
                        
                      approaches zero. Therefore the sequence 
                        
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       ν
                                    
                                 
                                 }
                              
                              
                                 ν
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        
                      forms a random sample of pdf 
                        
                           
                              
                                 π
                              
                              
                                 ¯
                              
                           
                        
                      as n increases without limit. Thus, using the sequence for large n we obtain, for instance, an approximation of the expected value of z with respect to 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                        
                      – a result which is used by HB.

In HB, the collection 
                        
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           }
                        
                      of part worth vectors of respondents 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                      is a random sample from a conditional multivariate normal distribution 
                        
                           N
                           (
                           α
                           ,
                           V
                           )
                        
                      given 
                        
                           α
                        
                      and V. In HB both 
                        
                           α
                        
                      and V are random. The prior distribution for 
                        
                           α
                        
                      is 
                        
                           N
                           (
                           0
                           ,
                           A
                           )
                        
                      with 
                        
                           
                              
                                 A
                              
                              
                                 -
                                 1
                              
                           
                           =
                           0
                        
                      and the prior distribution for V is an L dimensional inverse Wishart distribution 
                        
                           
                              
                                 W
                              
                              
                                 -
                                 1
                              
                           
                           (
                           LI
                           ,
                           L
                           )
                        
                      with L degrees of freedom and 
                        
                           I
                           ∈
                           
                              
                                 R
                              
                              
                                 L
                                 ×
                                 L
                              
                           
                        
                      an identity matrix. Given 
                        
                           α
                        
                      and V, the conditional prior distribution of 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                     , is multivariate normal 
                        
                           N
                           (
                           α
                           ,
                           V
                           )
                        
                     .

Returning to MCMC, denote 
                        
                           z
                           =
                           (
                           α
                           ,
                           V
                           ,
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           }
                           )
                        
                      and let 
                        
                           R
                           =
                           {
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                           }
                        
                      denote the responses 
                        
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                        
                      of person i in all CBC questions used for estimation. Using Bayes theorem the posterior pdf for z given its prior pdf 
                        
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                           (
                           z
                           )
                        
                      and responses R is
                        
                           (14)
                           
                              P
                              {
                              z
                              ∣
                              R
                              }
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    z
                                    )
                                    P
                                    {
                                    R
                                    ∣
                                    z
                                    }
                                 
                                 
                                    P
                                    {
                                    R
                                    }
                                 
                              
                              .
                           
                        
                     Here 
                        
                           P
                           {
                           R
                           ∣
                           z
                           }
                           =
                           P
                           {
                           R
                           ∣
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           }
                           }
                           =
                           
                              
                                 Π
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           P
                           {
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                           ∣
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           }
                           =
                           
                              
                                 Π
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           
                              
                                 Π
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 Q
                              
                           
                           
                              
                                 P
                              
                              
                                 ij
                              
                           
                        
                      where 
                        
                           
                              
                                 P
                              
                              
                                 ij
                              
                           
                        
                      is the probability given by (2) of the choice by respondent i in question j given 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                     . While the denominator in (14) is difficult to evaluate, HB employs MCMC to obtain a random sample of z from the posterior distribution. For this purpose we define 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                           (
                           z
                           )
                        
                      proportional to posterior pdf 
                        
                           P
                           {
                           z
                           ∣
                           R
                           }
                        
                      as
                        
                           (15)
                           
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              z
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              (
                              z
                              )
                              P
                              {
                              R
                              ∣
                              z
                              }
                              =
                              
                                 
                                    f
                                 
                                 
                                    α
                                 
                              
                              (
                              α
                              )
                              
                                 
                                    f
                                 
                                 
                                    V
                                 
                              
                              (
                              V
                              )
                              
                                 
                                    Π
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              [
                              
                                 
                                    f
                                 
                                 
                                    β
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    Π
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    Q
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                              
                              ]
                              ,
                           
                        
                     where 
                        
                           
                              
                                 f
                              
                              
                                 α
                              
                           
                           (
                           α
                           )
                        
                      is the pdf for 
                        
                           α
                        
                      of the prior multivariate normal 
                        
                           N
                           (
                           0
                           ,
                           A
                           )
                        
                     , 
                        
                           
                              
                                 f
                              
                              
                                 V
                              
                           
                           (
                           V
                           )
                        
                      is the pdf for V of the prior inverse Wishart 
                        
                           
                              
                                 W
                              
                              
                                 -
                                 1
                              
                           
                           (
                           LI
                           ,
                           L
                           )
                        
                     , 
                        
                           
                              
                                 f
                              
                              
                                 β
                              
                           
                           (
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           )
                        
                      is the pdf for 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                      of the prior multivariate normal 
                        
                           N
                           (
                           α
                           ,
                           V
                           )
                        
                      given 
                        
                           α
                        
                      and V, and 
                        
                           
                              
                                 P
                              
                              
                                 ij
                              
                           
                        
                      is the choice probability in question j by respondent i in (2) given 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                      .

Next, given 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                        
                      in (15) we show how the transition kernel 
                        
                           P
                           (
                           
                              
                                 z
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                           )
                        
                      (for a Markov chain starting step 
                        
                           ν
                        
                      with 
                        
                           
                              
                                 z
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                        
                      and moving to 
                        
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                        
                     ) is chosen to meet the stationarity condition (12). Using “block-at-a-time” sampling, 
                        
                           P
                           (
                           
                              
                                 z
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 ν
                              
                           
                           )
                        
                      can be defined as a product of conditional transition kernels (for justification, see Chib & Greenberg, 1995) by
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                ν
                                             
                                          
                                          )
                                          =
                                       
                                    
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                α
                                             
                                          
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                ν
                                             
                                          
                                          ∣
                                          
                                             
                                                V
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          ,
                                          {
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          }
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          ×
                                       
                                    
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                V
                                             
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                V
                                             
                                             
                                                ν
                                             
                                          
                                          ∣
                                          
                                             
                                                α
                                             
                                             
                                                ν
                                             
                                          
                                          ,
                                          {
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          }
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          ×
                                       
                                    
                                    
                                       
                                          
                                             
                                                Π
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                             
                                                ν
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                             
                                                ν
                                             
                                          
                                          ∣
                                          
                                             
                                                α
                                             
                                             
                                                ν
                                             
                                          
                                          ,
                                          
                                             
                                                V
                                             
                                             
                                                ν
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 P
                              
                              
                                 α
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 V
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     , for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                     , satisfy the stationarity condition (corresponding to (12)) with respect to conditional posterior probability distributions 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                           (
                           α
                           ∣
                           
                              
                                 V
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           ,
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           }
                           )
                        
                     , 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                           (
                           V
                           ∣
                           
                              
                                 α
                              
                              
                                 ν
                              
                           
                           ,
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           }
                           )
                        
                     , and 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                           (
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           ∣
                           
                              
                                 α
                              
                              
                                 ν
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 ν
                              
                           
                           )
                        
                     , respectively.

Let us now define each of the componets 
                        
                           
                              
                                 P
                              
                              
                                 α
                              
                           
                        
                     , 
                        
                           
                              
                                 P
                              
                              
                                 V
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     . First, it is simple to show that 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                           (
                           α
                           ∣
                           
                              
                                 V
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           ,
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           }
                           )
                        
                      is the pdf of 
                        
                           N
                           (
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           /
                           N
                           )
                        
                     , where 
                        
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           =
                           (
                           1
                           /
                           N
                           )
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                        
                     . The stationarity condition is trivially met if we define
                        
                           (17)
                           
                              
                                 
                                    P
                                 
                                 
                                    α
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    ν
                                 
                              
                              ∣
                              
                                 
                                    V
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              {
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              }
                              )
                              =
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    ν
                                 
                              
                              ∣
                              
                                 
                                    V
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              {
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              }
                              )
                              .
                           
                        
                     Second, it is well known and straightforward but lengthy to show that 
                        
                           
                              
                                 π
                              
                              
                                 ∗
                              
                           
                           (
                           V
                           ∣
                           
                              
                                 α
                              
                              
                                 ν
                              
                           
                           ,
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           }
                           )
                        
                      is the pdf of an L dimensional inverse Wishart distribution 
                        
                           
                              
                                 W
                              
                              
                                 -
                                 1
                              
                           
                           (
                           LI
                           +
                           H
                           ,
                           L
                           +
                           N
                           )
                        
                      with 
                        
                           L
                           +
                           N
                        
                      degrees of freedom and H given by (10) with 
                        
                           α
                           =
                           
                              
                                 α
                              
                              
                                 ν
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                     . Again, the stationarity condition trivially holds if we define
                        
                           (18)
                           
                              
                                 
                                    P
                                 
                                 
                                    V
                                 
                              
                              (
                              
                                 
                                    V
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    ν
                                 
                              
                              ∣
                              
                                 
                                    α
                                 
                                 
                                    ν
                                 
                              
                              ,
                              {
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              }
                              )
                              =
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    V
                                 
                                 
                                    ν
                                 
                              
                              ∣
                              
                                 
                                    α
                                 
                                 
                                    ν
                                 
                              
                              ,
                              {
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              }
                              )
                              .
                           
                        
                     Finally, for 
                        
                           
                              
                                 P
                              
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                      we employ Metropolis–Hastings kernel (Hastings, 1970; Metropolis, Rosenbluth, Rosenbluth, Teller, & Teller, 1953; see also Chib & Greenberg, 1995). To begin, note that
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              ∣
                              
                                 
                                    α
                                 
                                 
                                    ν
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    ν
                                 
                              
                              )
                              ∝
                              
                                 
                                    π
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              )
                              ≡
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   α
                                                
                                                
                                                   ν
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   V
                                                
                                                
                                                   ν
                                                
                                             
                                             )
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             α
                                          
                                          
                                             ν
                                          
                                       
                                       )
                                    
                                 
                              
                              ×
                              
                                 
                                    Π
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    Q
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                              
                              .
                           
                        
                     For step 
                        
                           ν
                        
                     , define candidate 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           +
                           cd
                        
                      where c is a positive scale constant and d is a random draw from 
                        
                           N
                           (
                           0
                           ,
                           
                              
                                 V
                              
                              
                                 ν
                              
                           
                           )
                        
                      whose pdf is denoted by 
                        
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           (
                           d
                           )
                        
                     . If the candidate is accepted then 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                              
                           
                           =
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                     . Define an acceptance probability of candidate 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                      by
                        
                           (19)
                           
                              ψ
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                 
                              
                              )
                              =
                              
                                 min
                              
                              [
                              1
                              ,
                              
                                 
                                    π
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              )
                              /
                              
                                 
                                    π
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              )
                              ]
                              .
                           
                        
                     Then the Metropolis–Hastings transition kernel is
                        
                           (20)
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                 
                              
                              ∣
                              
                                 
                                    α
                                 
                                 
                                    ν
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    ν
                                 
                              
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    d
                                 
                              
                              (
                              d
                              )
                              ψ
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                 
                              
                              )
                              +
                              r
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              )
                              δ
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                                 
                                    ν
                                    -
                                    1
                                 
                              
                              )
                              ,
                           
                        
                     where 
                        
                           r
                           (
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                           )
                        
                      is the probability for 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                              
                           
                           =
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                        
                     ; i.e., for candidate being rejected. It is simple to check that the first component of the sum in (20) referring to the transition to 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                              
                           
                           
                           ≠
                           
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                                 -
                                 1
                              
                           
                        
                      satisfies the reversibility condition.
                        5
                        Considering acceptance with 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                              
                           ; i.e., 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                       -
                                       1
                                    
                                 
                                 +
                                 cd
                              
                            and 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 -
                                 cd
                              
                           , suppose first that 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 )
                                 <
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                       -
                                       1
                                    
                                 
                                 )
                              
                           . Then 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       ν
                                       -
                                       1
                                    
                                 
                                 )
                                 ×
                                 
                                    
                                       f
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 d
                                 )
                                 ψ
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 )
                              
                            
                           
                              
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 d
                                 )
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 )
                              
                           
                           
                              
                                 
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    d
                                    )
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                       
                                    
                                    )
                                    
                                       min
                                    
                                    [
                                    1
                                    ,
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                       
                                    
                                    )
                                    ]
                                    
                                    [
                                    as
                                    
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                       
                                    
                                    )
                                    >
                                    1
                                    ]
                                 
                              
                           
                           
                              
                                 
                                    =
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                       
                                    
                                    )
                                    ×
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    -
                                    d
                                    )
                                    ψ
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                       
                                    
                                    ,
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                    [
                                    as
                                    
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                    
                                    
                                    is symmetric
                                    ]
                                    .
                                 
                              
                           This and a similar argument in case 
                              
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       π
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                    
                                       ν
                                       -
                                       1
                                    
                                 
                                 )
                              
                            confirms reversibility.
                     
                     
                        5
                     Hence in view of (11) and (13), the transition kernel in (20) satisfies the stationarity condition. In step 
                        
                           ν
                           =
                           1
                        
                      
                     HB starts with scale constant 
                        
                           c
                           =
                           0.1
                        
                      and adjusts its value dynamically so that the average acceptance frequency is about 0.3.

To conclude, starting MCMC simulations with 
                        
                           
                              
                                 z
                              
                              
                                 0
                              
                           
                           =
                           (
                           
                              
                                 α
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           ,
                           {
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                           }
                           )
                           =
                           (
                           0
                           ,
                           I
                           ,
                           {
                           0
                           }
                           )
                        
                     , in a single step 
                        
                           ν
                        
                      of HB we draw 
                        
                           
                              
                                 α
                              
                              
                                 ν
                              
                           
                        
                      from 
                        
                           
                              
                                 P
                              
                              
                                 α
                              
                           
                        
                     , then 
                        
                           
                              
                                 V
                              
                              
                                 ν
                              
                           
                        
                      from 
                        
                           
                              
                                 P
                              
                              
                                 V
                              
                           
                        
                      (both referring to Gibbs sampler), and finally for each 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                        
                      separately we draw 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                              
                           
                        
                      from 
                        
                           
                              
                                 P
                              
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                      (Metropolis–Hastings sampler). A large number (e.g., thousands) of steps are carried out until the initial starting point has no longer an impact (convergence occurs). From this point onwards, the draws of 
                        
                           
                              
                                 α
                              
                              
                                 ν
                              
                           
                        
                     , 
                        
                           
                              
                                 V
                              
                              
                                 ν
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ν
                              
                           
                        
                      represent sampling from posterior distribution (14) based on which an estimate of expected value of 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                      is obtained for all i.

In this section we use twelve test problems with field data for performance tests. We employ the holdout hit-rate as a performance criterion and compare the performance of LM and HB. Additionally, we consider simulated data sets and compare parameter recovery using the traditional metric of RMSE, the root mean square error.

For comparisons we used Sawtooth Software 
                        
                           CBC
                           /
                           HB
                        
                      4.2 with the default settings. All the data files were run with 20,000 iterations. With one of our data sets named 
                        
                           dw
                           7
                        
                      it was questionable whether or not proper convergence took place, but the prediction result turned out to be fairly good. However, additional iterations did not improve the result for 
                        
                           dw
                           7
                        
                     .


                     Gensler, Hinz, Skiera, and Theysohn (2012) point out the importance of extreme behavior in data files; i.e., such respondents that always choose ‘none’ or never choose ‘none’. Among our field data only 
                        
                           dw
                           7
                        
                      included the none-option, and the corresponding percentages for extreme behavior always selecting ‘none’ and never selecting ‘none’ were 0.4% and 44.2%.


                        Tables 1 and 2
                        
                         present descriptive figures of the field-data problems.
                           6
                           The authors thank Jussi Fredrikson for csh and Leonhard Kehl for the brand choice model 
                                 
                                    dw
                                    7
                                 
                              .
                        
                        
                           6
                         Our field data sets use random experimental question designs. For each problem and for each method we only use data on the first 250 respondents for the performance measurement.
                           7
                           Given a large number of test runs we restricted the number of responts somewhat arbitrarily to 250, which we felt is large enough for CBC analysis. However, we do not expect any problems with a much larger set of respondents.
                        
                        
                           7
                         We begin by choosing randomly and independently one holdout question for each respondent i. Then we use the remaining Q questions to estimate each individual part-worth vector 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        . The validation result is the holdout hit-rate. In order to get an idea of the variation in the validation results we perform ten independent repetitions of holdout selections, which we call samples. Thus, in each sample one question is randomly and independently chosen as a holdout task for each respondent i, and ten independent samples of holdout questions are used in comparisons of the methods.


                        Table 3
                         shows the holdout hit-rates of HB for twelve test problems and for ten samples of holdout selection. Average hit-rates over twelve problems are on the rightmost column, and the bottom rows indicate averages over the ten samples. The overall average hit-rate is 72.7 percent for HB.


                        Table 3 also shows the hit-rate improvement of LM over HB. The overall average hit-rate is improved by 0.4 percentage points by LM. Given the twelve problems and ten sample runs for each, the average improvement is statistically significant 
                           
                              (
                              p
                              <
                              0.02
                              )
                           
                        . Comparing the two methods problem-wise, the average holdout hit-rate is larger with LM for seven problems and with HB for the other five problems. Sample averages are in nine out of ten cases favorable to LM.

Unlike 
                           
                              HB
                              ,
                              LM
                           
                         employs an endogenous standard deviation of respondents’ individual valuation error. To see whether this makes a difference, we fixed the endogenous parameter 
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                         in LM (the same value as HB uses) and reran all twelve field data cases (each with 10 scenario variations). In these tests, the average holdout hit-rate difference was 0.0%; i.e., there was no statistically significant difference in the prediction performance of LM and HB. Thus this factor offers part of the explanation of the difference in performance shown in Table 3.

Using simulated true part-worths we compared LM against HB and tested the ability of these approaches to recover the part-worth vectors. Initially, we use the same test setting as in Halme and Kallio (2011) and which in turn was taken from Evgeniou, Pontil, and Toubia (2007). Thereafter, we modify the initial simulation setting by allowing a ‘none’ option among possible choices in each one of the initial tasks. To help our readers, we repeat the description of the initial simulation design below. Similar tests appear in several previous simulation studies.

The number of attributes is 10, each of which has two levels, and each question consists of two alternatives. Each component of the true part-worth vector 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                         is an independent random draw from 
                           
                              N
                              (
                              μ
                              ,
                              κ
                              μ
                              )
                           
                        , where an increase 
                           
                              μ
                           
                         leads to a decrease in the standard deviation of the response error and 
                           
                              κ
                           
                         accounts for the heterogeneity of the part-worths. Both 
                           
                              μ
                           
                         and 
                           
                              κ
                           
                         have two possible values; for 
                           
                              μ
                           
                         the value is either 0.2 or 1.2 (high and low response error), and 
                           
                              κ
                           
                         is either 1 or 3.5 (low and high heterogeneity).

Initially, we generated either 16 or 32 questions for each respondent. Fractional factorial design was employed (Nair, 2013) with the two alternatives in each question such that the two never had any attribute at the same level. The choices of respondents were simulated based on the probabilities of the multinomial logit model. Again, 250 individuals were simulated, with 50 percent of the initially generated and randomly selected questions being left for holdout. We generated five samples by independent random choices of the 8 or 16 holdout questions. In conclusion, the number of possible parameter combinations was 
                           
                              2
                              ×
                              2
                           
                         (for 
                           
                              μ
                           
                         and 
                           
                              κ
                           
                        ), there are two alternatives for the number of questions Q (8 or 16) used for estimation, and there are 5 samples of holdout selections resulting in 40 part-worth sets of respondents.

The traditional metric used in the comparison of LM and HB is the root mean square error (RMSE) of the true and estimated part-worths with both the vectors normalized to 1. We also report the holdout hit-rates to enable comparison with the results of the field data.

The top half of Table 4
                         shows for each method and for the eight variants the average holdout hit-rate and RMSE over five samples. With regard to RMSE, when 
                           
                              Q
                              =
                              8
                           
                        , LM performs significantly better than HB (
                           
                              p
                              <
                              0.001
                           
                        ). Similarly for average hit-rate, if 
                           
                              Q
                              =
                              8
                           
                         
                        LM outperform HB (
                           
                              p
                              <
                              0.025
                           
                        ). For 
                           
                              Q
                              =
                              16
                           
                        , there is no significant difference, neither in RMSE nor in hit-rate, among the two methods. The overall average hit-rate improvement of LM over HB is 1.4% points. The results by sample are shown in Appendix B.1.

Similarly, the bottom half of Table 4 shows the average holdout hit-rate and RMSE. Comparing the results with the previous one (without none-options), both hit-rates and RMSE are significantly weakened. This is the case even if the frequency of chosen none-options is low (see 
                           
                              LL
                              8
                           
                         and 
                           
                              LL
                              16
                           
                        ). The overall average hit-rate improvement of LM over HB is now increased to 3.9% points. However, there is large variation among the eight cases: in four cases the hit-rate improvement is over 6% points while in the 
                           
                              HL
                              16
                           
                         (high response error, low heterogeneity, 16 questions) it is −7% points. With regard to RMSE, in all eight cases average performance of HB does not exceed that of LM. Also for these cases Appendix B.2 shows the results by sample.

@&#CONCLUSIONS@&#

This paper proposes a likelihood based approach LM to CBC estimation. We compare the performance of LM with HB (the industry standard for CBC) using the field data from twelve problems. The criterion for comparison is the holdout hit-rate; i.e., share of correct predictions for holdout questions resulting from estimated utility functions. In these tests, the average predictive performance of LM exceeds that of HB and the differences are statistically significant. As indicated in Section 4, part of the explanation is that LM, unlike HB, employs an endogenous standard deviation of respondents’ individual valuation error the average impact of which turned out to be 0.4% in the hit rate.

We also compared the methods using simulated true part-worths and tested the ability of these approaches to recover those values. In these tests when the number of questions per respondent was small, LM provided an improvement over HB. For a larger number of questions, no significant difference was found among the two methods.

From our comparisons based on field data and the simulation tests one may identify characteristics of data sets that were linked with superior performance of either LM of HB. In particular, there is evidence (most notably from the simulation tests) that a smaller number of questions in CBC improves the chances that LM outperforms HB. The simulation studies including a none-option in each task indicate that LM is favorable if the response error is not too large, while large response errors together with a large number of tasks (per respondent) favor HB instead. Anyway, for a particular CBC analysis in practice, one might begin by testing the predictive power of the candidate methods, and based on the results, one chooses the method to be employed. While in practice HB has been a method without a competitive alternatives, our AMPL code is now available upon request to other researchers as well.


                     
                        Lemma 1
                        
                           Given vectors 
                           
                              
                                 α
                              
                            
                           and 
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           in 
                           
                              (3)
                            
                           and a matrix H in 
                           
                              (10)
                           
                           , if H is non-singular then the globally optimal solution for the problem
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          α
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    α
                                    )
                                    +
                                    N
                                    log
                                    ∣
                                    V
                                    ∣
                                 
                              
                           
                           
                              
                                 
                                    s
                                    .
                                    t
                                    .
                                    
                                    log
                                    ∣
                                    V
                                    ∣
                                    =
                                    0
                                 
                              
                           
                           is 
                           
                              
                                 V
                                 =
                                 (
                                 1
                                 /
                                 λ
                                 )
                                 H
                              
                           
                           , where 
                           
                              
                                 λ
                                 >
                                 0
                              
                            
                           is the geometric mean of eigenvalues of H.
                        

Optimality conditions imply 
                              
                                 
                                    
                                       V
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       HV
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 -
                                 (
                                 N
                                 +
                                 π
                                 )
                                 
                                    
                                       V
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 =
                                 0
                              
                           , where 
                              
                                 π
                              
                            is the dual variable of constraint 
                              
                                 log
                                 ∣
                                 V
                                 ∣
                                 =
                                 0
                              
                           . Solving for V yields 
                              
                                 V
                                 =
                                 H
                                 /
                                 (
                                 N
                                 +
                                 π
                                 )
                              
                           , which together with 
                              
                                 log
                                 ∣
                                 V
                                 ∣
                                 =
                                 0
                              
                            yields 
                              
                                 V
                                 =
                                 H
                                 /
                                 λ
                              
                           . To show global optimality, let A be any symmetric matrix with 
                              
                                 ∣
                                 A
                                 ∣
                                 =
                                 1
                              
                            and row vectors denoted by 
                              
                                 
                                    
                                       A
                                    
                                    
                                       l
                                    
                                 
                              
                           . Consider a covariance matrix 
                              
                                 V
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       -
                                       2
                                    
                                 
                              
                           . Then 
                              
                                 log
                                 ∣
                                 V
                                 ∣
                                 =
                                 0
                              
                            and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       α
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 α
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       α
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       HA
                                    
                                    
                                       l
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 tr
                                 (
                                 AHA
                                 )
                                 ⩾
                                 L
                                 ∣
                                 AHA
                                 
                                    
                                       ∣
                                    
                                    
                                       1
                                       /
                                       L
                                    
                                 
                                 =
                                 L
                                 ∣
                                 H
                                 
                                    
                                       ∣
                                    
                                    
                                       1
                                       /
                                       L
                                    
                                 
                                 =
                                 L
                                 λ
                              
                            providing a lower bound for the objective function. For 
                              
                                 V
                                 =
                                 H
                                 /
                                 λ
                              
                           , we have 
                              
                                 A
                                 =
                                 
                                    
                                       (
                                       H
                                       /
                                       λ
                                       )
                                    
                                    
                                       -
                                       1
                                       /
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       α
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 α
                                 )
                                 =
                                 tr
                                 (
                                 AHA
                                 )
                                 =
                                 λ
                                 tr
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       -
                                       1
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       HH
                                    
                                    
                                       -
                                       1
                                       /
                                       2
                                    
                                 
                                 )
                                 =
                                 λ
                                 L
                              
                           , which attains the lower bound above and the proof is complete.□


                        Table 5
                        .


                        Table 6
                        .

@&#REFERENCES@&#

