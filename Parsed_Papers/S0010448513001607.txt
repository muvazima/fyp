@&#MAIN-TITLE@&#Extraction of generative processes from B-Rep shapes and application to idealization transformations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Generative processes are derived from extrusion primitives identified in the object.


                        
                        
                           
                           Maximal primitives are identified and removed from the object to simplify its shape.


                        
                        
                           
                           The object is simplified up to single extrusions to produce a construction graph.


                        
                        
                           
                           The extracted graph is a non trivial representation of the object with additive process.


                        
                        
                           
                           Extrusion primitives and interfaces are used to generate an idealized model for FEA.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

B-Rep model

Construction graph

Generative shape process

Idealization

@&#ABSTRACT@&#


               
               
                  A construction tree is a set of shape generation processes commonly produced with CAD modelers during a design process of B-Rep objects. However, a construction tree does not bring all the desired properties in many configurations: dimension modifications, idealization processes, etc. Generating a non trivial set of generative processes, possibly forming a construction graph, can significantly improve the adequacy of some of these generative processes to meet user’s application needs. This paper proposes to extract generative processes from a given B-rep shape as a high-level shape description. To evaluate the usefulness of this description, finite element analyses (FEA) and particularly idealizations are the applications selected to evaluate the adequacy of additive generative processes. Non trivial construction trees containing generic extrusion and revolution primitives behave like well established CSG trees. Advantageously, the proposed approach is primitive-based, which ensures that any generative process of the construction graph does preserve the realizability of the corresponding volume. In the context of FEA, connections between idealized primitives of a construction graph can be efficiently performed using their interfaces. Consequently, generative processes of a construction graph become a high-level object structure that can be tailored to idealizations of primitives and robust connections between them.
               
            

@&#INTRODUCTION@&#

Shape decomposition is a frequent approach to analyze and structure objects. During product development processes, process planning defining how to sequence machining operations  [1,2], FEA evaluating the structural behavior of components  [3–5], are task examples that require shape decomposition. The initial generation of the component shape during the design phase can be regarded as the task where the component structure is generated with feature-based B-Rep modelers or hybrid CAD modelers, which also provide Boolean operators. Classically, the object structure is described using a binary tree containing the elementary features or primitives generating the object. This tree structure contains information very specific to each CAD software and, most of the time, is lost when transferring objects across CAD systems and across phases of product development processes. Indeed, the construction tree obtained is very efficient at producing a parameterized representation of the object allowing a user to easily modify some dimensions as well as the shape of the object.

However, the construction tree produced during the design phase may not be well suited for the shape decompositions taking place at other stages of product development processes, e.g. process planning and finite element analyses. As an example, Fig. 1
                      illustrates this configuration with a rather complex component where the entire user’s modeling process contains 34 steps, some of them containing multiple contours producing simultaneously several features. Two views defined as top and bottom in Fig. 1(a) show the major details of the component shape. Fig. 1(b) depicts some of the 34 steps involving either extrusion or revolution operations incorporating material addition or removal as complementary effect when shaping the object. As it appears in Fig. 1, the generative process can be rather complex and, even if it is available, there is no straightforward use or transformation of this process that could be exploited to idealize this object even though its shape contains stiffeners and thin areas that can be modeled with plate or shell elements rather than volume ones. With respect to the idealization objective, it appears mandatory to produce another generative process that could incorporate features or primitives whose shapes are close enough to that of stiffeners and thin wall areas.

Similarly, the current generative process is not well suited if the depth of some stiffener, 
                        
                           
                              S
                           
                           
                              t
                           
                        
                     , needs to be modified (see Fig. 1(a)) because this dimension is obtained through several material removal and addition operations (see steps 18, 20, 23 in Fig. 1(b)).

Using generative processes to model an object shape independently of any CAD modeler is a means to obtain a description that is intrinsic to each object  [6]. They stand for a set of modeling actions that can be used to generate different construction histories of this object. All the previous observations show the interest of associating generative processes to not only a history but to several ones to be able to meet various user’s needs. To this end, we propose to extract a construction graph from B-Rep CAD models so that the corresponding generative processes are useful for FEA and, particularly, idealization processes. This graph is extracted using a primitive removal operator that simplifies progressively the object’s shape. Somehow, the principle is to go ‘backward over time’.

The paper is structured with Section  2 that reviews prior contributions. Section  3 sets the context and the hypotheses of the proposed approach. Then, Section  4 describes identification and removal operators of primitives. Section  5 sets up the extraction of the generative process graph used in Section  6 to perform idealizations.

@&#RELATED WORK@&#

As observed in the Introduction, B-Rep decomposition has been extensively studied for feature recognition and suppression. In CAE applications, B-Rep and meshed representations  [7–9] have been used to support local simplifications for detail removal. Machining feature recognition has been pioneered by Vandenbrande  [9] and has got many contributions to recognize and classify negative features as holes, slots or pockets  [10–12]. Woo et al.  [1,2] has contributed with a volume decomposition approach using a concept of maximal volume and observed that some of them may not be meaningful as machining primitives. In the field of visualization, Lee et al.  [13] address a progressive solid model generation. To reduce the complexity of assembly models,  [14,15] propose a multi-resolution decomposition of an initial B-rep assembly model. Lockett  [16] proposes to recognize specific positive injection molding features. Her method uses an already generated Medial Axis (MA) to find features from idealized models. One recognized difficulty is the ability to obtain MA in a wide range of configurations.

One common obstacle of feature recognition approaches is their difficulty to set feature definitions that can be general enough to process a large range of configurations. This is often mentioned by authors when features interact with each other because the diversity of interactions can lead to a large range of configurations that can be difficult to identify and structure.

Finding sequences of blend features in an initial shape is relevant to FE preprocessing. Regarding blends’ removal, Zhu and Menq  [17] and Venkataraman  [18] detect and classify fillet/round features in order to create a suppression order and remove them from a CAD model. These operations can contribute to the identification of steps of a construction tree.

In FEA, automatic decomposition of mechanical parts into sub-regions creates positive feature decompositions. Chong et al.  [19] use an edge pairing approach to initiate mid-surface areas with split edges but pairing may not always exist. The face-pairing [20,21] works from nearly parallel faces of CAD models, which produces robust results on a reduced set of configurations. MA Transform (MAT) methods work on mesh models, which are more generic, but produce complex geometry in connection areas. More recently, Robinson and Armstrong  [22] used the MA to identify thin region candidates for idealization.

Still, the idealization processes face difficulties in handling general configurations and connections between idealized sub domains through extension operations. It is effectively the case when mid-surfaces are parallel to each other. Also, mid-surfaces are not always the optimal location of idealized sub domains and external/internal ones are preferred.

The methods of Lu et al.  [3] or Liu and Gadh  [5] that use edge loops to find convex and sweepable sub-volumes for hex meshing and, more recently, the one proposed by Makem  [4] that identifies automatically long, slender regions are other applications of features to FEA. Ref.  [3] shows that the decomposition criteria must differ from the machining ones.

Shapiro  [23] and Buchele  [24] address B-Rep to CSG conversion as a means to associate a construction tree with a B-Rep model and  [24] applies it to reverse engineering configurations. CSG tree representations can be categorized as either halfspace or bounded solid decompositions. In  [23,24] B-Rep to halfspace CSG representation is studied and it has been demonstrated that halfspaces solely derived from a volume boundary cannot always be combined into a CSG tree forming a valid solid.

Robinson et al.  [25] use pre-existing CAD information to identify 2D sketches that are analyzed by MA, which are not always efficient (see Section  1 and Fig. 1). Yang et al.  [26] use a pre-existing history tree as basis for model repairing. Li et al.  [27,28] introduced a regularity feature tree used to highlight the symmetry in the object that differs from CSG and construction trees. Belaziz et al.  [29] proposed a morphological analysis of solid models based on features and B-Rep transformations that are able to simplify the shape of an object. It is also a type of B-Rep to CSG conversion. Indeed, the shape modifiers are elementary B-Rep operators that do not convey shape information.

All the approaches generating a CSG type tree structure from a B-Rep bring a higher level of shape analysis. However, the corresponding framework of B-Rep to CSG conversion must be carefully addressed to avoid unresolvable boundary configurations, and producing a single tree structure appears to be too restrictive. Achieving good quality connections between idealized sub domains in a robust manner is still a bottleneck of many approaches processing CAD volumes for FEA.

Construction trees are important because an object submitted to FEA preparation can be subjected to different simplifications at different levels of its construction process. One key issue of these trees is to rely on primitives that are available in common industrial CAD software and to store the sequence of shapes from the simple initial primitive shape to the final object. This behavior is consistent with the objective of using the tree contents for idealization and simplification purposes because the shapes obtained after these operations should get simpler to stay meaningful with regard to these purposes. Detail removal and idealization are tasks that are not entirely formalized. Consequently, the user’s know-how has still an important impact on these tasks to adjust the results of idealization and simplification algorithms. Idealization refers to geometric transformations where a subset of a volume can be changed into a surface or a line, i.e. dimensional reductions whereas simplifications are dimension preserving.

The construction tree is a well-known concept for a user. Therefore, the user’s know-how can be used to navigate a shape and to select a simpler shape within its history so that it better fits the idealization requirements. As a conclusion, one can state that enabling shape navigation using primitive features similar to that of CAD software is an efficient complement to algorithmic approaches and construction trees or, more generally, construction graphs can support efficiently both.

In our method, the focus is placed on B-Rep mechanical components being designed using volume modelers. Looking at feature-based modeling functions in industrial CAD systems, they all contain extrusion and revolve operations which are combined with addition or removal of volume domains (see Fig. 2
                     (a)). The most generic version of the extrusion, as available in all CAD software, is defined with an extrusion direction orthogonal to a plane containing the primitive contour. Such an extrusion as well as the revolution are defined here as the reference primitives. These feature-based B-Rep operations can be seen as equivalent to regularized Boolean operations as available also in common hybrid CAD modelers. Modelers also offer other primitives, to model e.g. draft surfaces, stiffeners, or free-form surfaces from multiple sections. Even though we do not address these primitives here, it is not a limitation of our method. Indeed, draft surfaces, stiffeners and similar features can be modeled with a set of reference primitives when extending our method to extrusion operations with material removal and revolutions. Fig. 2 illustrates some examples. An extrusion feature where the extrusion direction is not orthogonal to the sketching plane is used for its definition. However, the resulting shape can be decomposed into an extrusion orthogonal to a sketching plane and ‘cuts’; see Fig. 2(c). The slanted shape of the initial object in Fig. 2(d) is another example of extrusion with material removal.

Another category of form features available from B-Rep CAD modelers is blending radii. Generally, they have no simple equivalence with extrusions and revolutions. Generated from B-Rep edges, they can be classified into two categories:
                        
                           1-
                           constant radius blends that can produce cylindrical, toroidal or spherical surfaces;

constant radius blends attached to curvilinear edges and variable radius blends.

Category 1 blends reflect extrusion and revolution primitives and can be incorporated in their corresponding sketch (see Fig. 2(a)). This family of objects is part of the current approach. Category 2 blends are not yet addressed and are left for future work. Prior work in this field  [18,17,30] can be used to derive the object to be analyzed from the initial object, possibly with user’s interactions. In summary, all reference primitives considered here are generated from a sketch step in a plane defining at least one closed contour. The contour is composed of line segments and arcs of circles (see Fig. 2(b)). This is a consequence of the previous hypothesis reducing the shapes addressed to closed surfaces bounded by planes, cylinders, cones, spheres, tori, and excluding free-form shapes in the definition of the object boundary. This is not really restrictive for a wide range of mechanical components except for blending radii. We therefore restrict the generative processes to extrusion primitives in order to reduce the complexity of the description of the proposed approach in the present paper. Further hypotheses are made in the following sections.

Given a target object 
                           M
                         to be analyzed, let us first consider the object independently of the modeling context stated above. 
                           M
                         is obtained through a set of primitives combined together by adding or removing material. Combinations of primitives thus create interactions between their bounding surfaces, which, in turn, produce intersection curves that form edges of the B-Rep 
                           M
                        . Consequently, edges of 
                           M
                         contain traces of generative processes that produced its primitives. Hence, following Leyton’s approach  [6], these edges can be seen as the memory of generation processes where primitives are sequentially combined.

Current CAD modelers are based on strictly sequential processes because the user can hardly generate simultaneous primitives without looking at intermediate results to see how they combine/interact together. Consequently, B-Rep operators in CAD modelers are only binary operators and, during a design process, the user-selected one combines the latest primitive generated to the existing shape of 
                           M
                         at the stage 
                           t
                         of this generative process. Additionally, CAD modelers providing regularized Boolean operators reduce them to binary operators, even though they are 
                           n
                        -ary ones, as classically defined in the CSG (Constructive Solid Geometry) approaches  [31]. Here, we do not make any restriction on the amount of primitives possibly generated ‘in parallel’, i.e. the arity of the combination operators is 
                           n
                           ≥
                           2
                        .

The number of possible generative processes producing 
                           M
                         can be arbitrarily large, e.g. even a cube can be obtained from an arbitrarily large number of extrusions of arbitrarily small extent combined together with a union operator. We therefore refer the reader to the concept of maximal primitives so that the number of primitives is finite and as small as possible for generating 
                           M
                        .

A valid primitive 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         identified at a stage 
                           t
                         using a base face 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         is said to be maximal when no other valid primitive 
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                         at that stage having 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 ′
                              
                           
                         as base face can be entirely inserted in 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         (see Section  4.1 and Fig. 8(a)): 
                           ∀
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           ⊄
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         is a maximal face as defined in Section  3.2.

Maximal primitives imply that the contour of a sketch can be arbitrarily complex, which is not the case in current engineering practice, where the use of simple primitives eases the interactive modeling process, the parameterization, and geometric constraint assignments to contours. The concept of maximal primitives is analogous to the concept of maximal volume used in  [2,1] but  [12] does not use it. Even if making use of maximal primitives considerably reduces the number of possible generative processes, they are far from being unique for 
                           M
                        . We therefore make the further hypothesis that the generative processes we are looking for are principally of type additive, i.e. they are purely based on a regularized union operator when combining primitives at each stage 
                           t
                         of generative modeling processes. This hypothesis is particularly advantageous when intending to tailor a set of generative processes that best fit the needs of idealization processes. Indeed, idealized structures, such as mid-surfaces, lie inside such primitives, and connections between primitives locate also the connections between their idealized representatives. Therefore, the idealized representation of 
                           M
                         can be essentially derived from each 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and its connections, independently of the other primitives in the case of additive combinations. Fig. 3
                        (a) gives an example where 
                           M
                         can be decomposed into two primitives combined with a union (b). 
                           M
                         in Fig. 3(b) can thus be idealized directly from these two primitives and their interface. On the contrary, when allowing material removal, idealization transformations are more complex to process, while the resulting volume shapes are identical. Fig. 3(c) shows two primitives which, combined by Boolean subtraction, result also in object (a). However, computing an idealization of (a) by combining idealizations of its primitives in (c) is not possible. Performing the idealization of 
                           M
                         from its primitives strengthens this process compared to [19–21] for two reasons: first, each 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and its connections bound the 3D location and the connections of other idealized primitives. Second, different categories of connections can be defined, which is important because idealization processes still rely on users’ know-how to process connections significantly differing from reference ones (see Fig. 13).

To further reduce the number of possible generative processes, the processes described should be non trivial variants of processes already identified. For example, the same rectangular block can be extruded with three different face contours and directions but they create the same volume. These equivalent processes can be detected when comparing the geometric properties of the contour. Other similar observations will be addressed in the following sections when describing the criteria to select meaningful generative processes.

The above hypotheses aim at reducing the number of generative processes producing the same object 
                           M
                         while containing primitives suited to idealization transformations independently of the design process initially set up by engineers.

The overall approach can be synthesized through the process flow of Fig. 4
                        . The input STEP file contains the B-Rep model 
                           M
                        . A set of generative processes is extracted that forms sets of construction trees, possibly producing a graph. To this end, application dependent criteria are used to identify one or more construction trees depending on the application needs. Here, we focus on criteria related to idealization for FEA.

In order to extract generative processes from the B-Rep decomposition of 
                           M
                        , it is important to have a decomposition of 
                           M
                         that uniquely characterizes its shape. A B-Rep decomposition of an object is however not unique (and thus not suitable), because it is subjected to two influences: 
                           
                              –
                              its modeling process, whether it is addressed forward during a design process or backward as in the present work. Indeed, each operation involving a primitive splits/joins boundary faces and edges. When joining adjacent faces or edges, their corresponding surfaces or curves can be identical. Their decomposition is thus not unique. However, CAD modelers may not merge the corresponding entities, thus producing a boundary decomposition that is not changing the object shape (see Fig. 5
                                 (a)). For our purposes, such configurations of faces and edges must lead to a merging process so that the object boundary decomposition is unique for a given shape;

the necessary topological conditions to set up a consistent paving of an object boundary, i.e. the boundary decomposition must be a CW-complex. Consequently, curved surfaces need to be partitioned. As an example, a cylinder is decomposed into two half cylinders in most CAD modelers or is described with a self connected patch sewed along a generatrix (see Fig. 5(b)). In either case, the edge(s) connecting the cylindrical patches are adjacent to the same cylindrical surface and are not meaningful from a shape point of view. Hence, for our purposes, they must not participate in the intrinsic boundary decomposition of the object.

Following these observations, the concepts of maximal faces and edges are introduced as a means to produce an intrinsic and unique boundary decomposition for a given object 
                           M
                        . Maximal faces are identified first. For each face of 
                           M
                        , a maximal face 
                           F
                         is obtained by repeatedly merging an adjacent face 
                           
                              
                                 F
                              
                              
                                 a
                              
                           
                         sharing a common edge with 
                           F
                         when 
                           
                              
                                 F
                              
                              
                                 a
                              
                           
                         is a surface of same type and same parameters as 
                           F
                        . 
                           F
                         is maximal when no more face 
                           
                              
                                 F
                              
                              
                                 a
                              
                           
                         can be merged with 
                           F
                        . Indeed, maximal faces coincide with ‘c-faces’ defined in  [32] that have been proved to uniquely define 
                           M
                        . Similarly, for each edge of 
                           M
                        , a maximal edge 
                           E
                         with adjacent faces 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         is obtained by repeatedly merging an adjacent edge 
                           
                              
                                 E
                              
                              
                                 a
                              
                           
                         when 
                           
                              
                                 E
                              
                              
                                 a
                              
                           
                         is also adjacent to 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                        . Again, 
                           E
                         is maximal when no more edge 
                           
                              
                                 E
                              
                              
                                 a
                              
                           
                         can be merged with 
                           E
                        . As a consequence of these merging processes, it is possible to end up with closed edges having no vertex or with closed faces having no edge. An example for the first case is obtained when generating the maximal face of the cylinder in Fig. 5(b). A sphere described with a single face without any edge and vertex is an example of the second case.

Because of maximal edges without vertices and faces without edges, merging operations are performed topologically only, i.e. the object’s B-Rep representation is left unchanged. Maximal faces and edges are generated not only for the initial model 
                           M
                         but also after the removal of each primitive when identifying the graph of generative processes. Consequently, maximal primitives are based on maximal faces and edges even if not explicitly mentioned throughout this document.

Given an input volume object, the first step of our method is to transform it into a blending radii free object 
                        M
                     . For this, we apply defeaturing functions available in most CAD systems. This operation is a consequence of the modeling context defined in Section  3. Even though these functions may not be sufficient and robust enough, this is currently our working configuration. In contrast to blending radii, most chamfers are included in the present approach because they can be part of extrusion primitives and hence, included in the sketched contours used to define extrusion primitives. Even if CAD software packages provide specific functions for chamfers, they are devoted to the design context, but basic operators of extrusion with material addition or removal could produce the same result, in general. This analysis regarding chamfers shows the effect of the concept of maximal primitives described in Section  3.1. Starting with the object 
                        M
                     , the generative processes are obtained through two phases:
                        
                           –
                           
                              
                                 M
                               is processed by iterative identification and removal of primitives. The objective of this phase is to ‘go back in time’ until reaching root primitives for generative processes. The result of this phase is a set of primitives;

based on hypotheses of Section  3.1, a set of generative processes is produced using the primitives obtained at the end of the first phase to meet the requirements of an application: here idealization.


                     Fig. 6
                      summarizes the overall scheme just described previously. Fig. 7
                     
                      illustrates the major steps of the extraction of a generative process graph, i.e. from the primitive identification up to its removal from 
                        M
                     , and will be further explained in Sections  4.1 and 4.2.

In order to identify extrusion primitives 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         in 
                           M
                           =
                           
                              
                                 M
                              
                              
                                 0
                              
                           
                         and evolutions 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         of it, backward at the 
                           j
                        th step of the generation of the generative process graph, it is mandatory to define its geometric parameters as well as the hypotheses taken in the present work (see Fig. 8). First of all, notice that a ‘reference primitive’ 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is never appearing entirely in 
                           M
                         or 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         unless it is isolated like a root of a construction tree, i.e.  
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           M
                         or 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . Apart from these particular cases, 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         are only partly visible. For simplicity, we refer to such 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         as ‘visible primitives’. 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is the memory of a generative process that took place between 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                        . Extracting 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         significantly differs compared to feature recognition approaches  [20,3,2,21,12] that use 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and their neighborhood to subdivide the object. Here, identifying visible primitives enables the generation of reference ones having simpler contours.

The parameters involved in a reference extrusion 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         are the two base faces, 
                           F
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                         and 
                           F
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                        , that are planar and contain the same sketched contour where the extrusion takes place. Considering extrusions that add volume to a pre-existing object, the edges of 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         are called contour edges which are convex. A convex edge is such that the normals at its adjacent faces define an angle 
                           α
                         such that: 
                           0
                           <
                           α
                           <
                           π
                        . When 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         belongs to 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        , the contour edges along which 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is attached to 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         can be either convex or concave depending on the neighborhood of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         (see Fig. 8(a)).

In the direction 
                           
                              d
                           
                         of the extrusion, all the edges are straight line segments parallel to each other and orthogonal to 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                        . These edges are named lateral edges. Faces adjacent to 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         are called lateral faces. They are bounded by four edges, two of them being lateral edges. Lateral edges can be fictive lateral edges when a lateral face coincides with a face of 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         adjacent to 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         (see Fig. 8(a)). When lateral faces of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         coincide with adjacent faces in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        , there cannot be edges separating 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         from 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         because of the definition of maximal faces. Such a configuration refers to fictive base edges (see Fig. 7 with the definition of primitive 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        ).


                        Visibility. The visibility of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         depends on its insertion in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         and sets the conditions to identify 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         in 
                           ∂
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . The simplest visibility is obtained when 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        ’s base faces 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         exist and when at least one lateral edge connects 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         (see Fig. 8(a)).

More generally, 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is identified using two conditions. First, at least one base face 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         is visible in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        , i.e.  
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         can be identified by any planar maximal face. Second, one lateral edge exists, i.e. a straight line segment orthogonal and connected to a convex edge of 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                        . This edge defines the extrusion distance of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . Further lateral faces are identified by propagation from both sides of the candidate edge until the convexity of the edge of 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                         no longer holds. Notice that the lateral edges mentioned may not be maximal edges when lateral faces are cylindrical because maximal faces may remove all B-Rep edges along a cylindrical area. These conditions of definition of extrusion distance restrict the range of extrusion primitives addressed compared to the use of the longest lateral segment existing in the lateral faces attached to 
                           F
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                        . However, it is a first step enabling us to address a fair set of mechanical components and validate the major concepts of the proposed approach. This generalization is left for future work. Fig. 8(b), (c) give examples involving two or one visible base face, respectively.


                        Attachment. An extrusion primitive 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is attached to 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         in accordance with its visibility in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . The attachment defines a geometric interface, 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                        , between 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                        , i.e.  
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                           =
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ∩
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                        . This interface can be a surface or a volume or both, i.e. a non-manifold model. One of the simplest attachments occurs when 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         has its base faces 
                           F
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                         and 
                           F
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                         visible with similar contours. This means that 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is connected to 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         through lateral faces only. Consequently, 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         is a surface defined by the set of lateral faces not visible in 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . Fig. 8(a) illustrates such a type of interface (
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         contains two faces depicted in yellow).

A simple example of attachment involving a volume interface 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         between 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         is given in Fig. 8(d). Notice that the interface between 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         contains also a surface interface that is not highlighted. However, as we will see in Section  5, all possible variants of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         must be evaluated to keep the acceptable ones.

In a first step, 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         can be translated directly into an algorithm to identify them (procedure find_visible_extrusion of Algorithm 1). The visibility of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         does not refer to its neighboring faces in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . Next, they are subjected to validity conditions described in the following section.

The purpose is now to describe the removal operator that produces a new model 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         anterior to 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . This removal operator is defined as a binary operator with 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         as operands and 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         as result. In the context of a generative process, 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         relates to a step 
                           j
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         to a step 
                           
                              (
                              j
                              +
                              1
                              )
                           
                        .


                        Characterization of interfaces. In order to be able to generate 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         once 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is identified, it is necessary to reconstruct faces adjacent to 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         so that 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         defines a volume. To this end, the faces of 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         adjacent to 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         must be characterized. Here, we consider that 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is adjacent to other subsets of primitives through one edge at least. The removal operator depends on the type of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         and two categories can be set up to simplify the presentation of this operation: 
                           
                              1-
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  is of surface type. In this category, the removal operator will have to create lateral faces and/or the extension of 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                  so that the extended face coincides with 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                 . Indeed, this category needs to be subdivided into two sub categories: 
                                    
                                       a-
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   G
                                                
                                             
                                           contains lateral faces of 
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                           only (see Fig. 8(a)) or 
                                             
                                                
                                                   I
                                                
                                                
                                                   G
                                                
                                             
                                           contains also an extension of 
                                             F
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                           and edges of this extension are concave edges in 
                                             
                                                
                                                   M
                                                
                                                
                                                   −
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          ;


                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   G
                                                
                                             
                                           may contain lateral faces of 
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                           but it contains an extension of 
                                             F
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                           and the edges of this extension are fictive base edges in 
                                             
                                                
                                                   M
                                                
                                                
                                                   −
                                                   j
                                                
                                             
                                          . These edges would be convex edges in 
                                             
                                                
                                                   M
                                                
                                                
                                                   −
                                                   
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                           (see 
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                           in Fig. 7);


                                 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  contains at least one volume sub domain.

In addition, considering that 
                           F
                           
                              
                                 b
                              
                              
                                 1
                              
                           
                         at least is visible and 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is also visible (see Section  4.1), the attachment contour may not be entirely available to form one or more edge loops (see Fig. 8(a)). Also, 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         can contain more than one connected component when 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is resembling a handle connected to 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                        , which produces more than one edge loop to describe the attachment of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         to 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         in 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                        .


                        Validity. Whatever the category of interface, once 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is identified and its parameters are set (contour and extrusion distance), it is necessary to validate it prior to define its interface (step 2 of Fig. 7). Let 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         designate the volume of the reference primitive, i.e. the entire extrusion 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . To ensure that 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is indeed a primitive of 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        , the necessary condition is formally expressed using regularized Boolean operators between these two volumes: 
                           
                              (1)
                              
                                 
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          j
                                       
                                    
                                    
                                       
                                          ∪
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       −
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       −
                                       j
                                    
                                 
                                 =
                                 ϕ
                                 .
                              
                           
                        
                     

This equation states that 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         intersects 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         only along the edge loops forming its attachment to 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                        , i.e.  
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         does not cross the boundary of 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         at other location than its attachment. The regularized Boolean subtraction states that limit configurations producing common points, curve segments or surface areas between 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         at other locations than the attachment of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         are acceptable. This condition strongly reduces the number of primitives over time. Fig. 7 at step 2 shows that primitives 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         can be discarded.


                        Removal of 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        . The next step is to generate 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         once 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         has been identified and removed from 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . Depending on the type of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                        , some faces of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         may be added to ensure that 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         is a volume. 
                           
                              •
                              If 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  is of type 1a, then the faces adjacent to the contour edges of 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                  are orthogonal to 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                 . These faces are either planar or cylindrical. 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  contains the faces extending these faces, 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 , to form the lateral faces of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  that were ‘hidden in 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 ’. Edges of the attachment of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  belonging to lateral faces of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  can be lateral edges (either real or fictive ones) or arbitrary ones. Lateral edges bound faces in 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 , arbitrary edges bound the extension of the partly visible lateral faces of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 , they belong to: 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 . Then, 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  may contain the extension of 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                  called 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                  such that: 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    ∪
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    =
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                 . Then 
                                    
                                       (2)
                                       
                                          ∂
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          =
                                          
                                             (
                                             ∂
                                             
                                                
                                                   M
                                                
                                                
                                                   −
                                                   j
                                                
                                             
                                             −
                                             ∂
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          ∪
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ∪
                                             
                                                
                                                   F
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ∪
                                             
                                                
                                                   F
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                  where 
                                    ∂
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          j
                                       
                                    
                                  is the set of connected faces bounding 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          j
                                       
                                    
                                  and 
                                    ∂
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  is the set of connected faces bounding the visible part of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 . 
                                    ∂
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                  defines a closed, orientable surface, without self intersection. 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                  is therefore a volume.

If 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  is of type 1b, 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  contains a set of faces extending lateral faces of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 : 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 . To reduce the description of the various configurations, let us focus on the key aspect related to the extension of 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                  contained in 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                 . If this extension can be defined like 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                  above, it has to be observed that fictive edges of this extension in 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          j
                                       
                                    
                                  are replaced by convex edges in 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                 , i.e. edges of the same type (convex) as their corresponding edges in 
                                    F
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                  (see Fig. 7 step 3 left image). Without going into details, these fictive edges can be removed to simplify the contour of 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  since they bring unnecessary complexity to 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  and do not affect the complexity of 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                 . The corresponding effect is illustrated in Fig. 7 steps 3 and 4. This contour simplification can influence the contents of the sets 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          F
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                  above but it has no impact on the integrity of the volume 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                  obtained.

If 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  belongs to category 2, it contains at least one volume sub domain. Here again the diversity of configurations can be rather large and it is not intended to give a detailed description of this category. A first condition to generate a volume interface relates to surfaces adjacent to 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 . If 
                                    S
                                  is the extension of such a surface and 
                                    S
                                    
                                       
                                          ∩
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    ≠
                                    ϕ
                                    ,
                                    S
                                  may contribute to the generation of a volume sub domain. Then, each of these surfaces has to be processed. To this end, all the edges attaching 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  in 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                  and bounding the same surface in 
                                    
                                       
                                          M
                                       
                                       
                                          −
                                          
                                             (
                                             j
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                  are grouped together since they form a subset of the contour of faces possibly contributing to a volume sub domain. These groups are named 
                                    
                                       
                                          E
                                       
                                       
                                          a
                                       
                                    
                                 . Such an example of edge grouping is given in Fig. 8(d) where 
                                    
                                       
                                          e
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          e
                                       
                                       
                                          2
                                       
                                    
                                  are grouped because of their adjacency between 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                  and the same cylindrical surface. 
                                    
                                       
                                          E
                                       
                                       
                                          a
                                       
                                    
                                  together with other sets of edges are used to identify loops in 
                                    S
                                  that define a volume sub domain of 
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                  that must satisfy validity conditions not described here for sake of conciseness.

There may be several valid volume sub domains defining alternative sets of faces to replace the visible part of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ,
                           ∂
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , in 
                           ∂
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         by sets of faces that promote either the extension of surfaces adjacent to 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         or the imprint of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         with the use of faces belonging to the hidden part of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . All the variants are processed to evaluate their possible contribution to the generative process graph.

If, in a general setting, there may be several variants of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         to define 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                        , these variants always produce a realizable volume, which differs from the halfspace decomposition approaches studied in  [23,24] where complements to the halfspaces derived from their initial boundary were needed to produce a realizable volume.

Having defined the primitive removal operator, the purpose is now to incorporate constraints on variants of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         so that a meaningful set of models 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                           ,
                           j
                           >
                           0
                        , can be generated to produce a generative process graph. As mentioned earlier, the purpose is to ‘go back in time’ from model 
                           M
                         to single primitives forming the roots of possible construction trees. To this end, any acceptable primitive removal at step 
                           j
                         of the graph generation must produce a transformation of 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         into 
                           k
                         objects 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         using 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        , one of the variants of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                        , such that 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         are simpler than 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . This simplicity concept is a necessary condition for the graph generation to converge toward a set of construction trees having a single primitive as root. Consequently, the simplicity concept applied to the transition between 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         is sufficient to ensure the convergence of the graph generation process.

The shape simplification occurring between 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         can be defined as follows. First of all, it has to be considered that 
                           ∂
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         and 
                           ∂
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         contain maximal faces and edges. In fact, after 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is removed and replaced by 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         to produce 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        , its boundary decomposition is re-evaluated to contain maximal faces and edges only. Then, let 
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                         be the number of (maximal) faces in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         and 
                           
                              
                                 n
                              
                              
                                 
                                    
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         be the same quantity for 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        , the quantity 
                           
                              
                                 δ
                              
                              
                                 j
                                 k
                              
                           
                        : 
                           
                              
                                 δ
                              
                              
                                 j
                                 k
                              
                           
                           =
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 n
                              
                              
                                 
                                    
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         characterizes the shape simplification under the variant 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         if 
                           
                              
                                 δ
                              
                              
                                 j
                                 k
                              
                           
                           ≥
                           0
                        . This condition is justified because it enforces a ‘diminishing number of maximal faces over time’, which is an intrinsic quantity to each shape.


                        
                           
                              
                           
                        
                     

Having defined the condition to evolve backward in the generative process graph, the graph generation is summarized with Algorithm 1. The main procedure Extract_graph processes the node_list current variants of the model at the current step ‘backward in time’ using the procedure Process_variant and compares the new variants to the existing graph nodes using compare_config. If variants are identical, graph nodes are merged, which creates cycles. Then, Extract_graph adds a tree structure to a given variant corresponding to the new simpler variants derived from 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                        . The graph is completed when there is no more variant to process, i.e.  node_list is empty. Here, the purpose is to remove (using remove_primitives) the largest possible amount of primitives 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         whose interfaces 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         are not overlapping each other, i.e.  
                           ∀
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              ,
                              l
                              )
                           
                           ,
                           i
                           ≠
                           j
                           ,
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           ∈
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           ∈
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           ∩
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           =
                           ϕ
                        , otherwise 
                           
                              
                                 δ
                              
                              
                                 j
                                 k
                              
                           
                         would not be meaningful. Selecting the largest possible amount of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and assigning them to a graph node is mandatory to produce a compact graph. Each such node expresses the fact that all its 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         could be removed, one by one, in an arbitrary order, which avoids describing trivial ordering changes.

To process each variant 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         of 
                           M
                           ,
                           
                              Process_variant
                           
                         starts with the identification of valid visible extrusion primitives in 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         using find_extrusion (see Sections  4.1 and 4.2 respectively). However, to produce maximal primitives, all valid primitives which can be included into others (because their contour or their extrusion distance is smaller than the others) are removed (remove_ext_included_ext).

Once valid maximal primitives have been identified, processing the current variant 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         carries on with contour simplification: simplify_prim_contour, if it does not impact the shape complexity of 
                           
                              
                                 M
                              
                              
                                 −
                                 
                                    (
                                    j
                                    +
                                    1
                                    )
                                 
                              
                           
                         (see Section  4.2). Then, all the valid geometric interfaces 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         of each primitive are generated with generate_geom_interfaces (see Section  4.2) and interfaces 
                           
                              
                                 I
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         increasing the shape complexity are discarded with discard_complex to ensure the convergence (see Section  5.1). Sets of independent primitives are ordered to ease the user’s navigation in the graph.

The previous algorithm has been applied to a set of components whose shapes are compatible with extrusion processes to stay consistent with Algorithm 1 though they are industrial components. The results have been obtained automatically using Algorithm 1 implemented using Python and bindings with Open Cascade (OCC) library. Statistics given are the amount of calls to a generic Boolean type operator available in the OCC library, the total number of visible primitives (find_visible_extrusions), 
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        , and the final number of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         in the graph, 
                           
                              
                                 n
                              
                              
                                 p
                              
                           
                        .


                        Fig. 9
                          shows the generative processes extracted from four different and rather simple components. They are characterized by triples (
                           
                              
                                 n
                              
                              
                                 B
                              
                           
                           ;
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                           ;
                           
                              
                                 n
                              
                              
                                 p
                              
                           
                        ), (2183; 220; 8), (8246; 225; 15), (1544; 132; 6), (9353; 240; 31), for a, b, c and d, respectively. The graph structure reduces to a tree one for each of them. It shows that merging all extrusions in parallel into a single node can be achieved and results into a compact representation. These results also show the need for a constraint, that we can formalize as follows: configurations produced by generate_independent_ext must be such that each variant 
                           
                              
                                 M
                              
                              
                                 
                                    
                                       −
                                       
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         generated from 
                           
                              
                                 M
                              
                              
                                 −
                                 j
                              
                           
                         must contain a unique connected component as it is with 
                           M
                        . However, this has not been implemented yet. This continuity constraint expresses the fact that 
                           M
                         is a continuous medium and its design process follows this concept too. Consequently, any of its transformation stages must be so to ensure that any simplified model, i.e. any graph node, can stand as basis for an idealization process. Then, it is up to the idealizations and their hypotheses to remove such a constraint, e.g. when replacing a primitive by kinematic boundary conditions to express a rigid body behavior locally.


                        Fig. 10
                         shows the graph extracted from the component analyzed in Fig. 1. It is characterized by (111789; 1440; 62). Two variants appear at step 4 and later merge at step 8. It effectively produces a graph structure. It can be observed that the construction histories are easier to understand for a user than the one effectively used to model the object (see Fig. 1). Clearly, the extrusion primitives better meet the requirements of an idealization process and they are also better suited to dimension modification processes as mentioned in Section  1. It has been shown that this graph is a promising basis for getting a better insight of a shape structure and evaluating its adequacy for idealizations.

Here, we briefly illustrate how a generative process graph obtained with Algorithm 1 can be used in shape idealizations.

The primitives extracted from the graph can be used to analyze their morphology and evaluate their adequacy for idealizations. Because the primitives are all extrusions and adding material, analyzing their morphology can be performed with the MAT  [4,25,21]. MAT is particularly suited to extrusion primitives since it can be applied in 2D because of the constant thickness of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         and can be used to decide whether 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         can be assigned a plate or shell mechanical behavior. In the present case, the 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         obtained lead to two distinct configurations (see Fig. 11
                        ).   Fig. 11(a) shows a configuration with a thin extrusion, i.e. the maximal diameter 
                           Φ
                         obtained with the MAT from 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        ’s contour is much larger than 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        ’s thickness defined by the extrusion distance 
                           d
                        . Then, the dimensional reduction of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         would be a surface parallel to the base face having 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        ’s contour. Fig. 11(b) shows a configuration where the morphology of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         leads to an idealization that would be based on the content of the MAT because 
                           d
                         is much larger than 
                           Φ
                        .

To idealize a sub domain of an object in mechanics, a reference proportion used to decide whether it is idealizable or not is a ratio of ten between its in-plane dimensions and its thickness. This can be formalized as: 
                           x
                           =
                           max
                           
                              (
                              
                                 (
                                 max
                                 Φ
                                 /
                                 d
                                 )
                              
                              ,
                              
                                 (
                                 d
                                 /
                                 max
                                 Φ
                                 )
                              
                              )
                           
                         and 
                           x
                         is applicable for all morphologies of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        s. Another threshold can be user-defined to tune the morphological analysis and decide when 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         can/cannot be idealized. Fig. 11(c) illustrates a configuration where the morphological analysis does not produce a ratio 
                           x
                           >
                           10
                         though a user might idealize 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         as a plate. Let 
                           x
                           =
                           3
                         be this user-defined value; Fig. 12
                        
                         shows the result of the interactive analysis the user can perform from the decomposition results obtained in Figs. 9 and 10. Colors’ interpretation is given in the figure caption. The analysis is applied to the graph rather than a single tree structure to improve the efficiency of the analysis. However, the result obtained on component of Fig. 10 shows that the variants in the construction graph have no influence with respect to the morphological analysis criterion, in the present case. Results on components of Figs. 9 and 10(a) show the limit of this criterion because some non-idealizable 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         (see indications in Fig. 12 regarding violet sub domains) are indeed well proportioned to be idealized with beams. Such configurations are clearly calling for complementary criteria.

If the morphological analysis of 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is one application of the generative process graph, the primitive decomposition obtained can be used to monitor the idealizations. To this end, a taxonomy of connections between extrusion primitives is summarized in Fig. 13. The taxonomy refers to parallel and orthogonal configurations for simplicity but these configurations can be extended to process a larger range of angles. More specifically, the configuration where 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         is orthogonal to 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         both is lacking of robust solutions  [20,21] and other connections can require deviation from mid-surface location.

Having decomposed 
                           M
                         into extrusion primitives 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , the locations of interfaces 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         between 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         are precisely identified and can be used to monitor the deviations needed from mid-surfaces to improve the idealization process and take into account the user’s know-how. Particularly, connections with parallel mid-surfaces can be handled with mid-surface repositioning (see 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         in Fig. 14
                        (b)) and a corresponding adjustment of the material thickness on both sides of the idealized surface. This is a current practice in linear analysis that has been advantageously implemented using the relative position of extrusions. Similarly, when 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         are orthogonal to each other and their 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                         is located at their boundary (see 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         in Fig. 14(b)), either of the mid-surfaces needs to be relocated to avoid meshing narrow areas along one of the 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        ’s boundaries (here 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         is moved according to 
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                        ). Again, this configuration can be processed using the precise location of 
                           
                              
                                 I
                              
                              
                                 G
                              
                           
                        .


                        Fig. 14(a) illustrates a component with its decomposition through the generative process graph and the corresponding interfaces between its extrusion primitives. This decomposition contains a set of primitive connections of both categories discussed in Section  6.2 and Fig. 14(b) shows the repositioning of mid-surfaces among 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                         that improves their connections and the overall idealization process. Fig. 14(c) shows the resulting idealized model and its corresponding FE mesh.

Construction trees and shape generation processes are common approaches to model mechanical components. Here, it has been shown that construction trees can be extracted from the B-Rep model of a component. Indeed, construction trees are structured into a graph to represent the non trivial collection of generative processes that produce the input B-Rep model. The graph contains non trivial construction trees in the sense that variants of extrusion directions producing the same primitive are not encoded; material addition operations that can be conducted in parallel are grouped into a single graph node to avoid the description of combinatorial combinations when primitives are added sequentially as in CAD software.

The benefit of a generative process graph has been evaluated in the context of idealizations as needed for FEA. Also, the object decomposition produces an accurate description of geometric interfaces between primitives, which has been advantageously used to set up idealizations.

Clearly, future work will focus on incorporating material removal operations and revolutions to extend the range of objects that can be processed.

@&#REFERENCES@&#

