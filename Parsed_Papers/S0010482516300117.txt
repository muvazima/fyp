@&#MAIN-TITLE@&#Detection of small bowel tumor based on multi-scale curvelet analysis and fractal technology in capsule endoscopy

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           89 valid capsule videos were collected from 105 clinical trials with new developed WCE system.


                        
                        
                           
                           A novel automatic computer-aid system is proposed for small bowel tumor detection.


                        
                        
                           
                           The textural feature set is extracted by using discrete curvelet transform and fractal technology.


                        
                        
                           
                           The GA–SVM method is proposed for feature selection and WCE image classification.


                        
                        
                           
                           Extensive comparison experiments demonstrate that the proposed system outperforms recent approaches.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Small bowel tumor

Multi-scale curvelet

Fractal technology

Textural features

Support vector machine (SVM)

Genetic algorithm (GA)

@&#ABSTRACT@&#


               
               
                  Wireless capsule endoscopy (WCE) has been a revolutionary technique to noninvasively inspect gastrointestinal (GI) tract diseases, especially small bowel tumor. However, it is a tedious task for physicians to examine captured images. To develop a computer-aid diagnosis tool for relieving the huge burden of physicians, the intestinal video data from 89 clinical patients with the indications of potential tumors was analyzed. Out of the 89 patients, 15(16.8%) were diagnosed with small bowel tumor. A novel set of textural features that integrate multi-scale curvelet and fractal technology were proposed to distinguish normal images from tumor images. The second order textural descriptors as well as higher order moments between different color channels were computed from images synthesized by the inverse curvelet transform of the selected scales. Then, a classification approach based on support vector machine (SVM) and genetic algorithm (GA) was further employed to select the optimal feature set and classify the real small bowel images. Extensive comparison experiments validate that the proposed automatic diagnosis scheme achieves a promising tumor classification performance of 97.8% sensitivity and 96.7% specificity in the selected images from our clinical data.
               
            

@&#INTRODUCTION@&#

Small bowel tumors are an uncommon and heterogeneous group of diseases, accounting for 3–6% of all GI tract tumors and 1–3% of cancers [1–4]. Histologists have identified almost 40 different types of small bowel tumors. However, due to nonspecific or absent symptoms and inaccessibility of the small bowel, the diagnosis of small bowel tumors is often delayed, which results in poor survival prognosis for patients with malignant lesions [5]. In fact, conventional diagnostic modalities present some crucial limitations in the diagnosis of GI diseases, such as incomplete exploring depth, invasive exam procedure and poor performance in diagnostic yield [6–13]. The above problems promote the development of effective non-invasive monitoring systems like several types of wireless image capsule endoscopy (WI-CE) from different manufacturers and the wireless video capsule endoscopy system (WV-CES) that we designed in a previous work [14]. It has been discovered that WI-CEs are superior in finding Crohn׳s disease, obscure bleeding and suspected polyps of small bowel [15,16]. However, the image resolution and frame rate of WI-CEs are relatively poor. WV-CES can continuously collect videos of human GI tract under normal physiological conditions, analyze video data and evaluate GI state. Patients do not need to be narcotized before the examination and can walk freely during the test. WV-CES provides much more frames per second and high image resolution. In this manuscript, the GI video data is obtained by means of using WV-CES.

Based on the information of GI images, researchers have made a variety of efforts to automatically recognize small bowel tumors and help physicians to make decisions. Baopu Li et al. [17] proposed novel textural features which combined wavelet with local binary pattern for the detection of tumors in WCE images. Then, they proved their advanced performance by comparing them with several other traditional texture features [18], including curvelet based local binary pattern (CLBP) [19], color wavelet covariance (CWC) [20] and texture spectrum histogram (TSH) [21]. SVM-based feature selection methods can be used to further improve detection accuracy [22]. However, the wavelet owns low directional sensitivity and the texture patterns usually appear to be complex in a medical image. In [23], Daniel J C B et al. put forward different feature sets based on discrete curvelet transform (DCT) and statistical texture descriptors to recognize the WCE images of tumors. With the covariances of texture descriptors in different angles, this scheme showed promising classification results with SVM in real WCE image data. However, the method they proposed had poor robustness to illumination variation of different WCE images and the covariances were only calculated from a given curvelet scale. Daniel C B and Dalila B R [24] introduced a multi-scale analysis method based on the second and third order moments of statistical features taken from two reconstructed images. The images were obtained by the inverse wavelet transform of selected wavelet bands. The dimensionality of the feature set was reduced by using principal component analysis (PCA). However, the feature reduction method using PCA was not improved in classification performance.

In the current work, a computerized detection system for small bowel tumors is developed to exploit multi-scale textural features and a feature selection method based on SVM. To achieve this goal, a clinical study was conducted, covering 105 patients with different indications of potential tumors. The high prevalence rate found in the study proves the advancement of WV-CES we designed. Novel features for the selected small bowel images, which characterize multi-direction texture patterns and are robust to illumination variation of the images, are extracted by combining discrete curvelet transform with fractal technology. To find the optimal features which yield the greatest classification performance, a feature selection approach and genetic algorithm based on SVM (GA–SVM) are used to refine the proposed feature set. Comparison experiments with different feature sets and other methods of selected WV-CES images validate that the proposed method achieves an encouraging recognition rate for small bowel tumors.

The small bowel video data was obtained by the WV-CES that we developed. The WV-CES consists of three parts including a wireless capsule, a portable recorder and a workstation as shown in 
                        Fig. 1. The capsule incorporates a miniaturized camera, four light sources, a radio transmitter, a battery and a low-power application-specific integrated circuit (ASIC). The little device is propelled by peristalsis, capturing the image videos of entire GI tract with a resolution of 400×400 and at a frame rate of 24f/s. Meanwhile, the video data of images is wirelessly transmitted outside the patients׳ bodies. The portable recorder can receive the data transmitted from the capsule in real time and store them on the multimedia card (MMC). Then, the video data can be downloaded to a computer and processed at the workstation after the examination. The process includes playing back the video, image pre-processing, extracting characteristic textural features, recognizing abnormal images and providing a preliminary diagnosis.

To extend the work time of the capsule and increase the frame rate, a low-power controlling and processing ASIC is designed and made up of a three-stage clock management, a power management unit and a power efficient image compression module [25]. In addition, a novel RF transmitter with an on-off keying (OOK) modulation rate of 20Mb/s is applied in the capsule. Benefiting from these key designs, the capsule can work for more than 14h with specially-designed batteries.

In order to reduce the volume of the capsule, all components with the small package are integrated onto three PCBs of 0.5mm thickness and 10mm diameter [14]. The performance parameters of the developed capsule system compared with some commercially available WI-CEs are shown in 
                        Table 1.

From August 2013 to March 2015, a total of 105 patients (46 females; mean age 47.8 years old; range from 31 to 67 years old) were chosen as candidates of the WCE procedure at the Gastroenterology Unit of Pudong New Area People׳s Hospital. Information consent of all patients was obtained and the study was in accordance with the ethical guidelines related to human experiments.

The main indications for the WCE procedure include obscure GI bleeding, chronic diarrhea associated with flushing syndrome, abdominal pain and weight loss. The mean duration of symptoms before diagnosis is 8 months. Prior to the WCE procedure, 105 patients had undergone 442 previous diagnostic procedures (average 4.2 per patient) which included 164 colonoscopies, 151 upper endoscopies, 41 CT scans, 34 enteroscopies, 26 enteroclysis, 18 CT enterographies, 6 MRI enterographies as well as 2 angiographies.

The aim of this study is to obtain complete videos of the small bowel in order to develop a computer-aid diagnostic system and automatically recognize tumor images. Thus, the following three categories of patients were excluded.
                           
                              1)
                              Patients (n=8) with acute gastroenteritis, severe ischemic diseases and radioactive colonitis (active bacterial dysentery and ulcerative colitis) were excluded from this study.

Rondontti et al. found that small bowel obstruction or strictures had a high risk of capsule retention [26]. In addition, patients with other implanted electromedical devices could influence the examination procedure of WCE. Therefore, patients with suspected intestinal obstruction (n=5) and cardiac pacemaker (n=1) were excluded.

Two patients without complete small bowel video data were also excluded.

After 8-h nocturnal fasting, all patients swallowed the capsule with a sip of water and were allowed to engage in their usual activities. Liquids were permitted to drink 2h later and patients were allowed to have light meals 4h after ingesting the capsule. The captured video of the examination was downloaded to the workstation and viewed by four expert gastroenterologists. The final histological diagnosis was established through surgery.

@&#METHOD@&#

Data analysis in the workstation is divided into the following steps including image pre-processing, multi-scale higher order color texture feature extraction, feature reduction and classification. The flowchart of data analysis method is shown in 
                     Fig. 2.

In the image pre-processing stage, two images which contain the most relevant textural information are synthesized from the original image. Discrete curvelet transform (DCT) is a powerful multi-direction mathematical tool that allows decomposing the image in different scales with high directional sensitivity. For a function of 
                           
                              x
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         at scale 
                           
                              
                                 2
                              
                              
                                 −
                                 j
                              
                           
                        , orientation 
                           
                              
                                 θ
                              
                              
                                 l
                              
                           
                         and position 
                           
                              
                                 x
                              
                              
                                 k
                              
                              
                                 (
                                 j
                                 ,
                                 l
                                 )
                              
                           
                        , the second-generation curvelets are defined as:
                           
                              (1)
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          j
                                          ,
                                          l
                                          ,
                                          k
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          φ
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          j
                                          ,
                                          k
                                          )
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                        where 
                           
                              
                                 R
                              
                              
                                 
                                    
                                       θ
                                    
                                    
                                       l
                                    
                                 
                              
                           
                         is the rotation by 
                           
                              
                                 θ
                              
                              
                                 l
                              
                           
                        , 
                           
                              
                                 
                                    θ
                                 
                                 
                                    l
                                 
                              
                              =
                              2
                              π
                              l
                              ⋅
                              
                                 
                                    2
                                 
                                 
                                    −
                                    
                                       ⌊
                                       
                                          j
                                          /
                                          2
                                       
                                       ⌋
                                    
                                 
                              
                              ,
                              0
                              ≤
                              l
                              ≤
                              
                                 
                                    2
                                 
                                 
                                    ⌊
                                    
                                       j
                                       /
                                       2
                                    
                                    ⌋
                                 
                              
                              −
                              1
                           
                         and 
                           
                              k
                              =
                              (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              )
                              ∈
                              
                                 
                                    Ζ
                                 
                                 2
                              
                           
                        . The waveform 
                           
                              
                                 φ
                              
                              
                                 j
                              
                           
                         is defined by Fourier transform in polar coordinates (r, θ):
                           
                              (2)
                              
                                 
                                    
                                       φ
                                       
                                          ^
                                       
                                    
                                    (
                                    r
                                    ,
                                    θ
                                    )
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          3
                                          j
                                          /
                                          4
                                       
                                    
                                    W
                                    (
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                    r
                                    )
                                    V
                                    (
                                    
                                       
                                          
                                             
                                                2
                                             
                                             
                                                ⌊
                                                
                                                   j
                                                   /
                                                   2
                                                
                                                ⌋
                                             
                                          
                                          θ
                                       
                                       
                                          2
                                          π
                                       
                                    
                                    )
                                 
                              
                           
                        
                     


                        
                           
                              W
                              (
                              r
                              )
                           
                         and 
                           
                              V
                              (
                              t
                              )
                           
                         are the scale-dependent radial and angular windows respectively which satisfy the property of partition unity. The curvelet coefficients of the 2-D function 
                           
                              f
                              (
                              t
                              )
                           
                         are defined as:
                           
                              (3)
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          j
                                          ,
                                          l
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       〈
                                       
                                          f
                                          ,
                                          
                                             
                                                φ
                                             
                                             
                                                j
                                                ,
                                                l
                                                ,
                                                k
                                             
                                          
                                       
                                       〉
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                R
                                             
                                             2
                                          
                                       
                                    
                                    f
                                    (
                                    t
                                    )
                                    
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                j
                                                ,
                                                l
                                                ,
                                                k
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                       
                                          ¯
                                       
                                    
                                    d
                                    t
                                 
                              
                           
                        
                     

The discretization of continuous curvelet transform can be realized by “wrapping” algorithm [27], which is shown in 
                        Fig. 3. For an original 2-D image 
                           I
                        , a four-scale and eight-angle discrete curvelet transformation is applied to each color channel 
                           
                              
                                 I
                              
                              i
                           
                        . This transformation leads to the coarsest, medium and finest detailed sub-images, which can be defined as:
                           
                              (4)
                              
                                 
                                    
                                       
                                          W
                                       
                                       i
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                M
                                             
                                             
                                                2
                                                ,
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                n
                                                ,
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                       }
                                    
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    ;
                                    n
                                    =
                                    3
                                    ,
                                    4
                                    ;
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    [
                                    1
                                    ,
                                    8
                                    ]
                                    ;
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    [
                                    1
                                    ,
                                    16
                                    ]
                                 
                              
                           
                        
                     

where 
                           n
                         stands for the decomposition scale, 
                           i
                         stands for the color channel and 
                           
                              
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         are the curvelet bands.

The most relevant textural information that discriminates normal from tumor images often appears in the second or the third scale [28]. Thus, two new images can be synthesized by inverse discrete curvelet transform (IDCT), with the coefficients of the selected scales and the other sets as zero. Let 
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         where 
                           
                              j
                              =
                              
                                 {
                                 
                                    1
                                    ,
                                    2
                                 
                                 }
                              
                           
                         represents the reconstructed images for each color channel:
                           
                              (5)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                          ,
                                          2
                                       
                                    
                                    =
                                    I
                                    D
                                    C
                                    T
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          2
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    ;
                                    
                                       
                                          l
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    [
                                    1
                                    ,
                                    8
                                    ]
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                          ,
                                          3
                                       
                                    
                                    =
                                    I
                                    D
                                    C
                                    T
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          3
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    ;
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                    ∈
                                    [
                                    1
                                    ,
                                    16
                                    ]
                                 
                              
                           
                        where 
                           
                              I
                              D
                              C
                              T
                              (
                              ⋅
                              )
                           
                         is the inverse curvelet transform, 
                           i
                         stands for color channel and 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                         for curvelet band. A total of 6 synthesized images are obtained for each capsule image.

After put forth in 1975 [29], the fractal has been widely used in the field of identification of biological information. In this paper, box dimension algorithm is used to calculate the fractal dimension matrices of synthesized images 
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         because it has presented significant effect on classifying textures and performs robustly to illumination variation [30,31].

For a N×N image 
                           
                              (
                              x
                              ,
                              y
                              ,
                              f
                              (
                              x
                              ,
                              y
                              )
                              )
                           
                        , where 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                           
                         is the value of the position 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        , a L×L window slides the image pixel by pixel. In the L×L window, the local fractal dimension is calculated as follows: dividing the window into 
                           
                              ω
                              ×
                              ω
                           
                         grids and letting 
                           
                              r
                              =
                              ω
                              /
                              L
                           
                        , the box-counting number required to cover the grid 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         is given by:
                           
                              (7)
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    
                                       f
                                       l
                                       o
                                       o
                                       r
                                    
                                    (
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          ω
                                          ×
                                          ω
                                       
                                    
                                    )
                                    +
                                    1
                                 
                              
                           
                        where 
                           
                              
                                 f
                              
                              
                                 max
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 min
                              
                           
                         are the maximum and minimum inside the grid 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                        . Then the box-counting number required to cover the whole L×L window is given by:
                           
                              (8)
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

For a different set of 
                           ω
                        , the matching 
                           
                              
                                 
                                    N
                                 
                                 
                                    r
                                 
                              
                           
                         values are calculated. The local fractal dimension of L×L window is given by:
                           
                              (9)
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                    =
                                    
                                    
                                       i
                                       s
                                       q
                                       l
                                       i
                                       n
                                    
                                    
                                       (
                                       
                                          
                                             
                                                log
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                             
                                                log
                                                (
                                                1
                                                /
                                                r
                                                )
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    i
                                 
                                 
                                    s
                                 
                                 
                                    q
                                 
                                 
                                    l
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              (
                              ⋅
                              )
                           
                         is the linear least square function.

The fractal dimension matrices of synthesized images are given by 
                           
                              D
                              (
                              
                                 
                                    R
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        . To reduce the number of features, six commonly-used texture statistical descriptors are estimated for each matrix. These descriptors are composed of standard deviation, energy, skew, inverse difference moment, correlation and entropy.

The texture descriptors of three color channels for both scales are likely to be correlated. So, the correlations for each texture descriptor, including the second order statistics and the third order moments in both scales, as shown in 
                        Table 2, are calculated as:
                           
                              (10)
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          D
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          D
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                (
                                                
                                                   D
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          )
                                       
                                       3
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          ζ
                                       
                                       
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                m
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          D
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          D
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          F
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          D
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                t
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                    i
                                    ≠
                                    k
                                    ≠
                                    t
                                 
                              
                           
                        where 
                           j
                         refers to selected curvelet scale, 
                           
                              i
                              ,
                              k
                              ,
                              t
                           
                         refer to different color channels, and 
                           m
                         stands for texture statistical descriptor. In practice, higher than third order moments are rarely used, so they are not taken into account. Considering 6 texture descriptors, this approach will result in 126 second order statistics and 84 high order moments, which constitutes the feature vector for each frame.

Usually, not all the components of the feature vector are equally pleasurable and applicable in the classification scheme. It is likely that a large number of features will increase computational resources and have a negligible or inverse effect in the recognition process. Therefore, it is necessary to find out the optimal feature set which owns the best performance in the classification.

In our research, GA is used for determining the optimal diagnostic features. The individual feature is represented by the binary code. (The value 0 means the exclusion of the feature and the value 1 means the inclusion of the feature.) The steps of the GA are summarized as follows [32]:
                           
                              1)
                              Initialize 
                                    
                                       t
                                       =
                                       0
                                    
                                  and the maximum 
                                    T
                                  and randomly generate the initial population 
                                    
                                       P
                                       (
                                       0
                                       )
                                    
                                 .

Compute and save fitness 
                                    
                                       u
                                       (
                                       m
                                       )
                                    
                                  for each individual 
                                    m
                                  in the current population.

Define selection probabilities 
                                    
                                       p
                                       (
                                       m
                                       )
                                    
                                  for each individual 
                                    m
                                  in 
                                    
                                       P
                                       (
                                       t
                                       )
                                    
                                 .

Probabilistically select individuals from 
                                    
                                       P
                                       (
                                       t
                                       )
                                    
                                  to generate 
                                    
                                       P
                                       (
                                       t
                                       +
                                       1
                                       )
                                    
                                  via genetic operators (crossover and mutation).

Repeat step 2 until the defined fitness function obtains the maximum value.

SVM is an advanced technique used in a host of applications. It has excellent ability to handle a high-dimensional problem with a minimum classification structural error [33]. Given a test feature vector 
                           x
                        , the trained SVM outputs a label which indicates the class it belongs to,
                           
                              (13)
                              
                                 
                                    s
                                    =
                                    
                                       s
                                       i
                                       g
                                       n
                                    
                                    
                                       {
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             K
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             x
                                             )
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                              
                           
                        where 
                           
                              K
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              x
                              )
                           
                         is a kernel function which performs mapping, 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 ω
                              
                              
                                 0
                              
                           
                         are weight coefficients, and 
                           
                              s
                              i
                              g
                              n
                           
                         is the function that returns 
                           
                              +
                              1
                           
                         for positive and 
                           
                              −
                              1
                           
                         for negative inputs. In most applications, the radial basis function (RBF) is often used as 
                           
                              K
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              x
                              )
                           
                        .

In the GA–SVM classification method, each chromosome is related to the feature vector input into the SVM classifier. The parameters of GA are as follows: the population size is 120, the crossover rate is 0.90 and the mutation rate is 0.05. In order to avoid over-fitting, 10-fold cross-validation is utilized in the feature selection and classification procedure. The error function tested on the validation data set with a minus sign is defined as the fitness function. The GA maximizes the fitness function by performing the subsequent genetic operators. The roulette wheel is applied for the selection.

@&#EXPERIMENTS AND RESULTS@&#

There was no difficulty for patients to ingest the capsule and the procedure was well carried out with no adverse effects. The capsule video films of small bowel were extracted and interpreted by four gastroenterologists and the mean reading time lasted 120min (range from 93 to 184min). The locations of lesions were determined by the time ratio calculated by the same method in [1]. The results indicated that 15 patients (11 males, mean age 44.2 years old) were diagnosed with 17 small intestine tumors, 10 of whom were identified exclusively by WCE. The overall diagnostic yield was calculated at 16.8% of the study population. The types and locations of tumors are summarized in 
                        Table 3. Further diagnostic and therapeutic procedures established the final histological diagnosis.

From the WCE examinations of the study population, a dataset consisting of 900 normal images and 900 typical tumor images were collected by four gastroenterologists in the interpretation of WCE images, according to their expertize and upon mutual agreement. The tumor images, with the lowest possible similarity, were equally chosen from 15 patients with small tumors. In order to get a high degree of generalization, only 20% of normal images belonged to 15 patients while 80% of this data was obtained from the rest of patients in the study population. Then, each image in the data base is labeled by the gastroenterologists to provide the real truth. Some examples of the data set are shown in 
                        
                        Figs. 4 and 5.

To evaluate the performance of the proposed multi-scale curvelet analysis and fractal method in the present work, several preliminary classification feature vectors, where no multi-scale correlation or fractal method was used, were also extracted by using the DCT coefficients of only one scale. In these feature vectors, the second order statistics computed by Eq. (10) or the second and third order moments computed by Eqs. (10)–(12), are included just by considering the second or the third scale of the DCT transform. The classification performance in WCE images is measured by accuracy, sensitivity and specificity which are presented in [17]. The classification results of these feature vectors are shown in 
                        Table 4.

It is well known that the most important textural characterizations of WCE images lie in the middle details of the DCT. As shown in Table 4, the best performance of classification is obtained with the feature vector that contains the second order statistics and the third order moments calculated from the second scale of the DCT transform with fractal method. The average classification accuracy is 91.7%. Furthermore, the average sensitivity and specificity are 92.6% and 90.8% respectively. In addition, it is clear that the feature vectors with the second order statistics and the third order moments together are superior to those that only contain the second order statistics. Therefore, the additional high order moments lead to better classification results (2%). Actually, in our implementation, the addition of fourth order moments has no significant influence on the classification results in the case of increasing the dimensionality of the feature vectors.


                        
                        Table 5 presents the classification results for the proposed multi-scale texture analysis method and the effect of the dimension reduction in the feature vector using different approaches including PCA, SVM based sequential floating forward selection (SFFS) and SVM based recursive feature elimination (RFE). Comparing Table 4 with Table 5, it is obvious that the correlations of texture descriptors between different culvelet scales can significantly improve the classification performance (Acc.=94.2±0.7%, Sen.=94.6±0.7%, Spe.=93.8±0.5%) compared to that only one scale used (Acc.=91.7±1.1%, Sen.=92.6±1.2%, Spe.=90.8±0.9%). In order to decrease computation time in the classification process, the optimal number of the best features obtained by PCA can be set by users. However, the PCA method cannot enhance the classification performance as expected. Among all the dimension reduction methods, the GA owns the best performance (Acc.=97.3±0.5%, Sen.=97.8±0.5%, Spe.=96.7±0.4%) and the number of the optimal features (57) is determined during the selection process. The high increase in accuracy is obtained at the cost of expensive calculation cost, which leads to much computation time in training SVM classifier. However, the learning procedure of the SVM classifier is realized only once and the testing procedure of the trained SVM classifier is realized in no time.

To further demonstrate the classification performance of the proposed algorithm, we compared it to several state-of-the-art methods aimed for automatic tumor detection in capsule endoscopy images. These methods include the color wavelet covariance (CWC) features [19], color curvelet covariance (CCC) features [22], and uniform local binary pattern (ULBP) features with SFFS or RFE [21] as well as multi-scale wavelet covariance (MWC) features with PCA [23]. The performances of these methods for the selected small bowel images are listed in 
                        Table 6.

From Tables 5 and 6, we can conclude that the feature extraction and selection method in the proposed scheme show better performance than ULBP based on SFFS and REF methods, with an accuracy increase of 4.7% and 7.2%, respectively and a margin of 3.4% compared to those of MWC with PCA. Moreover, the CWC and CCC features own relatively poor performance. The results demonstrate that multi-scale curvelet based fractal covariance method with GA has a better tumor recognition rate in real clinical image data. Compared to ULBP methods, the reason why the proposed feature set shows better performance for tumor detection is that multi-scale rather than single scale based texture features have better discrimination ability. Compared to MWC with PCA, the reason may be attributed to the fractal technology which is robust to illumination variation of WCE images caused by unstable imaging conditions.

@&#DISCUSSION@&#

The advent of WCE is a major breakthrough for detection of the GI tract diseases [15,34]. As a noninvasive, painless and radiation-free tool, it is well accepted by patients. However, it still has some shortcomings like low image quality and frame rate. In our present study, the prevalence of small bowel tumor is 16.8% which is larger than those found in current literatures [1,5] (range from 2% to 11%). The reason may be that, on the one hand, the image resolution of the WCE system we designed is larger than that in other studies and the frame rate is 24 per second. On the other hand, small bowel MRI is not conducted in all patients to exclude patients with small bowel obstruction caused by small bowel tumors. Therefore, a more advanced hardware design of the WCE system and a detailed inspection procedure may be the practical ways of improving the detection of small bowel tumors.

Many efforts have been made to alleviate the huge burden of physicians [35] or automatically detect different abnormalities of the GI tract [17–24]. As the high-frequency details of the WCE images contain more significant information content for tumor detection, the present work combines the advantages of curvelet transform with fractal technology, resulting in preferable description of textures with multi-scale analysis and better stability to illumination variation. Through using genetic algorithm and support vector machine as classifiers, the performance of the proposed method is compared to a few recent texture extraction methods. Results on the selected images verify that this method is encouraging in identifying tumor images. However, the practical problem which should be considered is that the false positive images will restrict the wide application of the proposed scheme in hospitals. Thus, a complicated color texture model combining different feature extraction methods [36] should be developed to improve the specificity of recognition as much as possible.

Focusing on improving the diagnostic efficiency of capsule endoscopy, this paper presents a systematic study for the automatic detection of small bowel tumors. Firstly, a total of 105 patients with different indications of potential tumors underwent the WCE examination with the new WCE system we developed. The interpretation of data of 89 valid videos achieved a high prevalence of small bowel tumors (16.8%). Then, a computer-aid system based on multi-scale texture analysis and a GA–SVM classifier is developed. The novel textural features are built upon multi-scale curvelet and fractal technology and the classifier is based on SVM cooperating with genetic algorithm. Extensive experiments verify that the proposed feature set reveals better discriminative ability for the WCE images of tumors. By using GA for feature selection, the proposed system shows further performance improvement. The positive recognition rates are 97.3%, 97.8%, and 96.7% in term of accuracy, sensitivity and specificity respectively.

In the future study, we will concentrate on the hardware optimization of the WCE system and to the deep learning of discriminating different types of tumors as well as other abnormalities such as vascular lesions or benign ulcers. In addition, more WCE examination cases should be conducted to validate the clinical application of the proposed scheme.

The authors do not have any conflict of interests to disclose.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the National Natural Science Foundation of China (NSFC) (No. 31170968) and Innovation Program of Shanghai Municipal Education Commission (No. 09DZ1907400).

@&#REFERENCES@&#

