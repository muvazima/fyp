@&#MAIN-TITLE@&#Multiphase segmentation using an implicit dual shape prior: Application to detection of left ventricle in cardiac MRI

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Novel segmentation algorithm is presented incorporating shape prior.


                        
                        
                           
                           Segmentation algorithm is developed in a variational framework using level sets.


                        
                        
                           
                           The prior uses the anatomical shape similarity between endo- and epicardium.


                        
                        
                           
                           Their dissimilarity is modeled following a Gaussian distribution.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Segmentation

Shape analysis

Implicit shape prior

Level set function

Magnetic resonance imaging

Left ventricle

Cardiac disease

@&#ABSTRACT@&#


               
               
                  Cardiac magnetic resonance imaging (MRI) has been extensively used in the diagnosis of cardiovascular disease and its quantitative evaluation. Cardiac MRI techniques have been progressively improved, providing high-resolution anatomical and functional information. One of the key steps in the assessment of cardiovascular disease is the quantitative analysis of the left ventricle (LV) contractile function. Thus, the accurate delineation of LV boundary is of great interest to improve diagnostic performance. In this work, we present a novel segmentation algorithm of LV from cardiac MRI incorporating an implicit shape prior without any training phase using level sets in a variational framework. The segmentation of LV still remains a challenging problem due to its subtle boundary, occlusion, and inhomogeneity. In order to overcome such difficulties, a shape prior knowledge on the anatomical constraint of LV is integrated into a region-based segmentation framework. The shape prior is introduced based on the anatomical shape similarity between endocardium and epicardium. The shape of endocardium is assumed to be mutually similar under scaling to the shape of epicardium. An implicit shape representation using signed distance function is introduced and their discrepancy is measured in a probabilistic way. Our shape constraint is imposed by a mutual similarity of shapes without any training phase that requires a collection of shapes to learn their statistical properties. The performance of the proposed method has been demonstrated on fifteen clinical datasets, showing its potential as the basis in the clinical diagnosis of cardiovascular disease.
               
            

@&#INTRODUCTION@&#

Cardiovascular disease is one of the leading causes of death in western countries [28]. Since 1919, cardiovascular disease remains as the foremost cause of death in the United States [7]. Noninvasive cardiac imaging is now central to the diagnosis and management of patients with cardiovascular disease [3]. Several imaging modalities are extensively used to aid in the diagnosis and surgery of cardiovascular disease. Most popular ones include magnetic resonance imaging (MRI), positron emission tomography (PET), single photon emission computed tomography (SPECT), ultrasound (US), and computed tomography (CT). The advance of these imaging technologies enables us to better understand the relation between the anatomy of human organ and its functional properties. Although echocardiography is currently used as the most common modality in the diagnosis of cardiac disease [2], the use of MRI plays an important role in clinical studies related to the treatment of cardiac abnormalities. In particular, cardiac MRI is generally considered as the gold standard for the volumetric analysis of left ventricle (LV) since it can provide high-resolution anatomical information on cardiac chamber volumes, functions, and myocardial mass [18]. MRI has become increasingly an important modality to assess the cardiac anatomy and its function related to the cardiac abnormalities [11]. Examples of cardiac MRI in end-systolic (ES) and end-diastolic (ED) phases are presented in Fig. 1
                     .

Assessment of the variation of the LV volume between diastole and systole is essential, as it allows calculation of the parameters that can serve as a diagnostic and prognostic predictor of coronary artery disease. Segmentation of LV is a fundamental and crucial prerequisite for the derivation of clinical heart parameters, such as, wall motion, end-diastolic volume (EDV), end-systolic volume (ESV), and ejection fraction (EF) [8]. In particular, the delineation of endocardium and epicardium is essential in this quantitative analysis [13]. In addition, segmentation of LV plays an important role in a variety of applications including computer-aided diagnosis, localization of pathology, and image-guided interventions [25,11]. However, it usually involves manual interventions that are prone to large inter- and intra-observer variations. Therefore, it is significant to develop an unsupervised and automated segmentation algorithm that can provide precise and reproducible results replacing human interactions that are tedious and time-consuming. However, automated LV segmentation remains a challenging task and the difficulty mainly stems from the complex anatomy of the heart, limited and non-isotropic resolution, highly variable pathology and anatomy, and cardiac and respiratory motion [11].

A number of segmentation approaches have been proposed to address this problem in the past. A comprehensive survey on LV segmentation can be found in [24,11]. One of the widely used segmentation methods is an edge-based segmentation method that characterizes the boundary of objects using edge indicator functions and attracts segmenting contours called snakes toward the vicinity of edges [12,20]. In [27], the snakes-based segmentation method was proposed to tackle segmentation of LV on MR images. Segmentation using the snake technique is performed by evolving a segmenting curve defined in the image domain under the influence of the energy that consists of internal and external forces. In classical active contour models, an edge detector is used to derive the external force, and the internal force regularizes the curve preferring a smooth boundary. However, the drawback of this approach is that the object boundaries are mainly characterized by image gradients that may not be strong enough to define boundaries. In addition to low contrast, image noise is a degrading factor in an edge-based segmentation. Thus, a region-based approach has been proposed in order to deal with low contrast and insignificant details adopting a more global partitioning that integrates intensity over the entire image domain [21,4] where a segmenting curve is represented by the zero level set of a high dimensional embedding function. The level set representation is preferable since it can naturally deal with topological changes in contrast to the parameterized curve representation.

In recent years, a model-based approach [32,29,6] has drawn a lot of attention as an alternative for image segmentation applications to deal with incomplete image information. It incorporates shape prior knowledge to improve the segmentation results overcoming poor image contrast, noise, and missing object boundaries. In modeling of shapes, its representation is introduced in either explicit or implicit way and each method has its advantages and disadvantages. The parametric point distribution model [5] with landmarks is an example of the explicit representation. Despite its efficiency due to low dimensionality, it has several drawbacks such as fixed topology or need of pairwise correspondences. To overcome these limitations, the level set method is employed as an implicit shape representation using signed distance function that has been adopted in the level set segmentation method [32,29,6]. The implicit contour representation has several advantages over the explicit one in that it does not depend on a specific parameterization. For example, Mitchell et al. [19] presented the model-based approach using active appearance model and Lorenzo-Vald√©s et al. [16] proposed a probabilistic atlas-based segmentation method for segmentation of 4D cardiac MR images.

In order to reduce the dimensionality of shapes that reside in a high dimensional space, principal component analysis (PCA) has been widely used to compute shape statistics. For example, Leventon et al. [15] proposed a shape prior energy to restrict the flow of the geodesic active contour, where the prior was derived by performing PCA on a collection of signed distance functions of the training shapes. Shape incorporating segmentation [22,32] generally imposes shape prior knowledge in guiding segmenting boundary in the presence of noise or subtle boundary. However, it requires building the training shape data, which is labor intensive. Yang et al. [35] proposed a method for segmentation of LV by incorporating a neighbor prior constraint using level set representations. In addition, Kohlberger et al. [14] proposed to use a soft constraint using signed distance functions to give explicit control over the wall thickness as a fixed constant. Although myocardium is known to be nearly incompressible, 5% volume variation is usually observed [17].

There are other segmentation approaches based on intensity-based fuzzy connectedness framework [23], thresholding [9] and region-growing [1]. In particular, in [23], the authors employed a temporal intensity difference as a characteristic feature and applied the Hough transform for approximating the region of the left ventricle. For better localization of the left ventricle, an intensity-based fuzzy affinity was introduced using polar coordinates and a dynamic programming scheme was used in the optimization procedure. However, a geometric shape information was not utilized in their work as a prior knowledge while our method imposes a geometric constraint on the segmentation energy functional.

In the segmentation of LV in cardiac MRI, it is noted that the detection of epicardium is more challenging than that of endocardium since the background contrast is lower than the blood pool contrast, resulting in a partially missing epicardium boundary. In addition to the low contrast, heterogeneous characteristics of the epicardium region make it more difficult to determine its boundary. In this work, we aim at developing an accurate LV segmentation algorithm for cardiac MRI. A preliminary version of this method was reported in our previous work [34]. In this work, we report a complete algorithm design and provide new validations on both synthetic and cardiac data. In particular, we modify the assumption on the underlying shape distribution and improve the energy on the shape prior that imposes a shape similarity between the endocardium and the epicardium. In addition, in the evaluation of the algorithm, we perform extensive experiments on more clinical data and the MICCAI Challenge data [26]. We also compare the proposed method against a Random Walker segmentation method [10]. Furthermore, this work provides a clearer and better structured description of the proposed method. In order to resolve the problems mentioned above and provide robust segmentation results, we propose to use a novel shape constraint; namely, the implicit dual shape prior, without a training procedure, based on the assumption that the endocardium and epicardium shapes are anatomically similar. Specifically, we propose an energy functional using coupled level set functions that represent endocardium and epicardium and their shape discrepancy is measured based on the difference between their signed distance functions. Cardiac MRI at end-diastolic (ED) and end-systolic (ES) phases are used in our numerical experiment and quantitative tests on fifteen subjects demonstrate the accuracy and robustness of the proposed model.

The remainder of this paper is organized as follows. Our segmentation model and the associated energy functional are presented in Section 2 where an implicit shape knowledge is also described. In Section 3 presents experimental results of LV segmentation on cardiac MRI. Discussion is provided in Section 4 and concluding remarks is given in Section 5.

@&#METHOD@&#

We view segmentation as an estimation problem via a Bayesian inference that involves likelihood and prior information. Our proposed work is based on iterative framework of estimating the level set functions that are constrained by the shape prior information. The solution to this estimation is given by particular evolution equations for the region boundaries.

Our segmentation model is based on a multiphase segmentation framework [33]. We aim to define the boundary of two regions of interest that are endocardium and epicardium. In particular, we propose a multiphase segmentation scheme using two level set functions œï
                        1 and œï
                        2 whose shapes are assumed to be similar under scaling transformation. The level set representation allows to describe and deform curves without parameterization and topological prior [31]. The energy functional for the segmentation is defined in terms of two level set functions whose zero level sets represent the boundary of endocardium and epicardium. Let S
                        1, S
                        2
                        ‚äÇ
                        Œ© be the regions for endocardium and epicardium, respectively, where 
                           
                              Œ©
                              ‚äÇ
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         is the image domain. Then, the boundaries of endocardium and epicardium are represented by ‚àÇS
                        1
                        ={x‚à£œï
                        1(x)=0} and ‚àÇS
                        2
                        ={x‚à£œï
                        2(x)=0}, respectively. The given image I is assumed to consist of three disjoint regions as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   endocardium
                                                   
                                                   (
                                                   blood pool
                                                   )
                                                   =
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   {
                                                   x
                                                   ‚àà
                                                   Œ©
                                                   |
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   >
                                                   0
                                                   }
                                                
                                             
                                             
                                                
                                                   epicardium
                                                   
                                                   (
                                                   myocardium
                                                   )
                                                   =
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   {
                                                   x
                                                   ‚àà
                                                   Œ©
                                                   |
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   <
                                                   0
                                                   ,
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   >
                                                   0
                                                   }
                                                
                                             
                                             
                                                
                                                   extracardiac background
                                                   =
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ‚à™
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   =
                                                   {
                                                   x
                                                   ‚àà
                                                   Œ©
                                                   |
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   <
                                                   0
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In our problem, we aim to delineate the boundaries of two structures simultaneously. In the segmentation procedure, the most probable structures with similar shapes are jointly estimated by incorporating a novel shape constraint in a Bayesian framework. Given the input image I, the optimal segmentation is obtained by maximizing the posterior probability. Using the Bayesian theorem we have the following relationship:
                           
                              (1)
                              
                                 p
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 I
                                 )
                                 ‚àù
                                 p
                                 (
                                 I
                                 |
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        where p(I‚à£œï
                        1,
                        œï
                        2) is the likelihood function and p(œï
                        1,
                        œï
                        2) is the prior probability of the segmenting curves. Maximizing this conditional probability of segmenting functions œï
                        1 and œï
                        2 given image I is equivalent to minimizing its negative logarithm, which gives the following minimizing process:
                           
                              (2)
                              
                                 E
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 -
                                 log
                                 p
                                 (
                                 I
                                 |
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 -
                                 log
                                 p
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        where the first term represents data fidelity E
                        data and the second term represents a shape prior E
                        prior, respectively.

A gradient descent method can be applied to minimize the above energy functional with respect to each level set function alternatively.

Let S
                        ‚äÇ
                        Œ© be a shape represented by the level set function œï(x) as S
                        ={x‚à£œï(x)‚©æ0} where a signed distance function is used for œï. For given two shapes S
                        1 and S
                        2, we propose their discrepancy measure D(x; S
                        1,
                        S
                        2) as follows:
                           
                              (3)
                              
                                 D
                                 (
                                 x
                                 ;
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 {
                                 (
                                 1
                                 -
                                 H
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 H
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 -
                                 H
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 )
                                 H
                                 (
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 }
                                 |
                                 
                                    
                                       œï
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       œï
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 ,
                              
                           
                        where H is the Heaviside function defined by:
                           
                              (4)
                              
                                 H
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   x
                                                   ‚©æ
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   x
                                                   <
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In our problem, one region of interest (epicardium) includes the other (endocardium) resulting in a spatial constraint such that S
                        1
                        ‚äÇ
                        S
                        2. It is usually necessary to take into account correspondences between geometric features in the two shapes when their dissimilarity is measured. However, it is computationally expensive to build correspondences between shapes at each evolution procedure of segmenting curves. It is desirable to measure the shape difference efficiently without building explicit shape correspondences, which is the motivation of our proposed shape constraint.

We illustrate our shape distance in a schematic way in Fig. 2
                         where the correspondence in two shape curves is presented in (a), the distance function values parameterized by the arc length are presented in (b), and the absolute values of the difference between two level set functions representing two shapes are shown in a color coding scheme in (c).

In Fig. 2a, a distance from point p
                        2 on the rectangular shape to the circular shape can be given by the shortest Euclidean distance between point p
                        2 and its corresponding point p
                        3 on the circular shape. On the other hand, a distance from p
                        3 on the circular shape to the rectangular shape can be given by the Euclidean distance between p
                        3 and its corresponding point p
                        1 on the rectangular shape. We have p
                        1
                        =
                        p
                        2 if S
                        1 and S
                        2 are circular shapes. However, a large shape variation from the circle leads to a spatial gap between p
                        1 and p
                        2. This asymmetric property motivates to take into account the distribution of the Euclidean distance between the level set functions of shapes within the region between the shape boundaries. The shape distance is obtained by the Euclidean distance between the level set functions given by ‚à£œï
                        1
                        ‚àí
                        œï
                        2‚à£ for all the points within the region between the shape boundaries restricted by (1‚àí
                        H(œï
                        1))H(œï
                        2)+ (1‚àí
                        H(œï
                        2)) H(œï
                        1).

Thus, we propose a novel shape constraint on two regions of interest assuming that the defined shape distance D(x) between the two shapes follows a Gaussian distribution with mean Œº and variance œÉ
                        2; we write 
                           
                              d
                              (
                              x
                              )
                              ‚àº
                              N
                              (
                              Œº
                              ,
                              
                                 
                                    œÉ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         within the region between the boundaries that define the two shapes where d(x)=‚à£œï
                        1(x)‚àí
                        œï
                        2(x)‚à£. Formally, we write
                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                          
                                             p
                                             (
                                             d
                                             (
                                             x
                                             )
                                             )
                                             ‚àù
                                             exp
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  d
                                                                  (
                                                                  x
                                                                  )
                                                                  -
                                                                  Œº
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  œÉ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ‚àà
                                             {
                                             x
                                             |
                                             (
                                             (
                                             1
                                             -
                                             H
                                             (
                                             
                                                
                                                   œï
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                             H
                                             (
                                             
                                                
                                                   œï
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             +
                                             (
                                             1
                                             -
                                             H
                                             (
                                             
                                                
                                                   œï
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             )
                                             H
                                             (
                                             
                                                
                                                   œï
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                             ‚©æ
                                             0
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        where p denotes a probability density. This proposed shape prior makes use of the statistical property of shape similarity between the two shapes S
                        1 and S
                        2. By considering the anatomical property of the left ventricle, we can assume that the shapes of the epicardium and the endocardium are circular and equivalent modulo scale, which naturally leads d(x) by taking correspondences into consideration without computing diffeomorphism between S
                        1 and S
                        2. When the epicardium and the endocardium are deformed away from the circular shape, d(x) is assumed to follow the Gaussian distribution with control parameter œÉ that is related to the shape variation of S
                        1 and S
                        2 from the circular shape.

In this section we introduce the energy functional for our segmentation model based on a region-based segmentation method [4]. Our segmentation energy consists of the following terms that take into account the intensity homogeneity, smooth boundary assumption, and the mutual shape similarity constraint. Each term of the energy functional is described as follows:

Following Chan‚ÄìVese region-based segmentation model [4], we define the image term assuming that the intensity within segmenting region is homogeneous. We use a piecewise constant image model 
                              
                                 I
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                          ‚à©
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                              
                           , where S
                           1
                           ‚äÇ 
                           S
                           2 due to the anatomical constraint and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       b
                                    
                                 
                                 ‚àà
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                              
                            are constants in regions corresponding to endocardium, epicardium and background, respectively. The data fidelity term that measures the homogeneity within each region is defined by using a two-phase segmentation model as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          data
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                    dx
                                    +
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                    dx
                                    +
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                    dx
                                 
                              
                           
                        

The regularization term is designed to penalize the length of the segmenting curves favoring smooth boundaries as follows:
                              
                                 (7)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          reg
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       ‚à´
                                       
                                          ‚àÇ
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                    ds
                                    +
                                    
                                       ‚à´
                                       
                                          ‚àÇ
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    ds
                                    =
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    |
                                    ‚àá
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    |
                                    
                                    dx
                                    +
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    |
                                    ‚àá
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    |
                                    
                                    dx
                                 
                              
                           
                        

In order to deal with noise, subtle boundaries, and other nuisance factors, we incorporate a higher level knowledge on the regions of interest imposing a shape constraint assuming that the shapes of two segmenting regions are similar under scaling and their distance follows a Gaussian distribution. The shape term is defined by:
                              
                                 (8)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          shape
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    -
                                    log
                                    p
                                    (
                                    d
                                    (
                                    x
                                    )
                                    )
                                    =
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    
                                       
                                          
                                             
                                                (
                                                |
                                                
                                                   
                                                      œï
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      œï
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                -
                                                Œº
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                œÉ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    dx
                                 
                              
                           where Œº is determined by:
                              
                                 (9)
                                 
                                    Œº
                                    =
                                    
                                       
                                          
                                             ‚à´
                                             
                                                Œ©
                                             
                                          
                                          |
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          (
                                          (
                                          1
                                          -
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          +
                                          (
                                          1
                                          -
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          )
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          dx
                                       
                                       
                                          
                                             ‚à´
                                             
                                                Œ©
                                             
                                          
                                          (
                                          1
                                          -
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          +
                                          (
                                          1
                                          -
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          )
                                          H
                                          (
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          dx
                                       
                                    
                                 
                              
                           and œÉ is a parameter that can be chosen empirically based on the deformation properties of the region to segment. The constant œÉ is a control parameter that is related to the allowable shape difference between two segmenting boundaries. The higher œÉ value is, the more the two shapes can differ.

Lastly, we define the external energy term employing the edge indicator function that improves the characterization of boundary and the convergence of the energy minimization. The external energy is defined by:
                              
                                 (10)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ext
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       ‚à´
                                       
                                          Œ©
                                       
                                    
                                    g
                                    (
                                    x
                                    ;
                                    I
                                    )
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    dx
                                 
                              
                           where 
                              
                                 g
                                 (
                                 x
                                 ;
                                 I
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       |
                                       ‚àá
                                       
                                          
                                             G
                                          
                                          
                                             œÅ
                                          
                                       
                                       ‚àó
                                       I
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            is the edge indicator function with the Gaussian kernel G
                           
                              œÅ
                            with the standard deviation œÅ (we set œÅ
                           =1 in our experiments). When the edge indicator function g(x)=1 is given as constant, the external energy term becomes the area of the background. Thus, this is considered as the weighted area of the background according to the edgeness of the image.

Considering all the above energy terms, the total segmentation energy functional is defined by:
                              
                                 (11)
                                 
                                    E
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          data
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    Œ±
                                    
                                       
                                          E
                                       
                                       
                                          reg
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    Œ≤
                                    
                                       
                                          E
                                       
                                       
                                          shape
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    Œª
                                    
                                       
                                          E
                                       
                                       
                                          ext
                                       
                                    
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           where Œ± controls the smoothness of segmenting shapes, Œ≤ weights the significance of the shape prior knowledge that specifies the allowable variation in distance between two shapes, and Œª is a coefficient of the external energy which helps speed up the curve evolution.

In the minimization of the energy functional a gradient descent scheme is used and an alternative minimization process with respect to œï
                           1 and œï
                           2 is performed, which can be given by
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            t
                                                         
                                                      
                                                      =
                                                      -
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  data
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      Œ±
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      Œ≤
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  shape
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      Œª
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  ext
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      0
                                                      
                                                      on
                                                      
                                                      Œ©
                                                      ‚ßπ
                                                      ‚àÇ
                                                      Œ©
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            t
                                                         
                                                      
                                                      =
                                                      -
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  data
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      Œ±
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      Œ≤
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  shape
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      Œª
                                                      
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  ext
                                                               
                                                            
                                                         
                                                         
                                                            ‚àÇ
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      0
                                                      
                                                      on
                                                      
                                                      Œ©
                                                      ‚ßπ
                                                      ‚àÇ
                                                      Œ©
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where t denotes an artificial variable that parameterizes the evolution of œï
                           1 and œï
                           2 and the associated Euler‚ÄìLagrange equation for each term yields the gradient direction of œï
                           1 and œï
                           2 as follows:
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                data
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    (
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                reg
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                    div
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   ‚àá
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   |
                                                   ‚àá
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                shape
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    (
                                    1
                                    -
                                    2
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          
                                             
                                                (
                                                |
                                                
                                                   
                                                      œï
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      œï
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                -
                                                Œº
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                œÉ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ext
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    (
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    -
                                    1
                                    )
                                    g
                                    (
                                    x
                                    ;
                                    I
                                    )
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                data
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    (
                                    (
                                    1
                                    -
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    |
                                    I
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                reg
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                    div
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   ‚àá
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   |
                                                   ‚àá
                                                   
                                                      
                                                         œï
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                shape
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    (
                                    1
                                    -
                                    2
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          
                                             
                                                (
                                                |
                                                
                                                   
                                                      œï
                                                   
                                                   
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      œï
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                -
                                                Œº
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                œÉ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ext
                                             
                                          
                                       
                                       
                                          ‚àÇ
                                          
                                             
                                                œï
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    Œ¥
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    (
                                    H
                                    (
                                    
                                       
                                          œï
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    -
                                    1
                                    )
                                    g
                                    (
                                    x
                                    ;
                                    I
                                    )
                                 
                              
                           with the following boundary condition:
                              
                                 (21)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      Œ¥
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      |
                                                      ‚àá
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      |
                                                   
                                                
                                                
                                                   
                                                      ‚àÇ
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      ‚àÇ
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ‚Üí
                                                         
                                                      
                                                   
                                                
                                                =
                                                0
                                                
                                                on
                                                
                                                ‚àÇ
                                                Œ©
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      Œ¥
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      |
                                                      ‚àá
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      |
                                                   
                                                
                                                
                                                   
                                                      ‚àÇ
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ‚àÇ
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ‚Üí
                                                         
                                                      
                                                   
                                                
                                                =
                                                0
                                                
                                                on
                                                
                                                ‚àÇ
                                                Œ©
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       n
                                    
                                    
                                       ‚Üí
                                    
                                 
                              
                            denotes the exterior normal to the boundary ‚àÇŒ©, and 
                              
                                 ‚àÇ
                                 
                                    
                                       œï
                                    
                                    
                                       i
                                    
                                 
                                 /
                                 ‚àÇ
                                 
                                    
                                       n
                                    
                                    
                                       ‚Üí
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              
                            denotes the normal derivative of œï
                           
                              i
                            at the boundary. Keeping œï
                           1 and œï
                           2 fixed and the minimization of the energy with respect to the constants c
                           1, c
                           2 and c
                           
                              b
                            is given by:
                              
                                 (22)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ‚à´
                                                         
                                                            Œ©
                                                         
                                                      
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      I
                                                      (
                                                      x
                                                      )
                                                      dx
                                                   
                                                   
                                                      
                                                         ‚à´
                                                         
                                                            Œ©
                                                         
                                                      
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      dx
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ‚à´
                                                         
                                                            Œ©
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      )
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      I
                                                      (
                                                      x
                                                      )
                                                      dx
                                                   
                                                   
                                                      
                                                         ‚à´
                                                         
                                                            Œ©
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      )
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      dx
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      b
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ‚à´
                                                         
                                                            Œ©
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      )
                                                      I
                                                      (
                                                      x
                                                      )
                                                      dx
                                                   
                                                   
                                                      
                                                         ‚à´
                                                         
                                                            Œ©
                                                         
                                                      
                                                      1
                                                      -
                                                      H
                                                      (
                                                      
                                                         
                                                            œï
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      )
                                                      dx
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

@&#IMPLEMENTATION@&#

The optimization algorithm, in summary, is given as the following steps:
                           Algorithm¬†1
                           Curve evolutions with an implicit dual shape prior. 
                                 
                                    
                                       
                                       
                                          
                                             1: The shape variation parameter œÉ is given
                                          
                                          
                                             2: Initialize œï
                                                1 and œï
                                                2 with shapes S
                                                1 and S
                                                2
                                             
                                          
                                          
                                             3: Compute c
                                                1, c
                                                2 and c
                                                
                                                   b
                                                 by (22)
                                             
                                          
                                          
                                             4: Compute Œº by (9)
                                             
                                          
                                          
                                             5: Update œï
                                                1 and œï
                                                2 by an iteration of (12) with boundary condition (21)
                                             
                                          
                                          
                                             6: Reinitialize œï
                                                1 and œï
                                                2 as the signed distance function
                                          
                                          
                                             7: Repeat Steps 3‚Äì6 until convergence of œï
                                                1 and œï
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           


                        S
                        1 and S
                        2 are the signed distance functions of circular shapes with different radii centered at a specified point x0. In implementing the Heaviside function, we used a regularized version as in [4] given by:
                           
                              (23)
                              
                                 
                                    
                                       H
                                    
                                    
                                       ‚àä
                                    
                                 
                                 (
                                 œï
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   œï
                                                   >
                                                   ‚àä
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   œï
                                                   <
                                                   -
                                                   ‚àä
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  œï
                                                               
                                                               
                                                                  ‚àä
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  œÄ
                                                               
                                                            
                                                            sin
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           œÄ
                                                                           œï
                                                                        
                                                                        
                                                                           ‚àä
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In addition, the approximation to delta function is given by
                           
                              (24)
                              
                                 Œ¥
                                 (
                                 œï
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                         ‚àä
                                                      
                                                   
                                                   (
                                                   1
                                                   +
                                                   cos
                                                   (
                                                   
                                                      
                                                         œÄ
                                                         œï
                                                      
                                                      
                                                         ‚àä
                                                      
                                                   
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   |
                                                   œï
                                                   |
                                                   <
                                                   ‚àä
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where we set ‚àä
                        =2.5 in our computation.

@&#EXPERIMENTAL RESULTS@&#

In this section, we presents experimental results to demonstrate the performance of the proposed algorithm using synthetic datasets and clinical MR datasets. All experiments were performed on Intel i7 CPU with a clock speed of 1.74GHz and 8 GByte memory. All programs were implemented in MATLAB. The mean computation time for segmenting one cardiac phase was 2.1¬±0.5min.

To illustrate the role of our shape constraint, simple yet demonstrative synthetic examples have been employed as shown in Fig. 3
                         where an example of one circular shape (inside) and another deformed circular shape with a rectangular corner (outside) is presented in top row and an example of one circular shape (inside) and its noisy version (outside) is presented in the bottom row. Assuming that the inner circle and outer circle have similar shape, the effect of the application of shape prior on different parameters is simulated in this experiment. To generate the noisy example, Gaussian noise with zero mean and standard deviation of 20 was added to investigate the effect of noise on the segmentation. We often encounter unusual local deformations in segmenting particularly an anatomical object that presents subtle boundary due to the lack of characteristic features.

In our shape energy, we can control the degree of deviation from one shape to the other by setting different values for the standard deviation œÉ involved in the shape dissimilarity measure, which results in constraining the allowable space of the mutual shape deformation. A small œÉ restricts both shapes to be similar and a large œÉ allows a high variation of the distance between two shapes. The segmentation results using a multiphase Chan‚ÄìVese segmentation model [4] are presented in Fig. 3a and e as comparisons to our shape constraint prior with different œÉ.

The cardiac MRI images were acquired on a clinical 1.5T MRI scanner (Siemens Sonata, Erlangen, Germany). The imaging parameters were as follows: field of view=350mm, matrix=255 √ó192 to 255√ó255, slice thickness=8mm, slice gap=2mm, pixel bandwidth=930kHz, flip angle=60¬∞ and segment size=5‚Äì9 lines depending on heart rate. We also used five datasets in the MICCAI Grand Challenge [26] for the evaluation of the proposed method. The details on datasets can be found in [26].

In our experiments, parameters were selected empirically same for all subjects (Œ±
                           =400, Œ≤
                           =30, Œª
                           =400, and œÉ
                           =2). The time step was set to 0.001. The algorithm stops when the energy change is less than 0.0001 or iteration reaches the predefined iteration number of 200. We performed re-initialization of signed distance functions in 10 iterations.

The methods were tested on cardiac MRI at ED and ES phases of fifteen subjects, followed by quantitative comparison to expert manual segmentation previously obtained. Initialization was performed on 2D mid slice of ED phase only with a two-click procedure by selecting the center of endocardium and boundary of endocardium. Subsequently, the initialization was propagated using slice-to-slice and frame-to-frame deformable registrations using similarity measure of mutual information as in [30]. In order to quantitatively evaluate the performance of the segmentation methods, four measurements were used. One is the dice similarity coefficient (DSC) defined as
                              
                                 (25)
                                 
                                    DSC
                                    =
                                    
                                       
                                          2
                                          |
                                          
                                             
                                                A
                                             
                                             
                                                s
                                             
                                          
                                          ‚à©
                                          
                                             
                                                A
                                             
                                             
                                                g
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                A
                                             
                                             
                                                s
                                             
                                          
                                          |
                                          +
                                          |
                                          
                                             
                                                A
                                             
                                             
                                                g
                                             
                                          
                                          |
                                       
                                    
                                    ,
                                 
                              
                           where A
                           
                              s
                            and A
                           
                              g
                            are the areas enclosed by the segmented contour and the ground truth, respectively. In addition, we measured clinically important parameters such as end-diastolic volume (EDV), end-systolic volume (ESV), myocardial mass, and LV ejection fraction (LVEF) where LVEF is defined as
                              
                                 (26)
                                 
                                    LVEF
                                    
                                    (
                                    %
                                    )
                                    =
                                    
                                       
                                          EDV
                                          -
                                          ESV
                                       
                                       
                                          EDV
                                       
                                    
                                    √ó
                                    100
                                    .
                                 
                              
                           
                        

The mean and standard deviation of the measurement were computed to evaluate the variation of the segmentation results for each subject.

@&#EXPERIMENTAL RESULTS@&#

We have applied our segmentation algorithm to cardiac MRI volume date of fifteen subjects and the manual segmentation by experts has been also obtained. As a comparison we have employed a multiphase Chan‚ÄìVese segmentation algorithm and the random walker algorithm [10] and the results are presented in Figs. 4 and 5
                           
                            where our proposed algorithm outperforms the multiphase Chan‚ÄìVese algorithm that fails to compensate the missing boundary and the random walker algorithm that fails in the presence of multiple objects. The experimental results indicate that our method successfully finds accurate boundaries for the endocardium and epicardium. Example of segmentation results of 2D and 3D volume for three representative cases using our method are presented in Figs. 6 and 7
                           
                           , respectively. The mean values of EDV, ESV, myocardial mass, and LVEF calculated from 10 studies by using manual segmentation and proposed algorithm are presented in Table 1
                            and the Bland‚ÄìAltman plot is provided in Fig. 8
                           , showing there is a small average of the differences between the proposed method and the ground truth. In addition, clinical values of EDV, ESV, myocardial mass, and LVEF for all subjects are presented in Fig. 9
                           . The resulting DSC plot, including the MICCAI Grand Challenge datasets is shown in Fig. 10
                            in which the mean and the standard deviation are 0.89¬±0.03. In our study, the statistical significance was evaluated using paired t-test (p
                           <0.05). The results using quantitative indices clearly show that the proposed method provides robust and accurate results as compared with the manual segmentation results (p
                           =NS). Our approach provides statistical modeling for the margin between two shapes based on the fact that the distance between epicardium and endocardium is not fixed but variable, and the epicardium delineation often suffers from vague boundary. Assuming fixed distance between two shapes, curve evolving can be robust to vague boundary but it is not flexible enough to capture the actual boundary. On the other hand, given no constraint, curve evolution depends only on the data fidelity term, which results in passing through the boundary. Thus, we achieved balance between them by adopting statistical modeling for the margin between two shapes. Examples of the best and worst segmentation results are shown in Fig. 11
                           .

@&#DISCUSSION@&#

We presented a segmentation algorithm incorporating a novel shape prior knowledge for the simultaneous segmentation of endocardium and epicardium of the LV in cardiac MRI. The segmentation method has been developed in a variational framework using level sets and the shape constraint was introduced in order to deal with subtle or missing boundary information. Our shape constraint was obtained based on the assumption that the shapes of the two regions of interest are close modulo a scaling transformation, entailing an implicit shape prior rather than an explicit one that is usually established by the training phase using manual annotation data.

In the representation of shape, we have employed an implicit form using a level set function that is desirable to deal with topological changes, however, the dimensionality of the shape space where our shapes reside is much higher that the one of a parameterized shape curve with finite bases. Its high dimensionality results in a highly computational complexity in estimating the intrinsic properties of shapes on a shape manifold. The high dimensionality and nonlinearity of the shape space motivate us to introduce an implicit shape prior that imposes a mutual similarity under a scaling transformation on the shape of segmenting boundaries within an allowable shape variation that is controlled by a scalar value of the standard deviation of Gaussian distribution. This controlling parameter is provided by the observation of the degree in measuring a shape discrepancy between the two segmenting shapes.

The performance of our segmentation algorithm has been shown to be effective and robust by the numerical experiments based on clinical datasets as well as synthetic datasets. The results of the algorithm were comparable to the manual segmentation in terms of the accuracy of boundary delineation.

In the modeling of shape discrepancy between the endocardium and the epicardium, we have assumed that the shape of epicardium is approximated by the shape of endocardium modulo scaling. Their shape difference is related to the shape of cardiac wall of which the inner boundary and the outer boundary may have geometrical perturbations that are assumed to follow the Gaussian distribution. This also provides computational convenience.

The energy functional for our segmentation scheme is not convex and therefore the solution is subject to the initial condition as most other methods in a variational framework are. Therefore, it is desirable to develop a convex segmentation energy formulation that incorporates a shape constraint, however, we have initialized with circular shapes with specified radii at the center point that is determined by analyzing directional integrations of intensity. We have introduced a shape prior that imposes a spatial shape constraint, but it is also desirable to consider a motion prior that imposes certain pattern such as radial motions on the deformation of the LV. A spatio-temporal prior will enable us to improve the characterization of temporal deformation that is significant clinical information in the diagnosis of heart abnormalities. The optimal parameter selection is a challenging task. The parameters are often chosen empirically based on the performance of the algorithm. In our experiments, each parameter was chosen based on the segmentation results, however we used same parameters for all datasets. For determining control parameter of the shape variation, we use a constant value through our experiments since the myocardium is nearly incompressible (5% volume variation is usually observed) [17].

The proposed work provided a novel approach to model shape prior without any training procedure in order to robustly segment LV. This work can be used to other related applications that have similar anatomical structures. The proposed method has been shown to have advantages in segmenting the structures with occluded or missing boundaries in cardiac application.

@&#CONCLUSION@&#

In this work, a segmentation method based on the novel shape constraint using level sets was developed for delineating LV in cardiac MRI. Experimental results show that the proposed method has superior performance to the conventional multiphase Chan‚ÄìVese segmentation method. It also delineates better the subtle or missing boundaries as qualitatively and quantitatively confirmed. The proposed method allows accurate segmentation of LV, thereby potentially improving further assessment of cardiovascular disease.

@&#ACKNOWLEDGMENT@&#

This work was supported by the National Research Foundation of Korea Grant funded by the Korean Government (MEST) (NRF-2010-220-D00078).

@&#REFERENCES@&#

