@&#MAIN-TITLE@&#Sweep scan path planning for efficient freeform surface inspection on five-axis CMM

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method for planning sweep scan path for freeform surfaces on a 5-axis CMM is proposed.


                        
                        
                           
                           The generated scan path utilizes kinematic advantages of 5-axis CMM to improve scanning efficiency.


                        
                        
                           
                           Experiments show significant improvement in scanning efficiency compared to some existing methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Sweep scan

Free-form surface

5-axis path planning

CMM

@&#ABSTRACT@&#


               
               
                  Compared with the traditional 3-axis coordinate measuring machine (CMM), a 5-axis CMM equipped with the capability of continues sweep scanning can provide much denser data points while taking much shorter time. This paper presents an automatic sweep scan path planning system that generates a continuous sweep scanning path for the inspection of an arbitrary free-form surface using a 5-axis CMM with three translational axes and a rotary head with two very light rotary axes. The system strives to significantly improve the scanning efficiency by utilizing the superb kinematic advantages of the two rotary axes, which have very low moment of inertia, to cover a larger area, while tremendously reducing the speed and acceleration demand on the three translational axes which have much larger inertia. The path is generated from a mesh model of the freeform surface and an iterative approach is used to ensure that the stylus contacts the surface at an acceptable angle during the entire scan. Physical scanning experiments are performed and the test results show significant improvement in scanning efficiency by the proposed sweep scan path planning method when compared with some existing continuous scanning path planning approaches such as the standard isoparametric or zigzag method.
               
            

@&#INTRODUCTION@&#

Free-form surfaces are widely used in the design of those products with high and strict precision requirement, such as turbine and blisk blades, high precision lenses, biomedical components, etc. For the purpose of error analysis in quality control and model reconstruction in reverse engineering, the geometric information of free-from surfaces should be retrieved both precisely and efficiently.

For free-form surface inspection, the most common and effective way is by means of a Coordinate Measuring Machine (CMM). Traditionally, the inspection is carried out on a three-axis CMM where a series of discretized points are firstly sampled on the design surface and then inspected in a point-by-point manner  [1]. Due to this discontinuous and manual nature, the inspection efficiency is extremely low, often taking hours or even days for large-size parts such as a turbine blade. To address this problem, a novel 5-axis inspection technology has been developed recently. Instead of working in the point-by-point manner, the probe of the five-axis inspection machine constantly touches the surface and sweeps on it continuously in the inspection process, thus tremendously reducing the operation time  [2,3]. A 5-axis inspection machine can further improve the efficiency of scan by utilizing the flexibility provided by the two additional rotary axes  [4–6].

The type of 5-axis CMM discussed in this paper is shown in Fig. 1
                     , which has a 2-axis rotary head attached to a traditional 3-axis CMM. The head contains a rotational axis A, which is parallel to the 
                        Z
                      axis of the CMM and has an unlimited range of motion, and another rotational axis 
                        B
                     , which is perpendicular to axis 
                        A
                      and can rotate from 
                        30
                        °
                      above to 
                        100
                        °
                      below the horizon. A probe holding an extreme light stylus is attached to the head. The probe is capable of measuring the deflection of the stylus tip continuously by bouncing a laser through the hollow shaft of the stylus at a mirror close to the tip. The position of the stylus tip can then be calculated from the position of all the five axes. The stylus assembly is able to continuously swivel around the pivot point inside the head where the two rotary axes intersect  [7].

The speed of scanning on a 5-axis CMM is, among other factors, mainly limited by the dynamic performance of the 
                        X
                        Y
                        Z
                      axes. While the servos may have the power to move the machine’s 
                        X
                        Y
                        Z
                      axes at high speed, doing so introduces excessive errors to the inspection result  [8,9]. After researching into the dynamic errors of scanning CMM’s, Pereira and Hocken  [10] suggested that, to achieve high inspection speed, faster servo motors should be used while the weights of various moving components of the machine should be as light as possible. This is exactly the unique kinematic characteristics of the type of 5-axis CMM to be studied in this paper. A process called sweep scanning can efficiently utilize the benefit brought by the two rotational axes for surface inspection  [11]. During a sweep scan, the stylus sweeps from side to side to cover the width of the surface while maintaining constant contact with the surface; meanwhile the rotary head translates to cover the length of the scan. The result is that the trajectory of the head (thus the 
                        X
                        Y
                        Z
                      axes) is much shorter and requires much less acceleration than the trajectory of the stylus tip itself.

Most past research on the subject of surface measurement using CMM has been about the traditional 3-axis CMM inspection, and with a focus point on sample points’ selection  [12]. For example, Obeidat and Raman  [13] and Yu et al.  [14] presented sampling methods to inspect freeform surfaces with discrete touch points. As the 5-axis continuous scanning technology is new, its research is also new, such as  [15–17], and only very recently did a few automatic scanning path planning systems such as Renishaw’s APEXBlade™ become publicly available, and they are all proprietary. While certain intuitive scan path planning methods have been proposed recently, such as the isoparametric line method  [15–17], to the authors’ best knowledge, there have been no public reports on the fundamental problem of how to plan an efficient scan path for an arbitrary freeform surface so that the kinematic characteristics–i.e., the stylus is extreme light while the 
                        X
                        Y
                        Z
                      table is very heavy–can be fully exploited, and this is the motivation behind the work of this paper. Specifically, we present a sweep scan path planning system for an arbitrary freeform surface which will, by fully taking kinematic advantages of the 5-axis CMM, automatically generate a scanning path that is in general far more efficient than those generated by the existing methods such as the isoparametric line method. Preliminary experimental results performed by the authors have convincingly validated our work.

In this section, a brief overview of the path planning system to be developed is given, with the details of each key component of the system to be elaborated in the follow-up sections.

As the initial input to our sweep scan path planning system, it is assumed that the user specifies the necessary input data/parameters based on an understanding of the path generation process. The first step is to divide the CAD (Computer-Aided Design) model of the surface to be measured into patches that can be scanned in a single sweep scan. Then a guide line (an embedded curve) on each patch needs to be determined to “guide” the path generation process for the patch. The user also needs to specify some other parameters such as the length of stylus and the range of stylus contact angle allowed by the CMM. In addition, the sample density as well as the pitch (to be defined later) need also be specified.

With the input provided, the first step of generating a sweep scan path is to determine the trajectory of the rotary head (or simply head) based on the guide line provided by the user. For each (sampled) position of the head, an intersection curve between the surface and a sphere with its center at the head position and radius equal to the length of stylus is calculated. Such an intersection curve will be called a reference line, and the center of the contributing sphere its source point. The next step is to select one and only one point from each reference line (details given later). These points describe the trajectory of the stylus tip. The last step is to check/modify the contact angle between the stylus and the surface—if the angles are within the required range at all the tip positions, the path can be output into a format ready to be used.

If in the last step of the path generation process some stylus contact angles are found to be out of the acceptable range, the path is not viable and must be modified. There are several ways to solve this problem. The simplest solution is to tweak the input parameters such as the length of the stylus if the solution is obvious. Another more plausible solution is to use the iterative adjustment operation described in Section  5 to generate a new head trajectory that would result in a more viable path. The first step of the iterative adjustment is to calculate the reference lines of the sample points on the trajectory of the rotary head. Then, the contact angles of the stylus at all the points contributed by these reference lines are checked. The next step is to determine a new head trajectory to better satisfy the contact angle requirement while keeping the trajectory smooth. These two-steps repeat themselves. If through this process a stable result is found that has all the contact angles within the requirement, the head trajectory will be used to calculate the final viable scan path. If on the other hand the process is unable to obtain a result inside the acceptable range, then either a longer stylus or a finer partition of the original surface is required.

The entire path planning process is outlined in Fig. 2
                        , and in the rest of the paper each component of the process will be described in detail.

The input surface 
                        S
                      to be scanned is assumed to be a mesh—it will be first triangulated if it is originally given as a parametric surface. For the scope of this paper, it is assumed that surface 
                        S
                      can be scanned in a single sweep scan, i.e., the stylus tip will keep in contact with 
                        S
                      during the entire scanning process. If otherwise, the surface has to be divided manually or by other algorithms with the capability and limitation of sweep scanning in mind. As the stylus tip is actually a sphere with a small radius (3 mm in the 5-axis CMM used in our physical experiments), 
                        S
                      will first be offset outward by this radius.

Given the mesh surface 
                        S
                     , a guide line on it needs to be provided by the user to guide the sweep scanning process. This guide line should be relatively smooth and roughly in the middle of the surface. The purpose of the guide line is to give our path generation algorithm a reference to the intended direction of the scan and a way to calculate the progress of the scan. The algorithm will ensure that points on the guide line are scanned in strictly monotone order. A well-chosen guide line can produce a viable scanning path directly. If otherwise, the iterative adjustment is needed to produce a viable path, as to be elaborated later.

Another important input is the length of the stylus, which is defined as the distance between the center of the tip and the center of the rotary head where axis 
                        A
                      and 
                        B
                      intersects. This length needs to be decided based on the availability of the stylus, the size and shape of 
                        S
                     , and the dimensions of the workspace. A longer stylus can scan a wider surface while satisfying the contact angle requirements of the sensor; while a shorter stylus can provide more accurate result and requires less workspace.

The first step of generating a sweep scan path is to determine the trajectory of the head, i.e., 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                        , which defines the center position of the rotary head during the scan and is completely determined by the three translational 
                           X
                           Y
                           Z
                         axes of the CMM.

Owing to the flexibility brought by the additional two rotary axes in the head, there is a wide range for the head trajectory all of which will result in an achievable scan path. One practical solution for getting a head trajectory, as proposed by us, is using a guide line on the surface provided as input. Refer to Fig. 3
                        . The guide line is represented by a sequence of points on the mesh. For each point on the guide line 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                        , a vector defining the desired stylus direction 
                           
                              
                                 V
                              
                              
                                 
                                    stylus
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         for measuring this point during the sweep scan is calculated from the surface normal 
                           
                              
                                 N
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         and the tangent 
                           
                              
                                 T
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         of the guide line at this point. 
                           
                              
                                 V
                              
                              
                                 
                                    stylus
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         is coplanar with 
                           
                              
                                 N
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         and 
                           
                              
                                 T
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         and the angle between 
                           
                              
                                 V
                              
                              
                                 
                                    stylus
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         and 
                           
                              
                                 T
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         is the given preferred contact angle between the stylus and the surface, 
                           
                              
                                 θ
                              
                              
                                 
                                    preferred
                                 
                              
                           
                        . A corresponding point on the head trajectory 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         is then calculated from 
                           
                              
                                 V
                              
                              
                                 
                                    stylus
                                 
                              
                           
                           
                              (
                              i
                              )
                           
                         with the length of stylus 
                           
                              
                                 L
                              
                              
                                 
                                    stylus
                                 
                              
                           
                        . This method ensures that for each head position on the head trajectory, the stylus contacts the corresponding point on the guide line with a preferred contact angle while providing a better chance for the stylus to cover a wider region on the surface within the acceptable contact angle range.

Since the points on the head trajectory are determined by that on the guide line, they are very unlikely to be sufficiently dense or uniformly spaced to produce a scan path with reasonable resolution. Therefore, these original points need to be interpolated so that the final head trajectory curve will be sufficiently smooth, and so do the original points on the guide line. In our implementation, simple Hermite interpolant is adopted. After the interpolation, the 
                           n
                        th point on the head trajectory is defined as the position of the head at time 
                           n
                           ×
                           
                              
                                 T
                              
                              
                                 
                                    step
                                 
                              
                           
                         with 
                           
                              
                                 T
                              
                              
                                 
                                    step
                                 
                              
                           
                         being the time step between any two adjacent points on the trajectory. This way, the head will be assumed to travel at a constant speed along its trajectory and the position of the head during the scan is defined with sufficient resolution.

Refer to Fig. 4
                        . Let 
                           t
                         denote the time starting from the beginning of the scanning. For each point on the head trajectory after interpolation, i.e., 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        , all the possible positions of the stylus tip lie on a sphere with its center at 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and a radius of 
                           
                              
                                 L
                              
                              
                                 
                                    stylus
                                 
                              
                           
                        . An intersection curve 
                           Φ
                           
                              (
                              t
                              )
                           
                         between this sphere and the mesh is calculated, as a list of points. As already defined, 
                           Φ
                           
                              (
                              t
                              )
                           
                         is called a reference line. In some special cases, the intersection could be multiple curves or even a closed loop. To handle these exceptions, the intersection result is checked to keep only the portion of curve within reasonable distance from 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        , i.e., the corresponding point to 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         on the guide line. Since 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         should roughly be at the center of the guide line as shown in Fig. 4, removing any point that is too far from 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         will limit the swing of stylus to a reasonable range and eliminate most cases of exceptions.

As the corresponding point on the guide line 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         is on the surface, the distance between 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         is 
                           
                              
                                 L
                              
                              
                                 
                                    stylus
                                 
                              
                           
                        , and thus 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         should also be on the reference line 
                           Φ
                           
                              (
                              t
                              )
                           
                        , albeit the numerical error due to the interpolation. The phase of swing of the stylus at time 
                           t
                         is determined by 
                           
                              
                                 L
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        , the length of the guide line from the starting point 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              0
                              )
                           
                         to 
                           
                              
                                 P
                              
                              
                                 
                                    guid
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        . A ratio is calculated by the following equation: 
                           
                              (1)
                              
                                 r
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 0.5
                                 +
                                 0.5
                                 ×
                                 
                                    sin
                                 
                                 
                                    (
                                    π
                                    ×
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   guide
                                                
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             Pitch
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         where pitch is the user-specified curve length between any two adjacent scanned points on the guide line, i.e., it is the period of the sinusoidal trajectory of the stylus tip, as shown in Fig. 5
                        . The stylus tip 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         lies on the reference line 
                           Φ
                           
                              (
                              t
                              )
                           
                         and divides it into two segments respectively with ratios 
                           r
                           
                              (
                              t
                              )
                           
                         and 
                           1
                           −
                           r
                           
                              (
                              t
                              )
                           
                         of the total length 
                           
                              
                                 L
                              
                              
                                 
                                    intersection
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         (see Fig. 6
                        ).

To check the viability of a scan path, first, the surface normal 
                           
                              
                                 
                                    
                                       N
                                    
                                    →
                                 
                              
                              
                                 
                                    mesh
                                 
                              
                           
                         at each tip position 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         is calculated from the surface (by averaging the normals of the 1-ring of 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        ). The orientation of the stylus 
                           
                              
                                 
                                    
                                       V
                                    
                                    →
                                 
                              
                              
                                 
                                    stylus
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         can be calculated from 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                           –
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        . The angle at which the stylus contacts the surface is 
                           θ
                           
                              (
                              t
                              )
                           
                           =
                           90
                           °
                           −
                           
                              
                                 cos
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          N
                                       
                                       →
                                    
                                 
                                 
                                    
                                       mesh
                                    
                                 
                              
                              ⋅
                              
                                 
                                    
                                       
                                          V
                                       
                                       →
                                    
                                 
                                 
                                    
                                       stylus
                                    
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                        . For a scan path to be viable the contact angle 
                           θ
                         must be within the specified angle range lest the stylus will either interfere with the surface or not be able to produce accurate measurement data.

In addition, the stylus and head need to be checked for collision against the workpiece. To achieve this, in our system the stylus and head are modeled as two cylinders and checked against the complete mesh of the workpiece for intersection.

If the viability check shows that the path generated is not viable, the user could either manually change the input parameters such as the guide line or preferred contact angle, or reply on the system-provided iterative adjustment procedure to automatically produce an alternative head trajectory that will result in a viable scan path. Since the head trajectory is what directly determines the positions of reference lines and hence the viability of the scan path, the algorithm will attempt to change the head trajectory so that all the contact angles during the sweep scan fall inside a specified angle range 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 
                                    min
                                 
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 
                                    max
                                 
                              
                           
                           )
                        
                     . The guide line will remain unchanged and the one to one correspondence of points on the guide line and head trajectory will be preserved to ensure that points on the guide line are still scanned in strictly monotone order. Otherwise, the algorithm may cause the new path to skip part of the surface.

The first step of searching for a better head trajectory is to evaluate the problem of the current one. Towards this task, a set of points on the guide line is used as reference. The interval between these points is roughly equal to the pitch of the intended scan path. From the corresponding points on the head trajectory, a set 
                           Ω
                         of reference lines is calculated.

To evaluate the head trajectory, for each tip point 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         on the tip trajectory corresponding to each reference line in 
                           Ω
                        , whose associated orientation of the stylus is along the direction from 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         to 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        , the stylus contact angle is calculated and checked against the specified range (
                           
                              
                                 θ
                              
                              
                                 
                                    min
                                 
                              
                           
                        , 
                           
                              
                                 θ
                              
                              
                                 
                                    max
                                 
                              
                           
                        ). Adjustment of the head trajectory then will be made if this angle is found to be out of the range, as follows.

Let 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         be the point corresponding to the reference line in 
                           Ω
                         that violates the range 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              )
                           
                         the most. Its corresponding point 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         on the head trajectory is modified so that the new stylus contact angle at 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         will be pulled inside the range 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              )
                           
                        . Specifically, referring to Fig. 7
                        , the head position 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         is rotated around point 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         in the plane spanned by the surface normal at 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and the line through 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         to a new position 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              t
                              )
                           
                        . This new position is still at a distance of 
                           
                              
                                 L
                              
                              
                                 
                                    stylus
                                 
                              
                           
                         from point 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and forms a contact angle of either 
                           
                              
                                 θ
                              
                              
                                 
                                    max
                                 
                              
                           
                         or 
                           
                              
                                 θ
                              
                              
                                 
                                    min
                                 
                              
                           
                         (depending on from which side did the original contact angle violate the range). This means that if the head position were moved to 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              t
                              )
                           
                        , the contact angle at 
                           
                              
                                 P
                              
                              
                                 
                                    tip
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         would satisfy the range requirement.

Unfortunately, doing so almost certainly would violate the one-to-one correspondence between the head trajectory and the guide line: the distance between the original 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and the new head position 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              t
                              )
                           
                         is no longer 
                           
                              
                                 L
                              
                              
                                 
                                    stylus
                                 
                              
                           
                        . To resolve this problem, in the plane defined by the three points 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        , 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              t
                              )
                           
                        , the displacement 
                           
                              
                                 
                                    
                                       V
                                    
                                    →
                                 
                              
                              
                                 
                                    displacement
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                           =
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              t
                              )
                           
                           −
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                         is rotated slightly until it produces a new head position 
                           
                              
                                 P
                              
                              
                                 
                                    head
                                 
                              
                              
                                 ″
                              
                           
                           
                              (
                              t
                              )
                           
                         that is at a distance of 
                           
                              
                                 L
                              
                              
                                 
                                    stylus
                                 
                              
                           
                         to 
                           
                              
                                 P
                              
                              
                                 
                                    guide
                                 
                              
                           
                           
                              (
                              t
                              )
                           
                        .

The amendment operation just prescribed above inevitably would cause the new head trajectory to become jagged and hence a smoothing operation is needed. The head positions are smoothed with a local regression using weighted linear least squares and a first degree polynomial model. Similar to the last step, to maintain the one-to-one relationship between the guide curve and the head trajectory, the smoothing is done along the stylus direction of each point on the guide line and a smoothed head trajectory is calculated from the stylus directions and the guide line. The displacement due to smoothing is limited to be less than the displacement created by the last step if the contact angle were to have an error of exactly 
                           
                              
                                 θ
                              
                              
                                 
                                    tolerance
                                 
                              
                           
                        . This way, if the error is larger than 
                           
                              
                                 θ
                              
                              
                                 
                                    tolerance
                                 
                              
                           
                        , the displacement created by the smoothing process will always be smaller than that due to the correction of the contact angle. This ensures that the smoothing process do not cause the contact angle to move more than 
                           
                              
                                 θ
                              
                              
                                 
                                    tolerance
                                 
                              
                           
                         outside the acceptable range.

After a new head trajectory is calculated, the whole process repeats itself. The maximum of the out-of-range errors of contact angles after each iteration is recorded. If it is decreasing, the process is repeated. If the maximal error reaches a stable value below 
                           
                              
                                 θ
                              
                              
                                 
                                    tolerance
                                 
                              
                           
                        , the head trajectory is determined to be acceptable and can be used to generate its corresponding stylus tip trajectory. If the error eventually increases or is stable but larger than 
                           
                              
                                 θ
                              
                              
                                 
                                    tolerance
                                 
                              
                           
                        , or a specified number of iterations have passed, the process is considered to be unable to find a solution and a manual adjustment of input is required. For example, the surface could be further divided into smaller patches.

A prototype of the presented sweep scan path generation algorithm has been implemented by us in MATLAB. To demonstrate how it works, a mesh model of a sweep surface is used with a stylus length of 250 mm and a preferred stylus contact angle of 
                        36
                        °
                      for head trajectory generation. The guide line is exactly the geodesic medial axis of the surface  [18].


                     Fig. 8
                      shows the guide line and the generated head path, Fig. 9
                      displays a zoomed region on the surface with the generated reference lines and the stylus tip trajectory. In this example, the pitch is about 20 times the sampling distance on the guide line (also the head trajectory). Close inspection found that adjacent reference lines intersect each other in some areas due to high curvature of the guide line and head path, as shown in the enlarged area. If the calculated tip path were to pass through such area, a loop in the tip path might be produced (but not necessarily). This, however, does not require special attention as keeping the loop will preserve the kinematic relationship between the axes and do not hinder smooth operation of the machine or reduce data density.


                     Fig. 10
                      depicts the final sweep scan path (the stylus tip trajectory + the head trajectory) in its entirety. An examination of the final sweep scan path shows that the stylus contact angle is within the acceptable range throughout the path and there is no collision between the stylus and the surface.

To demonstrate the iterative adjustment process, still using the same input surface, this time the guide line is purposely altered to deviate from the medial axis. The corresponding initial sweep scan path is found to violate the contact angle requirement at various places, as indicated by the red color in Fig. 11
                     . This initial head trajectory also contains sharp corners which will induce large acceleration on the 
                        X
                        Y
                        Z
                      axes. The iterative adjustment of the head trajectory is then initiated, with 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 
                                    min
                                 
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 
                                    max
                                 
                              
                           
                           )
                        
                        =
                        
                           (
                           15
                           °
                           ,
                           40
                           °
                           )
                        
                      and 
                        
                           
                              θ
                           
                           
                              
                                 tolerance
                              
                           
                        
                      set to 
                        10
                        °
                     . Fig. 12
                      shows the progressive evaluation of the head trajectory after each iteration and the process is terminated after the 7th with a maximum error of 
                        6.0
                        °
                     , below the specified tolerance. Fig. 13
                      displays the final sweep scan path after the final smoothing operation. The path calculated has a stylus contact angle range of 
                        10.3
                        °
                        –
                        38.3
                        °
                     , which is well within the acceptable range. The head trajectory is also smooth without any sharp corners.

@&#EXPERIMENTS@&#

To validate the proposed sweep scan path planning algorithm, three sets of comparison experiments are carried out on different surfaces. The specific 5-axis inspection machine used in our physical inspection experiments comprises a 3-axis COORD3 UNIVERSAL 15.9.8 CMM, together with a Renishaw Revo®  rotary head providing two high-speed rotary axes 
                        A
                      and 
                        B
                     , as shown in Fig. 14
                     .

In each set of experiment, our sweep scan path is compared to a control group. The control groups scan surfaces with some simple zigzag patterns, i.e., isoparametric lines, that rely on three-axis moves as much as possible and only adjust the stylus direction slightly when necessary in order to keep the stylus contact angle within the acceptable range. The CMM server is set up to report the tip position and rotary head angle every 0.1 s. This data is stored and processed to calculate the position of each axis during the scan.

The first group of experiments are performed on a generalized swept surface with gradually changing cross sections, as shown in Fig. 15
                        (a). The guide line is generated by tracing the middle point of the (changing) profile curve. A 250 mm long stylus with a 6 mm diameter tip sphere is used for both sweep scanning and the benchmarking zigzag scanning. The 5-axis inspection machine is set to scan with a maximum tip speed of 50 mm/s and a maximum tip acceleration of 
                           1000
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        , although the motion controller will automatically reduce the speed, if deemed necessary, to keep the stylus tip in contact with the surface.


                        Fig. 15(b) and (c) display respectively the generated tip trajectories by the benchmarking zigzag method and our sweep scan method. Both paths have a pitch of 8 mm and cover the surface with similar density. The sweep scan path is slightly longer due to its curved shape.


                        Fig. 16
                         shows the entire scanning paths by the two methods, i.e., both the tip path and its corresponding rotary head path. As clearly seen from the figure, although the tip path by our sweep scan method is slightly longer than that by the benchmarking method, the distance that the head travels during the entire scan is significantly shorter than that by the benchmarking method.

Plotting the position of individual axis against time reveals more details. Take the 
                           X
                         axis for example (Fig. 17
                        ): the periodic and jagged movement of the 
                           X
                         axis during the zigzag scanning is clearly shown, while the proposed sweep scanning method generates a very smooth motion curve without any corners. The plots for the 
                           Y
                         and 
                           Z
                         axis reveal similar results, as shown in Fig. 18
                        .


                        Fig. 19
                         plots the angle graph of the 
                           B
                         axis during the scan. It clearly shows how the sweep scanning path utilized this rotary axis to cover the width of the surface while the zigzag scan path only rotates the stylus slightly to adjust the contact angle between the stylus and the surface.

By differentiating and double differentiating the position graph of an axis, its speed and acceleration can be obtained. Figs. 20 and 21
                        
                         show respectively the speed and acceleration of the 
                           X
                         axis during the scans. Due to noise in the data, there are a few sharp spikes that should be ignored. The two figures undoubtedly show the difference between the proposed sweep scan method and the benchmarking zigzag method: with the zigzag method, in order to follow the zigzag tip path, repeatedly the 
                           X
                         axis needs to accelerate to high speed and then decelerate quickly to reverse its direction; on the other hand, owing to the smoothness of its head trajectory (see Fig. 17), our sweep scan path induces very low speed (as well as the acceleration) of the 
                           X
                         axis during the entire scan. It is worth explaining that the slight periodic oscillation in the speed of the 
                           X
                        -axis (and other two linear axes) during the sweep scan is most likely either due to the noise or due to the on-the-fly adjustment by the CMM’s motion controller that automatically reduces the scanning speed (the tip speed) in order to keep the stylus in contact with the surface.

To quantitatively evaluate the differences between the two scanning paths, the maximum speed and acceleration of each axis are calculated as they will be the limiting factors in scanning efficiency or accuracy, as listed in Tables 1 and 2
                        
                        . For translational axes, the control group reaches a maximum speed of 130.73 mm/s and a maximum acceleration of 
                           1021
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        , while the sweep scanning only generates a maximum speed of 27.92 mm/s and a maximum acceleration of 
                           207
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        . Taking the 
                           X
                         axis as an example, suppose its speed limit is 30 mm/s and it is the bottleneck. This literally means, if the zigzag scan path is to be adopted, in order to satisfy this speed limit, the tip speed (the scanning federate) has to slow down from the current 50 mm/s to less than 12 mm/s, while the proposed sweep scan path can still maintain the original 50 mm/s tip speed. (Note that the speed of any linear axis is linearly proportional to the speed of the stylus tip.) Or, put it another way around, the sweep scan path will achieve a 420% increase in inspection efficiency over the benchmarking zigzag method. It is also worth mentioning that the increase of the maximum angular speed or acceleration (if any) on the 
                           A
                         or 
                           B
                         axis by the sweep scan path posts no issues at all, owing exactly to the superb kinematic advantages of these two rotary axes—for instance, our Renishaw Revo®  head allows a 
                           225
                           °
                           /
                           
                              s
                           
                         limit on the angular speed of 
                           A
                         or 
                           B
                         axis, while the maximum speeds of 
                           A
                         and 
                           B
                         axis by the sweep scan path in Table 1 are only 
                           12.25
                           °
                           /
                           
                              s
                           
                        , and 
                           23.29
                           °
                           /
                           
                              s
                           
                         respectively.

The second test is performed on a symmetric compound surface that is formed by a cone, a sphere and a cylinder, as shown in Fig. 22
                        . The guide line is the intersection curve between the surface and its mirror plane 
                           x
                           =
                           660
                           
                           
                              mm
                           
                        . A 350 mm stylus with a 6 mm diameter tip sphere is used for both sweep scanning and zigzag scanning. This time, the CMM is set to scan very slowly with a tip speed of 10 mm/s and a tip acceleration of 
                           50
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                         so to increase the data point density and ensure that all the axes do not exceed their speed or acceleration limits during the test. The generated tip paths by the two methods are displayed in Fig. 23
                        .

Position graphs of the three translational axes (Fig. 24
                        ) evidently indicate how the 
                           X
                         axis in the sweep scan path remains stationary at 
                           x
                           =
                           660
                           
                           
                              mm
                           
                         and the 
                           Y
                           Z
                         axes smoothly and gradually move so to realize the head trajectory. On the contrary, the zigzag scan path dictates the 
                           X
                         axis to severely oscillate around 
                           x
                           =
                           660
                         while the 
                           Y
                         and 
                           Z
                         axis also show large-magnitude periodic fluctuations (with the period equal to the pitch). Again, the detrimental effect of these oscillations is best demonstrated by the speed and acceleration graphs, which show that the maximum 
                           X
                           Y
                           Z
                         speeds as required by the zigzag path are 5–10 times that by the sweep scan path (Fig. 25
                        ) and the situation is even worse when the acceleration/deceleration is considered (Fig. 26
                        ), as also confirmed by the specific data listed in Tables 3 and 4
                        
                        .

The third test group is a practical example of scanning CMM application. An airfoil model is divided into seven patches as shown in Fig. 27
                        . Fig. 28
                         shows the sweep scanning path planned for each patch.

Patch #0, which is the trailing edge, is scanned with both the proposed sweep scanning method and the zigzag scanning method for comparison. A 250 mm long stylus with a 6 mm diameter tip sphere is used. The CMM is set with a tip speed of 100 mm/s and a tip acceleration of 
                           300
                           
                           
                              mm
                           
                           /
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                        . Fig. 29
                         displays the guide line and the two tip paths by the two methods, while Figs. 30–32
                        
                        
                         plot the positions, speeds, and accelerations of the 
                           X
                           Y
                           Z
                         axes in the entire scan by the two methods. Perceptibly, this time the total scan time by the zigzag scan path is much longer than that by the sweep scan path, even though the two tip paths have similar length. The only plausible explanation for this is that, exactly because the zigzag scan path would demand too high acceleration or speed on the 
                           X
                           Y
                           Z
                         axes, the CMM’s motion controller has to reduce the tip federate from the original 100 mm/s in order to pull the acceleration or speed below the limits (see Tables 5 and 6
                        
                        ).

Among all the three experiments, compared to the benchmarking zigzag scan method, the proposed sweep scan path planning algorithm is able to reduce the maximum translational speed up to 82% and the maximum translational acceleration up to 87%. This means that, since the bottleneck to scanning speed is the speed of the translational 
                           X
                           Y
                           Z
                         axes of the CMM, the proposed sweep scan path can potentially increase the scanning efficient up to five times when compared to the benchmarking zigzag scan path.

@&#CONCLUSIONS@&#

This paper presents a new method to automatically generate a sweep scan path for performing continuous scanning inspection of an arbitrary free-form surface on a new type of 5-axis CMM. The proposed method fully utilizes the superb kinematic advantages of this new type of 5-axis CMM (i.e., the two rotary axes have extremely low moment of inertia) and is able to generate a sweep scan path that, as validated by the ample experiments performed by us, is in general far more efficient than a one by the existing methods such as the isoparametric method. While there are, though very few, commercially available software systems (such as the APEXBlade™ software by Renishaw) that offer sweep scan path planning function, they are all proprietary and only apply to certain strict types of geometry, e.g., a blade in the case of APEXBlade™, whereas the proposed sweep scan path planning method, at least in theory, supports surfaces of arbitrary shapes.

On the deficiency of the proposed method, although it can generate a viable sweep scan path automatically, significant user involvement is still required, most notably the need to partition the surface into patches that are suitable for the method. Another major limitation is that the quality of the generated sweep scan path crucially depends on the guide line which currently is provided by the user instead of being automatically determined by the system.

Future work will be along the line of how to alleviate the dependency on user’s involvement, especially the development of algorithms for automatically partitioning the surface and intelligently determining a good guide line for better collision avoidance and better overall quality of the sweep scan path. Finally and not the least, while the primary objective of the proposed path planning method is to significantly reduce the speed and acceleration loading on the 
                        X
                        Y
                        Z
                      axes of the CMM, which indeed are always the bottleneck to scanning efficiency, it will still be interesting to study how the length of the head trajectory will affect the scanning efficiency and how to minimize it.

@&#REFERENCES@&#

