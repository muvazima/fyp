@&#MAIN-TITLE@&#A coarse-to-fine IP-driven registration for pose estimation from single ultrasound image

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a method for pose estimation from single ultrasound image.


                        
                        
                           
                           We propose a 3D registration method using implicit polynomial (IP) model.


                        
                        
                           
                           We improve the robustness, accuracy and computational efficiency for registration by a coarse-to-fine process with multiple IPs from low degree to high degree.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ultrasound (US) image

Pose estimation

3D image registration

Implicit polynomial

@&#ABSTRACT@&#


               
               
                  A fast registration making use of implicit polynomial (IP) models is helpful for the real-time pose estimation from single clinical free-hand Ultrasound (US) image, because it is superior in the areas such as robustness against image noise, fast registration without enquiring correspondences, and fast IP coefficient transformation. However it might lead to the lack of accuracy or failure registration.
                  In this paper, we present a novel registration method based on a coarse-to-fine IP representation. The approach starts from a high-speed and reliable registration with a coarse (of low degree) IP model and stops when the desired accuracy is achieved by a fine (of high degree) IP model. Over the previous IP-to-point based methods our contributions are: (i) keeping the efficiency without requiring pair-wised correspondences, (ii) enhancing the robustness, and (iii) improving the accuracy. The experimental result demonstrates the good performance of our registration method and its capabilities of overcoming the limitations of unconstrained freehand ultrasound data, resulting in fast, robust and accurate registration.
               
            

@&#INTRODUCTION@&#

@&#MOTIVATION@&#

To support medical diagnosis, various imaging modalities, such as computed tomography (CT) scan, MRI, PET, and ultrasound (US), are widely used in clinics. Among these modalities, US has beneficial characteristics such as free-hand manner, non-invasiveness, compactness, low cost, and synchronization of operations and imaging. Thus US is attractive for assistance with surgical operations and real-time diagnosis of problems with the circulatory system, abdomen, breast, prostate gland, etc.

However, US images are notorious for the poor image quality, due to speckle noises, low signal-to-noise ratio, occlusions, and uniform brightness. And field of view (FOV) in US imaging is very limited; in severe cases, only 2D cross-sectional images are obtained. These aspects confuse the doctors in making right decisions for diagnosis.

In order to solve these issues, some recent literature advocates the fusion-of-modality techniques. For example, before the surgical operation, 3D models of target parts are obtained by rich but time-consuming modalities such as CT, MRI, and PET. By superimposing US images obtained during the operation on these 3D models, the result will provide rich information to help a doctor’s diagnosis. To achieve this, the key for superimposing is to estimate the pose of US images related to the images derived from other modalities.

@&#RELATED WORK@&#

The pose estimation can be viewed as a registration problem for two models: a source model (preoperative 3D model) and a target model (2D/3D US image). To do this, a class of methods such as [1,2] bind the optical position sensors to a US probe, and measure the relative US position to 3D models; For enhancing robustness, the methods in [3–5] combine the information from position sensors and image features.

Without position sensors, Penney et al. [6] propose to register the surface points manually selected from US images to a preoperative 3D shape model by MRI segmentation; similarly, Amin et al. [7] register the bone boundaries in US images to a shape model segmented from CT image by a modified ICP method; Lange et al. [8] take advantage of 3D-Power Doppler to extract vessel shapes from intraoperative 3D US and register with preoperative models in liver surgery; to enhance the robustness, mutual information is advocated as measuring image similarities, such as [9,10]; Wein et al. [11] achieve the CT-ultrasound registration by simulating the US image sequence from CT image, and using a new similarity metric: linear correlation of linear combination; other methods such as [12,13,10] estimate the relative positions according to the image features or intensity and gradient information of US images and preoperative 3D models. Although each of the methods has its effectiveness, they suffer from expensive computation caused either by the intensity-based similarity calculation or point-to-point ICP-based registration and thus they are difficult to work in real time.

Regardless of the data type, the registration problem is solved basically by three families of methods: (i) ICP-based methods: the iterative closest point method (ICP) first proposed by Besl and McKay [14] or its accelerated variations such as [15] for 3D range data, (ii) point-model methods: e.g., Fitzgibbon [16] encodes the Euclidean distance field by fast distance transformation and employs the robust estimation to remove the outliers; Huang et al. [17] proposed new similarity measurement using information theory to achieve the robust non-rigid registration; and iii) the approach relying on algebraic/geometric invariant features, e.g., moment features is described in [18], and IP global features are proposed by Taubin et al. [19,20]. The first family of methods can achieve fine registration, but requires time-consuming computation of point-to-point/surface correspondences; The second family of methods can achieve the registration efficiently but needs huge memory, especially in dense 3D cases, to preserve the distance field; and the third family of methods can achieve fast registration, but cannot deal with registration in the case of partially overlapping the target objects [18].

In our previous work [21,22], we propose to approximate the Euclidean distance with the algebraic formulation using implicit polynomials (IPs) and speed up the registration. The advantages of this method over the prior methods are that: i) unlike the ICP-based methods, it avoids the extra computation for point-wise correspondences; ii) unlike the point-model method of preserving a discrete distance field, it needs very little memory space for preserving a few IP coefficients, and the algebraic model can generate an infinite distance field to support registration in a wider space; iii) unlike the coarse registration methods, it supports partial-overlapped registration. A recent work proposed by Rouhani and Sappa [23] improves the optimization by Levenberg–Marquardt algorithm which leads to a faster convergence. These methods adopt a single IP based registration which remains an essential issue: a moderate IP model is really difficult to generate and thus to be obstacle to an accurate and robust registration.

The previous studies in [24,25] pointed out two issues frustrating the IP fitting: i) An IP of low degree loses local accuracy for object representation, whereas ii) an IP of high degree might be globally unstable (the undesired surfaces appear in the fitting result). However the former may lead to the lack of accuracy for registration, but the latter may lead to a failure registration. Fig. 1
                         shows an example when an IP (gray surface) is registered to scattered points (blue points). While Fig. 1 (a) shows the registration result losing much accuracy due to coarse IP of low degree, Fig. 1 (b) shows failure registration due to the global instability problem of IP fitting with high degree.

Our method inherits IP’s merits: neither time-consuming process of correspondence searching nor huge memory for storing the discrete distance field is required. In addition, over the previous methods in [21–23] that use single IP for registration, we propose a coarse-to-fine IP registration. As illustrated in Fig. 2
                         leftmost, it starts from a low degree IP (ellipsoid) to achieve a robust initial guess. Second, after a rough registration covered by the IPs of low degree, the higher degree IPs can drive to a more accurate position, even if the IP is not stably modeled (extra zero sets appear around the desired zero set), as shown in Fig. 2 rightmost. Our method improves the robustness and accuracy. The robustness is guaranteed by the coarse estimation with an IP of low degree, whereas the high accuracy can be achieved by an IP of high degree given the appropriate initial guess.

Compared to the global IP matching methods, such as [19,20], our method overcomes the partially overlapped problem. Such merits make it possible to be applied for the registration between a 3D shape and a 2D US image plane. We adopt boundary information which is independent of the types of modalities. As illustrated in Fig. 3
                         (a), our method supposes the 3D model has been obtained in an advance which is desired to registered with the online ultrasound image shown in Fig. 3 (b). In an online process, e.g., during a surgical operation, it fast aligns a 3D IP models to a 2D US image, as the coarse-to-fine approach shown in Fig. 4
                        . Then the desired relative pose information between 3D model and the 2D US image (associated with the probe position information of ultrasound device) is obtained.

This paper is organized as follows: Section 2 introduces the mathematics of IP modeling and its properties; In Section 3, we present the registration technique using IP, formulated in both a general case and a US image case, and based on coarse-to-fine approach; Section 4 reports experimental results followed by conclusion in Sections 5. In addition, we present our symbolic computational transformation of IP in Appendix A.

We adopt implicit polynomials for modeling the preoperative 3D images captured by a modality such as MRI, CT-SCAN, or 3D US, supposing that the 3D boundary has been obtained from the segmentation result of the captured volume images.

Suppose model 
                           
                              M
                           
                         obtained from 3D boundary data represents a closed surface, and by contracting and expending it defines two 3D layers (see [26]): the inner layer Γ
                        − and outer layer Γ
                        +. Then the model is represented by its distance transform:
                           
                              (1)
                              
                                 Φ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   x
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                
                                                   +
                                                   d
                                                   (
                                                   x
                                                   ,
                                                   M
                                                   )
                                                   ,
                                                
                                                
                                                   x
                                                   ∈
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   -
                                                   d
                                                   (
                                                   x
                                                   ,
                                                   M
                                                   )
                                                   ,
                                                
                                                
                                                   x
                                                   ∈
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where x
                        = (x
                        
                        y
                        
                        z) is the location of one data point in Cartesian coordinates, and 
                           
                              d
                              (
                              x
                              ,
                              M
                              )
                              =
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ∈
                                    M
                                 
                              
                              ‖
                              x
                              -
                              
                                 
                                    x
                                 
                                 
                                    M
                                 
                              
                              ‖
                           
                         is the Euclidean distance from x to the model consisting of the points 
                           
                              
                                 
                                    x
                                 
                                 
                                    M
                                 
                              
                           
                        . We approximate Φ with an implicit polynomial (IP) as:
                           
                              (2)
                              
                                 Φ
                                 ≈
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          0
                                          ⩽
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ;
                                          i
                                          +
                                          j
                                          +
                                          k
                                          ⩽
                                          n
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ijk
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         
                                                         x
                                                         
                                                         …
                                                         
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         ︸
                                                      
                                                   
                                                
                                                
                                                   m
                                                   
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  000
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  100
                                                               
                                                            
                                                            
                                                            …
                                                            
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  00
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            ︸
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where n is the degree of an IP, and the IP can be represented as an inner product between the monomial vector and the coefficient vector as: m
                        T
                        a. The indices {i,
                        j,
                        k} are sorted by the inverse lexicographical order (see Table 1
                         in [27]). This problem can be viewed as the linear least-squares problem solved by 3L method [26].

IP representation has several good properties such as robust against noise, easy calculation for partial derivatives and easy transformation, but also has bad properties such as global unstable fitting. These properties are described in the followings:

The previous studies, such as [24,28], pointed that IP fitting is robust against noise, missing data and occlusions, and in [25] there shows an example that IP representation does not vary largely when adding noise to the data set to some extent. Note this property is best matched to the modeling for medical images, since many images captured by the modalities, such as ultrasound device, are often with poor image quality due to speckle noises, low signal-to-noise ratio and occlusions.

Given an IP, its partial derivatives can be simply calculated by a symbolical transformation. For example, if an IP of n-degree is associated with coefficient vector a
                           ={a
                           
                              ijk
                           }, then its first partial derivative of y, 
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                              
                           , is an IP of (n
                           −1)-degree and can be calculated as 
                              
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       a
                                    
                                    
                                       ijk
                                    
                                    
                                       ′
                                    
                                 
                                 }
                              
                           , where
                              
                                 (3)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          ,
                                          j
                                          -
                                          1
                                          ,
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ja
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            k
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      j
                                                      ⩾
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Fig. 5
                           (a) illustrates the gradients 
                              
                                 ▽
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   y
                                                
                                             
                                             ,
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           , where each entry is the first order derivatives.

An IP model f(x)=
                           m(x)T
                           a can be easily transformed by rotation or/and translation, as it is a matrix–vector multiplication operation on the coefficients as:
                              
                                 (4)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    V
                                    (
                                    p
                                    )
                                    a
                                    ,
                                 
                              
                           where V is a function mapping 3D transformation parameters 
                              
                                 p
                                 =
                                 (
                                 t
                                 ,
                                 R
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              
                            ×SO (3) to a square matrix with same dimension to coefficient vector a. To our knowledge, although prior literature, such as [20], have proved the existence of matrix V, the computational implementation is not explicitly described. Tarel et al. [19] proposed a tensor-based transformation for IP, but it still suffers from heavy computational cost. Therefore, let us present our symbolic computational in A based on Taubin and Cooper’s theory [20].

No matter how robust against noise, IP still suffers from the representation problem on global instability [24,25], when fitting with high degree IP to the object. The example shown in Fig. 5(b) and (c) implies that high degree IP is locally accurate but globally unstable, which might lead to a failure registration.

In this section, before we present our coarse-to-fine registration method, let us first consider the case driven by single IP model. The objective of IP-driven registration is to find a transformation that makes the IP zero set to be “best” matched with the given data set. It can be formulated as an energy minimization problem in a general case or US image case as introduced in Section 3.2. To this end, the moderate measurement for the distance between data set and IP is required first.

We define function d(x
                           i
                        ,
                        f
                        
                           n
                        ) for measuring the algebraic distance between a discrete point x
                           i
                         and an IP model f
                        
                           n
                         as:
                           
                              (5)
                              
                                 d
                                 (
                                 x
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                    
                                       ‖
                                       ▽
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       )
                                       ‖
                                    
                                 
                                 ,
                                 ∀
                                 x
                                 ∈
                                 Ω
                                 ,
                              
                           
                        The magnitude of this algebraic distance d has been proved to close Euclidean distance in [29]), but note that d is a kind of signed distance since if x in the inner region of IP, then d
                        <0. Fig. 6
                        (a)–(c) illustrate the difference of three distance fields generated by Euclidean distance, Eqs. (2) and (5).

We define the gradient vector with length of distance 
                           
                              G
                              :
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         as
                           
                              (6)
                              
                                 G
                                 (
                                 x
                                 )
                                 =
                                 d
                                 (
                                 x
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 
                                    
                                       ▽
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                    
                                       ‖
                                       ▽
                                       
                                          
                                             f
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       )
                                       ‖
                                    
                                 
                                 ,
                                 ∀
                                 x
                                 ∈
                                 Ω
                                 .
                              
                           
                        This can be viewed as a resized version of the original gradient vectors with distance d(x). Fig. 6(d) illustrates the gradient field for example.

Given the definition of a distance between a certain data set and an IP, the next problem is how to predict the transformation for the IP that can minimize distance to the data set.

In our method, the minimization is done through the following two steps: for accelerating the convergence, first, it minimizes the function without any constraint in the transformation. This means every point can move freely during the first minimization. Next, it determines the transformation parameters to better describe the first minimization result. These two steps are repeated until convergence.

Let us describe the registration between an IP and a partial object, in a general case and a US image case.

In general case, registration can be simply formulated to minimize the energy functional of the integration of distances as follows:
                              
                                 (7)
                                 
                                    E
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    d
                                    Ω
                                    ,
                                 
                              
                           where Ω represents the partial surface of an object, and x∈
                           Ω. Then, by calculus of variations [30], the Gateaux derivative (first variation) of the functional E to point x can be approximately formulated as
                              
                                 (8)
                                 
                                    
                                       
                                          ∂
                                          E
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    ≈
                                    2
                                    G
                                    (
                                    x
                                    )
                                    ,
                                 
                              
                           if we consider ▽f
                           
                              n
                            as a constant value for computational convenience.

Therefore, we need to minimize this functional to satisfy the Euler–Lagrange equation 
                              
                                 
                                    
                                       ∂
                                       E
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 =
                                 0
                              
                           . Thus the steepest descent process is executed in the following gradient flow for each point x:
                              
                                 (9)
                                 
                                    
                                       
                                          ∂
                                          x
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    -
                                    2
                                    G
                                    (
                                    x
                                    )
                                    .
                                 
                              
                           
                        

For the task of pose estimation of the US probe, the US images from the 2D probe that image the organ slice boundaries are usually expected to be matched with the corresponding planar intersection of the 3D model.

Furthermore, US images are heavily noise-contaminated. Since precise extraction of the organ’s boundary is therefore very difficult, maybe impossible, simple boundary-based registration described in the general case is not sufficient for US images. But fortunately, the organ’s inside region is clearly seen in US images as shown in Fig. 3(b). These two points are key for improving the general method for US images.

For solving the first point, we use a Gaussian smoothed edge indicator defined by [31]. Let I(x) be a 2D US image function in 3D space, and pixel position 
                              
                                 x
                                 (
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            be in the 3D plane Ω. Let g(x) be the indicator defined as follows:
                              
                                 (10)
                                 
                                    g
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                (
                                                1
                                                +
                                                |
                                                ▽
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      σ
                                                   
                                                
                                                ∗
                                                I
                                                |
                                                /
                                                k
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where G
                           
                              σ
                            is a Gaussian filter with standard deviation σ, and ∗ denotes convolution.

For making use of the second point, we compose the energy function with combining a boundary constraint 
                              
                                 L
                                 (
                                 x
                                 )
                              
                           and an inside constraint 
                              
                                 A
                                 (
                                 x
                                 )
                              
                           , such as
                              
                                 (11)
                                 
                                    E
                                    (
                                    x
                                    )
                                    =
                                    α
                                    L
                                    (
                                    x
                                    )
                                    -
                                    β
                                    A
                                    (
                                    x
                                    )
                                    ,
                                 
                              
                           where α and β are constants, and the terms 
                              
                                 L
                                 (
                                 x
                                 )
                              
                            and 
                              
                                 A
                                 (
                                 x
                                 )
                              
                            are defined by
                              
                                 (12)
                                 
                                    L
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    δ
                                    (
                                    d
                                    (
                                    x
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ·
                                    g
                                    (
                                    x
                                    )
                                    )
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    d
                                    Ω
                                    ,
                                 
                              
                           and
                              
                                 (13)
                                 
                                    A
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    H
                                    (
                                    -
                                    d
                                    (
                                    x
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ·
                                    g
                                    (
                                    x
                                    )
                                    )
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    d
                                    Ω
                                    ,
                                 
                              
                           respectively; Ω corresponds to the image plane. δ is the univariate Dirac function defined as:
                              
                                 (14)
                                 
                                    δ
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      |
                                                      x
                                                      |
                                                      >
                                                      κ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                            κ
                                                         
                                                      
                                                      [
                                                      1
                                                      +
                                                      cos
                                                      (
                                                      
                                                         
                                                            π
                                                            x
                                                         
                                                         
                                                            κ
                                                         
                                                      
                                                      )
                                                      ]
                                                      ,
                                                   
                                                   
                                                      |
                                                      x
                                                      |
                                                      ⩽
                                                      κ
                                                   
                                                
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where κ is constant and practically set with κ
                           =2 in our experiments. H is the Heaviside function defined as:
                              
                                 (15)
                                 
                                    H
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      x
                                                      <
                                                      0
                                                   
                                                
                                                
                                                   
                                                      x
                                                      +
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      /
                                                      2
                                                      ,
                                                   
                                                   
                                                      x
                                                      ⩾
                                                      0
                                                   
                                                
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Let us explain the meaning of these terms. Minimize the energy functional 
                              
                                 E
                              
                            in (11), which is equivalent to minimizing 
                              
                                 L
                              
                            in (12), and maximize 
                              
                                 A
                              
                            in (13). First, the energy function with respect to the boundary 
                              
                                 L
                              
                            is equivalent to the integral of edge indicator values along the intersected curve between IP and US image plane because the IP model should be converged around an edge-like part in US images. Second, the energy function with respect to the inside region 
                              
                                 A
                              
                            is the integral of edge indicator values over the inner region surrounded by the intersected curve. It is expected to be as large as possible. To summarize, minimizing 
                              
                                 L
                              
                            and 
                              
                                 -
                                 A
                              
                            achieves the registration.

By calculus of variations, the Gateaux derivative (first variation) of the functional 
                              
                                 E
                              
                            in (11) can be approximately written as
                              
                                 (16)
                                 
                                    
                                       
                                          ∂
                                          E
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    ≈
                                    (
                                    α
                                    δ
                                    (
                                    d
                                    ·
                                    g
                                    )
                                    -
                                    β
                                    H
                                    (
                                    -
                                    d
                                    ·
                                    g
                                    )
                                    )
                                    G
                                    .
                                 
                              
                           
                        

The steepest descent process for minimization of the functional 
                              
                                 E
                              
                            is the following gradient flow:
                              
                                 (17)
                                 
                                    
                                       
                                          ∂
                                          x
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    -
                                    (
                                    α
                                    δ
                                    (
                                    d
                                    ·
                                    g
                                    )
                                    +
                                    β
                                    H
                                    (
                                    -
                                    d
                                    ·
                                    g
                                    )
                                    )
                                    G
                                    .
                                 
                              
                           
                        

The minimization can be done through the following two steps: for accelerating the convergence, first, it minimizes the function without any constraint in the transformation. This means every point can move freely using Eqs. (9) and (17). Next, it determines the transformation parameters to better describe the first minimization result. These two steps are repeated until convergence.

Let 
                           
                              X
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    N
                                    ×
                                    3
                                 
                              
                           
                         preserve N 3D data points. Then the approximation of (9) and (17) by the above difference scheme can be simply written as:
                           
                              (18)
                              
                                 
                                    
                                       ∂
                                       X
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                        It is the approximation of discrete data set transformation by the above spatial difference scheme in (9) and (17).
                           
                              (19)
                              
                                 A
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                           
                         is a matrix in which each row consists of the mean value (center point) of X, and if A is decomposed with singular value decomposition (SVD) algorithm as A
                        =
                        USV
                        T, then the transformation is given as:
                           
                              (20)
                              
                                 R
                                 =
                                 
                                    
                                       UV
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                 t
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        where R and t are rotation and translation parameters respectively.

Now, we have two choices of operation at each step that makes the iteration convergent:


                        Point-to-IP Operation: Each point x moves toward IP, by updating its position as:
                           
                              (21)
                              
                                 
                                    
                                       x
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 R
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 t
                                 ;
                              
                           
                        
                     


                        IP-to-point Operation: IP moves toward the point set by updating the coefficient vector as:
                           
                              (22)
                              
                                 
                                    
                                       a
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 V
                                 (
                                 R
                                 ,
                                 t
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        by the algorithm proposed in A.

Both the two operations are mathematically equivalent, but however they can be selected in different cases for accelerating the computation. When the point set is small, e.g., less than 6800 points, point-to-IP operation is faster than the IP-to-point operation of an 8-degree IP. But on the other hand, e.g., in the US case, since the point set extracted from pixels is often huge (a 320×240 image can own 76,800 points), then the IP-to-point operation is definitely required for the acceleration.

Given the registration approaches both for general and US cases derived by single IP, let us present our coarse-to-fine registration with coupled two sub-processes: (1) coarse-to-fine representation and (2) coarse-to-fine transformation.

The coarse-to-fine representation is based on our previous method, incremental fitting [25]. This approach can fit a complex model in an incremental manner, for achieving the coarse-to-fine representation. It works efficiently because the upper-triangular linear system is solved incrementally until the desired fitting accuracy can be satisfied.

However this incremental method cannot be directly used for registration, because at each step it cannot guarantee to obtain a complete degree form of IP which is necessary for calculating the transformation matrix (See A). To make the incremental scheme suitable for registration, we modify the incremental scheme to be a degree-by-degree incremental manner; that is, it increase with an integral degree at each step.

Then our registration can be conducted through a coarse-to-fine transformation. As shown in Fig. 2, transformation is carried out at each step after the degree is increased. Each transformation starts with the position obtained from the result of lower IP at previous step, and stops at the position when the registration residual is small enough. The approach can described by the following algorithm.
                           Algorithm 1
                           Algorithm: Coarse-to-fine registration 
                                 
                                    
                                       
                                       
                                       
                                          
                                             (1)
                                             Input: given source model S and target model T,
                                          
                                          
                                             
                                             Output: transformation parameter p
                                             
                                          
                                          
                                             
                                             Initialization: set p
                                                
                                                   i
                                                 with null rotation and translation,
                                          
                                          
                                             (2)
                                             Fitting S with the ith degree IP f
                                                
                                                   i
                                                ;
                                          
                                          
                                             (3)
                                             Updating coefficient as: a
                                                
                                                   i
                                                
                                                ←
                                                V(p
                                                
                                                   i
                                                )a
                                                
                                                   i
                                                ;
                                          
                                          
                                             (4)
                                             Estimating p
                                                
                                                   i
                                                 by the registration between f
                                                
                                                   i
                                                 and T;
                                          
                                          
                                             (5)
                                             If the desired fitting accuracy can be satisfied, then stop;
                                          
                                          
                                             
                                             otherwise, increasing degree as: i
                                                ←
                                                i
                                                +1 and goto (2)
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTAL RESULTS@&#

In this section, we report results of experiments dealing with some synthetic data sets to evaluate the method on computational performance. All the experiments were implemented in Matlab 8 combined by C++ code with a PC having an Intel core 2 CPU, 2.4GHz, and 2GB memory.

In the experiments of registration for general case, we first test the robustness and accuracy for global overlapped registration using the 3D shape models shown in Fig. 7
                           , where the source models are shown in gray and the target models are shown in green; we added Gaussian noise to the source model with standard deviations 0.01; and we initially rotated the target model by 30° to each axis, and translated by unit 2 along the X and Y-axis. Note, All the original data sets are regularized by centering the data-set center of mass at the origin of the coordinate system and scaling it by dividing each point by the average length from point to origin.

Then we tested three methods for comparison: (i) standard ICP method [14], (ii) correspondences free methods with single IP [21,23] and (iii) proposed method. Fig. 8
                            shows the registration results for each method.

Through the results in Fig. 8, we can see that, (i) all the results for “brain” object look acceptable, since the IP fits are stable even to the high degree, the registration with single IP works well and (ii) however, for the other two objects, single IP methods perform worse as losing accuracy with low degree IP, and failure registration with high degree IP due to the fits of high degree is unstable.


                           Table 1 shows the comparison of registration result. We can see that although the ICP method always keep highest accuracy, but it is time-consuming due to the heavy computation for correspondence searching, while the correspondences free registration with single IP shows the low accuracy and instability in the second and third cases.

Second, we synthesized a set of data for testing the performance on partially overlaps. As shown in Fig. 9
                           , the following four parts of the bunny object in different colors are registered to the whole bunny model: the “head” in blue and “tail” in red are cut from the original point cloud; the “sparse head” in green is generated by down-sampling 10% of original points and adding Gaussian noise with standard deviation of 0.1; and “3D-plane curve” part in pink is selected from the points on the cross-section between a 3D plane and the bunny object, and added with Gaussian noise in standard deviation of 0.1. Fig. 9(a) shows the initial position for registration for each part and (b) shows the finial result obtained by our method.

We show a comparable result based on graph of MSE vs. iteration number in Fig. 10
                           , where two noisy data set of “sparse head” and “3D-plane curve” are adopted for the registration in Fig. 10(a) and (b) respectively. The result implies that (i) single IP registration [21,22] of 6-degree is stable but lose accuracy while the registration of 10-degree might lead to slow or failed convergence; (ii) in contrast, our method is often with fast convergence when using the IP of low degree and with high accuracy when using the IP of high degree; (iii) compare to the distance transformation method [16] which requires 100×100×100 grid in memory for storing the distance field, IP only needs very small memory for storing several coefficients.


                           A discussion on partially overlapped registration. However, we do not suggest IP should be applied for the registration of open curves or surfaces (e.g., the range images captured from different views) due to the reason: the IP fit of an open curve/surface might infinite extend in the space if there is no constraint to make it closed, which may lead the registration to depend on the initial position guess very much. To illustrate this, a simple example is shown in Fig. 11
                            where an IP fit (shown in green curve) is priorly obtained by fitting to a target model which is close to the blue dots points (M2’s final position), but it extends much more longer than this target model in 2D space. Then two source models M1 and M2 starting at red and blue circle points to register to the IP. Although M2 successfully register to the correct position, M1 got failure result caused by the influence under the extended extra part of the IP fit.


                        Fig. 12
                         shows pose estimation process for a US image, where the US images are obtained by measuring phantom ATS514 [32] consisting of the cylinder-like shapes inside in different materials. Then we use a cylinder-like IP model (2-degree IP shown in red in Fig. 12)) to register the US images. The initial position is set as: the cylinder-like IP model crosses the US image plane with an angle of 85∘. In the process the motion of the IP is driven to fit to the hole-like region in the image.


                        Fig. 12 shows three US image frames with the same initialization and in the second row of Fig. 12 the iteration number required and final relative pose are shown. The third row shows the cross-section contour between the IP and the US plane at the final iteration. For each case, the consumed CPU time is within 30ms.


                           Fig. 14 shows another result of the US image pose estimation where the images are obtained by scanning a duck toy made of rubber in the cistern shown in Fig. 13
                            left. The duck model scanned by 3D range sensor without denoising is shown in Fig. 13 right. Top rows of Figs. 14 and 15
                           
                            show the coarse-to-fine IP models and its relative positions to US images, and bottom rows show the cross-section contour resulting from the registration at the selected steps. In both of the cases the consumed CPU time is within 100ms.

The third example is to test by solving a registration problem between real CT data and a US image. To do this, we first segmented the CT data to obtain the desired organ object by modern segmentation methods such as Graph Cut (see Fig. 16
                           ). Note, since the organ object is simple, we model it only by a 4-degree IP as shown in Fig. 16 right. Finding the relative pose to CT data for a US image now becomes finding the relative pose to the IP model.

The first example is pose estimation for a single US image shown in Fig. 17
                            where we show the registration process with relative pose and cross-section contour at each selected iteration.

We also tried a tracking problem for a US image sequence by tracking the position of the kidney object with the above IP model. Results are shown in Fig. 18
                           , where we show the cross-section contours of IP for selected frames.

@&#CONCLUSIONS@&#

In this paper, we extend our previous method, correspondences free registration with single IP model, to a new coarse-to-fine registration driven by the multiple IPs of incremental degrees. The better performance is achieved by two aspects: (i) The registration robustness and computational efficiency are improved by initial coarse registration with IP of low degree, since no extra IP surface appears and low cost of transformation for the IP and (ii) the registration accuracy is improved by IP of high-degree, due to the local details are representable for the IP.

In general, the proposed method is has the potential for real-time US image pose estimation because of four main advantages: (i) IP representation is robust against US image noise. (ii) IP transformation can be performed faster than transformation of data sets, since the number of data sets is often large extracted from US images. (iii) Thanks to IP gradient flows, the registration procedure can be performed by simple steepest descent-based minimization without time-consuming calculation of point-wise correspondences. (iv) The coarse-to-fine algorithm improves the robustness and accuracy than single IP registration.

@&#ACKNOWLEDGMENTS@&#

This work was partially supported by Canon Inc., under the project: Physics-based vision theories for next-generation medical image processing.

First, let us explain some notations for polynomial operations which were first introduced by Taubin and Cooper (see [20]). Let a coefficient a
                        
                           ijk
                         of an IP in Eq. (2) be presented as 
                           
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          ijk
                                       
                                    
                                 
                                 
                                    i
                                    !
                                    j
                                    !
                                    k
                                    !
                                 
                              
                           
                        , and a vector 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    ]
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      l
                                                      00
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      l
                                                      !
                                                      0
                                                      !
                                                      0
                                                      !
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      l
                                                      -
                                                      1
                                                      ,
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      l
                                                      -
                                                      1
                                                      )
                                                      !
                                                      1
                                                      !
                                                      0
                                                      !
                                                   
                                                
                                             
                                          
                                          
                                          …
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      00
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      !
                                                      0
                                                      !
                                                      l
                                                      !
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                         be according to the lth form of IP. An operation on this vector is defined as: 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    ,
                                    m
                                    ]
                                 
                              
                              =
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    ]
                                 
                              
                              ★
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    m
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        , where ★ represents the classic matrix multiplication, with the difference that the individual elements 
                           
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          ijk
                                       
                                    
                                 
                                 
                                    
                                       
                                          i
                                          !
                                          j
                                          !
                                          k
                                          !
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          abc
                                       
                                    
                                 
                                 
                                    
                                       
                                          a
                                          !
                                          b
                                          !
                                          c
                                          !
                                       
                                    
                                 
                              
                           
                         in each vector are multiplied as 
                           
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                          +
                                          a
                                          ,
                                          j
                                          +
                                          b
                                          ,
                                          k
                                          +
                                          c
                                       
                                    
                                 
                                 
                                    
                                       
                                          i
                                          !
                                          j
                                          !
                                          k
                                          !
                                       
                                    
                                    
                                       
                                          a
                                          !
                                          b
                                          !
                                          c
                                          !
                                       
                                    
                                 
                              
                           
                        . For example,
                           
                              (A.1)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         100
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                         !
                                                         0
                                                         !
                                                         0
                                                         !
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         010
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         !
                                                         1
                                                         !
                                                         0
                                                         !
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         001
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         !
                                                         0
                                                         !
                                                         1
                                                         !
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        and
                           
                              (A.2)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       1
                                       ,
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       1
                                       ]
                                    
                                 
                                 ★
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       1
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         200
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         110
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         101
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         110
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         020
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         011
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         101
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         011
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         002
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In [20], it was pointed out that under a non-singular coordinate transformation A, e.g., 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    ]
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    [
                                    l
                                    ]
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    ]
                                 
                              
                           
                        , the transformed coefficient matrix is given by
                           
                              (A.3)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       ,
                                       m
                                       ]
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       [
                                       l
                                       ]
                                    
                                    
                                       -
                                       T
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       ,
                                       m
                                       ]
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                              
                           
                        where A
                        [l] is a non-singular h
                        
                           l
                        
                        ×
                        h
                        
                           l
                         transformation matrix (assuming h
                        
                           l
                         be the number of monomial in the lth form), and A
                        [m] is the same. From this equation, we know that if A
                        [l] and A
                        [m] are given, then a linear relationship between Φ
                        [l,m]′ and Φ
                        [l,m] can be found; that is, the element-wise correspondence can be linearly expressed as
                           
                              (A.4)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       ijk
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          β
                                          ;
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ⩽
                                          l
                                          +
                                          m
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       α
                                       β
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       ijk
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       α
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       +
                                       m
                                       ]
                                    
                                 
                                 .
                              
                           
                        
                     

Then since all of the elements in vector Φ
                        [l+m] are contained in matrix Φ
                        [l,m], and similarly all of the elements in 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    +
                                    m
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         are contained in 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    ,
                                    m
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                        , a new linear correspondence can be constructed between Φ
                        [l+m] and 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    +
                                    m
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         by arranging the necessary elements in the right order into 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    l
                                    +
                                    m
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         as
                           
                              (A.5)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       +
                                       m
                                       ]
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             l
                                             +
                                             m
                                             ,
                                             0
                                             ,
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             l
                                             +
                                             m
                                             -
                                             1
                                             ,
                                             1
                                             ,
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             l
                                             +
                                             m
                                             -
                                             2
                                             ,
                                             2
                                             ,
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             [
                                             l
                                             +
                                             m
                                             ]
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             [
                                             l
                                             +
                                             m
                                             ]
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             [
                                             l
                                             +
                                             m
                                             ]
                                          
                                       
                                       ,
                                       …
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       [
                                       l
                                       +
                                       m
                                       ]
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       +
                                       m
                                       ]
                                    
                                 
                                 ,
                              
                           
                        if the (l
                        +
                        m)th transformation matrix is constructed as: 
                           
                              
                                 
                                    A
                                 
                                 
                                    [
                                    l
                                    +
                                    m
                                    ]
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    …
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        .

As a simple example, the elements of Φ
                        [2] 
                        
                           
                              
                                 
                                    
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               200
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         110
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         101
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               020
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         011
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               002
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                         are contained in Φ
                        [1,1] shown in (A.2), and the elements of 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    2
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         are contained in 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    1
                                    ,
                                    1
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                        . From the equation 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    1
                                    ,
                                    1
                                    ]
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    [
                                    1
                                    ]
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    1
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    [
                                    1
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         (supposing R
                        [1] is a pure rotation matrix), it is easy to find out the relationship of a linear expansion for the elements, e.g., the first element of 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    1
                                    ,
                                    1
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         is expanded as: 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    200
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    1
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    11
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    200
                                 
                              
                              +
                              2
                              
                                 
                                    r
                                 
                                 
                                    11
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    12
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    110
                                 
                              
                              +
                              2
                              
                                 
                                    r
                                 
                                 
                                    11
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    13
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    101
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    12
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    020
                                 
                              
                              +
                              2
                              
                                 
                                    r
                                 
                                 
                                    12
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    13
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    011
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    13
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    002
                                 
                              
                           
                        , where r
                        1 is the first row of R
                        [1] and r
                        
                           ij
                         is an element of R
                        [1]. Then since all the elements in Φ
                        [1,1] are contained in Φ
                        [1], we can find a linear relationship 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    200
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    2
                                    ]
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                11
                                             
                                             
                                                2
                                             
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                11
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                12
                                             
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                11
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                13
                                             
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                12
                                             
                                             
                                                2
                                             
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                12
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                13
                                             
                                          
                                          
                                          
                                             
                                                r
                                             
                                             
                                                13
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                         is viewed as the first row of A
                        [2].

Therefore, transformation matrices for different forms can be calculated in an incremental manner as.
                           Algorithm 2
                           Algorithm 
                                 
                                    
                                       
                                       
                                       
                                          
                                             (1)
                                             Initialization: given A
                                                [1];
                                          
                                          
                                             (2)
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            [
                                                            1
                                                            ,
                                                            1
                                                            ]
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            1
                                                            ]
                                                         
                                                         
                                                            -
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            [
                                                            1
                                                            ,
                                                            1
                                                            ]
                                                         
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            1
                                                            ]
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      ⟶
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            2
                                                            ]
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             (3)
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            [
                                                            1
                                                            ,
                                                            2
                                                            ]
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            1
                                                            ]
                                                         
                                                         
                                                            -
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            [
                                                            1
                                                            ,
                                                            2
                                                            ]
                                                         
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            2
                                                            ]
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      ⟶
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            3
                                                            ]
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             ⋮
                                          
                                          
                                             (n)
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            [
                                                            1
                                                            ,
                                                            n
                                                            -
                                                            1
                                                            ]
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            1
                                                            ]
                                                         
                                                         
                                                            -
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            [
                                                            1
                                                            ,
                                                            n
                                                            -
                                                            1
                                                            ]
                                                         
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            n
                                                            -
                                                            1
                                                            ]
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      ⟶
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            [
                                                            n
                                                            ]
                                                         
                                                      
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           

Here, → represents constructing the transformation matrix for the next step, after finding out the linear mapping relationship between 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    [
                                    1
                                    ,
                                    l
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         and Φ
                        [1,l]. Note if the initial argument A
                        [1] represents the pure rotation, then A
                        [l] is an orthogonal matrix (see [20]), and thus Eq. (A.3) degenerates to
                           
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       ,
                                       m
                                       ]
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       [
                                       l
                                       ]
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       [
                                       l
                                       ,
                                       m
                                       ]
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

By using homogeneous coordinates, an IP of n variables in Euclidean space can be described in projective space by a corresponding homogeneous IP of n
                        +1 variables. To convert a ternary (i.e. 3D) IP of degree d
                        
                           
                              (A.6)
                              
                                 
                                    
                                       f
                                    
                                    
                                       3
                                       D
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          0
                                          ⩽
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ;
                                          i
                                          +
                                          j
                                          +
                                          k
                                          ⩽
                                          d
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ijk
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        into its homogeneous representation, a new component t
                        =1 is added to the 3D IP as
                           
                              (A.7)
                              
                                 
                                    
                                       f
                                    
                                    
                                       4
                                       D
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          0
                                          ⩽
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                          ;
                                          i
                                          +
                                          j
                                          +
                                          k
                                          +
                                          l
                                          =
                                          d
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ijk
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       l
                                    
                                 
                                 .
                              
                           
                        
                     

Therefore a homogeneous polynomial corresponding to a 3D IP of degree d is a form of degree d in a 4D IP. Thus the procedure mentioned in the last section can be used to transform the homogeneous IP (4D IP). The different is that the incremental algorithm starts from a 4×4 affine transformation matrix A
                        [1], e.g., in the Euclidean case
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       [
                                       1
                                       ]
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         3
                                                         ×
                                                         3
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                         ×
                                                         3
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where R
                        3×3 and t are a pure 3D rotation matrix and a translation vector. As a result, a 3D IP of degree d can be affine-transformed only by A
                        [d], once it is worked out. Furthermore, the incremental scheme can be modified for saving the computational cost, e.g., for calculating A
                        [9] we can select the incremental order as:


                        A
                        [1]
                        →
                        A
                        [2]
                        →
                        A
                        [4]
                        →
                        A
                        [8]
                        →
                        A
                        [9].

@&#REFERENCES@&#

