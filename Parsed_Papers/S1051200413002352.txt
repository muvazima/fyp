@&#MAIN-TITLE@&#Segment dependent dynamic multi-histogram equalization for image contrast enhancement

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This work utilizes the concept of histogram equalization.


                        
                        
                           
                           It introduces the new concept of even expansion of histogram bins.


                        
                        
                           
                           More emphasis has been given on avoidance of intensity saturation problem.


                        
                        
                           
                           New full dynamic range allocation of narrow segments has been introduced.


                        
                        
                           
                           New normalization function has also been introduced.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Histogram equalization

Brightness preservation

Contrast enhancement

Multiple segmentation

Intensity saturation

@&#ABSTRACT@&#


               
               
                  Histogram equalization (HE) method proved to be a simple and most effective technique for contrast enhancement of digital images. However it does not preserve the brightness and natural appearance of the images, which is a major drawback. To overcome this limitation, several Bi- and Multi-HE methods have been proposed. Although the Bi-HE methods significantly enhance the contrast and may preserve the brightness, the natural appearance of the images is not preserved as these methods suffer with the problem of intensity saturation. While Multi-HE methods are proposed to further maintain the brightness and natural appearance of images, but at the cost of contrast enhancement. In this paper, two novel Multi-HE methods for contrast enhancement of natural images, while preserving the brightness and natural appearance of the images, have been proposed. The technique involves decomposing the histogram of an input image into multiple segments based on mean or median values as thresholds. The narrow range segments are identified and are allocated full dynamic range before applying HE to each segment independently. Finally the combined equalized histogram is normalized to avoid the saturation of intensities and un-even distribution of bins. Simulation results show that, for the variety of test images (120 images) the proposed method enhances contrast while preserving brightness and natural appearance and outperforms contemporary methods both qualitatively and quantitatively. The statistical consistency of results has also been verified through ANOVA statistical tool.
               
            

@&#INTRODUCTION@&#

The use of cellphones and other portable multimedia devices equipped with high definition (HD) cameras are becoming popular. Although these devices are quite effective, however they fail to capture clearer pictures in low light environments such as twilight, dawn and sunset/sunrise. The low contrast images are also noticed in shade and overcast environment. Under low light conditions, light emitting diodes (LEDs) are an alternative to capture images within a short range. Therefore, in general, the images captured under low-light conditions are hardly of any use unless processed to enhance the contrast.

A simple, popular and most effective technique for contrast enhancement is the histogram equalization (HE) [1]. The HE works on the cumulative distribution function based mapping of intensity levels. It flattens and stretches the dynamics range of the imageʼs histogram to achieve overall contrast enhancement [2]. HE has been successfully applied in various fields such as medical and satellite image processing. Despite of its popularity, conventional HE (CHE) is not suitable for implementation in consumer electronics devices, such as mobile phones and digital cameras being used to capture natural images. This is because of the fact that the HE normally introduces some undesirable artifacts in the processed images due to saturation of intensities. That is, some uniform regions in the processed image may saturate with very bright or very dark intensities. Thus, for the implementation of contrast enhancement in such devices, it is advisable that the processed image should retain the brightness and natural appearance of the input image [3]. Many solutions have been suggested to overcome this drawback of conventional HE. Most of these suggestions are based on multiple HE and can be broadly classified in two groups namely Bi-HE [4–8] and Multi-HE [8–15].

The brightness preserving bi-histogram equalization (BBHE) method has been one of the earliest works in this direction [4]. It divides the histogram of input image into two sub-histograms using the mean intensity as threshold and then each sub-histogram is equalized independently. A similar approach referred to as dualistic sub-image histogram equalization (DSIHE) has also been developed, according to which histogram division is based on the median intensity value [5]. It has been claimed that DSIHE is better than BBHE in terms of preserving brightness and entropy of the image. An improved, although complex brightness preserving method, known as minimum mean brightness error bi-histogram equalization (MMBEBHE) has been reported in [6]. It is based on the minimum absolute mean brightness error (AMBE) between input mean value and output mean value, as a threshold intensity level. Recently, the improved versions of BBHE have been suggested [7,8]. Such methods are based on setting the plateau limits in order to avoid intensity saturation. If the frequency of occurrence of intensity exceeds the plateau limit, corresponding frequency is replaced by a plateau limit, else remain the same as the original bin. Depending upon mean and median based plateau limits, these methods have been referred to as bi-histogram equalization plateau limit (BHEPL) [7], and bi-histogram equalization median plateau limit (BHEPL-D) [8]. Further, it is claimed [7,8] that the resultant image will be prevented from intensity saturation and is free from problems of over-enhancement. However in the present study, it is believed that the intensity saturation is not the sole problem that needs to be avoided, but the expansion of intensity levels (after HE process) also plays an important role.

To further preserve the brightness and natural appearance of the input image, the histogram may be segmented into more than two sub-histograms, and each sub-histogram may be equalized independently. This approach referred to as Multi-HE in literature, has been proved to be quite effective for contrast enhancement while preserving brightness and natural appearance. The basic idea in Multi-HE is to segment the histogram into large number of segments; the segment boundaries (threshold) are determined using mean [9], median [10] and variance [11]. The Multi-HE methods preserve the brightness, as each histogram segment (when equalized) yield lesser shift in the brightness compared to Bi-HE and conventional HE methods [9]. Due to this reason, the Multi-HE methods are expected to preserve both brightness and natural appearance of the processed image. Among the Multi-HE methods, recursive mean-separate histogram equalization (RMSHE) [9] and recursive sub-image histogram equalization (RSIHE) [10] are the respective extensions of BBHE and DSIHE methods. These methods use either mean or median intensity of an image as a threshold value to segment its histogram into two parts, each segment is then separated into two parts and process is repeated recursively, resulting in 
                        
                           
                              2
                           
                           
                              γ
                           
                        
                      segments (where γ is a positive integer, representing the number of iterations). Two minimum-within-class-variance based histogram segmentation methods have been developed that preserve the brightness to some extent, however it suffers a poor performance in terms of contrast enhancement [11]. A hybrid Multi-HE scheme has also been developed, that uses image mean (at first level) and within-class-variance (at subsequent levels) as threshold values for histogram segmentation, and then equalizes each segment independently [12]. The scheme is further modified in [13], which uses Gaussian filters for smoothing the histogram of input image before segmenting and equalizing each segment independently. The Multi-HE methods [9–12] are expected to have better brightness preservation property for the larger values of integer ‘γ’. However, for relatively larger values of integer ‘γ’, the histogram of processed image tends to be similar to input histogram while the processed image tends to be a copy of the input image without any contrast enhancement [16].

In Multi-HE methods discussed above [9–13], the segment boundaries usually cluster around larger probability regions of histogram, as evident from Fig. 1
                     (a). As a result many narrow range segments may be observed, which are separately shown in Fig. 1(b). The conventional HE, when applied to these narrow ranged segments, may not expand their dynamic range effectively thereby resulting in poor contrast of the processed image. To overcome this problem, Dynamic HE (DHE) method has been suggested [14]. DHE segments the histogram of input image using local minima of histogram, and a new dynamic range is assigned to each segment based on the original dynamic range and the number of pixels in the corresponding segment. However, under low light conditions DHE suffers with intensity saturation problems and produces undesirable artifacts [15]. Also, DHE gives emphasis on contrast enhancement without preserving the brightness [17]. Other Multi-HE based dynamic equalization approaches are dynamic quadrants histogram equalization plateau limit (DQHEPL) [8], and quadrants dynamic histogram equalization (QDHE) [15]. These techniques use DHE and plateau based clipping to avoid intensity saturation problem. It is worth noting that, these methods rely on the assumption that natural appearance of images can be preserved by avoiding the intensity saturation problem only; which is not true. It is observed that in order to maintain the natural appearance of the processed image, not only the intensity saturation should be avoided but also it is necessary that HE on each segment should expand the intensity levels evenly. This fact can be verified by observing the images processed by DQHEPL method. Despite the negligible intensity saturation problem in this algorithm, the processed images do not have the natural appearance. This is due to the fact that the HE on each segment expands the intensity levels un-evenly. To overcome the problems of brightness shift, visual artifacts and intensity saturation in the processed image, many other HE methods have also been proposed in the literature [18–25].

In this paper we propose a novel method, which ensures that pixel intensities within each segment are expanded evenly while avoiding intensity saturation problem, resulting into preservation of brightness and natural appearance of the image. The proposed method segments the histogram of input image into sub-histograms using mean and median as thresholds. The image having narrow peaks in the histogram, when segmented may result into many narrow segments (sub-histograms). The HE over these narrow ranged segments may not be able to enhance the contrast until they are expanded efficiently. This work proposes allocates full dynamic range to the narrow segments before HE process, as shown in Fig. 1(c). The proposed method, named as Segment Dependent Dynamic Multi-Histogram Equalization (SDDMHE), because it allocates new full dynamic range only to narrow ranged segments, after that HE is applied to each segment independently. The final step involves the application of normalization function, so that the saturation as well as un-even expansion of intensities can be avoided and natural appearance can be preserved more precisely. The proposed SDDMHE method is likely to produce better images as compared to other methods.

Remainder of the paper is organized as follows: The conventional HE is described in Section 2. Section 3 presents overview of histogram segmentation process. Section 4 presents the details of proposed method. Simulation results and discussion are given in Section 5, and finally paper is concluded in Section 6.

This section reviews the basic concept of conventional HE method for contrast enhancement of images. It maps the input intensity levels to new levels using the cumulative distribution function (cdf) as a transformation function. Consider the input image 
                        I
                        (
                        i
                        ,
                        j
                        )
                      of dimension 
                        u
                        ×
                        v
                      having L discrete intensity levels 
                        
                           
                              X
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              X
                           
                           
                              L
                              −
                              1
                           
                        
                      (for 8-bit image, 
                        L
                        =
                        256
                     ). For simplicity kth intensity level 
                        
                           
                              X
                           
                           
                              k
                           
                        
                      is denoted by k. The probability distribution function (pdf) for kth intensity level is defined as:
                        
                           (1)
                           
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 n
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 /
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       L
                                       −
                                       1
                                    
                                 
                                 n
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 )
                              
                              =
                              n
                              (
                              
                                 
                                    X
                                 
                                 
                                    k
                                 
                              
                              )
                              /
                              N
                           
                        
                      where, k is an integer in the range 0 to 
                        L
                        −
                        1
                      i.e. 
                        k
                        ∈
                        [
                        0
                        ,
                        L
                        −
                        1
                        ]
                     , 
                        n
                        (
                        
                           
                              X
                           
                           
                              k
                           
                        
                        )
                      is number of pixels with kth intensity level, and 
                        N
                        
                        (
                        =
                        u
                        ×
                        v
                        )
                      is total number of pixels in the image. The histogram of an image, 
                        H
                        [
                        
                           
                              X
                           
                           
                              l
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              u
                           
                        
                        ]
                      is simply the plot of 
                        n
                        (
                        
                           
                              X
                           
                           
                              k
                           
                        
                        )
                      vs. 
                        
                           
                              X
                           
                           
                              k
                           
                        
                     , where 
                        
                           
                              X
                           
                           
                              l
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              u
                           
                        
                      are lower and upper intensity levels respectively. The cumulative distribution function (cdf) is defined as:
                        
                           (2)
                           
                              c
                              (
                              
                                 
                                    X
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    q
                                    =
                                    0
                                 
                                 k
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    q
                                 
                              
                              )
                              
                              ∀
                              k
                              ∈
                              [
                              0
                              ,
                              L
                              −
                              1
                              ]
                           
                        
                      where, 
                        c
                        (
                        
                           
                              X
                           
                           
                              k
                           
                        
                        )
                      is the cdf at the kth intensity level. It may be noted that 
                        c
                        (
                        
                           
                              X
                           
                           
                              L
                              −
                              1
                           
                        
                        )
                      will always be unity. The conventional HE method maps the input image I (having dynamic range 
                        (
                        
                           
                              X
                           
                           
                              l
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              u
                           
                        
                        )
                     ) into the entire range (
                        
                           
                              X
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              L
                              −
                              1
                           
                        
                     ) by using the cdf as a transformation function. Let T be the transformation function which maps the input intensity level 
                        
                           
                              X
                           
                           
                              k
                           
                        
                      into output intensity level 
                        T
                        (
                        
                           
                              X
                           
                           
                              k
                           
                        
                        )
                      is defined as:
                        
                           (3)
                           
                              T
                              (
                              
                                 
                                    X
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 ⌊
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       L
                                       −
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ×
                                 c
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ⌉
                              
                           
                        
                      where, 
                        ⌊
                        x
                        ⌉
                      is the integer nearest to x. It can be noticed from (3), that the transformation function T is the scaled version of cdf. The HE therefore, uses the histogram of the input image to obtain the transformation function. Thus the output image 
                        O
                        (
                        i
                        ,
                        j
                        )
                      can be obtained as:
                        
                           (4)
                           
                              O
                              (
                              i
                              ,
                              j
                              )
                              =
                              T
                              
                                 [
                                 I
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ]
                              
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              I
                           
                        
                     
                  

Since the contrast enhancement of HE is proportional to the height of the histogram, the intensity levels with large number of pixels (high peaks) are expanded to a larger range as compared to the intensity levels with lower number of pixels [26]. Although HE method efficiently utilizes display intensities, it tends to introduce visual artifacts and loss of natural appearance in the processed image. Also as mentioned earlier, HE tends to shift the mean brightness of the image to the mid-intensity level (i.e. 
                        L
                        /
                        2
                     ), which is not desirable.

The brightness preservation is commonly achieved by applying HE over multiple segmented histograms (sub-histograms), instead of global histogram [4,5]. Various approaches which select the threshold values (boundaries) for histogram segmentation have been suggested in the literature [9–11]. To explain the concept of histogram segmentation, let 
                        H
                        [
                        
                           
                              X
                           
                           
                              l
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              u
                           
                        
                        ]
                      be the global histogram of the input image 
                        I
                        (
                        i
                        ,
                        j
                        )
                     , where 
                        
                           
                              X
                           
                           
                              l
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              u
                           
                        
                      are lower and uppermost intensities of the image. Let 
                        H
                        [
                        
                           
                              X
                           
                           
                              l
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              u
                           
                        
                        ]
                      be segmented into n sub-histograms i.e.
                        
                           (5)
                           
                              H
                              [
                              
                                 
                                    X
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    u
                                 
                              
                              ]
                              =
                              
                                 ⋃
                                 
                                    r
                                    =
                                    1
                                 
                                 n
                              
                              
                                 
                                    H
                                 
                                 
                                    r
                                 
                              
                              
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 ]
                              
                           
                        
                      where, 
                        
                           
                              H
                           
                           
                              r
                           
                        
                      represents rth segment of H. 
                        
                           
                              X
                           
                           
                              l
                           
                           
                              r
                              ,
                              n
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              u
                           
                           
                              r
                              ,
                              n
                           
                        
                      represent lower and uppermost boundaries of rth (out of n) segment respectively. It should be noted that 
                        
                           
                              X
                           
                           
                              l
                           
                           
                              1
                              ,
                              n
                           
                        
                        =
                        
                           
                              X
                           
                           
                              l
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              u
                           
                           
                              n
                              ,
                              n
                           
                        
                        =
                        
                           
                              X
                           
                           
                              u
                           
                        
                     . In literature, HE with two segments (
                        n
                        =
                        2
                     ) and more than two segments (
                        n
                        >
                        2
                     ) are referred to as Bi-HE and Multi-HE respectively. Each of the segmented histograms 
                        
                           
                              H
                           
                           
                              r
                           
                        
                      represents a sub-image 
                        
                           
                              I
                           
                           
                              r
                              ,
                              n
                           
                        
                      having 
                        
                           
                              X
                           
                           
                              l
                           
                           
                              r
                              ,
                              n
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              u
                           
                           
                              r
                              ,
                              n
                           
                        
                      as lower and upper intensity levels respectively. The segment boundaries 
                        
                           
                              X
                           
                           
                              l
                           
                           
                              r
                              ,
                              n
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              u
                           
                           
                              r
                              ,
                              n
                           
                        
                      depend on the criterion used for the segmentation. Two common criteria for histogram segmentation are the mean [4] and median [5] which are described below.

For the image 
                           I
                           (
                           i
                           ,
                           j
                           )
                         having histogram 
                           H
                           [
                           
                              
                                 X
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                           
                           ]
                         or its pdf 
                           p
                           (
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                           )
                         as defined in (1), the mean intensity value (m) of the image is defined as:
                           
                              (6)
                              
                                 m
                                 =
                                 
                                    ⌊
                                    
                                       ∑
                                       
                                          k
                                          =
                                          X
                                          l
                                       
                                       
                                          
                                             X
                                          
                                          
                                             u
                                          
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    .
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ⌉
                                 
                              
                           
                        
                     

The mean intensity value (m) is then selected as the threshold for decomposing the image histogram into two segments i.e. 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           [
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           ]
                         and 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           [
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 2
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 2
                                 ,
                                 2
                              
                           
                           ]
                        , where each segment represents a sub-image. Note that 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           [
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           ]
                         consists of 
                           {
                           
                              
                                 X
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 l
                              
                           
                           +
                           1
                           ,
                           …
                           ,
                           m
                           }
                         intensity levels and 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           [
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 2
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 2
                                 ,
                                 2
                              
                           
                           ]
                         consists of 
                           {
                           m
                           +
                           1
                        , 
                           m
                           +
                           2
                           ,
                           …
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                           
                           }
                         intensity levels. The corresponding sub-images may be represented as:
                           
                              (7)
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ⩽
                                    m
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       I
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    >
                                    m
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                        
                     

Alternative to mean-based segmentation, the median based segmentation has also been attempted [5]. Assume that A is an array consisting of image pixels in the ascending or descending order, and 
                           N
                           (
                           A
                           )
                         is the number of elements in that array. If 
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                         is the middle index of A, then median intensity ‘μ’ is defined as:
                           
                              (9)
                              
                                 μ
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             A
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             if 
                                             N
                                             (
                                             A
                                             )
                                              is odd
                                          
                                       
                                       
                                          
                                             (
                                             A
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             +
                                             A
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             1
                                             )
                                             )
                                             /
                                             2
                                          
                                          
                                             if 
                                             N
                                             (
                                             A
                                             )
                                              is even
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The corresponding sub-images may be represented as:
                           
                              (10)
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ⩽
                                    μ
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       I
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    >
                                    μ
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                         where, 
                           
                              
                                 I
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         is the rth sub-image out of total n sub-images.

The above segmentation approaches can be extended to higher levels by applying them iteratively on each segment [9,10], resulting in Multi-HE methods. In Bi-HE and Multi-HE, each of the segmented histograms (
                           
                              
                                 H
                              
                              
                                 r
                              
                           
                        ) are equalized independently. Since HE has the tendency to shift the mean brightness towards mid-point of allowed range of intensities for equalization, therefore the output images of Bi-HE (
                           n
                           =
                           2
                        ) methods likely to have their mean brightness in the middle of input mean intensity and 
                           L
                           /
                           2
                         intensity levels. As n increases, the mean brightness of processed image approaches towards mean intensity of input image, and therefore suitable for preserving the brightness. However n should not be increased too much, as it increases the complexity and reduces contrast enhancement performance.

@&#PROPOSED METHOD@&#

As mentioned earlier that a good histogram equalization technique should achieve contrast enhancement while preserving the brightness and natural appearance of the images. Most of the existing methods achieve one of these objectives at cost of the others. Some attempt has been made to achieve the contrast enhancement while preserving the natural appearance of images, by first expanding the original histogram over full range [
                        
                           
                              X
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              X
                           
                           
                              L
                              −
                              1
                           
                        
                     ] then performing the segmentation and HE processes [14]. This method neglects the brightness preserving property and produces intensity saturation artifacts. The intensity saturation problem has been resolved by imposing plateau limits [15].

It has been observed that most of the Multi-HE methods achieve good contrast gain while preserving the brightness, but fails to maintain the natural appearance of processes images. It was assumed that the intensity saturation problem causes loss in natural appearance; however it is observed that the methods avoiding the intensity saturation problem are also unable to maintain the natural appearance of the images. The present investigations reveal that it is not only the intensity saturation that is responsible for loss of natural appearance, but also uneven separation among the bins in the histogram of a processed image (refer to Fig. 2
                     (b)). This paper therefore proposes a novel algorithm to preserve the natural appearance and brightness of images while improving their contrast. In the proposed algorithm, the histogram of input image is first segmented (using mean or median intensity values as threshold), then the narrow segments are expanded to the full intensity range while other segments remain unaltered. Each segment (expanded/unexpanded) are then equalized within their new dynamic range using conventional HE. Finally the equalized image is normalized to avoid intensity saturation artifacts. Due to segment dependent histogram equalization in the proposed method, it is named as segment dependent dynamic Multi-HE (SDDMHE). The flowchart of the proposed method is shown in Fig. 3
                     . It consists of four modules: segmentation, expansion of narrow segments, equalization and normalization; which are described in the following subsections.

Let 
                           I
                           (
                           i
                           ,
                           j
                           )
                         be the image having histogram 
                           H
                           [
                           
                              
                                 X
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 u
                              
                           
                           ]
                         which is to be partitioned into n segments. Let 
                           
                              
                                 t
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         represent a threshold that separates rth and 
                           (
                           r
                           +
                           1
                           )
                        th segments, then 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         can be defined as:
                           
                              (12)
                              
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   l
                                                
                                             
                                          
                                          
                                             r
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   r
                                                   −
                                                   1
                                                   ,
                                                   n
                                                
                                             
                                             +
                                             1
                                          
                                          
                                             r
                                             >
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   r
                                                   ,
                                                   n
                                                
                                             
                                          
                                          
                                             r
                                             <
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             r
                                             =
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If 
                           
                              
                                 t
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         are determined by using the mean of the occupied intensities then proposed method can be referred to as SDDMHE-M, whereas if 
                           
                              
                                 t
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         are determined by using median of occupied intensities, then it can be referred to as SDDMHE-D. The segmented sub-images may be represented as:
                           
                              (14)
                              
                                 I
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       1
                                       ,
                                       n
                                    
                                 
                                 ∪
                                 
                                    
                                       I
                                    
                                    
                                       2
                                       ,
                                       n
                                    
                                 
                                 ∪
                                 ⋯
                                 ∪
                                 
                                    
                                       I
                                    
                                    
                                       n
                                       ,
                                       n
                                    
                                 
                              
                           
                         where, the first (
                           r
                           =
                           1
                        ) and last (
                           r
                           =
                           n
                        ) sub-images are obtained as:
                           
                              (15)
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ⩽
                                    
                                       
                                          t
                                       
                                       
                                          1
                                          ,
                                          n
                                       
                                    
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       I
                                    
                                    
                                       n
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    >
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          −
                                          1
                                          ,
                                          n
                                       
                                    
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                         and rth 
                           (
                           r
                           ∈
                           [
                           2
                           ,
                           n
                           −
                           1
                           ]
                           )
                         sub-image is defined as:
                           
                              (17)
                              
                                 
                                    
                                       I
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    
                                       
                                          t
                                       
                                       
                                          r
                                          ,
                                          n
                                       
                                    
                                    ⩾
                                    I
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    >
                                    
                                       
                                          t
                                       
                                       
                                          r
                                          −
                                          1
                                          ,
                                          n
                                       
                                    
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    I
                                    }
                                 
                              
                           
                        
                     

Most of the existing Multi-HE methods perform the equalization over each segment (sub-histogram), between two separating points. The contrast enhancement obtained in a narrow range segment (with closer separating points) is less significant compared to the optimally spaced segments. Consequently, the processed image tends to suffer intensity saturation artifacts and therefore loss of natural appearance. To solve such problems new range allocation schemes have been suggested in [15]. These approaches are based on fact that dynamic range of input image is less than full range. However sometimes image histogram are non-uniformly spread over full range, but majority of pixels have small range of intensity, as previously discussed and shown in Fig. 1(a). In such cases, schemes mentioned above fail to achieve good contrast enhancement.

The proposed SDDMHE methods attempt to overcome the problem of un-even expansion by allocating full range to selected (narrow) segments before the equalization process. It is in this step where the proposed method differs from the existing methods. In order to describe range allocation scheme of proposed method consider a segmented histogram defined in (5). The upper and lower segment boundaries of rth segment are 
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         respectively. The range of rth segment is:
                           
                              (18)
                              
                                 
                                    range
                                 
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 ,
                                 
                                 where 
                                 r
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                     

Note that 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 1
                                 ,
                                 n
                              
                           
                           =
                           0
                         and 
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 n
                                 ,
                                 n
                              
                           
                           =
                           L
                           −
                           1
                        . Each segment is associated with a factor
                           ,
                           f
                           (
                           r
                           )
                        , defined as:
                           
                              (19)
                              
                                 f
                                 (
                                 r
                                 )
                                 =
                                 
                                    (
                                    
                                       n
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ×
                                 
                                    range
                                 
                                 (
                                 r
                                 )
                              
                           
                         where, n is the total number of segments. Based on this factor, a segment is classified as narrow if its 
                           f
                           (
                           r
                           )
                         is less than unity (
                           f
                           (
                           r
                           )
                           <
                           1
                        ), otherwise a wider segment.

In SDDMHE methods, all narrow segments will be expanded to full range before the equalization process; whereas other segments are equalized within their original boundaries. The process of segment dependent range allocation is depicted in Fig. 1(c). The pseudo-code of range allocation algorithm is as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             for
                                          
                                          
                                          r
                                          =
                                          1
                                          :
                                          n
                                       
                                       
                                    
                                    
                                       
                                       
                                          
                                             range
                                          
                                          (
                                          r
                                          )
                                          =
                                          
                                             
                                                X
                                             
                                             
                                                u
                                             
                                             
                                                r
                                                ,
                                                n
                                             
                                          
                                          −
                                          
                                             
                                                X
                                             
                                             
                                                l
                                             
                                             
                                                r
                                                ,
                                                n
                                             
                                          
                                          ;
                                       
                                    
                                    
                                       
                                       
                                          f
                                          (
                                          r
                                          )
                                          =
                                          
                                             (
                                             
                                                n
                                                
                                                   L
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          ×
                                          
                                             range
                                          
                                          (
                                          r
                                          )
                                       
                                    
                                    
                                       
                                          
                                          
                                             if
                                          
                                          
                                          f
                                          (
                                          r
                                          )
                                          <
                                          1
                                       
                                    
                                    
                                       
                                       
                                          
                                             new
                                          
                                          
                                          
                                             range
                                          
                                          (
                                          r
                                          )
                                          =
                                          L
                                          −
                                          1
                                          ;
                                       
                                    
                                    
                                       
                                          
                                          
                                             else
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             new
                                          
                                          
                                          
                                             range
                                          
                                          (
                                          r
                                          )
                                          =
                                          
                                             range
                                          
                                          (
                                          r
                                          )
                                          ;
                                       
                                    
                                    
                                       
                                          
                                          
                                             end
                                          
                                       
                                    
                                    
                                       
                                          
                                             end
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                     

In this step, conventional HE process is applied over each segment. Here two types of segments are to be processed individually: the narrow segment scaled to full dynamic range and, wider segments (without any expansion). The mapping process is similar to that of conventional HE discussed in Section 2. The mapping of rth segment is determined as:
                           
                              (20)
                              
                                 T
                                 (
                                 k
                                 )
                                 =
                                 T
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 +
                                 
                                    ⌊
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             u
                                          
                                          
                                             r
                                             ,
                                             n
                                          
                                       
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             l
                                          
                                          
                                             r
                                             ,
                                             n
                                          
                                       
                                       )
                                    
                                    ×
                                    c
                                    (
                                    k
                                    )
                                    ⌉
                                 
                              
                           
                        
                     

For narrow segments 
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                           =
                           L
                           −
                           1
                         and 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                           =
                           0
                        , whereas for wider segments 
                           
                              
                                 X
                              
                              
                                 u
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 l
                              
                              
                                 r
                                 ,
                                 n
                              
                           
                         are the segment boundaries.

In the proposed method each segment is equalized independently and output image is obtained by adding the equalized images of each segment. This may result into saturation of intensities and output image 
                           O
                           (
                           i
                           ,
                           j
                           )
                         may appear to be whitish, as shown in Fig. 4
                        (b). This is because of expansion of narrow segments to the full range (explained in Section 4.2). It has been observed that if these expanded segments are rescaled back to the original range, the saturation problem may be avoided but the bins of the histogram of each segment appear to have un-evenly distributed which results in some visual artifacts, as shown in Fig. 4(c).

In order to solve these problems, we propose normalization of intensity levels of the output image. The normalized intensities (
                           
                              
                                 X
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                        ) are the weighted average of intensities of input image and that of processed image.
                           
                              (21)
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    ⌊
                                    
                                       
                                          (
                                          (
                                          w
                                          ×
                                          
                                             
                                                X
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          +
                                          T
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          )
                                       
                                       /
                                    
                                    (
                                    w
                                    +
                                    1
                                    )
                                    ⌉
                                 
                              
                           
                         where, 
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                         are the original intensities of input image, 
                           T
                           (
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                           )
                         are the intensities produced after HE process, and w is non-negative weight. The value of w is selected according to maximum information contained in the output image. That is, the minimum value of w which gives maximum entropy (calculated for each of 25 training images and then averaged) is used. Fig. 4(d) shows the effect of normalization process on visual quality of the image for 
                           n
                           =
                           4
                        . It has been observed that value of w that gives better visual quality of the output image depends on the number of segments (n). In this work, 
                           w
                           =
                           15
                        , 50, 110 and 150 are used for 
                           n
                           =
                           4
                        , 8, 16 and 32 respectively. These values are obtained experimentally for 25 training images and are fixed for all test images.

A data set of 120 test images has been used to evaluate and compare the performance of proposed SDDMHE-M and SDDMHE-D methods with our implementation of Conventional HE (CHE), BBHE [4], DSIHE [5], BHEPL-D [8], DQHEPL [8], RMSHE [9], and RSIHE [10] methods. Although results for most of the Multi-HE (DQHEPL, RMSHE, RSIHE) methods has been reported for four segments only, but we investigate the performance of proposed methods for 4, 8, 16 and 32 segments and compare the corresponding results of RMSHE and RSIHE methods. The test images are selected to have wide variation in size, average brightness and contrast. Some of the selected images have darker background (captured in low-light environments) while many images are of brighter nature (captured in bounced light source environments). Some of the images under consideration have poor contrast (having standard deviation of less than 30), and mostly extracted from CVG-UGR database [27]. Due to the space limitations, we have analyzed the results of only six test images in detail. These images are of varying size and suffer with different types of degradations. The characteristics of these six images are as follows;
                        
                           •
                           ‘Woman’ (
                                 254
                                 ×
                                 254
                              ) is a noisy and of dark background image having poor contrast and medium brightness;

‘Street’ (
                                 3600
                                 ×
                                 5840
                              ) image is taken at night-time in street light and has poor contrast and brightness;

‘Porch’ (
                                 2064
                                 ×
                                 1304
                              ) is an image of a dark room with sun-light entering from grilled door. It contains some dark and some bright pixels, and therefore has good dynamic range;

‘U2’ (
                                 501
                                 ×
                                 501
                              ) is an aerial image of a plane, having majority of dark pixels and therefore is of poor contrast;

‘Road’ (
                                 256
                                 ×
                                 256
                              ) is a very bright image, but of poor contrast;

‘City’ (
                                 298
                                 ×
                                 260
                              ) is an aerial image of a city, having many noisy pixels and of poor contrast.

The mean intensity levels, standard deviation (SD), discrete entropy (DE) and edge based contrast measurement (EBCM) (to be defined later) values of these six images, which are the measure of brightness, contrast, information content and edge-based contrast respectively, are listed in Table 1
                     . Also listed in Table 1 are the average values of SD, DE, and EBCM parameters averaged over 120 test images. The proposed and existing HE algorithms are implemented in MATLAB R2011a and executed on a PC equipped with Quad Core 2.2 GHz processor and 4 GB RAM.

As mentioned earlier, the aim of this work is to improve the contrast while preserving brightness and natural appearance of the images. Generally it is difficult to quantify the achievement of these contradicting objectives. Therefore it is desirable to have both qualitative (subjective) and quantitative (objective) assessments. For quantitative assessment, seven metrics – absolute mean brightness error (AMBE), standard deviation (SD), edge based contrast measurement (EBCM), discrete entropy (DE), universal image quality (UIQ), peak signal to noise ratio (PSNR) and image quality measure (IQM) rating (R) [28] – are used to measure and compare the performance of various techniques.

In this paper, following performance metrics are used to measure and compare the performance of various histogram equalization techniques.


                        Absolute Mean Brightness Error (AMBE)
                     

AMBE is the absolute difference between mean intensity of output image I and output image O i.e.
                           
                              (22)
                              
                                 AMBE
                                 (
                                 I
                                 ,
                                 O
                                 )
                                 =
                                 
                                    |
                                    m
                                    [
                                    I
                                    ]
                                    −
                                    m
                                    [
                                    O
                                    ]
                                    |
                                 
                              
                           
                         where, 
                           m
                           (
                           X
                           )
                         is the mean intensity of image X, defined in (6). The lower the value of AMBE, the better is the brightness preservation.


                        Discrete Entropy (DE)
                     

DE of the image is the measure its information richness. The higher the value of DE, more information the image contains. In HE approach, the high value of DE implies lesser intensity saturation effect [28]. It is defined as:
                           
                              (23)
                              
                                 DE
                                 =
                                 −
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       L
                                       −
                                       1
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 .
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                 (
                                 bits
                                 )
                              
                           
                         where, 
                           p
                           (
                           
                              
                                 X
                              
                              
                                 k
                              
                           
                           )
                         is the pdf of kth intensity level. For output image, it is obtained from histogram of output image.


                        Standard Deviation (SD)
                     

The contrast of the image is generally measured by its standard deviation (SD), also denoted as σ, which is defined in (24) as:
                           
                              (24)
                              
                                 SD
                                 =
                                 σ
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             L
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             m
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ×
                                       p
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                              
                           
                         where, m is the mean intensity of the image. An image with higher value of σ supposed to have better contrast. However, it is worth noting that, the high value of σ does not always implies the better enhancement of the image.


                        Edge Based Contrast Measurement (EBCM)
                     

The edge based contrast measurement (EBCM) [26] is another commonly used parameter to measure and compares the performance of various contrast enhancement techniques. It is based on the observation that the human perception mechanisms are very sensitive to edges. The EBCM for image I of size 
                           u
                           ×
                           v
                         is defined as follows:
                           
                              (25)
                              
                                 EBCM
                                 (
                                 I
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    u
                                 
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    v
                                 
                                 c
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 /
                                 u
                                 ×
                                 v
                              
                           
                         where 
                           c
                           (
                           i
                           ,
                           j
                           )
                         is contrast of pixel 
                           (
                           i
                           ,
                           j
                           )
                         having pixel intensity 
                           I
                           (
                           i
                           ,
                           j
                           )
                         and is defined as:
                           
                              (26)
                              
                                 c
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       |
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       −
                                       e
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                    
                                       |
                                       I
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       +
                                       e
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       |
                                    
                                 
                              
                           
                         In (26), 
                           e
                           (
                           i
                           ,
                           j
                           )
                         is the mean edge gray level defined in (27) below:
                           
                              (27)
                              
                                 e
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       ∑
                                       
                                          (
                                          y
                                          ,
                                          z
                                          )
                                          ∈
                                          α
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    g
                                    (
                                    y
                                    ,
                                    z
                                    )
                                    I
                                    (
                                    y
                                    ,
                                    z
                                    )
                                    /
                                 
                                 
                                    (
                                    
                                       ∑
                                       
                                          (
                                          y
                                          ,
                                          z
                                          )
                                          ∈
                                          α
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    g
                                    (
                                    y
                                    ,
                                    z
                                    )
                                    )
                                 
                              
                           
                         where 
                           α
                           (
                           i
                           ,
                           j
                           )
                         is the set of all neighboring pixels of pixel (
                           i
                           ,
                           j
                        ), and 
                           g
                           (
                           y
                           ,
                           z
                           )
                         is the edge value at pixel (
                           y
                           ,
                           z
                        ), which is the magnitude of the image gradient using Sobel operators [1]. Without loss of generality, the 
                           3
                           ×
                           3
                         neighborhood is employed. It is expected that, for an output image O of an input image I, the contrast is improved when 
                           EBCM
                           (
                           O
                           )
                           ⩾
                           EBCM
                           (
                           I
                           )
                         
                        [26], but a high value of EBCM does not always mean good and natural image enhancement.


                        Universal Image Quality (UIQ)
                     

The universal image quality (UIQ) [29] is another metric used to judge the performance of various HE methods in terms of the preservation of natural appearance of the output image. To define UIQ, let 
                           I
                           =
                           {
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                           }
                         and 
                           O
                           =
                           {
                           
                              
                                 O
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                           }
                         be the input and processed output images respectively, each of size 
                           N
                           =
                           u
                           ×
                           v
                        , and UIQ is then defined as:
                           
                              (28)
                              
                                 UIQ
                                 =
                                 
                                    
                                       4
                                       
                                          
                                             σ
                                          
                                          
                                             I
                                             O
                                          
                                       
                                       ×
                                       m
                                       (
                                       I
                                       )
                                       ×
                                       m
                                       (
                                       O
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             O
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       [
                                       
                                          
                                             (
                                             m
                                             (
                                             I
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             m
                                             (
                                             O
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                         where, 
                           m
                           (
                           I
                           )
                         and 
                           m
                           (
                           O
                           )
                        , as defined in (6) are mean intensity levels of input and output images respectively, and 
                           
                              
                                 σ
                              
                              
                                 I
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 O
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 I
                                 O
                              
                              
                                 2
                              
                           
                         are defined below;
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       m
                                       (
                                       I
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       (
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       m
                                       (
                                       O
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       I
                                       O
                                    
                                 
                                 =
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    m
                                    (
                                    I
                                    )
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          O
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    m
                                    (
                                    O
                                    )
                                    )
                                 
                              
                           
                         This parameter considers three types of distortions namely; loss of correlation, luminance distortion, and contrast distortion. Ideally the closer the value of UIQ to unity, the better is the preservation of natural appearance.


                        Peak Signal to Noise Ratio (PSNR)
                     

In order to access the appropriateness of processed image for consumer electronics products, the quality of output image is also measured in terms of Peak Signal to Noise Ratio (PSNR), defined in (29).
                           
                              (29)
                              
                                 PSNR
                                 =
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 
                                    [
                                    
                                       
                                          (
                                          L
                                          −
                                          1
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    MSE
                                    ]
                                 
                              
                           
                         where, MSE is the mean square error, which can be defined as
                           
                              (30)
                              
                                 MSE
                                 =
                                 
                                    ∑
                                    i
                                 
                                 
                                    ∑
                                    j
                                 
                                 
                                    
                                       
                                          |
                                          I
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          −
                                          O
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    /
                                 
                                 N
                              
                           
                         
                        
                           I
                           (
                           i
                           ,
                           j
                           )
                         and 
                           O
                           (
                           i
                           ,
                           j
                           )
                         are corresponding pixels in input and output image respectively, and N is the total number of pixels in the image.


                        Image Quality Measure (IQM) Rating (R)
                     

Image Quality Measure Rating (R) [28] is used for evaluating the subjective quality of the processed images. It considers two important visual masking effects i.e. luminance masking and texture masking, which highly effects human visibility to the artifacts, therefore IQM has been proposed to provide better correlation of image quality with human opinion. R is basically the ratio of the total number of pixels detected with noise artifacts (
                           
                              
                                 I
                              
                              
                                 n
                                 o
                                 i
                                 s
                                 e
                              
                           
                        ) to the total number of pixels (N), which is defined in (31):
                           
                              (31)
                              
                                 R
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       u
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       v
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       noise
                                    
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 /
                                 N
                              
                           
                         where, 
                           
                              
                                 I
                              
                              
                                 n
                                 o
                                 i
                                 s
                                 e
                              
                           
                           (
                           i
                           ,
                           j
                           )
                         depends on local entropy and edge magnitude of the original and processed images. In order to investigate the performance of various HE methods in terms of R, the values of local entropy and edge magnitude have been extracted using the set of parameters given in [28]. The smaller the value of R, the better is the perceptible quality of the image.

To assess the qualitative (subjective) performance, various HE methods are applied to all test (total 120) images, however for analysis of results, only six images namely; woman, street, porch, U2, road, and city have been considered. The statistical parameters (mean intensity, SD, DE, and EBCM values) of these images are listed in Table 1. The input images and corresponding output images processed by existing HE methods (CHE, BBHE, DSIHE, BHEPL-D, DQHEPL, RMSHE, and RSIHE) and proposed SDDMHE-M and SDDMHE-D methods are shown in Figs. 5, 7, 8, 9, 10 and 11
                         respectively.

The input image of woman (Fig. 5(a)), containing many dark and bright regions and has mean intensity value =117.89 (Table 1), which is also apparent from its histogram shown in Fig. 6
                        (a). A close observation of Figs. 5(b)–(e) reveals that conventional HE (CHE) and Bi-HE (i.e. BBHE, DSIHE and BHEPL-D respectively) have almost similar performance and produces brighter output image. Further observing corresponding histograms in Figs. 6(b)–(e), it can be concluded that equalized histograms suffer with intensity saturation and over enhancement problems, which is the cause of noise amplification and washout effect in these images. On the other hand, Multi-HE methods like DQHEPL, RMSHE, and RSIHE result better quality (at least subjectively) images, compared to Bi-HE methods as evident from Figs. 5(f)–(n), and also corresponding histograms in Figs. 6(f)–(n). Although these images look better than that of Bi-HE but still they donʼt have natural appearance, though brightness is preserved. This is due to un-even expansion of different segments. Further it can be observed that as the number of segments increases (
                           n
                           =
                           8
                        , 16 and 32) in RMSHE and RSIHE methods, the processed images tend to be closer to the corresponding input images. The results of proposed methods are shown in Figs. 5(o)–(v) with corresponding histogram in Figs. 6(o)–(v) for SDDMHE-M (
                           n
                           =
                           4
                           ,
                           8
                           ,
                           16
                           ,
                           32
                        ) and SDDMHE-D (
                           n
                           =
                           4
                           ,
                           8
                           ,
                           16
                           ,
                           32
                        ) respectively. Comparing all these images it is clear that proposed methods outperform others in preserving brightness and natural appearance with good contrast enhancement. Among the results of the proposed methods, it can be observed that as ‘n’ increases, subjective quality marginally increases, though it is difficult to appreciate.


                        Fig. 7
                        (a) shows ‘street’ image, which is a relatively dark image with poor contrast. For this image CHE, BBHE, and DSIHE (Figs. 7(b)–(d)) perform better than other methods, but noise amplification by CHE is easily visible in the dark sky. On the other hand, other methods (Figs. 7(e)–(n)) suffer non-linear enhancement problem which is quite visible from improper shadow details of the boy. One of the reason behind non-linear contrast enhancement is un-even expansion of the image intensities. However proposed method (Figs. 7(o)–(v)) outperforms all other methods which can be justified from reduced noise effect, proper shadow of the boy, and visible border of the bricks in the lower part of the image.

In Fig. 8
                        , ‘porch’ image and its processed version with different HE methods are shown. This image has mostly dark pixels and also some brighter pixels, and has good dynamic range. Those equalization methods such as DQHEPL, which are based on assumption that input image should have much lower dynamic range than the full range, may not enhance the image contrast effectively. This is evident from Fig. 8(f). It can be observed that CHE and Bi-HE methods (Figs. 8(b)–(e)) produce almost similar results with severely distorted wall details. Further, it can be seen in Fig. 8(f) that the output image processed by DQHEPL method has dark wall details. On the other hand image processed by RMSHE and RSIHE (Figs. 8(g)–(n)) shows better results as compared to CHE and Bi-HE methods but still the visual artifacts are introduced in the processed images, whereas proposed methods (Figs. 8(o)–(v)) produce good quality images without any noise amplification.


                        Fig. 9
                         shows the original U2 image, and its processed versions. U2 is a dark (mean 
                           intensity
                           =
                           106.17
                        ) and of very low contrast (standard deviation =9.29) image. The output of CHE (Fig. 9(b)) method has whitish effect in the region of plane whereas background has noisy textures. The results of Bi-HE (BBHE, DSIHE and BHEPL-D) methods shown in Figs. 9(c)–(e) are relatively better than that of CHE, but still suffer with the problem of intensity saturation. On the other hand, among the Multi-HE methods (Figs. 9(f)–(n)), DQHEPL has relatively better quality than RMSHE and RSIHE methods, as it preserves natural look of the image. Although these results are better than Bi-HE methods, but RMSHE and RSIHE methods still suffer with intensity saturation problem, as evident from noise-type background of these images. From the results of proposed methods shown in Figs. 9(o)–(v), it can be noticed that these images are of relatively better quality and appear to have natural look, however, the results for 
                           n
                           =
                           32
                         are slightly better than the results for proposed method with lesser number of segments.


                        Figs. 10 and 11
                        
                         show input and processed images of ‘road’ and ‘city’ images respectively. Both images are of poor contrast, but ‘road’ image is brighter and city image is darker. Similar to discussion in previous paragraphs for other images, the results for these images follows similar trends. That is the proposed methods outperform other methods in terms of subjective quality of output images, as evident from the respective results in Figs. 10 and 11.


                        Tables 2a, 2b, 2c and 2d
                        
                        
                        
                         present the values of (AMBE, DE), (SD, EBCM), (UIQ, PSNR), and R respectively for six test images obtained using various HE methods. Also Table 3
                         gives the average value of these parameters for the entire data set of 120 test images. The values of parameter for best performing HE method are shown in bold faces.

Observing the AMBE (which is measure of brightness preservation) values for various images in Table 2a, it is clear that in general, for all images, the proposed methods (SDDMHE-M and SDDMHE-D) results smaller values of AMBE compared to other methods. Thus the proposed methods have better brightness preservation compared to other methods. Further, comparison among the AMBE values of proposed methods, SDDMHE-M has better performance than SDDMHE-D. However, for both methods, the AMBE values decreases as n increases. Therefore, proposed methods perform better for large number of segments. When we compare among all methods, the proposed SDDMHE-M (
                           n
                           =
                           32
                        ) method has minimum value of AMBE for most of the test images, and that of SDDMHE-D (
                           n
                           =
                           32
                        ) is very close to the minimum AMBE. The similar results are obtained on average basis as well, which is evident from Table 3.

Again, comparing the values of DE for various methods in Table 2a, it can be observed that the proposed methods give larger value of DE. Since the DE measures the information content in the processed image, its higher value is desirable. The higher value of DE also means lesser intensity saturation effect due to HE. Thus the proposed methods outperform other methods by resulting higher value of DE. Although the value of DE for SDDMHE-M and SDDMHE-D are close to each other but their relative performance varies from image to image. Therefore it can be concluded that, the proposed method successfully avoids the intensity saturation problem.


                        Table 2b compares the values of two metrics used for contrast enhancement performance, namely standard deviation (SD) and EBCM, for various HE methods and for all six test images under consideration. As stated earlier, the main objective of the proposed method is to achieve not only the contrast enhancement, but at the same time to preserve the brightness and natural appearance of input image. The brightness preservation requires minimum shift in the mean intensity level, while preservation of natural look requires the even and saturation-free expansion of histogram. In order to achieve these objectives, it is necessary that while expanding the histogram (or pdf) of the input image, the pdf of processed image should retain the shape of input pdf as much as possible, with the minimum possible shift in the mean value. Further to achieve the contrast enhancement, it is necessary that SD and EBCM of output image should be higher than corresponding values of the input image. Observing Tables 1 and 2b, it can be seen that proposed method achieves all these objectives. However, the SD of processed images using proposed methods are lesser (but more than that of input images, refer to Table 1) than the corresponding values of other methods. This verifies our earlier stand that higher values of SD and EBCM do not always mean that the corresponding enhancement technique is good. Further, the results in Table 2b show that in the proposed methods, increasing the number of segments slightly decreases the values of SD and increases (marginally) the values of EBCM. This verifies that although the subjective quality of enhanced image improves but statistical parameter like SD has the reverse trend.

In order to measure the quality of processed image, two parameters namely UIQ and PSNR are used. The values of these parameters for images processed using different HE methods are given in Table 2c. The higher the values of these parameters, the better the similarities between original and processed images. From the values in Table 2c, it can be observed that proposed methods are quite effective and outperform other methods as they have highest values of these parameters. Further, increasing the number of segments gives additional performance improvement. Since, UIQ models three different types of distortions (loss of correlation, luminance distortion, and contrast distortion), it is the most suitable parameter for performance comparison of HE methods in terms of quality. It is particularly important in our case as the main objective of proposed methods is to eliminate un-even expansion of bins while minimizing the intensity saturation for preservation of natural appearance of images. The UIQ considers degree of correlation between input and output images, higher correlation means proper even expansion of bins. It is worth noting that three distortions included in UIQ may give better judgment of three factors i.e. natural appearance, brightness preservation and contrast enhancement, which is our main objective. From Table 2c, it is evident that the proposed methods achieve these objectives as they have UIQ values very close to unity and outperforms other methods. In terms of PSNR value also the proposed methods have the best performance among all considered HE methods.


                        Table 2d also shows the quality of images processed by various HE methods in terms of IQM rating, R which has been proposed for assessing the quality of histogram equalized images [28]. The value of R is the measure of number of noisy pixels in the processed images. Therefore lower value of R signifies better visual quality of the images; ideally the value of R should be zero. It can be observed from Table 2d that the proposed methods perform better as compared to other methods by resulting into lower value of R for majority of images. Further, as the number of segments increases, the value of R decreases thereby resulting into better image quality, which is also evident from UIQ and PSNR values (refer to Table 2c).


                        Table 3 presents the average values of all the parameters considered for comparison of various equalization methods. The parameter values are averaged over that 120 test images. In addition, Table 3 also compares different methods in term of number of images for which EBCM of output image is more than that of input image (column 6) and the average execution time (in the last column). From this table, it is evident that proposed methods have minimum value of AMBE (therefore preserve the brightness), higher value of DE (means processed images retains most on the information content), maximum number of images for which EBCM(O)⩾EBCM(I), highest values of UIQ (close to unity) and PSNR, and lowest value (close to zero) of R. However, in terms of SD and EBMC, quantitatively the performances of proposed methods are not as good as other methods, but as discussed earlier these are the metrics used to measure the contrast enhancement only. Further, the CHE method although has the highest value of SD and EBMC, but out of 120 images processed by this method, only 77 processed images has EBCM value greater than or equal to that of input images. On the other hand, the proposed methods (for 
                           n
                           =
                           32
                        ) results up to 84 processed images satisfying the above condition.

In order to measure the complexity of various methods execution time of each algorithm (average over all 120 test images) is also listed in Table 3. It can be observed that the proposed methods in general have higher complexity compared to other methods. The reason of higher complexity is the additional step of full dynamic range scaling of narrower segments in the proposed methods. The complexity further increases as the number of segments in the proposed methods increases. Among two proposed methods, the higher complexity of SDDMHE-D is due to median operation for histogram segmentation. It is worth noting that the CHE has lowest complexity because it does not perform any histogram segmentation or dynamic scaling like other methods, but it has poor performance in terms of all parameters except SD and EBCM. The plateau based methods like DQHEPL also require extra execution time for clipping process and have complexity close to that of proposed methods for four segments (
                           n
                           =
                           4
                        ). The higher complexity of proposed method is therefore the price to be paid to achieve better performance. But thanks to the availability of high speed Android based processors in modern mobile devices; the higher execution time is no more an issue of major concern.

In order to justify the statistical significance of results obtained and to make comparison more meaningful, it is advisable to perform variance analysis test. However, to perform such test, it must be checked if data (results) have normal distribution or not i.e. normality test should be performed first. Depending upon the nature of distribution an appropriate ANOVA test may be performed to verify statistical significance of the results.

Among the many available normality test, we have used DʼAgostino–Pearson test of normality. The main reason for selection of this test is that since 120 images are considered for comparing performance of proposed techniques with other HE methods in terms of various parameters (refer to Table 3), and for such a large data set this normality test is more reliable compared to simple t-test [30]. Table 4
                            shows the probability associated with DʼAgostino–Pearson test of normality for each set of data (for all 120 images). The normality test has been performed for each set of 120 data for each performance metric and for each HE method. The critical chi-squared value is set to 0.05, and the degree of freedom employed in the analysis is 2. As evident from Table 4, that all probabilities associated with chi-squared statistics for each parameter and each HE method is less than the critical chi-squared value (0.05), therefore it can be concluded that all data sets (for each of seven performance metrics and for all HE methods) donʼt have the normal distribution and null hypothesis for this test rejects.

As stated in the previous subsection (Section 5.4.1), all data sets lack the normal distribution characteristic, therefore a distribution free ANOVA test has to be deployed. In this work, Kruskal–Wallis one-way ANOVA [30] test for performance analysis has been used, since being a non-parametric test tool, it can be applied for significance test of distribution-free data. The Kruskal–Wallis one-way ANOVA test is based on an analysis of variance using the ranks of the data values, not the data values themselves. It returns a p-value, on the basis of which one can measure the significant difference among the data sets. If the p-value is near zero, it suggests that at least one sample median is significantly different from the others. Generally 
                              p
                              =
                              0.05
                            is considered as threshold, that is two data sets are said to be significantly different if p-value is less than 0.05.

In order to verify the statistical significant difference between the results obtained from the proposed HE methods (SDDMHE-M and SDDMHE-D) to that of other methods, separate Kruskal–Wallis one-way ANOVA test has been performed with each pair of methods with similar number of segments. Tables 5a–5e
                           
                           
                           
                           
                            compare the p-values obtained using Kruskal–Wallis one-way ANOVA test for various pairs of HE methods (the proposed methods are paired with all other HE methods of the similar segments), for 
                              n
                              =
                              2
                           , 4, 8, 16 and 32, where n is the number of segments and corresponding p-values are listed in Tables 5a, 5b, 5c, 5d and 5e respectively. The p-values for each pair of methods are obtained by considering data set of 120 test images and for all seven parameters defined in Section 5.1.


                           Table 5a contains p-values of Kruskal–Wallis one-way ANOVA test for 
                              n
                              =
                              2
                           , pairing each of BBHE, DSIHE and BHEPL-D with proposed SDDMHE-M and SDDMHE-D methods. It can be observed from this table that the proposed methods (for 
                              n
                              =
                              2
                           ) are not significantly different from other Bi-HE methods in terms of AMBE, DE and EBCM parameters as corresponding p-values are greater than 0.05. However, it can be observed that proposed methods are significantly different from the other Bi-HE methods in terms of other metrics such as SD, UIQ, PSNR and R. That is, the proposed methods have significantly different performance than other methods for four (out of seven) metrics, whereas for remaining three metrics, the proposed methods are not significantly different than the other methods.

Similarly, Table 5b compares the statistical significant difference between proposed SDDMHE methods (for 
                              n
                              =
                              4
                           ) and other Multi-HE methods (for 
                              n
                              =
                              4
                           ) such as DQHEPL, RMSHE and RSIHE methods. By observing p-values in table, a conclusion similar to that for 
                              n
                              =
                              2
                            (described above) can be derived. That is, the proposed methods are significantly different than other methods in terms of SD, UIQ, PSNR and R metrics. From Tables 5c, 5d, and 5e, the similar trend can also be noticed for higher number of segments (
                              n
                              =
                              8
                              ,
                              16
                              
                              and
                              
                              32
                           ), i.e. SDDMHE methods are significantly different from RMSHE and RSIHE (for correspondingly the same number of segments) in terms of the same set of metrics, as for lower order segments.

To further strengthen our observations, and to quantify the information content in all 120 processed images by various HE methods, the box plots are shown in Figs. 12
                           (a)–(g), for AMBE, DE, SD, EBCM, UIQ, PSNR and R respectively. A close analysis of these figures reveals that box-plot analyses of results are in consistence with our earlier observations discussed in Section 5.3. That is, the proposed method outperforms all other HE methods in terms of information richness (DE), visual and perceptual qualities (UIQ, PSNR and R) and is comparable to other methods in terms of brightness preservation (AMBE) and EBCM. However, as discussed earlier, although the SD values of our methods are better than that of input images, but not as good as that of other HE methods. Thus the box-plot analysis verifies and confirms the consistency of performance difference between our methods and other HE methods.

@&#CONCLUSION@&#

In this paper, two novel Multi-HE methods i.e. SDDMHE-M and SDDMHE-D have been proposed. These methods differ in the histogram segmentation which is based either on mean or median intensities respectively. The novelty of proposed methods is the scaling of narrow segments to the full range followed by the normalization process. The proposed methods result into expanded histogram of processed image, but of approximately similar shape as that of the input image. The proposed methods also minimize the intensity saturation problem and improve the output image quality by avoiding un-even distribution of bins in the output histogram. The simulation results over large number of test images show that the proposed methods enhance the contrast while preserving the brightness and natural appearance of the images, but at the cost of computational complexity. In order to measure the significant difference among various HE methods, normality and non-parametric ANOVA tests are also performed and these tests verify that the proposed methods are significantly different than other HE methods at least in terms of four (out of seven) metrics considered for comparison. Due to these desirable features the proposed methods are suitable for consumer electronics products equipped with cameras.

@&#ACKNOWLEDGEMENTS@&#

The authors wish to acknowledge the anonymous reviewers, whose comments helped us to improve the quality of this paper. This work has been carried out in the Department of Electronics Engineering, Aligarh Muslim University, Aligarh, India. The work is partly funded by University Grant Commission (UGC) under DRS Phase II scheme (Grant No. F.3-68/2009 (SAP-II)).

The pseudo-code of SDDMHE method for gray scale image is as follows:
                        
                           1.
                           Load image I;

Calculate 
                                 H
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                 
                                 ]
                              , the histogram of image I, where 
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                               and 
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                 
                               are lower and upper intensity of I.

For SDDMHE-M, calculate mean intensity ‘m’ according to Eq. (6);

For SDDMHE-D, calculate median intensity ‘μ’ according to Eq. (9).

Divide 
                                 H
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                 
                                 ]
                               into two segments considering ‘m’ or ‘μ’ as initial threshold.

Partition each segment obtained in step 4, further into two segments with mean or median intensity of that segment as new threshold.

Repeat step 5 until 
                                 H
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                 
                                 ]
                               is divided into n segments, where n is an integer power of two.

Say, 
                                 H
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       ⋃
                                    
                                    
                                       r
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       r
                                    
                                 
                                 [
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                                 ]
                              , r is integer representing segment ID and 
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                               and 
                                 
                                    
                                       X
                                    
                                    
                                       u
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                               are lower and upper intensities of rth segment, defined as
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             l
                                          
                                          
                                             r
                                             ,
                                             n
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                                
                                                   r
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         r
                                                         −
                                                         1
                                                         ,
                                                         n
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   r
                                                   >
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             u
                                          
                                          
                                             r
                                             ,
                                             n
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         r
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                                
                                                   r
                                                   <
                                                   n
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   r
                                                   =
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       t
                                    
                                    
                                       r
                                       ,
                                       n
                                    
                                 
                               is the boundary separating rth and 
                                 (
                                 r
                                 +
                                 1
                                 )
                              th the segments.


                              
                                 
                                    
                                       
                                          
                                             
                                                for
                                                
                                                r
                                                =
                                                1
                                                :
                                                n
                                             
                                          
                                          
                                             
                                                do
                                             
                                          
                                          
                                             
                                                
                                                Calculate
                                                
                                                
                                                   range
                                                
                                                (
                                                r
                                                )
                                                =
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      r
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      l
                                                   
                                                   
                                                      r
                                                      ,
                                                      n
                                                   
                                                
                                                ;
                                             
                                          
                                          
                                             
                                                
                                                Calculate
                                                
                                                f
                                                (
                                                r
                                                )
                                                =
                                                (
                                                
                                                   n
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                )
                                                ×
                                                
                                                   range
                                                
                                                (
                                                r
                                                )
                                             
                                          
                                          
                                             
                                                
                                                if 
                                                f
                                                (
                                                r
                                                )
                                                <
                                                1
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   new
                                                
                                                
                                                
                                                   range
                                                
                                                (
                                                r
                                                )
                                                =
                                                L
                                                −
                                                1
                                                ;
                                             
                                          
                                          
                                             
                                                
                                                else
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                   new
                                                
                                                
                                                
                                                   range
                                                
                                                (
                                                r
                                                )
                                                =
                                                
                                                   range
                                                
                                                (
                                                r
                                                )
                                                ;
                                             
                                          
                                          
                                             
                                                
                                                end
                                             
                                          
                                          
                                             
                                                
                                                Perform histogram equalization of segment over
                                             
                                          
                                          
                                             
                                                
                                                
                                                   new range
                                                
                                                ;
                                             
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                              
                           

Add histogram of each segment and perform normalization as defined in Eq. (21) to get the final intensity levels;

Generate the output image O using the intensity levels obtained in step 8.

@&#REFERENCES@&#

