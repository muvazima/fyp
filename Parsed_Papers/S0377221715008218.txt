@&#MAIN-TITLE@&#Optimizing layouts of initial AFV refueling stations targeting different drivers, and experiments with agent-based simulations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This paper first explores who should be targeted with initial AFV refueling stations.


                        
                        
                           
                           Then, it explores the diffusion of AFVs with different numbers of these initial stations.


                        
                        
                           
                           This paper conducts agent-based simulations for the case of Shanghai.


                        
                        
                           
                           If AFV technologies are mature, drivers in or close to the center should be targeted.


                        
                        
                           
                           Too many initial AFV refueling stations might result in slow diffusion of AFVs.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Simulation

Optimal layout

Alternative fuel vehicles

Initial refueling stations

Agent-based model

@&#ABSTRACT@&#


               
               
                  The number of refuelling stations for AFVs (alternative fuel vehicles) is limited during the early stages of the diffusion of AFVs. Different layouts of these initial stations will result in different degrees of driver concern regarding refueling and will therefore influence individuals’ decisions to adopt AFVs. The question becomes “what is an optimal layout for these initial stations? Should it target all drivers or just a portion of them, and if so, which portion?” Further, how does the number of initial AFV refueling stations influence the adoption of AFVs? This paper explores these questions with agent-based simulations. Using Shanghai as the basis of computational experiments, this paper first generates different optimal layouts using a genetic algorithm to minimize the total concern of different targeted drivers and then conducts agent-based simulations on the diffusion of AFVs with these layouts. The main findings of this study are that (1) targeting drivers in the city center can induce the fastest diffusion of AFVs if AFV technologies are mature and (2) it is possible that a larger number of initial AFV refueling stations may result in slower diffusion of AFVs because these initial stations may not have sufficient customers to survive. The simulations can provide some insights for cities that are trying to promote the diffusion of AFVs.
               
            

@&#INTRODUCTION@&#

Alternative fuel vehicles (AFVs), such as fuel cell vehicles and electric vehicles, have been the subject of increasing attention from the general public (Petschnig, Heidenreich, & Spieth, 2014) as environmental friendly alternatives to conventional internal combustion engines. Nevertheless, the adoption of AFVs is still in its infancy. A widely recognized obstacle for the diffusion of AFVs is the “chicken and egg” problem concerning the adoption of AFVs and the construction of AFV refueling stations (e.g., Hoen & Koetse, 2014; Kenzie, 2010, Sweda & Klabjan, 2011). Drivers will be reluctant to adopt AFVs if there are few AFV refueling stations, and energy companies will have little motivation to establish AFV refueling stations if there are few AFVs on the road.

Governments or AFV business leaders such as Tesla must initiate projects that act as both demonstrations of AFV refueling stations and “seeds” for the diffusion of AFVs. Due to budget constraints, the number of “seeds” – initial AFV refueling stations – is limited during the early stages of AFV diffusion. Different “seed” layouts will result in differing degrees of driver concern about refueling and thus influence their decision to adopt AFVs. The question becomes, what is an optimal layout of these initial stations? Should it target all drivers or just a portion of them, and if so, which portion? Further, how will the number of initial AFV refueling stations influence the adoption of AFVs?

There is little historical data to answer the above questions. It is also difficult to explore these questions with traditional operational optimization approaches or equilibrium analyses because the diffusion of AFVs is a complex process involving interactions among adaptive and heterogeneous actors. Agent-based modeling, or ABM, is regarded as a powerful tool to study these types of complex processes (Arthur, 1999). Several agent-based models have been developed to study the co-diffusion of AFVs and their refueling stations (see Ma, Zhao, Xiang, Zhu, & Liu, 2014a, Schwoon, 2008, Stephan & Sullvian, 2004). This paper explores the above questions via agent-based simulations.

In this paper, the basis for selecting different groups of targeted drivers are largely based on different geographical parts of a city because the question of where to put the initial AFV refueling stations is geographically based. Exploring schemes based on other factors (e.g., demographic data) will be addressed in future work. This paper explores the effects of the following four schemes for selecting targeted drivers.

                        
                           (a)
                           All drivers in the city.

Drivers who were selected if their concerns about refueling fall below a given threshold (thus, they are considered potential early adopters of AFVs).

Drivers living in the center of the city.

Drivers living in a suburb of the city.

Using Shanghai as the experimental city, this paper first generates different optimal layouts with a genetic algorithm to minimize the total concern of different targeted drivers, then conducts agent-based simulations to test which layout will induce the most rapid diffusion of AFVs.

Many studies have attempted to estimate the sufficient number of initial AFV refueling stations (in terms of the percentage of existing gasoline stations) to ensure drivers will not be concerned about their ability to refuel AFVs, and most of the estimations fall in the range of 10–20% (e.g., Kurani, 1992, Melaina, 2003, Nicholas, Handy, & Sperling, 2004). In our perspective, a sufficient number of AFV refueling stations is not built in a day. There is an evolutionary process through which some early AFV refueling stations will be closed due to lack of customers, while others will be established if enough potential customers are observed. The rise and fall of natural gas stations for NGVs (natural gas vehicles) in Shanghai beginning just before the turn of the century (Chi, Ma, & Ning, 2012) is a good example of this process, although it has been ignored in most of the existing studies. The agent-based model that will be introduced in Section 2 captures this process well. Using the agent-based model, we run simulations to explore how different numbers of initial AFV refueling stations influence the diffusion of AFVs.

Focusing on the starting point of the diffusion process of AFVs, the agent-based model introduced in this paper addresses drivers’ concern when making the decision to adopting AFVs. This concern is the result of drivers' observations of the scarcity of AFV refueling stations before they adopt AFVs. In this sense, it is a little different from the term “range anxiety” (Acello, 1997), which commonly denotes anxiety about the availability of refueling stations when driving an AFV. For example, Adler, Mirchandani, Xue, and Xia (2014) defined a driver's level of range anxiety as a monotonically increasing function of the fuel used: the lower the fuel remaining is, the higher the anxiety, and vice versa.

Our model seeks to minimize drivers' concerns about the availability of facilities when they are travelling in a network. In this sense, it is similar to the Flow-Refueling Location Model (FRLM) developed by Lim and Kuby (2010). The main difference is that our model aims to minimize the total concerns of drivers based on their observations when driving, whereas FRLM aims to maximize the traffic flows served by a given number of stations (e.g., Chung & Kwon, 2015). To our knowledge, there are no existing studies that seek to minimize drivers' concern in the context described in this paper.

Our study is limited to AFVs that have refueling patterns similar to those of traditional vehicles, i.e., vehicles that must go to a refueling/recharging station, which routinely takes several minutes. Recently, electric vehicles have appeared as promising new form of AFV (China's State Council 2012, The US Department of Energy 2013). Rapidly charging depleted batteries or using robots to replace spent batteries (Mak, Rong, & Shen, 2013) with fully charged ones, which would only take several minutes, presents a promising refueling system for electric vehicles. The AFVs in this paper can be thought of as these types of electric vehicles, and the refueling stations presented are considered either fast-charging or battery-changing stations. The model and methods presented in this paper also apply to other AFVs, such as hydrogen fuel cell and gas-fuelled vehicles, but they do not apply to electric vehicles requiring several hours to recharge.
                        1
                     
                     
                        1
                        For these kinds of electric vehicles, it is better to install recharging facilities in parking places.
                     
                  

The analysis framework presented in this paper focuses on the relationship between drivers and the locations of initial AFV refueling stations; decision makers, i.e., governments or AFV business leaders who apply the framework to design the layout of initial AFV refueling stations, should take note of other constraints, such as zoning, neighboring land uses, risk, land cost and availability, visibility, and so on, which have been thoroughly explored in other studies (e.g., Current, ReVelle, & Cohon, 1985, Nicholas et al., 2004).

The purpose of the paper is not to propose a new genetic algorithm, nor to show the benefit of the genetic algorithm. The genetic algorithm applied here is similar to that used in Lim and Kuby's work on the Flow-Refueling Location Model (Lim & Kuby 2010). Instead, the main purpose of this paper is to explore the issue of selecting target drivers when designing the layout of a fixed number of initial AFV refueling stations. Little work has been done on the issue that considers interactions among heterogeneous actors, and the main contribution of this paper is to illuminate this area by applying the genetic algorithm and agent-based simulations. The agent-based simulations presented in this paper can aid intuitions on the issue but they do not prove theorems or find patterns in direct measurement of the real world (Axelrod, 1997).

The remainder of this paper is organized as follows. Section 2 introduces the agent-based models for the co-diffusion of AFVs and their refueling stations as well as the definition of drivers' concern applied in this study. Section 3 introduces the genetic algorithm for generating optimal layouts and the four different schemes of selecting targeted drivers. Section 4 presents the agent-based simulations and analysis of the diffusion of AFVs with different layouts and numbers of initial AFV refueling stations as applied to Shanghai. Section 5 concludes.


                        Stephan and Sullivan (2004) proposed a stylized agent-based model to simulate the co-diffusion process of AFVs and their refueling stations in an urban area. Schwoon (2008) and Ma et al. (2014a) further extended the model by linking the stylized model with additional realities. In these models, there are two types of agents: driver agents and station owner agents. A driver agent will update his/her vehicle after a given number of years. When updating his/her vehicle, a driver agent will evaluate the utility of adopting an AFV using the following function:

                           
                              (1)
                              
                                 
                                    u
                                    =
                                    FixedBenefit
                                    +
                                    VariableBenefit
                                    +
                                    SocialValue
                                    −
                                    Concern
                                    .
                                 
                              
                           
                        In the above Eq. (1)
                        
                           
                              •
                              
                                 u denotes a driver agent's utility of switching from a traditional vehicle to an AFV;


                                 FixedBenefit represents the benefit of the lower price of buying an AFV with subsidies from the government. Because an AFV is usually more expensive than a traditional vehicle, the FixedBenefit variable can be negative if the subsidies are low. As more driver agents adopt AFVs, the cost of AFVs will decrease due to the technological learning effect (Arrow, 1962), and the FixedBenefit may thus increase.


                                 VariableBenefit represents the energy cost savings when adopting an AFV; it is dependent on how many miles the driver agent will drive. Government subsidies for alternative fuel and carbon tax policies for fossil fuels will influence the VariableBenefit.


                                 SocialValue represents a driver's pride in being environmentally friendly or a user of advanced technology.


                                 Concern represents the driver agent's concern about the availability of AFV refueling stations. If the driver agent finds that there are few AFV refueling stations through his/her past driving experience, then his/her concern will be great; thus, the utility will be negative, and he/she will not adopt an AFV. If few people adopt AFVs, the technological learning effect will be weak and AFVs will remain expensive.

A station owner agent will consider establishing an AFV refueling station at a location if he/she finds that there are many AFVs passing the location. Once a refueling station is established, it will be operated for at least half a year, after which point it will be closed if insufficient AFVs pass by. The establishment and closure of AFV refueling stations will influence driver agents’ concern and thus their utility of adopting AFVs. A more detailed description of the interaction between driver agents and station owner agents can be found in Appendix A or in Ma et al. (2014a).

Using the agent-based models introduced above, we run computer simulations on the diffusion of AFVs. A successful diffusion process could be described as the following. At first, there are a few pioneer adopters of AFVs. With the initial construction of AFV refueling stations, the technological learning effect causes the FixedBenefit to increase, and more drivers will adopt AFVs. As a result, more AFV refueling stations will be built, which will decrease driver agents’ concern and encouraging more driver agents to adopt AFVs. This will result in further technological learning and the establishment of additional AFV refueling stations, and thus the diffusion enters a beneficial cycle. Diffusion can also fail if government subsidies are insufficient or if the layout of initial AFV refueling stations is not appropriate.

In the models (Schwoon, 2008, Stephan & Sullivan, 2004, and Ma et al., 2014a) introduced above, a driver agent's concern is defined by Eq. (2).

                        
                           (2)
                           
                              
                                 
                                    w
                                    i
                                    k
                                 
                                 =
                                 
                                    
                                       ∑
                                       j
                                    
                                    
                                       
                                          
                                             a
                                             j
                                             k
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                   j
                                                   k
                                                
                                                −
                                                D
                                             
                                             )
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        
                     where k denotes the ID of a layout, 
                        
                           w
                           i
                           k
                        
                      denotes the ith driver agent's concern about refueling with layout k, 
                        
                           d
                           j
                           k
                        
                      denotes the distance between the jth AFV refueling station and the (j − 1)th one during the driver agent's driving route with layout k, D is a constant value denoting the don't-worry distance (i.e., if the distance between two neighboring refueling stations in a driver's route is less than D, then the driver will not worry for this part of the route), 
                        
                           a
                           j
                           k
                        
                      is a dummy parameter denoting whether 
                        
                           d
                           j
                           k
                        
                      is longer than D, and

                        
                           (3)
                           
                              
                                 
                                    a
                                    j
                                    k
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      d
                                                      j
                                                      k
                                                   
                                                   ≤
                                                   D
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      d
                                                      j
                                                      k
                                                   
                                                   >
                                                   D
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     The D in Eqs. (2) and (3) does not signify the refueling range of an AFV. Rather, it is a distance beyond which driver agents will feel that refueling stations are rare. For example, the refueling ranges of most existing gasoline vehicles are beyond 400 kilometers, but drivers may feel that refueling stations are rare if two neighboring stations in a route are more than 10 kilometers apart, as 10 kilometers is far below the refueling range.

With Eq. (2), a driver agent's concern is determined by his/her driving route as well as the layout of AFV refueling stations. Different layouts of initial AFV refueling stations will result in different levels of concern among driver agents during the early stages of AFV diffusion. According to Eq. (1), the layout that results in low concern will help the diffusion of AFVs.

Suppose there are H potential sites for N initial AFV refueling stations; then, the number of different layouts of these stations is:

                           
                              (4)
                              
                                 
                                    K
                                    =
                                    
                                       C
                                       H
                                       N
                                    
                                    =
                                    
                                       
                                          H
                                          !
                                       
                                       
                                          
                                             (
                                             
                                                H
                                                −
                                                N
                                             
                                             )
                                          
                                          !
                                          N
                                          !
                                       
                                    
                                    .
                                    
                                       (
                                       
                                          N
                                          ≤
                                          H
                                       
                                       )
                                    
                                 
                              
                           
                        Our purpose is to find an optimal layout k* ∈ [1, K], and thus the value of the following Eq. (5) is minimized.

                           
                              (5)
                              
                                 
                                    
                                    
                                       W
                                       k
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       w
                                       i
                                       k
                                    
                                    …
                                    
                                       (
                                       
                                          k
                                          ∈
                                          [
                                          1
                                          ,
                                          K
                                          ]
                                       
                                       )
                                    
                                 
                              
                           
                        The problem is a mixed-integer optimization problem. There could be hundreds or thousands of potential sites for AFV refueling stations in a city, and the possible number of layouts — K in Eq. (4) — is tremendous. Thus, it is difficult to adopt traditional methods, such as brute force or a blind search, to find the optimal solution. In this paper, we apply a genetic algorithm to find the (close-to) optimal layout.

In the genetic algorithm, a layout is treated as a chromosome and its fitness is the total concern of all drivers regarding the layout. We denote the collection of potential sites for AFV refueling stations with a set 
                           
                              S
                              =
                              {
                              
                                 
                                    s
                                    1
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    s
                                    H
                                 
                              
                              }
                           
                        . A layout of initial AFV refueling stations can be denoted with a set 
                           
                              l
                              =
                              (
                              
                                 
                                    l
                                    1
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    l
                                    N
                                 
                              
                              )
                           
                         with 
                           
                              
                                 l
                                 i
                              
                              ∈
                              S
                              
                              
                                 (
                                 
                                    i
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    N
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 l
                                 i
                              
                              ≠
                              
                                 l
                                 j
                              
                              
                              
                                 (
                                 
                                    i
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    N
                                    ;
                                    j
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    N
                                 
                                 )
                              
                           
                        . The genetic algorithm can be described by the following 6-step process.


                        
                           
                              Step 1:
                              Generate the first generation layouts (or chromosomes) of initial refueling stations randomly with no site in the set S appearing in the generation more than once, and denoting all layouts in this generation with a set 
                                    
                                       
                                          L
                                          m
                                       
                                       
                                          (
                                          m
                                          =
                                          1
                                          )
                                       
                                    
                                 ;

Calculate driver agents’ total concern with each layout in the current generation Lm
                                  as the fitness of each layout;

Generate a new layout randomly from sites that have not been used in the current generation, and use the new layout to replace the layout with the lowest fitness in the current generation Lm
                                 ;

Generate a new generation of layouts (
                                    
                                       L
                                       
                                          m
                                          +
                                          1
                                       
                                    
                                 ) by randomly selecting two layouts in Lm
                                  and conducting two-point crossover; use the layout with the maximal fitness in Lm
                                  to replace one randomly selected layout in 
                                    
                                       L
                                       
                                          m
                                          +
                                          1
                                       
                                    
                                 , and then conduct mutation for all layouts in 
                                    
                                       L
                                       
                                          m
                                          +
                                          1
                                       
                                    
                                 : for each layout, we randomly choose one of its locations (potential sites for AFV refueling stations) and replace it with a randomly chosen location which is not included in the current generation.


                                 
                                    
                                       m
                                       =
                                       m
                                       +
                                       1
                                    
                                 ; if m > m*, go to step 6, otherwise 
                                    
                                       
                                          L
                                          m
                                       
                                       =
                                       
                                          L
                                          
                                             m
                                             +
                                             1
                                          
                                       
                                    
                                  and go to step 2, where m* is a predefined number;

Select the layout with the maximal fitness in Lm
                                  and end.

Step 4 in the above process is somewhat inspired by Lim and Kuby's work on maximizing the traffic flows served by a given number of stations (Lim & Kuby 2010). We also tested the scheme of assigning a probability to each layout with Eq. (6) for being selected as the parents of the next generation of layouts; however, we found it quickly reduces the diversity of chromosomes and the genetic algorithm will lock into local optimal solutions that are not good enough. Using the scheme of generating new generations of layouts can find better solutions than using the scheme based on Eq. (6):

                           
                              (6)
                              
                                 
                                    p
                                    =
                                    
                                       
                                          f
                                          −
                                          
                                             f
                                             min
                                          
                                       
                                       
                                          
                                             f
                                             max
                                          
                                          −
                                          
                                             f
                                             min
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where p is the probability that a layout will be selected as one of the parents for the next generation of layouts, f is fitness of the layout, f
                        max  is the maximal fitness of all layouts in the same generation, and f
                        min  is the minimal fitness of all layouts in the same generation.

There is no guarantee that the genetic algorithm will find a global optimal solution. The solution found by the genetic algorithm is "optimal" within a certain number of iterations, and it is most likely a local optimal solution rather than the global optimal solution.

With the genetic algorithm, should we minimize the total concern of all driver agents in a city, or just a portion of them? Which is more effective for promoting the diffusion of AFVs? To explore these questions, we design the following four schemes for selecting targeted driver agents, and their effects will be tested using agent-based simulations in Section 4. In the four schemes, targeted driver agents are mainly selected from different parts of the city because this paper aims to analyze where the initial AFV refueling stations should be placed.

                           
                              (a)
                              In the first scheme, potential sites of initial AFV refueling stations are assumed to be located throughout the entire city, all driver agents in the city are targeted, and their concerns are included in the objective function, i.e., Eq. (5).

In the second scheme, potential sites are still assumed to be located throughout the entire city, but not all driver agents in the city are targeted. Instead, only driver agents with concerns no larger than a given threshold are targeted and only their concerns will be included in Eq. (5). Those driver agents with concern above the threshold are not considered to be potential early adopters of AFVs and are therefore ignored when establishing initial AFV refueling stations. In this scheme, when applying the GA, the target driver agents are dynamic with different layouts of initial AFV refueling stations.

In the third scheme, potential sites of initial AFV refueling stations are limited to the center of the city, only drivers with main driving routes in the center are targeted, and their concerns will be included in Eq. (5). This scheme is based on the fact that drivers and driving routes in the city center are much more intensive than those in suburbs; thus, the limited number of initial AFV refueling stations can have more potential customers, which can result in more effective technological learning.

In the fourth scheme, potential sites of initial AFV refueling stations are limited to a city's suburban district, only drivers with main driving routes in this suburb are targeted, and their concerns are included in Eq. (5). The government may select a suburban district for AFV demonstration projects for different reasons. One important reason may be that there is lingering uncertainty in the safety of AFVs and their refueling stations, and it is felt to be prudent to locate them away from areas with high population density.

Shanghai is one of the largest cities in China with a well-developed economy and infrastructure. In 2011, Shanghai became the first city in China to begin demonstration projects of plug-in electric vehicles, and it has the potential to be selected as an adoption center for AFVs. In the following sections, we conduct computational experiments with the agent-based model introduced in
Section 2
 to test the optimal layouts generated from different groups of targeted drivers and with the genetic algorithm introduced in
Section 3.

Various existing traffic forecasting methods (e.g., Chrobok, Kaumann, Wahle, & Schreckenberg, 2005, Dia, 2001, Duffus, Alfa, & Soliman, 1987, Tsekeris & Stathopoulos, 2006) can be used to generate driving trips in an area. The main purpose of this paper is not to study traffic forecasting but to analyze optimal layouts of initial AFV refueling stations, given that the distribution of driving routes is already known. Therefore, we apply a simple method developed by Ma, Zhu, Liu, and Chi (2014b) to generate driving trips for the experiments. The details of the method can be found in Appendix B. The driving routes generated with this method do not have to be more precise than those generated with traditional traffic forecasting methods. The advantages of the method are that its input data are widely available and it does not require intensive data collection.

The experiments were implemented using Repast (North et al., 2013) as the ABM platform and ArcGIS (ESRI 2004) as the GIS (geographic information system) platform; communications between Repast and ArcGIS are realized through reading and writing operations on shapefiles in which spatial vectors are stored as two-dimensional tables. More details concerning the technological minutiae of the implementations can be found in Appendix C.

In our experiments, we use 8000 driver agents to represent millions of drivers in Shanghai. These driver agents are assumed to live in 400 residential zones and work in 400 workplace zones. Shanghai is composed of 19 districts. We allocate the residential zones within each district according to the proportion of each district's population to the total population of Shanghai. Then, we randomly place residential zones in the districts. We allocate the workplace zones within each district based on the proportion of each district's GDP (gross domestic product) to the total GDP of Shanghai. Then, we randomly place workplace zones in the districts. The population and GDP data are from the Shanghai Statistical Bureau (2009).

Compared with trips for other purposes, such as shopping and leisure, commuting trips are more fixed in terms of both time and space. Each driver agent is randomly assigned a residential zone and, following the proportions of the four commute types in Table 1
                        , randomly assigned a workplace zone. Dijkstra's algorithm (Dijkstra, 1959) is applied to each driver agent to decide his/her shortest commute route. In reality, a driver might not select the shortest path. In our experiments, for the sake of simplification, a driver agent takes the shortest commute route.

In addition to driving trips for commuting, driving trips for other purposes are generated from the driver agents’ residential zones and attractions such as shopping malls. There are also some randomly chosen driving trips. All driving trips are pre-generated exogenously before the genetic algorithm is applied to generate the optimal layouts with different targeted drivers.

We use Shanghai's main road network for our simulation. The road network includes more than 800 arcs and 532 nodes. In the experiment, the driver agents’ don't-worry distance is set as 11 kilometers. This is a value estimated roughly according to the distribution of gasoline refueling stations in Shanghai and previous studies (e.g., Kurani, 1992, Melaina, 2003, Nicholas et al., 2004), which show that drivers' concerns about refueling will be largely eliminated when the number of AFV refueling stations reaches 10–20% of existing gasoline refueling stations. As noted above, the don't-worry distance does not mean the refueling range of an AFV. It is a distance beyond which driver agents will feel that the AFV refueling stations are rare. The potential sites of AFVs refueling stations are simply assumed as the 532 nodes of the road network. Fig. 1
                         provides an illustration of Shanghai's main road network and the distribution of residential zones, workplace zones, and attractions in our agent-based simulations.

When using the genetic algorithm introduced in Section 3.1 to find the optimal layouts in this case study, we apply two-point crossover; the two points are selected randomly. We tried several mutation rates and found that excessively large mutation rates (e.g., 0.1) were not good for the convergence of the algorithm, while excessively small mutation rates (e.g., 0.01) could result in a quick lock-in local optimal solution. After significant trial and error, we set the mutation rate as 0.05 for the experiments reported in the following. The population size of each generation is set as 40.

Based on a survey of the traditional and electric vehicles available in the market, we performed the following estimation for traditional vehicles and AFVs in the model. The cost of a traditional vehicle is assumed to be 25,000 US$, its annual maintenance cost is 150 US$, and its fuel cost per kilometer is 0.1 US$. The initial price of an AFV is 40,000 US$, its initial annual maintenance cost is 300 US$, and its energy cost per kilometer is 0.025 US$ (i.e., 25% of that of a traditional vehicle). The social value of using an AFV is set according to the average annual income, which is 7000 US$. The technological learning rate of AFVs is assumed to be 10%.

In Shanghai, the subsidy from the government for an electric vehicle is approximately 40% of the total price (including a reduced purchasing tax and a free license plate, which is otherwise priced by a monthly auction). Only 40 driver agents (0.5% of all driver agents) are designated as adopters of AFVs at the beginning of the simulation.

In the simulation, one step denotes one month. The time period for each driver agent to update his/her vehicle follows a normal distribution with a mean of four years (48 steps) and a standard deviation of one year (12 steps).

Suppose there are 10 initial AFV refueling stations. Fig. 2
                            shows their optimal layouts generated by the genetic algorithm (introduced in Section 3.1) targeting different driver agents, which are selected based on the four different schemes introduced in Section 3.2. Fig. 2(a) is the optimal layout targeting all driver agents, in which refueling stations are allowed to be placed throughout Shanghai to minimize the total concern of all driver agents. Fig. 2(b) is the optimal layout targeting those driver agents whose concern is less than a given threshold (60). We can see that, with these targeted driver agents, the 10 refueling stations are located closer to the center of Shanghai than those in layout (a). This is because many driver agents who live far from the centre have higher concerns than the given threshold, and the optimal layout therefore ignores them. The design of the given threshold is a state-of-the-art work. Fig. 2(c) is the optimal layout targeting drivers in the centre, in which initial AFV refuelling stations are allowed to be placed in the center districts only to minimize the concerns of the targeted driver agents. Fig. 2(d) is the optimal layout targeting driver agents in a suburban district (the Jiading district), in which initial AFV refueling stations are allowed to be placed in the suburban district only to minimize the concerns of the targeted driver agents. The Jiading district was selected because it is the main location of Shanghai's car industry and the city's current demonstration projects are mainly in this district.

We use the agent-based model introduced in
Section 2
 to simulate the diffusion of AFVs with the four optimal layouts of initial AFV refueling stations illustrated in Fig. 2. Fig. 3
                         shows the diffusion of AFVs in these simulations. Due to the complexity emerging from the interactions between driver agents and station owner agents, the diffusion of AFVs could be different with the same layout. Each diffusion curve in Fig. 3 is the average of 10 simulations with the same layout.

From Fig. 3, we can see that the diffusion of AFVs with layout (c) is the fastest, followed by the diffusion with layout (b) and then layout (a); the diffusion with layout (d) is the slowest. These simulation results match our intuition that ceteris paribus, a layout aiming to minimize the concerns of drivers in the city center will help the diffusion of AFVs, while the layouts aiming to minimize the concern of all drivers in the entire city or only drivers in a suburb district are not appropriate designs for promoting the diffusion of AFVs.

Of course, when selecting locations for initial AFV refueling stations, decision makers must also consider other factors, such as zoning, neighboring land uses, risk, land cost and availability, visibility, and so on. Shanghai has selected the Jiading district as the place for AFV demonstration projects, which results in the slowest diffusion of AFVs in our simulation. Jiadang was selected for several reasons:

                           
                              •
                              Shanghai's car industry is mainly in Jiading, and thus it is easy to install and maintain AFV refueling stations there.

The population in Jiading is not as dense as in the city center, meaning that the land cost of AFV refueling stations and the risk caused by the uncertainties of AFV technologies are not as high. Jiading is also less sparsely populated as in other suburb districts, so the number of potential adopters somewhat higher.

When there are still significant uncertainties concerning AFV technologies, it is not a bad idea to initialize them in a district such as Jiading. When the technologies related to AFVs are quite mature, our simulations suggest placing initial AFV refueling stations in the center of a city.

We also ran simulations to explore how different numbers of initial AFV refueling stations influence the diffusion of AFVs. We generated the layout of these initial refueling stations with the second and third schemes introduced in Section 3.2. The reason these two schemes were selected is that the layouts generated with them can induce rapid diffusion of AFVs. As shown in Section 4.3, layout (c) and layout (b) are generated with the two schemes, and the diffusion of AFVs under these schemes is faster than with other layouts.


                        Figs. 4
                         and 5
                         show the diffusion of AFVs with different numbers of initial AFV refueling stations with layouts generated by the second and third schemes, respectively. Again, because the diffusion of AFVs could be different with the same layout, each diffusion curve in Figs. 4 and 5 is the average of 10 simulations with the same layout.

The common intuition is that the more initial AFV refueling stations there are, the faster the diffusion of AFVs will be. As both Figs. 4 and 5 show, when there are 10 initial refueling stations, the diffusion of AFVs is fastest. When the number is larger than 10, i.e., 12, 20, or 40 in Figs. 4 and 5, the diffusion of AFVs is slower than it was with 10 refueling stations.


                        Figs. 4 and 5 suggest that it is not a good idea to establish as many initial AFV refueling stations as possible under budget constraints. If there are too many initial AFV refueling stations, most of them will not have enough customers to survive and will be closed after a certain period, thus resulting in the slower diffusion of AFVs.


                        Figs. 4 and 5 also show that when the number of initial refueling stations does not exceed 10, the layout generated by the third scheme are better than that generated by the second scheme; however, when there are more than 10 refueling stations, the layout generated by the second scheme is better than that generated by the third scheme. This is because the third scheme targets only driver agents in the city center; when the number of initial AFV refueling station is small, it is a rational idea, but when the number grows, it becomes more rational to target some driver agents in the suburbs (that are still close to the center) in addition to driver agents in the center. The second scheme can realize this rationality because its targeted driver agents are not limited to those in the city center.

Using agent-based simulations for the case of Shanghai, this paper first analyzed the diffusion of AFVs in conjunction with optimal layouts of AFV refueling stations generated with different targeted drivers. The simulation results suggest that when designing a (nearly) optimal layout of initial AFV refueling stations for a city, if the technologies are already mature, it is better to target drivers in or close to the center of the city. The paper then analyzed the diffusion of AFVs with different numbers of initial AFV refueling stations; the main finding is that it is not proper to establish as many initial AFV refueling stations as possible because if there are too many stations, there will be insufficient customers for them to survive, thus resulting in the slow diffusion of AFVs.

The schemes for selecting different targeted drivers are mainly based on different parts of a city. In our future work, we would like to explore more complex schemes of selecting different drivers considering demographic features such as age, income, and so on.

The study presented in this paper focused on the interactions between driver agents and station owner agents. When applying the analysis framework or adopting the suggestions drawn from the simulations, it should be noted that there are other constraints, such as zoning, neighboring land uses, risk, land cost and availability, visibility, and so on, that are beyond the scope of this paper.

The main contribution of this paper is not to propose a new genetic algorithm, nor to show the benefit of the genetic algorithm. Instead, the main contribution of this paper is to illuminate the issue of selecting target drivers when designing the layout of a fixed number of initial AFV refueling stations.

The methodology we have adopted in this study is in accord with Axelrod's description of the value of simulation (Axelrod, 1997):

“Simulation is a third way of doing science. Like deduction, it starts with a set of explicit assumptions. But unlike deduction, it does not prove theorems. Instead a simulation generates data that can be analyzed inductively. Unlike typical induction, however, the simulated data comes from a rigorously specified set of rules rather than direct measurement of the real world. While induction can be used to find patterns in data, and deduction can be used to find consequences of assumptions, simulation modeling can be used to aid intuition”.

Because there is little historical data with which to answer the questions this paper explored, and because it is difficult to explore these questions with traditional operational optimization approaches or equilibrium analysis, the simulations and analysis present in this paper can provide some insights for cities that are attempting to promote the diffusion of AFVs.

@&#ACKNOWLEDGMENTS@&#

This research was sponsored by NSFC (No. 71125002).

We describe the model following the ODD (Overview, Design concepts and Details) protocol (Grimm et al., 2006).

The purpose of the model is to simulate the co-diffusion of AFVs and their refueling stations in an urban city with different layouts of initial refueling stations (Ma et al., 2014a).

There are two types of agents in the model: driver agents and station owner agents. Driver agents are characterized by the state variables: identity number, living location, working location, time period of buying a new vehicle. Driver agents will calculate their concerns about refueling an AFV with the availability of refueling stations in its driving paths, and also the utility of using an AFV. We use several thousand (e.g., 8000 in the case study presented in Section 5) driver agents to represent the drivers in an urban city. Station owner agents are characterized by the state variables: identity number, location, and threshold for survival. Each station owner agent operates one refueling station for AFVs. We assume there are several (e.g., 10 in the case study presented in Section 5) initial refueling stations (owner agents) for AFVs. During the simulation, new refueling stations (owner agents) will come into being and some existing ones will disappear.

In addition to driver agents and station owner agents, other entities in the model are AFVs, a government, and an urban city. All AFVs are homogenous with a technological learning rate. The government gives a subsidy to driver agents who buy AFVs. The urban city is composed of several districts, e.g., 19 districts in Shanghai, including both the center and suburbs of the city. The road network in our simulations includes main roads in the urban city.

One step in the simulation represents one month; we run each simulation for 180 months (15 years).

With each step (or month), four modules or phases are processed in the following order:

                           
                              1.
                              
                                 Switching to AFVs. This phase includes the following three sub-phases:

Buying or not. Each driver agent checks whether it is time to buy a new vehicle, the buying decision following a lognormal distribution.

Calculating utility. Each driver agent who will buy a new vehicle calculates the utility of using an AFV.

Selecting a vehicle. Each driver agent who will buy a new vehicle with a positive utility of using an AFV selects an AFV; otherwise the agent selects a traditional vehicle.


                                 Removing unsuccessful station owner agents (or refueling stations). If an existing station owner agent has operated for more than 6 steps (half a year) and the number of AFVs passing it is lower than the threshold at it can survive, it will be removed from the system.


                                 Coming of new station owner agents. New station owner agents appear in the places where there are enough AFVs passing through.


                                 Updating AFVs’ cost. The new cost of AFVs is calculated with the technological learning effect.


                        Emergence: The diffusion of AFVs emerges from each driver agent's decision to adopt an AFV based on its utility of using an AFV. The diffusion of refueling stations emerges from station owners decisions on establishing new or closing existing refueling stations.


                        Adaption: Driver agents will switch to AFVs or traditional vehicles based on their utilities of using AFVs. Station owner agents will open or close AFVs’ refueling stations based on their observations of the number of potential customers.


                        Sensing: Driver agents know the locations of refueling stations in their driving paths, based on which they have different concerns about the availability of AFV refueling stations. Station owner agents know the number of AFVs passing through their locations and they also know the threshold number for their surviving.


                        Interaction: The number and layout of station owner agents (i.e., refueling stations) will influence driver agents’ concerns about the availability of AFV refueling stations; in turn, the number of driver agents adopting AFVs will influence the coming of new station owner agents and survival of existing station owner agents. The number of driver agents adopting AFVs will influence AFVs’ technological learning effect, and in turn, the technological learning effect will influence the cost of AFVs and thus influence the number of driver agents adopting AFVs.


                        Stochasticity: Driver agents’ intervals of buying a new vehicle follow a normal distribution.


                        Observation: The number of driver agents adopting AFVs and the number of refueling stations are recorded step by step. The dynamics (coming, existing, and disappearing) of station owner agents are displayed on a GIS map step by step.

In the case study presented in Section 5, the simulations begin with 8000 driver agents, 0.05% of whom are assumed to have adopted AFVs. The living and working places are initialized based on the spatial distribution of population and GDP in Shanghai. In different simulations, the layout of initial refueling stations could be initialized differently (for studying what type of layout is better for the diffusion of AFVs). The initial cost of AFVs is set based on the evaluation of the average cost of AFVs. The road network includes the main roads in Shanghai. Driver agents’ living and working places are determined following the spatial distribution of Shanghai's population and GDP (Gross Domestic Production). Driver agents’ driving routes to attractions (e.g., shopping malls) are generated randomly following a Poisson distribution.

In the current model, with initialization, the simulation process is not affected by external (or environmental) dynamics. In the future, we would consider including external dynamics in the price of gasoline, number of driver agents, and so on.

A driver agent will update his/her vehicle after a certain number of years, which exhibits a normal distribution. When updating his/her vehicle, a driver agent will evaluate the utility of using an AFV, as shown in Eq. (A.1):
                              
                                 (A.1)
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             =
                                          
                                          
                                             
                                                FixedBenefit
                                                +
                                                VariableBenefit
                                                ×
                                                Distan
                                                ceTraveled
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                SocialValue
                                                −
                                                Concern
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where u represents a driver agent's utility of using an AFV. FixedBenefit represents the benefit of the lower cost of buying an AFV with a government subsidy. Because an AFV is usually more expensive than a traditional vehicle, the FixedBenefit variable can be negative. As more drivers switch to AFVs, their cost could decrease as a result of the technological learning effect (Arrow, 1962), and thus, the FixedBenefit could increase. VariableBenefit represents the energy cost savings per kilometer when using an AFV. Government subsidies for alternative fuel and carbon tax policies for fossil fuels will influence the VariableBenefit. DistanceTraveled denotes how many kilometers the driver agent drives. SocialValue represents the social value of a driver's pride in being environmentally friendly or being a user of advanced technology and the reduction of maintenance costs once AFVs are widely diffused
                              2
                           
                           
                              2
                              With a greater adoption of one type of AFVs, there will be more service centers for the maintenance of that type of AFVs. Thus, the maintenance will be more convenient, and the price of maintenance might decrease with competition.
                           . Concern represents a driver's concern about the availability of refueling stations. If a driver has found that there are few refueling stations during his/her past driving experience, then his/her Concern will be large; thus, the utility will be negative and he/she will not adopt an AFV. If few people adopt AFVs, the technological learning effect will be weak and AFVs will remain expensive. A driver's Concern is determined by his/her driving route as well as the distribution of refueling stations. For the driver agents, there will be a don't-worry distance, designated as DWD. If a driver can find the next refueling station within DWD, he/she will not worry about refueling.

The dynamics of a driver agent's FixedBenefit of adopting an AFV in Eq. (A.1) is calculated with Eq. (A.2):

                              
                                 (A.2)
                                 
                                    
                                       FixedBenefit
                                       =
                                       
                                          C
                                          F
                                       
                                       −
                                       C
                                       
                                          (
                                          Q
                                          )
                                       
                                       
                                          (
                                          
                                             1
                                             −
                                             Subsidy
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           where CF
                            denotes the cost of purchasing a traditional vehicle, which is treated as constant in the simulation, Subsidy denotes the percentage of the purchasing cost of an AFV that the government will pay to the driver agent, and C(Q) denotes the cost of an AFV when the cumulative production is Q.

With more driver agents switching to AFVs, the cost of an AFV decreases according to the technological learning effect (Arrow, 1962), described by Eq. (A.3):

                              
                                 (A.3)
                                 
                                    
                                       C
                                       
                                          (
                                          Q
                                          )
                                       
                                       =
                                       
                                          C
                                          0
                                       
                                       ×
                                       
                                          Q
                                          
                                             −
                                             b
                                          
                                       
                                       ,
                                    
                                 
                              
                           where C
                           0 denotes the initial cost of purchasing an AFV, Q denotes the cumulative production/purchasing,
                              3
                           
                           
                              3
                              In the model, we simply assume that the supply of and demand for AFVs are the same.
                            
                           b is the elasticity of investment cost with regard to cumulative production and it is easy to prove that 
                              
                                 1
                                 −
                                 
                                    2
                                    
                                       −
                                       b
                                    
                                 
                              
                            (which is called technological learning rate) is the percentage of cost reduction when cumulative production doubles.

The driver agents’ VariableBenefit is calculated with Eq. (A.4):

                              
                                 (A.4)
                                 
                                    
                                       VeraibleBenefit
                                       =
                                       
                                          E
                                          F
                                       
                                       −
                                       E
                                       ,
                                    
                                 
                              
                           
                        

where EF
                            denotes a traditional vehicle's fuel cost per kilometer and E denotes an AFV's fuel cost per kilometer. In our current version of the model, EF
                            and E are defined as constant values. In the long run, EF
                            and E may be dynamic as the price of gasoline and electricity are changing, which will be considered in our future work.

In the model, SocialValue is calculated with Eq. (A.5):

                              
                                 (A.5)
                                 
                                    
                                       BeliefSpace
                                       
                                       &
                                       
                                       V
                                       o
                                       l
                                       u
                                       m
                                       e
                                       =
                                       B
                                       +
                                       
                                          M
                                          F
                                       
                                       −
                                       
                                          M
                                          0
                                       
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                
                                                   
                                                      m
                                                      t
                                                   
                                                   M
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       ,
                                    
                                 
                              
                           where B denotes the social value of using an AFV and is defined as a driver agent's average annual income (see Schwoon, 2008), MF
                            denotes the monthly maintenance cost of a traditional vehicle, M
                           0 denotes the initial monthly maintenance cost of an AFV, 
                              
                                 m
                                 t
                              
                            denotes the number of driver agents using AFVs at time t, and M is the total number of driver agents.

When calculating a driver's utility (u) of using an AFV, the Concern calculated with Eq. (2) is transfer into currency with a design parameter λ, which can be thought of as the expected loss in worry for each kilometer.

A station owner agent will consider establishing a new refueling station if he/she finds that there are many (i.e., above a certain threshold) AFVs passing by a location. The establishment of new refueling stations will influence a driver's Concern, and thus the utility of using an AFV. Once a station is built, it will be operated for at least 6 months, and after that, it will be closed if the number of AFVs passing by it drops below a certain threshold.

A station owner agent's utility for building a new refueling facility is defined with Eq. (A.6):

                              
                                 (A.6)
                                 
                                    
                                       
                                          U
                                          s
                                       
                                       =
                                       TotalTraffic
                                       −
                                       Threshold
                                       ,
                                    
                                 
                              
                           where Us
                            denotes a station owner's utility, TotalTraffic is the number of AFVs passing through a location during a certain time period, and Threshold is a number indicating that, when there is a sufficient number of AFVs passing through a refueling station, the station can make a profit and therefore survive.

Whether a refueling station can make a profit and survive depends not only on how many potential consumers there are (i.e., the number of AFVs passing through the station) but also on the number of competitive stations. In our model, the Threshold is a function of the total number of AFV refueling stations as well as the distance to neighboring AFV stations, as shown in Eq. (A.7):
                              4
                           
                           
                              4
                              For a specific kind of AFV, it is better to perform a detailed study of the economics of establishing a new refueling station, which will be discussed in our future work.
                           
                           
                              
                                 (A.7)
                                 
                                    
                                       T
                                       h
                                       r
                                       e
                                       s
                                       h
                                       o
                                       l
                                       d
                                       =
                                       G
                                       +
                                       β
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          H
                                       
                                       
                                          
                                             1.0001
                                          
                                          
                                             
                                                D
                                                min
                                             
                                             −
                                             
                                                D
                                                i
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where G denotes the total number of existing AFV refueling stations, D
                           min  denotes the minimal distance between two neighbor nodes in the overall road network. Here, “nodes” mean the nodes of the road network. A road network is denoted with many nodes and links (or edges) in a GIS. D
                           min  indicates the shortest link (or edge) in the road network. It does not mean the minimal distance between two refueling stations. Di
                            denotes the distance between the location at which a new refueling station is considered to be built and its ith neighboring refueling station, and β is a design parameter signifying the weighted distance to its neighboring stations. It follows from Eq. (A.7) that more total AFV refueling stations as well as more and closer neighboring stations result in a higher Threshold. In our model, we set β = 10, which means that a very close neighboring refueling station will increase the Threshold by 10. With Eq. (A.7), two refueling stations can be in direct competition in the same neighborhood if there is a sufficient number of AFVs passing through their location, i.e., larger than the threshold calculated with Eq. (A.7) and thus both of them can have enough business to survive. Eq. (A.7) reflects our stylized assumption that each refueling station needs a certain number of customers to survive.

When the Us
                            for a location is positive, a refueling station for AFVs will be built there. Once a new refueling station is built, it will be operated for at least 6 steps. After 6 steps, if Us
                            becomes negative, then the station will be closed.

With the agent-based model, we can run computer simulations. A successful adoption process could be described as the following. In the beginning, there are few pioneer adopters of AFVs. With the initial refueling stations organized by the government, the technological learning effect causes the FixedBenefit to increase, and more drivers will adopt AFVs. As a result, more refueling stations will be built, further decreasing the drivers’ Concern and encouraging more drivers to adopt AFVs. More drivers adopting AFVs will result in a greater rate of technological learning and the establishment of more refueling stations, thus causing a beneficial cycle of the adoption of AFVs. Adoption could also devolve into a cycle of negative feedback and fail if the effect of technological learning is too weak, if government subsidies are insufficient, or if the layout of initial refueling stations is not appropriate.

Various existing traffic forecasting methods (e.g., Chrobok et al., 2005, Dia, 2001, Duffus et al., 1987, Tsekeris & Stathopoulos, 2006) can be used to generate the driving trips in an area for the agent-based model. These methods commonly require very intensive data collection and analysis. Considering that our model is not intended for traffic management or planning, we developed a simpler method as an alternative option (in addition to traditional methods) for users to generate driving trips for the ABM (Ma et al., 2014b). The method does not require extensive work to be performed on the data. It uses widely available social, economic, and spatial data as inputs to generate driving trips in an area. The method is described below.

Cities/areas are commonly composed of several districts, and statistical data, such as GDP and population size, are often widely available at the district level. Thus, our method uses statistical data at this level to generate driving trips. Compared with trips for other purposes, such as shopping and leisure, commuting trips are more fixed in terms of both time and space. As shown in Table B1
                     , commuting trips in a city/area can be divided into four major types resulting from the combinations of one's home and work place locations. For different cities/areas, the proportion of the four types of commute in Table B1 could be different.

Several driver agents’ homes may be very close, for example, in the same community. In the simulation, we simply assume that they are living in the same location, called a living quarter. Similarly, several driver agents’ work places may be very close, for example, in the same business park. In the simulation, we also simply assume that they are working in the same location, called a working quarter. As shown in Fig. B.1
                     , our method of generating commute driving trips begins with calculating the number of living quarters and working quarters in each district, using population and GDP data.

The number of living quarters in each district is calculated with Eq. (B.1):

                        
                           (B.1)
                           
                              
                                 L
                                 
                                    Q
                                    i
                                 
                                 =
                                 
                                    
                                       P
                                       i
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          P
                                          i
                                       
                                    
                                 
                                 ×
                                 m
                                 
                                    (
                                    
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       …
                                       m
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     where LQi
                      denotes the number of living quarters in the ith district of a city, Pi
                      denotes the resident population in the ith district, m denotes the total number of living quarters in the city/area, and m denotes the number of districts in the city.

The number of working quarters in each district is calculated with Eq. (B.2):

                        
                           (B.2)
                           
                              
                                 W
                                 
                                    Q
                                    i
                                 
                                 =
                                 
                                    
                                       G
                                       D
                                       
                                          P
                                          i
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          G
                                          D
                                          
                                             P
                                             i
                                          
                                       
                                    
                                 
                                 ×
                                 l
                                 
                                    (
                                    
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       …
                                       n
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     where WQi
                      denotes the number of working quarters in the ith district, l denotes the total number of working quarters, and GDPi
                      denotes the ith district's GDP.

After obtaining the number of living and working quarters in each district, they are randomly placed in each district in a GIS digital map. Then, each driver agent is randomly assigned a living quarter, and following the proportion of the four commute types in Table B1, each driver agent is randomly assigned a working quarter. Dijkstra's algorithm (Dijkstra, 1959) is applied for each driver agent to decide his/her commute route.
                        5
                     
                     
                        5
                        In reality, a driver might not select the shortest path. In this simplified method, we follow the SS model because the method is not used for traffic forecasting but for generating driving routes of representative agents.
                      Dijkstra's algorithm is one of the most popular algorithms for finding the shortest path between two locations and it is widely used in many GIS systems.

In addition to driving trips for one's commute, driving trips for other purposes are generated from the driver agents’ homes and attractions such as shopping malls. In addition, there are also randomly chosen driving trips. For each step, which denotes one month in our model, we assume that there are 20 two-way trips for one's commute, and a number of trips to attractions that follow a Poisson distribution with a mean of 8 and an upward limit of 10.

We tested the method with Shanghai and Beijing and found that the commute times produced by the method were in close agreement with survey results (Ma et al., 2014b), which provides some validation of the potential usefulness of the method.

In the original SS model (Stephan & Sullivan, 2004), agents live in a stylized space defined by a square, and the road network is defined by intersecting lines that form right angles. Most of the driver agents’ driving trips are for commuting. The driver agents’ homes and work places are initialized randomly in the square space. For each driver agent, the commuting trip is set to be the shortest path between his/her home and work place. The driver agents’ other driving trips are set from their homes to an attraction, e.g., a shopping mall. The stylized model can explain the complexity of the adoption process, but the simulations are far from realistic scenarios because they are not linked with a real social-economic background. To help decision makers find a close-to-optimal layout of the initial refueling stations, our simulations links the agent-based model with a real city/area's road network in a GIS as well as the city/area's social and economic background.

In recent years, with the rapid development of GISs, a large amount of spatial data is stored digitally in various GISs. Integrating these spatial data into agent-based models is an advance of the ABM approach, and researchers have focused increasingly greater attention on this effort (Gilbert 2007). The integration of ABMs and GISs still faces many of challenges, and the primary issue is that the software platform and technology of ABMs and GISs have been developed independently (Stanilov 2011).

The integration of ABMs and GISs can be classified into two types, grid-based integration and vector-based integration. The first type of integration is relatively simple. It replaces the square space with a polygon denoting an area's shape, but the main elements in the space are still grids. Most of the current integrations of ABMs and GISs are of this type. The second type integrates vectors denoting the space topology into an ABM. This type of integration is more complex, and it usually demands significant computational requirements (Stanilov 2011).

A city/area's road network in a GIS is stored mostly as vectors. Using Repast (North et al., 2013) as the ABM platform and ArcGIS (ESRI 2004) as the GIS platform, we explored a vector-based solution for linking the SS model with a real-road network. In our solution, Repast and ArcGIS work mostly independently from each other, and all of the communications between Repast and ArcGIS are realized through reading and writing operations on shapefiles in which spatial vectors are stored as two-dimensional tables. The data exchange works in both directions between Repast and ArcGIS at each simulation step. In the agent-based model, new refueling stations will be established and some old ones might be closed at each step, which will influence driver agents’ utility. Thus, at each step, Repast will obtain the position of all agents from ArcGIS's shapefile and write back the changing of station owners’ position to the shapefile; of course, visualization is another reason for returning to ArcGIS.

@&#REFERENCES@&#


                     
                        
                           [1]
                           Arrow, K.J. (1962). The economic implications of learning by doing. Review of Economic Studies. 29(3):155–173.

Chrobok, R., Kaumann, O., Wahle, J., Schreckenberg, M. (2005). Different methods of traffic forecast based on real data. European Journal of Operational Research, 155: 558–568.

Dia, H. (2001). An object-oriented neural network approach to short-term traffic forecasting. European Journal of Operational Research, 131: 253–261.

Dijkstra, E. (1959). A note on two problems with graphs. Numerical Mathematics. 1:267–271.

Duffus, L.N., Alfa, S.A., Soliman, A.H. (1987). The reliability of using the gravity model for forecasting trip distribution. Transportation, 14(3):175–192.

ESRI. (2004). ArcGIS Engine Developer Guide.

Gilbert, G.N. (2007). Advances in agent-based modeling, Agent-based models, SAGE publications. 68–90.

Grimm, V., Berger, U., Bastiansen, F., Eliassen, S., Ginot, V., Giske, J., Goss-Custard, J., Grand, T., Heinz, S.K., Huse, G., Huth, A., Jepsen, J.U., Jørgensen, C., Mooij, W.M., Müller, B., Pe'er, G., Piou, C., Railsback, S.F., Robbins, A.M., Robbins, M.M., Rossmanith, E., Rüger, N., Strand, E., Souissi, S., Stillman, R.A., Vabø, R., Visser, U., DeAngelis, D.L. (2006). A standard protocol for describing individual-based and agent-based models. Ecological Modelling, 198: 115–126.

Ma T.J., Zhao J.J., Xiang S.J., Zhu Ya., Liu Peipei. (2014a). An agent-based training system for optimising the layout of AFVs' initial filling stations, Journal of Artificial Societies and Social Simulation. 17 (4) 6, available at: http://jasss.soc.surrey.ac.uk/17/4/6.html.

Ma, T.J., Zhu, Y., Liu, P.P., Chi, C.J. (2014b). A simulation method to generate commute trips—for agent-based modeling on co-diffusion of alternative fuel vehicles and their filling stations. Simulation, 90(5), 560–569.

North, M.J., N.T. Collier, J. Ozik, E. Tatara, M. Altaweel, C.M. Macal, M. Bragen, and P. Sydelko. (2013). Complex Adaptive Systems Modeling with Repast Simphony. Complex Adaptive Systems Modeling, Springer, Heidelberg, FRG. http://www.casmodeling.com/content/1/1/3.

Schwoon, M. (2008). Learning by doing, learning spillovers and the diffusion of fuel cell vehicles. Simulation Modelling Practice and Theory. 16:1463–1476.

Stanilov, K. (2011). Space in agent-based models, Agent-based models of geographical systems, Springer. 253–269.

Stephan, C., Sullivan, J. (2004). An agent based hydrogen vehicle/infrastructure model. In Proceedings of the congress on evolutionary computation, IEEE, New York. 1774–1779.

Tsekeris, T., Stathopoulos A. (2006). Gravity models for dynamic transport planning: Development and implementation in urban networks. Journal of Transport Geography. 14: 152–160.

@&#REFERENCES@&#

