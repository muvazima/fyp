@&#MAIN-TITLE@&#A novel relative entropy–posterior predictive model checking approach with limited information statistics for latent trait models in sparse 
                  
                     
                        2
                     
                     
                        k
                     
                  
                contingency tables

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel Relative Entropy–Posterior Predictive Model Checking method is proposed.


                        
                        
                           
                           RE–PPMC with limited information checks the model fitness effectively.


                        
                        
                           
                           Compared with the original PPMC with PPP value, RE value is better.


                        
                        
                           
                           Compared with parametric bootstrapping, RE–PPMC is more feasible.


                        
                        
                           
                           The univariate information is robust with dual characteristics.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Goodness-of-fit

Latent trait model

Limited information statistics

Parametric bootstrapping

Posterior predictive model checking

Relative entropy

@&#ABSTRACT@&#


               
               
                  Limited information statistics have been recommended as the goodness-of-fit measures in sparse 
                        
                           
                              2
                           
                           
                              k
                           
                        
                      contingency tables, but the 
                        p
                     -values of these test statistics are computationally difficult to obtain. A Bayesian model diagnostic tool, Relative Entropy–Posterior Predictive Model Checking (RE–PPMC), is proposed to assess the global fit for latent trait models in this paper. This approach utilizes the relative entropy (RE) to resolve possible problems in the original PPMC procedure based on the posterior predictive 
                        p
                     -value (PPP-value). Compared with the typical conservatism of PPP-value, the RE value measures the discrepancy effectively. Simulated and real data sets with different item numbers, degree of sparseness, sample sizes, and factor dimensions are studied to investigate the performance of the proposed method. The estimates of univariate information and difficulty parameters are found to be robust with dual characteristics, which produce practical implications for educational testing. Compared with parametric bootstrapping, RE–PPMC is much more capable of evaluating the model adequacy.
               
            

@&#INTRODUCTION@&#

Dichotomous data with 
                        k
                      items are common in social sciences and are considered as 
                        
                           
                              2
                           
                           
                              k
                           
                        
                      contingency tables in the context of statistics. Latent variable models (LVM; for an overview, see  Bartholomew et al., 2011) provide a unified framework for the analysis of the latent structure of complex data. In particular, when the observed variables are categorical with continuous latent variables, it is referred to as a latent trait model (LTM). Note that, the LTM is often otherwise known as the item response theory (IRT) model. This type of models has been widely applied in many fields, especially for educational testing (e.g., to measure students’ abilities or to estimate item difficulty). There are several parametric estimation methods for LTM, e.g., the expectation maximization (EM) algorithm (Bock and Aitkin, 1981; An and Bentler, 2012), and the Bayesian approach (Patz and Junker, 1999; Yuen and Kuok, 2011; Yuen and Mu, 2012).

However, the goodness-of-fit problem, which is an important step in the model building sequence, has not been completely solved. Traditional approaches include the Pearson chi-squared 
                        
                           (
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                           )
                        
                      and the log-likelihood ratio 
                        
                           (
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                           )
                        
                     , but they degenerate when the number of data points 
                        N
                      is not sufficiently large and the number of items 
                        k
                      is not small (e.g.,  
                        k
                      is around 10 but 
                        N
                      is about 1500). In this case, the contingency tables are very sparse, since the total number of cells increases exponentially as 
                        k
                     increases. For example, 
                        
                           
                              2
                           
                           
                              k
                           
                        
                      is around 103 or 106 when 
                        k
                      is 10 or 20, respectively.

To address this problem, Bartholomew and Leung (2002) suggested using test statistics 
                        
                           (
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           )
                        
                      in which information was only the second-order margin, and its distribution was approximated via a linear transformation of the chi-squared random variable by matching moments under the simple null hypothesis. Cai et al. (2006) incorporated the Jacobian to construct the covariance matrix of residuals under the composite null hypotheses. These are called the limited information statistics, compared with full information such as 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              G
                           
                           
                              2
                           
                        
                     , since only the low-order margins are utilized. Maydeu-Olivares and Joe (2005) provided the theoretical framework for limited and full information. The limited information statistics approach is suitable for handling the sparseness problem, as the low-order margins are less likely to be insufficiently filled than the response cells. Furthermore, the low-order margins are quite sufficient to identify a LTM (Maydeu-Olivares and Joe, 2006). Nevertheless, the inversion of the asymptotic covariance matrix of the low-order residuals imposes computational problems (Maydeu-Olivares and Joe, 2008).

Instead of taking the asymptotic 
                        p
                     -values of test statistics with complicated variance–covariance matrix and its inverse, the parametric bootstrapping (PB) produces an empirical 
                        p
                     -value by sampling from the parametric null distribution from a frequentist perspective. A number of researchers (Langeheine et al., 1996; Bartholomew and Tzamourani, 1999; Genest et al., 2009) recommended the use of a PB procedure for full information statistics. Tollenaar and Mooijaart (2003) and Mavridis et al. (2007) investigated the appropriateness of using limited information statistics as well as full information statistics, but found the asymptotic and PB 
                        p
                     -values are different, especially in the case of full information statistics. Moreover, PB is time-consuming when the latent variable dimension is larger than one.

Another alternative is Bayesian inference, which provides not only an optimal estimation of the parameters but also the associated uncertainty. One well-known approach is the posterior predictive model checking (PPMC). The aim is to compare the observed data with replicated samples generated from the posterior distribution using a number of discrepancy measures. If the posited model is appropriate, the generated data and associated statistics will be similar to the originals. This concept was originated by Rubin (1984), and was later extended to include general discrepancies by Gelman et al. (1996a). Constructing the graph of the realized and predictive distributions was recommended in the literature (Gelman et al., 1996a; Sinharay et al., 2006; Levy, 2011) to assess model fit, together with the posterior predictive 
                        p
                     -value (PPP-value). Sinharay et al. (2006) and Levy (2011) applied PPMC to IRT in order to examine item and person fit instead of global fit. In the present paper, we propose the Relative Entropy–Posterior Predictive Model Checking (RE–PPMC) approach to complement the original procedure so that an arbitrary assertion of graphical comparison can be avoided. The discrepancy measures used in this paper are full and limited information statistics, which are designed to assess model fit at the test rather than the item- or person-levels. Moreover, multi-dimensional models as well as a unidimensional model are considered.

The paper is organized as follows: Section  2 presents the theoretical framework of the LTM; Section  3 describes discrepancy measures including full and limited information statistics; Section  4 introduces the procedure of the proposed RE–PPMC method; Section  5 reports simulation studies to investigate the performance of RE–PPMC and compares it with the original PPMC and PB; Section  6 analyzes some previously studied real data sets to illustrate additional insights of the proposed method.

LVM provides a unified framework for the interpretation of multivariate data, and it is applicable to various research disciplines. One of its purposes is for dimension reduction, i.e., to reduce a large number of observed variables or items 
                        
                           (
                           k
                           )
                        
                      to a much smaller number 
                        
                           (
                           q
                           )
                        
                      of latent variables. Although Leung (2008) conducted three-dimensional analysis 
                        
                           (
                           q
                           =
                           3
                           )
                        
                        ,
                        q
                      was in most cases either 1 or 2 for categorical manifest variables. A further purpose is to measure certain latent quantities, e.g., cognitive abilities, and another to achieve conditional independence in order to explain inter-dependence among all 
                        k
                      items.

Both manifest and latent variables can be continuous and categorical. In this paper, we focus on cases with binary manifest variables and continuous latent variables. Because the major model development in this area has stemmed from the field of educational and psychological testing, where the latent variables are conceived as traits, they are referred to as latent trait models (LTMs), or more usually the IRT model. The emphasis of this study is on proposing a novel method of checking model fit for LTMs. We concentrate on models with one or two factors.

The specifications of one- and two-factor LTMs for binary data are described as follows. The vector of manifest variables is denoted by 
                        
                           x
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                      with 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        =
                        0
                      or 1; and the vector of latent variables is denoted by 
                        
                           z
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       q
                                    
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                     . Let 
                        p
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           1
                           ∣
                           
                              z
                           
                           ,
                           
                              α
                           
                           )
                        
                      denote the probability of a positive response to item 
                        i
                      (i.e.,  
                        
                           
                              x
                           
                           
                              i
                           
                        
                        =
                        1
                     ) given latent student ability value 
                        
                           z
                        
                      with parameters 
                        
                           α
                        
                     . According to Bartholomew et al. (2011), this probability is given by: 
                        
                           (1)
                           
                              p
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    z
                                 
                                 ,
                                 
                                    α
                                 
                                 )
                              
                              =
                              
                                 
                                    exp
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             q
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                                 
                                    1
                                    +
                                    exp
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             q
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              k
                              ,
                           
                        
                      where 
                        
                           
                              α
                           
                           
                              i
                              0
                           
                        
                      is the ‘difficulty’ parameter of item 
                        i
                      in education testing; and 
                        
                           
                              α
                           
                           
                              i
                              j
                           
                        
                        
                        
                           (
                           j
                           =
                           1
                           ,
                           
                           …
                           ,
                           q
                           )
                        
                      are the factor loadings, also known as ‘discrimination’ parameters. Define a 
                        k
                     -vector 
                        
                           
                              
                                 α
                              
                           
                           
                              0
                           
                        
                      that contains all 
                        
                           
                              α
                           
                           
                              i
                              0
                           
                        
                        
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           k
                           )
                        
                     ; a 
                        k
                     -vector 
                        
                           
                              
                                 α
                              
                           
                           
                              j
                           
                        
                        
                        
                           (
                           j
                           =
                           1
                           ,
                           …
                           ,
                           q
                           )
                        
                      that contains all 
                        
                           
                              α
                           
                           
                              i
                              j
                           
                        
                        
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           k
                           )
                        
                     ; and the 
                        k
                        ×
                        
                           (
                           q
                           +
                           1
                           )
                        
                     -matrix 
                        
                           α
                        
                      that contains all model parameters, i.e.,  
                        
                           α
                        
                        =
                        
                           (
                           
                              
                                 
                                    α
                                 
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 
                                    α
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    α
                                 
                              
                              
                                 q
                              
                           
                           )
                        
                     . For the one-factor model, 
                        q
                        =
                        1
                     ; and for the two-factor model, 
                        q
                        =
                        2
                     . One of the objectives of this paper is to investigate the effects of under- and over-fitting, so both the one- and two-factor models are considered.

The latent variables 
                        
                           z
                        
                      are assumed to follow independent standard normal distributions. Then the (unconditional) probability of the 
                        r
                     th observed response pattern 
                        
                           
                              
                                 x
                              
                           
                           
                              r
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       k
                                    
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                      can be written as 
                        
                           (2)
                           
                              p
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       r
                                    
                                 
                                 ∣
                                 
                                    α
                                 
                                 )
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    +
                                    ∞
                                 
                              
                              ϕ
                              
                                 (
                                 
                                    z
                                 
                                 )
                              
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       [
                                       p
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                r
                                                i
                                             
                                          
                                          =
                                          1
                                          ∣
                                          
                                             z
                                          
                                          ,
                                          
                                             α
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       [
                                       1
                                       −
                                       p
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                r
                                                i
                                             
                                          
                                          =
                                          1
                                          ∣
                                          
                                             z
                                          
                                          ,
                                          
                                             α
                                          
                                          )
                                       
                                       ]
                                    
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                              
                                 d
                              
                              
                                 z
                              
                              ,
                              
                              r
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    2
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                      where 
                        ϕ
                        
                           (
                           ⋅
                           )
                        
                      is the probability density function of the standard normal random variable. For convenience of notation, define 
                        
                           
                              p
                           
                           
                              r
                           
                        
                        
                           (
                           
                              α
                           
                           )
                        
                        ≡
                        p
                        
                           (
                           
                              
                                 
                                    x
                                 
                              
                              
                                 r
                              
                           
                           ∣
                           
                              α
                           
                           )
                        
                     . The likelihood function is then expressed as 
                        
                           (3)
                           
                              p
                              
                                 (
                                 
                                    X
                                 
                                 ∣
                                 
                                    α
                                 
                                 )
                              
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    r
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          α
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          N
                                          f
                                       
                                       
                                          r
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              f
                           
                           
                              r
                           
                        
                      is the observed frequency of the 
                        r
                     th response pattern.

For 
                        k
                      dichotomous items, there are 
                        
                           
                              2
                           
                           
                              k
                           
                        
                      response patterns. The vector of the sample (observed) frequencies for all response patterns is denoted by 
                        
                           f
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                     . The corresponding vector of the true probabilities under the model is denoted by 
                        
                           p
                        
                        
                           (
                           
                              α
                           
                           )
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       α
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       α
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       α
                                    
                                    )
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                     . The elements of the vector 
                        
                           p
                        
                        
                           (
                           
                              α
                           
                           )
                        
                      can be computed from the Eq. (2). Then the vector of the estimated probabilities under the fitted model is denoted by 
                        
                           p
                        
                        
                           (
                           
                              
                                 
                                    α
                                 
                              
                              
                                 ˆ
                              
                           
                           )
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 )
                              
                           
                           
                              ′
                           
                        
                     , where 
                        
                           
                              
                                 α
                              
                           
                           
                              ˆ
                           
                        
                      is the estimator of 
                        
                           α
                        
                     . The global fit (or test-level model fit) is assessed through the discrepancy between the estimated probabilities 
                        
                           p
                        
                        
                           (
                           
                              
                                 
                                    α
                                 
                              
                              
                                 ˆ
                              
                           
                           )
                        
                      and sample frequencies 
                        
                           f
                        
                     .

This paper focuses on the goodness-of-fit measures with limited information statistics based on low-order margins denoted as 
                        
                           
                              Y
                           
                           
                              l
                           
                        
                        
                        
                           (
                           l
                           ≤
                           5
                           )
                        
                     , with full information statistics 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      provides for comparison purposes.

The Pearson chi-square 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and the likelihood ratio 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         compare the observed and estimated frequencies across all response patterns. They are defined as follows: 
                           
                              
                                 (4)
                                 
                                    
                                       
                                          χ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   N
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   −
                                                   N
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      α
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 (5)
                                 
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    2
                                    N
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                α
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    ln
                                    
                                       (
                                       
                                          
                                             N
                                             
                                                
                                                   f
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             N
                                             
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

Their asymptotic distributions are the chi-square distribution with 
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           −
                           k
                           
                              (
                              q
                              +
                              1
                              )
                           
                           −
                           1
                         degrees of freedom. However, the asymptotic 
                           p
                        -value (the 
                           p
                        -value calculated from the asymptotic distribution of the test statistics under the null hypothesis) fails to reveal the nature of the discrepancy in the case of the assumed model in sparse tables. To obtain reliable 
                           p
                        -values, the strategy of generating the empirical sampling distribution of goodness-of-fit statistics (
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                        ) using PB has been proposed (Langeheine et al., 1996; Tollenaar and Mooijaart, 2003).

Limited information statistics are closely related to the orders of margins. Let the estimated univariate (i.e. first-order margin) probabilities be 
                           
                              
                                 
                                    π
                                 
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    
                                       α
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           =
                           
                              {
                              p
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              k
                              }
                           
                        , and the estimated second-order margin probabilities 
                           
                              
                                 
                                    π
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       α
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           =
                           
                              {
                              p
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 1
                                 |
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              ,
                              i
                              ,
                              j
                              =
                              1
                              ,
                              …
                              ,
                              k
                              ,
                                and  
                              i
                              <
                              j
                              }
                           
                         and so on. Low-order probabilities can be obtained using a 
                           
                              (
                              
                                 
                                    
                                       k
                                    
                                 
                                 
                                    
                                       l
                                    
                                 
                              
                              )
                           
                           ×
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                         indicator matrix 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 l
                              
                           
                         such that 
                           
                              
                                 
                                    π
                                 
                              
                              
                                 l
                              
                           
                           
                              (
                              
                                 
                                    
                                       α
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    M
                                 
                              
                              
                                 l
                              
                           
                           
                              p
                           
                           
                              (
                              
                                 
                                    
                                       α
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           
                           
                              (
                              l
                              =
                              1
                              ,
                              2
                              ,
                              …
                              )
                           
                         (Maydeu-Olivares and Joe, 2005). Taking an example of 
                           k
                           =
                           3
                        , this relationship can be written as follows: 
                           
                              (6)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                         where 
                           
                              p
                           
                           
                              (
                              
                                 
                                    
                                       α
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          
                                             (
                                             0
                                             
                                             0
                                             
                                             0
                                             )
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          
                                             (
                                             1
                                             
                                             0
                                             
                                             0
                                             )
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          
                                             (
                                             1
                                             
                                             1
                                             
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         is the 23-vector that contains the probabilities for all possible response patterns; e.g.,  
                           
                              
                                 p
                              
                              
                                 
                                    (
                                    1
                                    
                                    0
                                    
                                    0
                                    )
                                 
                              
                           
                         is the probability of responding to the first item positively and the other two negatively.

The first-order margin contains no information about dependencies among the items, but the margins with second order or above are able to capture this information. The low-order marginal frequencies are seldom sparse even in small data sets. Bartholomew and Leung (2002) proposed the 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         statistics on the second-order margin: 
                           
                              (7)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                N
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                N
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       N
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   α
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      α
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 f
                              
                              
                                 i
                                 j
                              
                           
                         is the sample proportion responding positively to both items 
                           i
                         and 
                           j
                        ; and 
                           
                              
                                 p
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              
                                 
                                    
                                       α
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         is the corresponding probability estimated from the fitted model.

In this paper, limited information statistics 
                           
                              
                                 Y
                              
                              
                                 l
                              
                           
                         are considered and defined as follows: 
                           
                              (8)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 N
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   f
                                                
                                             
                                             
                                                l
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   π
                                                
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             diag
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             f
                                          
                                       
                                       
                                          l
                                       
                                    
                                    −
                                    
                                       
                                          
                                             π
                                          
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    f
                                 
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 
                                    M
                                 
                              
                              
                                 l
                              
                           
                           
                              f
                           
                        ; and 
                           
                              
                                 
                                    Ω
                                 
                              
                              
                                 l
                              
                           
                           =
                           
                              
                                 
                                    M
                                 
                              
                              
                                 l
                              
                           
                           
                              (
                              
                                 diag
                              
                              
                                 (
                                 
                                    p
                                 
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 )
                              
                              −
                              
                                 p
                              
                              
                                 (
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       (
                                       
                                          
                                             
                                                α
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              )
                           
                           
                              
                                 
                                    M
                                 
                              
                              
                                 l
                              
                              
                                 
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        . The uncertainties of these statistics will be handled by the proposed RE–PPMC method, as described in the next section.

Our objective is to develop a Bayesian procedure to quantify the discrepancy between a prescribed LTM and the observed data. In this approach, relative entropy based on posterior predictive model checking is proposed to assess the goodness-of-fit.

Let 
                           p
                           
                              (
                              
                                 θ
                              
                              )
                           
                         denote the prior distribution of the parameters; and let 
                           p
                           
                              (
                              
                                 X
                              
                              ∣
                              
                                 θ
                              
                              )
                           
                         be the likelihood function of a parameter model, where the vector of the unknown parameters 
                           
                              θ
                           
                         contains two groups of components: item parameters 
                           
                              α
                           
                         and latent variables (nuisance parameters here) 
                           
                              z
                           
                        . Then the posterior probability distribution of 
                           
                              θ
                           
                        , denoted by 
                           p
                           
                              (
                              
                                 θ
                              
                              ∣
                              
                                 X
                              
                              )
                           
                        , is proportional to the product of 
                           p
                           
                              (
                              
                                 X
                              
                              ∣
                              
                                 θ
                              
                              )
                           
                         and 
                           p
                           
                              (
                              
                                 θ
                              
                              )
                           
                        , according to the Bayes’ theorem. PPMC is a Bayesian method for assessing model fit by examining whether the posterior predictive distribution of replicated data 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 r
                                 e
                                 p
                              
                           
                         is consistent with the observed data 
                           
                              X
                           
                         (Rubin, 1984). The replicated data is drawn from the posterior predictive distribution: 
                           
                              (9)
                              
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          r
                                          e
                                          p
                                       
                                    
                                    ∣
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 ∫
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          r
                                          e
                                          p
                                       
                                    
                                    ∣
                                    
                                       θ
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       θ
                                    
                                    ∣
                                    
                                       X
                                    
                                    )
                                 
                                 
                                 
                                    d
                                 
                                 
                                    θ
                                 
                                 .
                              
                           
                        
                     

The difference between the replicated and observed data can be illustrated graphically, but only by the way of subjective judgment. To obtain an objective assessment, the PPP-value (Meng, 1994) is defined as the tail-area of the posterior predictive distribution for a selected discrepancy measure 
                           D
                           
                              (
                              ⋅
                              )
                           
                        : 
                           
                              (10)
                              
                                 PPP-value  
                                 =
                                 p
                                 
                                    (
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             r
                                             e
                                             p
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    ≥
                                    D
                                    
                                       (
                                       
                                          X
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    |
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 ∫
                                 I
                                 
                                    (
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             r
                                             e
                                             p
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    ≥
                                    D
                                    
                                       (
                                       
                                          X
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          r
                                          e
                                          p
                                       
                                    
                                    ∣
                                    
                                       θ
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       θ
                                    
                                    ∣
                                    
                                       X
                                    
                                    )
                                 
                                 
                                 
                                    d
                                 
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       r
                                       e
                                       p
                                    
                                 
                                 
                                 
                                    d
                                 
                                 
                                    θ
                                 
                                 ,
                              
                           
                         where 
                           I
                           
                              (
                              ⋅
                              )
                           
                         is the indicator function taking the value of 1 if its argument is true and 0 otherwise. Discrepancy measures should be capable of revealing any significant discrepancy between model prediction and data. In this study, we consider the full and limited information statistics described in Section  3 as the discrepancy measures. The difference between the realized discrepancy measure 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         based on the observed data, and the predictive measure 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         based on the replicated data, is indicative of misfit.

If the postulated model fits the data well, the replicated data 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 r
                                 e
                                 p
                              
                           
                         will be similar to the observed data 
                           X
                        , and hence the PPP-value will be around 0.5 (Bayarri and Berger, 2000). An extreme PPP-value (e.g., smaller than 0.05 or larger than 0.95) implies a poor fit (Sinharay et al., 2006). However, PPP-values are conservative in some cases, as it uses the indicator function, only counts number of data points where 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                           ≥
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                        , but not the magnitude.


                        Gelman et al. (1996a) mentioned that the plot of the realized discrepancy compared with the posterior predictive distribution was far more valuable than the PPP-value itself in most cases. However, the graphical assessment is ambiguous about the magnitude of discrepancies. In this paper, a novel RE–PPMC method which utilizes the information of the whole distribution is proposed to measure the difference between the realized and predictive distribution using the relative entropy (RE): 
                           
                              (11)
                              
                                 
                                    
                                       D
                                    
                                    
                                       K
                                       L
                                    
                                 
                                 
                                    (
                                    P
                                    ∥
                                    Q
                                    )
                                 
                                 =
                                 ∫
                                 ln
                                 
                                    (
                                    
                                       
                                          p
                                          
                                             (
                                             D
                                             
                                                (
                                                
                                                   X
                                                
                                                ,
                                                
                                                   θ
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          p
                                          
                                             (
                                             D
                                             
                                                (
                                                
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      r
                                                      e
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   θ
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    D
                                    
                                       (
                                       
                                          X
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    )
                                 
                                 
                                 
                                    d
                                 
                                 
                                    X
                                 
                                 
                                 
                                    d
                                 
                                 
                                    θ
                                 
                                 ,
                              
                           
                         where 
                           p
                           
                              (
                              D
                              
                                 (
                                 
                                    X
                                 
                                 ,
                                 
                                    θ
                                 
                                 )
                              
                              )
                           
                         and 
                           p
                           
                              (
                              D
                              
                                 (
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       r
                                       e
                                       p
                                    
                                 
                                 ,
                                 
                                    θ
                                 
                                 )
                              
                              )
                           
                         are the probability density functions (PDFs) of 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         and 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         respectively.

RE–PPMC is based on the general concept of relative entropy (also ‘Kullback–Leibler divergence’;  Kullback and Leibler, 1951; Sweeting et al., 2006), which is an asymmetric measure of the difference between two probability distributions. Specifically, it takes the expectation of the differences between two densities with respect to the realized posterior. The RE will yield a high value if the predictive data 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 r
                                 e
                                 p
                              
                           
                         is not close to the observed data 
                           
                              X
                           
                        . Therefore, the smaller the RE value, the better the model fits the data.

In practice, direct calculation of the integral in Eqs. (10) and (11) is computationally prohibitive, but it is more easily accomplished via Monte Carlo simulation. In other words, the required computation is typically a by-product of the usual Bayesian simulation, such as Markov chain Monte Carlo (MCMC), which provides a set of 
                           
                              θ
                           
                         drawn from the posterior distribution 
                           p
                           
                              (
                              
                                 θ
                              
                              ∣
                              
                                 X
                              
                              )
                           
                        .

The RE–PPMC procedure is introduced as follows.

Step 1: estimate the model parameters by the MCMC algorithm, and generate 
                           M
                         samples in the parameter space to obtain the posterior distribution for 
                           
                              θ
                           
                        . For more details, please refer to Appendix A.

Step 2: for each point 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 m
                              
                           
                         in the posterior distribution in Step 1, draw a replicated data set 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 r
                                 e
                                 p
                                 ,
                                 m
                              
                           
                        , and then compute the values of the realized and predictive discrepancy measures 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         and 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                    ,
                                    m
                                 
                              
                              ,
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         respectively.

Step 3: calculate the RE between the realized and predictive distributions, using the kernel density estimates to represent the PDFs of 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         and 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         respectively. This can be computed by using the function ‘ksdensity’ in MATLAB, with automatic bandwidth selection (Botev et al., 2010). The normal kernel function is used and evaluated at specified values in vector 
                           
                              
                                 
                                    (
                                    D
                                    
                                       (
                                       
                                          X
                                       
                                       ,
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    D
                                    
                                       (
                                       
                                          X
                                       
                                       ,
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             M
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             r
                                             e
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             r
                                             e
                                             p
                                             ,
                                             M
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             M
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 ′
                              
                           
                         respectively.

Step 4: assess the global fit using RE values: 
                           
                              (12)
                              
                                 
                                    
                                       D
                                    
                                    
                                       K
                                       L
                                    
                                 
                                 
                                    (
                                    P
                                    ∥
                                    Q
                                    )
                                 
                                 ≈
                                 
                                    
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 ln
                                 
                                    (
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             (
                                             D
                                             
                                                (
                                                
                                                   X
                                                
                                                ,
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             (
                                             D
                                             
                                                (
                                                
                                                   
                                                      
                                                         X
                                                      
                                                   
                                                   
                                                      r
                                                      e
                                                      p
                                                      ,
                                                      m
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 p
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              D
                              
                                 (
                                 
                                    X
                                 
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              )
                           
                         and 
                           
                              
                                 p
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              D
                              
                                 (
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       r
                                       e
                                       p
                                       ,
                                       m
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          θ
                                       
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              )
                           
                         are the kernel density estimates obtained in Step 3.

While the PPP-value only calculates the proportion of data points where 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         bigger than 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                        , the relative entropy value measures the magnitude of the discrepancy between two probability density functions 
                           p
                           
                              (
                              D
                              
                                 (
                                 
                                    X
                                 
                                 ,
                                 
                                    θ
                                 
                                 )
                              
                              )
                           
                         and 
                           p
                           
                              (
                              D
                              
                                 (
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       r
                                       e
                                       p
                                    
                                 
                                 ,
                                 
                                    θ
                                 
                                 )
                              
                              )
                           
                        . The PPP-value utilizes the tail area probability for the Bayesian test, and the RE value quantifies the information loss.

Though the PPP-value provides a straightforward criterion for comparing the realized discrepancy 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         and predictive discrepancy 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                        , it fails in certain other situations. Even if the PPP-value is around 0.5, it may represent different scenarios.  Fig. 1
                         shows a typical case of the realized and posterior predictive distributions for two different data sets in two different ways: 
                           x
                           –
                           y
                         plots and frequency distributions. In the upper layer, two 
                           x
                           –
                           y
                         plots of replicated against realized distributions are displayed. In the lower layer, correspondingly both realized and predictive frequency distributions are plotted in the same graphs for comparison.

According to Eq. (10), the PPP-value is estimated as the proportion of points above the 45° line in the upper layer of Fig. 1. Hence the PPP-values of the two scatterplots are close to 0.5, implying good fit in both cases. However, the standard deviation of predictive measures 
                           D
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    r
                                    e
                                    p
                                 
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         is much larger than that of realized measures 
                           D
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 θ
                              
                              )
                           
                         in the left top sub-plot, compared with the right top sub-graph. These distinctions are clearer in the graphs of the corresponding probability density function given in the lower layer of Fig. 1. For the data set in the left sub-plot, the distribution of realized discrepancy is peaked while the predictive one is flat, indicating model misfit. This is typically the case for full information and is described below. For the data set in the right sub-graph, the two curves are virtually overlapping, implying a good fit. Again, this is typical of limited information, as will be explained later.

The above-mentioned example shows that the PPP-value is insufficient to assess model fit, and that graphical assessment is therefore important. The PPP-value scale based on tail area probability has become ossified at cut-points that tend to exaggerate the evidence against the null (Berger and Sellke, 1987). In other words, this property of the PPP-value implies that the test could fail to reject an inadequate posited model. This typical conservatism was also noted by Meng (1994) and Rubin (1998). Robins et al. (2000) pointed out that the distribution of the PPP-value was concentrated around 0.5 but less dispersed than a uniform distribution, and thus had conservative performing characteristics.

Graphical display is a useful supplement but ambiguous on occasions, and it is desirable to develop an objective indicator for this purpose. The proposed RE–PPMC approach fulfils the goal. As mentioned above, the PPP-values of Fig. 1 are both close to 0.5, but the RE values are 1.07 and 0.01 respectively, indicating substantial underlying differences.

To verify the effectiveness and efficiency of the proposed method, simulated studies are used with different item numbers, factor dimensions and sample sizes. The true item parameters 
                        
                           α
                        
                      of three models used for data generating in simulation studies are listed in Table 1
                     . Based on Eq. (2), the true probabilities of each cell in Models 1, 2 and 3 are obtained. Sampling is accomplished by drawing 
                        N
                      random numbers from a uniform distribution in the interval (0,1) and classifying numbers into the cumulative true probability vectors to determine the frequency of each cell. Therefore, the simulated data sets under each simulated scenario are generated seriatim. The computer programs were written in MATLAB, version 7.14 for Windows 7 on an Intel Core i5, 2.9 GHz with 4 GB RAM, and the following results were based on this configuration.

In Model 1, there are five items with one factor (or latent variable), and only the first five items 
                        
                           (
                           k
                           =
                           5
                           )
                        
                      for 
                        
                           
                              α
                           
                           
                              0
                           
                        
                     ’s and 
                        
                           
                              α
                           
                           
                              1
                           
                        
                     ’s are applicable. These 
                        α
                     ’s are almost the same as the maximum likelihood estimates (MLE) of the Social Life Satisfaction (SLF) data (Bartholomew et al., 2011, p. 113). Hence, if the SLF data and simulated data are both generated from the one-factor LTM with similar parameters, the corresponding statistics will follow similar patterns, and this will be reported later. In Model 2, there are ten items 
                        
                           (
                           k
                           =
                           10
                           )
                        
                      with one factor, and all 
                        
                           
                              α
                           
                           
                              0
                           
                        
                     ’s and 
                        
                           
                              α
                           
                           
                              1
                           
                        
                     ’s in the second and third columns are used. Model 1 comprises the first five items of Model 2. In Model 3, there are ten items with two factors and all 
                        α
                     ’s (i.e.,  
                        
                           
                              α
                           
                           
                              0
                           
                        
                     ’s, 
                        
                           
                              α
                           
                           
                              1
                           
                        
                     ’s and 
                        
                           
                              α
                           
                           
                              2
                           
                        
                     ’s) are needed, and the vectors 
                        
                           
                              
                                 α
                              
                           
                           
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 α
                              
                           
                           
                              
                                 2
                              
                           
                        
                      are enforced to be orthogonal to each other so that a two-factor model is represented. These three models are selected to cover the cases of five and ten items with one and two factors.

Consider five values of 
                        N
                        ,
                        500
                        ,
                        1000
                        ,
                        1500
                        ,
                        3000
                      and 10,000, to investigate the effect of sample size on the goodness-of-fit. The first four values are commonly encountered in practice, while the last serves to illustrate the limiting behavior.

The above procedure simulates data from known null distribution and fits the same model. To demonstrate the effects of fitting an inappropriate model, some data sets are generated from alternative hypotheses. As described above, the main purpose of LTM is for data extraction and modeling of item interdependence, and the types of alternative considered are under- and over-fitting. Under-fitting refers to a fitted model that is insufficient to provide a reasonable representation of a data set, e.g. fitting the data drawn from Model 3 (a two-factor model) with a one-factor model in simulation studies. For over-fitting, a fitted model is over-fitted to the data with unnecessary excessive components to explain idiosyncrasies, e.g. fitting the data generated from Model 2 (a one-factor model) with a two-factor model in simulation studies.


                        Tables 2–4
                        
                        
                         report the PB 
                           p
                        -values, PPP-values and RE values respectively, where both fitting and data-generating models are associated with the same factor dimension.

In the case of PB, the 
                           p
                        -value is defined as the tail area from the observed discrepancy measures to the end, and so a 
                           p
                        -value <0.05 indicates statistical significance and hence poor fit. For all discrepancy measures and sample sizes, the 
                           p
                        -values are substantially larger than the significant 0.05 value, and most of them are larger than 0.2, implying good fit.

In the case of the PPMC method, the PPP-values around 0.5 indicate good fit. Results show that all PPP-values range from 0.4 to 0.6 for limited information statistics and all sample sizes, indicating good fit. The range of PPP-values based on the full information statistics is 0.2–0.9, showing a wide degree of goodness-of-fit, because of the vulnerability towards sparseness.

With the proposed RE–PPMC approach, the relative entropy is incorporated with PPMC to assess the goodness-of-fit. The smaller the RE value, the better the model fits the data. When full information statistics are used as discrepancy measures, the RE values are mostly larger than 1.0 for Models 2 and 3. For instance, in the case of Model 2 with 
                           N
                           =
                           1500
                        , the relative entropies of full information statistics (
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                        ) are 0.771 and 1.071 respectively. On the other hand, when limited information statistics are used, the RE values are very small, with only three values larger than 0.1 but less than 0.2. Again, in the same example, the RE values of the limited information statistics (
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                         to 
                           
                              
                                 Y
                              
                              
                                 5
                              
                           
                        ) are 0.010, 0.023, 0.043, 0.055 and 0.061 respectively. Hence, the RE value is much smaller in the case of limited information statistics.

To verify the results by RE–PPMC, graphical displays are used to visualize the performance of each discrepancy measure. If the model is adequate for the data, two curves will be similar or overlapping; in this case, the PPP-value is close to 0.5, and the RE value is very small, e.g. smaller than 0.1. For economy of space, only certain typical cases are selected for illustration, but others behave in a similar way. Fig. 2
                         compares the performance of graphical diagnostic assessment between full and limited information for Model 2 with 1500 examinees. The left top subplot shows that the predictive values of 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         are mostly larger than the realized values. The PPP-values of 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         are 0.758 and 0.575 respectively. These non-extreme values, especially in the case of 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                        , suggest good model fit. However, the top sub-graphs both demonstrate that the distribution of the realized discrepancy has an obvious sharp peak while the predictive discrepancy is much flatter, i.e. the standard deviation of the realized discrepancy is much smaller. The lower sub-plots provide graphical evidence of good fit when limited information statistics are used, where the predictive values are similar to the realized. Full information statistics are therefore not suitable to assess model fit using RE–PPMC, because full information statistics based on cells are more vulnerable than limited information in sparse 
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                         tables.

Overall, the proposed RE–PPMC with limited information statistics is preferable for checking model fit. From this point onwards, limited information statistics are considered to be the only discrepancy measures.

Here, the data sets are generated from the two-factor model and fitted with the one-factor model. Results are given in Table 5
                        . For 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                        , regardless of 
                           N
                         and models, all indicators, PB p-, PPP- and RE-values, suggest good fit. With PB, the 
                           p
                        -values of 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 4
                              
                           
                         are all statistically significant (i.e. <0.05), indicating under-fitness, but marginally significant in the case of 
                           
                              
                                 Y
                              
                              
                                 5
                              
                           
                         with 
                           N
                           =
                           1000
                         and 1500. Generally, the 
                           p
                        -value indicates poor fit in under-fitting cases but with only minor irregularities.

For small value of 
                           N
                           ,
                           500
                           ,
                           1000
                         or 1500, the PPP-values range from 0.4 to 0.6, and are not capable of indicating under-fitting. For example, when 
                           N
                           =
                           1500
                        , Fig. 3
                         shows that the curves of realized and predictive discrepancies virtually overlapping. In particular, the corresponding PPP-values are around 0.5 and the RE values between 0.1 and 0.2 for 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         to 
                           
                              
                                 Y
                              
                              
                                 4
                              
                           
                        , indicating some degree of under-fitness. In contrast, no significant discrepancy is detected in the graphs.

For larger value of 
                           N
                           ,
                           3000
                         or 10,000, the PPP-values deviate significantly from 0.5, indicating under-fitting, especially for when 
                           N
                           =
                           10
                           ,
                           000
                        . When 
                           N
                           =
                           3000
                        , the RE values for 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         to 
                           
                              
                                 Y
                              
                              
                                 5
                              
                           
                         are 0.915, 1.296, 1.144, and 0.755, respectively, implying discrepancies between the posited model and the data. The graphs indicate the same conclusion, where the two curves start separating. From Fig. 4
                        , the means of the realized distributions of 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         to 
                           
                              
                                 Y
                              
                              
                                 5
                              
                           
                         are larger than the predictive distributions with a shift of location, suggesting that the realized discrepancies are larger than the predictive ones, and hence demonstrate under-fitness. Moreover, the RE value expands with an increasing value of 
                           N
                        , where the two corresponding curves are further apart from each other. A similar phenomenon can be observed in the analysis of real data below.

The general pattern is that the larger the value of 
                           N
                         the larger the RE value and the proposed method is more capable of detecting under-fitting. In the simulation studies, good fit is associated with RE values which are of good fit if less than 0.1, while moderate fit is associated with RE values between 0.1–0.2; otherwise, poor fit is the result of RE values larger than 0.2. This will be used as a reference point in analyzing real data below.


                        Robustness of the first-order margins fit
                     

In the simulation studies, 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                         indicates good fit in all cases. In other words, the first-order margin is robust, and this is reflected in the difficulty parameter 
                           
                              
                                 α
                              
                              
                                 i
                                 0
                              
                           
                        ’s. Table 6
                         reports the true and estimated values of 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 0
                              
                           
                        , together with the first-order margins, and they are ordered according to the true value of 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 0
                              
                           
                         in the second column. The true and estimated values are similar for both the values of 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 0
                              
                           
                         and the first-order margins. The estimated difficulty parameters 
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 0
                              
                           
                         and first-order margins not only have the same ranking, but are also virtually correlated (correlation coefficient =0.994). To conclude, the number of factors has no effect on difficulty parameters.

The robustness of 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                         based on the first-order margins has a dual character. On the positive side, the difficulty parameters estimated from one factor or one-parameter IRT, including Rasch models, can be trusted even though the underlying models are of two or more factors. On the negative side, one should be aware that the models used may not be sufficient to explain the dependency among items, even though the univariate margins are satisfactorily fitted.

In this section, the data sets are simulated from the one-factor model but fitted with a two-factor model to study over-fitness (see Table 7
                        ). All empirical PB 
                           p
                        -values, PPP-values and RE values suggest good fit. This is consistent with the graphs which are similar to Fig. 2, with realized and predictive distributions overlapping. This is because the criteria used are discrepancy measures based on accuracy, without penalizing unnecessarily complicated parameterization. Hence, further research using other criteria and purposes is needed, e.g. utilizing Bayesian model class selection (Yuen, 2010).

Comparing the parameter estimates with the corresponding true values, the difficulty parameters 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 0
                              
                           
                         are also found to be robust. In addition, the true discrimination parameters 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 1
                              
                           
                         exhibit a linear relationship with the estimates 
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                         under the posited model in an over-fitting case (correlation coefficients of 0.884 and 0.826 respectively). These results explain the way in which all proposed statistics using PPMC and PB indicate good fit.

While PB uses the MLE for data generation, PPMC uses samplings from the posterior distribution of the parameters. Most computational effort in the case of PB is devoted to the MLE from each sample, e.g. using the EM algorithm. Furthermore, fitting a two-factor model is much more computationally expensive than a one-factor model, as it involves considerably more double integrals. The computational expense grows exponentially with the latent dimensions (or number of factors) and bootstrap-replicates. To the contrary, PPMC spends most of the computing time, around 85%, on building the posterior distribution through MCMC, and the rest 15% on computing the RE value. In this way, RE–PPMC is more efficient than PB, especially in the case of a two-factor model fit.

For one-factor models, both PB and RE–PPMC require approximately 20 min with 1000 bootstrap replicates and 5000 Markov-chain samples respectively. However, for Model 3 with two factors and 
                           k
                           =
                           10
                        , PB takes almost a whole day, while RE–PPMC takes only an hour. In a large-scale examination where the number of items 
                           k
                         is much larger than 10, assessing data-model fit via PB may take a month or a year, which is not feasible in practice. In short, RE–PPMC has critical advantages over PB in the terms of computational practicality for two or more factors and with large 
                           k
                        .

Previously studied real data sets are considered, in order to provide a clear exposition of the performance of the proposed method. The first is the SLF data described above, which has been analyzed in many studies. The second and third data sets consist respectively of the 10- and 8-item sexual attitude data (referred to ‘Sex10’ and ‘Sex8’) of the British Social Attitudes survey of 1990 (Bartholomew and Leung, 2002). The original data covered ten items (Sex10), but Bartholomew and Leung (2002) found that only eight items (Sex8) were lined up with one factor.

The sparseness problem is not serious in SLF data, as 
                           N
                           =
                           1490
                         and 
                           k
                           =
                           5
                        , but some cells have a frequency of less than 5. The 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         of one-factor LTM yield values of 38.92 and 39.09 respectively, both with 21 degrees of freedom, indicating poor fit at the 1% significance level. Bartholomew and Leung (2002) investigated the asymptotic results of the full information statistics, as none of the contributions from second- and third-order margins was individually larger than the critical values at the 5% level. They used 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         to analyze and suggested good fit when parameters are fixed at MLE. Cai et al. (2006) produced opposite results when the effect of parameter estimation was taken into account.

In fitting a one-factor model to SLF data, the MLE of parameter values are almost identical to those in Model 1 in this paper. Therefore, if the SLF data is generated from the one-factor LTM, one would expect the corresponding statistics and graphs to be very similar to those simulated from Model 1. Table 8
                        , however, reports dissimilar results. The PB 
                           p
                        -values indicate statistical significances which imply poor fit. Though the PPP values are close to 0.5, the graphs in Fig. 5
                         reveal some departure of the predictive posterior distribution from the realized. As graphs are associated with subjective interpretation, RE–PPMC provides an objective reference. Except 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                        , all RE values are larger than 0.2, indicating poor fit and consistency with PB results. Moreover, the RE values suggest further departures of the predictive posterior distribution from the realized in 
                           
                              
                                 Y
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 5
                              
                           
                         than those in 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 3
                              
                           
                        , and explain why 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 3
                              
                           
                         do not produce very large departures.

There has been no previous instance in the literature of a two-factor model for SLF data. When a two-factor model is used for data, goodness-of-fit as measured by traditional 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                           =
                           29.32
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                           =
                           28.82
                        , with 16 degrees of freedom, yields corresponding 
                           p
                        -values of 0.022 and 0.025 respectively. Nevertheless, good fit is suggested through PB, PPMC and RE–PPMC, especially with the RE values in Table 8 and the graphs in Fig. 6
                         displaying much better fit. This further supports the proposition that traditional 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         are not suitable for goodness-of-fit assessment. As a form of further explanation, the rotated standardized factor loadings are plotted in Fig. 7
                        , and the exact wording of items appears in Appendix B. There are two clear-cut factors extracted from all items. Items 1 and 5 are loaded on to one factor, related to ‘any people’, while items 2–4 are loaded on to the other, related to ‘poor people’. These all demonstrate the power of LTM to identify latent variables when the observed variables are binary.

The second example turns to a case of the problem of severe sparseness with 10 items and 1077 respondents. Traditional 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 G
                              
                              
                                 2
                              
                           
                         with asymptotic distributions are not invalid. Previous studies have shown poor fit with the one-factor model by measuring the observed second- and third-order margins (De Menezes and Bartholomew, 1996; Bartholomew and Leung, 2002; Bartholomew et al., 2002). Results are shown in Table 9
                        .

Except 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                        , the extreme empirical 
                           p
                        -values calculated from 1000 bootstrap samplings, reported in Table 9, show that one latent variable fails to explain attitudes towards sexual behavior. This is consistent with the corresponding results produced by all PPP-values of discrepancy measures except 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                        , all far from 0.5. The RE values are much larger than 1.0 (RE of 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         is 4.49 and the others are all infinite). The predictive values of the test statistics except 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                         are very different from the realized ones (shown in Fig. 8
                        ), providing stark evidence of the inadequacy of one-factor fit. For all limited information statistics except 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                        , the realized distribution always has a larger mean than the predictive distribution, indicating that these realized discrepancies are always larger than the predictive ones. When compared with those in simulation studies with 
                           N
                           =
                           1500
                         in the under-fitting case (i.e. Section  5.2), the one-factor model is obviously inadequate.

When the second factor is included, the PPP-values are close to 0.5. Comparing the RE values shown in Table 9 and the graphs in Figs. 8 and 9
                        , it is clear that fitting with a two-factor model is a considerable improvement. After checking 
                           
                              α
                           
                        , the first eight items are in one factor whilst the last two are in the other, the same conclusion reached by Bartholomew and Leung (2002).

Although all 
                           p
                        -values via PB and PPP-values indicate good fit, the RE values imply that there are some departures in the case of the two-factor model. The RE values ranging from 0.18 to 0.40, show a discernible improvement from a one-factor model, but they do not suggest a very good fit. One way to improve this is to remove items. Because the last two items, concerned with adoption by homosexual couples, give the major contribution to poor fit (Bartholomew and Leung, 2002; Bartholomew et al., 2002), further analysis is conducted with the last two items omitted and being denoted as Sex8.

Fitting a one-factor model to Sex8, the PPP-values are close to 0.5, but the RE values of 
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                         to 
                           
                              
                                 Y
                              
                              
                                 5
                              
                           
                         are 0.515, 1.048, 1.283 and 1.266, all larger than 0.2 and implying that the one-factor model is a poor fit. The 
                           p
                        -values based on PB are smaller than 0.05 (except 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                        ), again indicating poor fit. Hence, the fit with the one-factor model is still questionable, even after removing two items. (see Fig. 10
                        .)


                        Bartholomew and Leung (2002) reported fitting with 8 items on one-factor only; the present study adds to the analysis with the two-factor model. After adding another factor, the RE–PPMC results listed in Table 9 and the graphical assessment in Fig. 11
                         show that the two-factor model fits well and offers better interpretations in terms of 
                           
                              α
                           
                        .

The rotated standardized factor loadings for 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                              
                              
                                 2
                              
                           
                         are plotted in Fig. 12
                         with 8 items. Note that items 3 and 4 have low loadings on the first factor and high loadings on the second, while items 6–8 have high loadings in the second factor and low loadings on the first. These findings support a two-factor model. However, items 2 and 5 lie in between, making it difficult for analytical tools to distinguish first and second factor loadings. According to the item content (exact wording of items appears in Appendix B), the first factor is concerned with homosexuals teaching or holding public position (items 6–8), and the second factor can be interpreted as premarital and extramarital sexual relations (items 3 and 4). Items 2 and 5 focus on sexual discrimination.

@&#CONCLUSION@&#

Assessment of the goodness-of-fit for 
                        
                           
                              2
                           
                           
                              k
                           
                        
                      tables is a long-standing problem. Limited information statistics shed some light on the matter, but pose challenges in the calculation of the 
                        p
                     -values. This paper addresses the issue by proposing a novel approach, RE–PPMC.

From a series of simulation studies, RE–PPMC is a useful replacement for PPP-values to give a numerical measure complementing graphical display in PPMC, because complete information on the entire posterior distribution is utilized. It is found that RE with a value less than 0.1 indicates good fit, but that the higher the value the more a worse fit is implied. When this is applied to real data, it gives additional insight into that found previously.

In this paper, the effects of different order margins are investigated separately. It is important to practitioners that the estimation of the first-order margins is robust, enabling the difficulty parameters to be trustworthy, but it fails to detect the misfit of the underlying model with an inappropriate factor dimension, as shown in the simulation studies. The bivariate margins perform well in handling inter-dependence among variables. In this paper, we use LTM and restrict the order of margins to within five, but other models and higher order margins can easily be included in the existing framework.

There are two components of parameters: item parameters 
                        
                           α
                        
                      and ability parameters 
                        
                           z
                        
                     , with the latter being treated as the nuisance parameters. Gauss–Hermite quadrature in EM algorithm (Bock and Aitkin, 1981) is used to approximate the probabilities of observed response patterns 
                        
                           
                              p
                           
                           
                              r
                           
                        
                        
                           (
                           
                              α
                           
                           )
                        
                        ,
                        r
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              2
                           
                           
                              k
                           
                        
                     . Eq. (2) for the one-factor LTM can be written: 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 
                                    α
                                 
                                 )
                              
                              ≡
                              p
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       r
                                    
                                 
                                 ∣
                                 
                                    α
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ∏
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              π
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       i
                                    
                                 
                                 ∣
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    α
                                 
                                 )
                              
                              ,
                              
                              r
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    2
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                      where the posterior probability of 
                        
                           
                              x
                           
                           
                              r
                              i
                           
                        
                      given 
                        
                           
                              y
                           
                           
                              t
                           
                        
                      and 
                        
                           α
                        
                      is 
                        
                           
                              π
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       i
                                    
                                 
                                 ∣
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    α
                                 
                                 )
                              
                              =
                              
                                 [
                                 p
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          r
                                          i
                                       
                                    
                                    =
                                    1
                                    ∣
                                    
                                       
                                          y
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       α
                                    
                                    )
                                 
                                 ]
                              
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    r
                                    i
                                 
                              
                           
                        
                        
                           
                              
                                 [
                                 1
                                 −
                                 p
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          r
                                          i
                                       
                                    
                                    =
                                    1
                                    ∣
                                    
                                       
                                          y
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       α
                                    
                                    )
                                 
                                 ]
                              
                           
                           
                              
                                 
                                    1
                                    −
                                    x
                                 
                                 
                                    r
                                    i
                                 
                              
                           
                        
                     ; 
                        n
                      is the number of quadrature knots; 
                        
                           
                              y
                           
                           
                              t
                           
                        
                        
                           =
                        
                        
                           
                              u
                           
                           
                              t
                           
                        
                        /
                        
                           
                              2
                           
                        
                      (
                        
                           
                              u
                           
                           
                              t
                           
                        
                      are the roots of the Hermite polynomial, transforming 
                        
                           
                              u
                           
                           
                              t
                           
                        
                      is to avoid 
                        
                           
                              2
                           
                        
                      appearing in expansions); 
                        
                           
                              w
                           
                           
                              t
                           
                        
                      are the associated quadrature weights. For the two-factor LTM, the formula is 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 
                                    α
                                 
                                 )
                              
                              ≡
                              p
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       r
                                    
                                 
                                 ∣
                                 
                                    α
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    ∏
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              π
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       r
                                       i
                                    
                                 
                                 ∣
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    α
                                 
                                 )
                              
                              ,
                              
                              r
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    2
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                      Similar expression can be used in higher dimensions.

To estimate the item parameters 
                        
                           α
                        
                     , we use an Metropolis–Hastings (M–H) with Gibbs sampling algorithm (Patz and Junker, 1999). The M–H algorithm is a MCMC method using a proposal density and a technique for rejecting proposed moves. The Gibbs sampling is also a MCMC algorithm for obtaining a sequence of observations from the complex joint posterior distribution. The combination of these two strategies avoids the slow convergence of M–H algorithm and the calculation of the normalizing constants required in Gibbs sampling. To proceed we make the following assumptions. 
                        
                           (a)
                           All item parameters 
                                 
                                    α
                                 
                               are assumed to be a prior independent normal with mean 
                                 
                                    0
                                 
                               and variance 
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       2
                                    
                                 
                              . The prior density 
                                 h
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               is then given by 
                                 h
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ∣
                                    
                                       0
                                    
                                    ,
                                    
                                       
                                          
                                             σ
                                          
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              , where 
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                               is a diagonal variance matrix of the parameters related to item 
                                 i
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                              . Although the discrimination parameters are expected to be positive in many IRT applications, a normal prior allows greater generalizability (Béguin and Glas, 2001). From the simulation study, the estimates are not sensitive to different prior variances on 
                                 
                                    α
                                 
                              , as long as the prior variance is not close to zero. In the absence of prior knowledge, we assume that all variances are the same across the items.

For the M–H algorithm at each step, the next state is chosen by sampling a candidate from the proposal distribution 
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    ∣
                                    
                                       α
                                    
                                    )
                                 
                              , which is a PDF for 
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               that depends on 
                                 
                                    α
                                 
                              . A good proposal distribution should resemble the posterior distribution of the parameters. Here, the normal is assumed: 
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          
                                             ∗
                                          
                                       
                                    
                                    ∣
                                    
                                       α
                                    
                                    )
                                 
                                 =
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    ∣
                                    
                                       α
                                    
                                    ,
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              . The generating variance 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       2
                                    
                                 
                               will determine the results of acceptance probabilities, 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                              . Gelman et al. (1996b) recommended that 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       2
                                    
                                 
                               should be chosen to give the acceptance rates of about 50%. The symmetrical proposal distribution indicates 
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          
                                             ∗
                                          
                                       
                                    
                                    ∣
                                    
                                       α
                                    
                                    )
                                 
                                 =
                                 q
                                 
                                    (
                                    
                                       α
                                    
                                    ∣
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                              , so that 
                                 q
                                 
                                    (
                                    ⋅
                                    )
                                 
                               drops out the calculations of the acceptance probabilities.

The posterior distribution is proportional to the likelihood times the prior probability. 
                        M
                      Markov chain samples 
                        
                           {
                           
                              
                                 
                                    α
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    α
                                 
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    α
                                 
                              
                              
                                 M
                              
                           
                           }
                        
                      are simulated with a limiting stationary distribution equal to the target PDF 
                        p
                        
                           (
                           
                              α
                           
                           ∣
                           
                              X
                           
                           )
                        
                     . The details of an M–H within Gibbs sampling algorithm for obtaining the parameters 
                        
                           α
                        
                      at each transition step are descripted as follows. 
                        
                           1.
                           Draw a candidate state 
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                               from the proposal PDF 
                                 q
                                 
                                    (
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    ∣
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                               independently for each item 
                                 i
                              , where 
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                               is the current state 
                                 t
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                              .

Compute the acceptance probability density quotient for each item 
                                 i
                              : 
                                 
                                    
                                       Q
                                       
                                          (
                                          
                                             
                                                
                                                   α
                                                
                                             
                                             
                                                i
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   α
                                                
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   X
                                                
                                                ∣
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                             q
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ∣
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             p
                                             
                                                (
                                                
                                                   X
                                                
                                                ∣
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                             q
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ∣
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   r
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   r
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Accept 
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       i
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                               with the probability 
                                 min
                                 
                                    (
                                    1
                                    ,
                                    Q
                                    )
                                 
                              . Otherwise, set 
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       i
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          α
                                       
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                              .

For convergence diagnostics, we use the approach of Gelman and Rubin (1992): start several, say 3, chains at different initial values and check whether the results are the same among these three chains after 
                        M
                      (e.g.,  
                        =
                        10
                        ,
                        000
                     ) iterations. One of the initial values is MLE estimated from EM algorithm, and results converge within 5000 iterations. The first 1000 iterations are taken to be burn-in and discarded; and the remaining 4000 outputs are thinned by retaining every 4th state to get 1000 samples for computing RE and PPP-values.

Social life feelings survey: 
                        
                           1.
                           Anyone can raise his standard of living if he is willing to work at it.

Our country has too many poor people who can do little to raise their standard of living.

Individuals are poor because of the lack of effort on their part.

Poor people could improve their lot if they tried.

Most people have a good deal of freedom in deciding how to live.

Sexual attitude survey: 
                        
                           1.
                           Should divorce be easier here?

Do you support the law against sexual discrimination?

View on pre-marital sex: not at all wrong …always wrong

View on extramarital sex: not at all wrong …always wrong.

View on sexual relationship between individuals of the same sex: not at all wrong …always wrong.

Should gays teach in schools?

Should gays teach in higher education?

Should gays hold public positions?

Should a female homosexual couple be allowed to adopt children?

Should a male homosexual couple be allowed to adopt children?

@&#REFERENCES@&#

