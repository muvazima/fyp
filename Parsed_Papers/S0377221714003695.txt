@&#MAIN-TITLE@&#Bidding in sequential electricity markets: The Nordic case

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider sequential electricity markets.


                        
                        
                           
                           We develop a stochastic programming model for coordinated bidding.


                        
                        
                           
                           Our case study shows that there is significant gain from coordination.


                        
                        
                           
                           Coordination may become increasingly important with growth in renewables.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Stochastic programming

Scenario generation

Electricity markets

Bidding

@&#ABSTRACT@&#


               
               
                  For electricity market participants trading in sequential markets with differences in price levels and risk exposure, it is relevant to analyze the potential of coordinated bidding. We consider a Nordic power producer who engages in the day-ahead spot market and the hour-ahead balancing market. In both markets, clearing prices and dispatched volumes are unknown at the time of bidding. However, in the balancing market, the market participant faces an additional risk of not being dispatched. Taking into account the sequential clearing of these markets and the gradual realization of market prices, we formulate the bidding problem as a multi-stage stochastic program. We investigate whether higher risk exposure may cause hesitation to bid into the balancing market. Furthermore, we quantify the gain from coordinated bidding, and by deriving bounds on this gain, assess the performance of alternative bidding strategies used in practice.
               
            

@&#INTRODUCTION@&#

With 73% of the total physical power exchange in the Nordic region being traded at Nord Pool in 2011 (Nord Pool, 2011), this is Europe’s largest and most liquid market place for electricity. More specifically, Nord Pool operates the day-ahead spot market Elspot for the physical exchange of production and consumption. This market covers Norway, Sweden, Denmark, Finland and Estonia, and had 350 members and an impressive turnover of 294.4terawatthour in 2011.
                        1
                        In comparison, the intra-day adjustment market Elbas, which is likewise operated by Nord Pool, had 100 members and a turnover of only 2.7terawatthour.
                     
                     
                        1
                     
                  

Although the spot market facilitates day-ahead balancing of expected production and consumption, real-time imbalances may still occur. It is the responsibility of the local electricity system operator, e.g. in Norway, Statnett, in Sweden, Svenska Kraftnät, and in Denmark, Energinet.dk, to ensure the physical balancing of supply and demand by activation of so-called balancing or regulating power. There exists a common Nordic market for regulating power, referred to as the balancing market. Regulating power can therefore be activated anywhere in the Nordic region, although each transmission system operator clears the market locally. The balancing market has few members, e.g. in Denmark only 6. Despite a significant total supply of regulating power, total demand is much larger, which may be explained by a hesitation to enter this market.
                        2
                        It should be taken into account that part of the Danish demand for regulating power is usually covered by import from Norway and Sweden.
                     
                     
                        2
                      Furthermore, the need for supply of balancing services is expected to increase with the increasing growth in fluctuating renewable production, as pointed out by e.g. (Holttinen, 2008; Holttinen et al., 2009).

The above electricity market design applies not only in the Nordic region, but analogies to day-ahead spot and near real-time balancing markets are found in e.g. the Netherlands and Portugal/Spain, although with different bidding rules and market setups.

For electricity market participants able to engage in sequential markets such as the Nordic spot and balancing markets, it is relevant to analyze the potential of coordinated bidding. Nevertheless, a hesitation to enter the balancing market can sometimes be observed in practice. This motivates the following research questions: Can the hesitation be explained by differences in price levels and risk exposure between the two markets? Is it profitable to hold back capacity in the spot market to facilitate subsequent offering of up regulation, or to put forward capacity in the spot market such as to offer down regulation? If so, what is the gain from doing so?

To answer these questions, we consider a power producer who trades in a day-ahead spot market and an hour-ahead balancing market. In both markets, clearing prices and dispatched volumes are unknown at the time of bidding. However, in the balancing market, the market participant faces an additional risk of not being dispatched. Taking into account the sequential clearing of these markets and the gradual realization of market prices, we formulate the bidding problem as a multi-stage stochastic program.

Our contribution is threefold:
                        
                           •
                           We develop a multi-stage stochastic programming model for coordinated bidding into two sequential markets, taking into account market price uncertainty and existing market rules. This model can be used for market exchange irrespective of the production or consumption technology.

When generating market price scenarios, we put efforts into preserving autocorrelations and cross-correlations. Since separate scenario sampling and reduction may alter correlations, we alternate between the two methods in a stage-wise fashion.

To assess the performance of alternative bidding strategies used in practice, we derive bounds on the gain from coordinated bidding. These bounds can be computed without actually solving the multi-stage stochastic coordination problem.

The paper is organized as follows. Section 2 first provides an overview of electricity market bidding in the literature. We proceed to introduce the Nordic electricity markets, including the spot and balancing markets in Section 3, and formulate a multi-stage stochastic programming model for coordinated bidding into these markets in Section 4. Section 5 is concerned with the generation of market price scenarios that serve as input to the stochastic programming model. We derive bounds on the gain from coordinated bidding in Section 6, and numerically quantify this gain in Section 7. Section 8 concludes our analysis.

The problem of optimal electricity market bidding is an optimization problem under uncertainty, given that the outcome of market clearing is unknown at the time of bidding. Naturally, the formulations of and solutions to the bidding problem found in the literature reflect the variety of approaches to optimization under uncertainty.

One strand of literature is based on optimal control and dynamic programming, and focus on the characterization and derivation of closed-form solutions to the bidding problem. An example is Anderson and Philpott (2002) who formulate a non-linear control problem and find necessary conditions for optimality. In their formulation, the authors make use of a so-called market distribution function, representing the probability that a generator is not fully dispatched at a given bid price and volume. For a price-taker, this is equivalent to the probability that the bid price exceeds the realized market price at a given volume, which is also what we use. Whereas an efficient approach to solving the non-linear problem remains an open question, Neame, Philpott, and Pritchard (2003) derive optimality conditions for a hydroelectric reservoir with continuous output range, and solve the bidding problem by a discretization of this range and the application of dynamic programming. A similar approach is taken by Pritchard and Zakeri (2003) who likewise find offer curves for hydro reservoirs, and by Pritchard, Philpott, and Neame (2005) who decompose the hydropower optimization into an inter-stage scheduling problem and an intra-stage bidding problem. In general, it is difficult to handle complex constraints and multiple state variables by the optimal control approaches, and the bidding formulations may often account for operational restrictions only through the reward function, take into account only one market, and do not include the costs of non-compliance with the market commitments.

In contrast, mathematical programming formulations easily allow for various constraints, and furthermore, through the extension to stochastic programming, for multiple sources of uncertainty. Examples of bidding models for price-taking electricity producers are (Contreras, Candiles, de la Fuente, & Gómez, 2002; Fleten & Kristoffersen, 2007; Fleten & Pettersen, 2005; Ladurantaye, de Gendreau, & Potvin, 2007; Lu, Chow, & Desrochers, 2004; Ni, Luh, & Rourke, 2004). These models include many details such as ramping restrictions, capacity limits, storage balances, start-up costs, and risk constraints. Reviews on optimal electricity scheduling and market exchange have been given by Wallace and Fleten (2003) and Kristoffersen and Fleten (2010).

Here, we extend the work in Fleten and Kristoffersen (2007) to sequential markets. This problem has already been addressed by Plazas, Conjeo, and Prieto (2005) who consider bidding into three sequential short-term markets. For the Nordic markets, contributions include Fosso, Gjelsvik, Haugstad, Mo, and Wangensteen (1999) who consider production scheduling with a view towards the spot, balancing and futures markets, and Faria and Fleten (2011) who focus on the day-ahead Elspot market and intra-day Elbas market. To the best of our knowledge, very few have explicitly addressed the problem of coordinated bidding into the spot and balancing markets, the only example we could find being Olsson (2005). Whereas Fosso et al. (1999) model only price insensitive bids, Olsson (2005) assumes smooth bidding curves instead of the piece-wise linear curves prescribed by the market rules, and Plazas et al. (2005) do not distinguish between the process of bidding into the balancing market (before market clearing) and the settling of imbalances in this market (after market clearing). The major difference to previous work, however, is our modeling of market dynamics. Existing market models are static, making the sequential bidding problem two-stage or three-stage. In contrast, we capture the dynamics of the two markets in a multi-stage model such that spot market bidding decisions are day-ahead and balancing market decisions are hour-ahead.

With many details and the inclusion of uncertainty, mathematical programming models can be computationally hard and time consuming. Efforts to efficiently solve the bidding problem have been made by Klæboe (2011) who resorts to Bender’s decomposition, and Nascimento and Powell (2009) and Loehndorf, Wozabal, and Minner (2013) who apply approximate dynamic programming to integrate scheduling and bidding decisions for energy storage.

As an alternative to approximating the stochastic programming problem by cutting planes or simulation, we suggest to reduce computation time through careful generation of scenarios. Variations of scenario generation methods from the literature include (Høyland & Wallace, 2001, 2003) who propose moment/property matching by optimization or simulation. Another commonly used approach is to model the underlying stochastic processes, simulate a large number of sample paths/scenarios, and subsequently reduce this number by clustering. Central references on this method are (Dupac̆ová, Gröwe-Kuska, & Römisch, 2003; Heitsch & Römisch, 2003, 2007) for two-stage programs, Heitsch and Römisch (2009) for multi-stage programs, and Gröwe-Kuska, Heitsch, and Römisch (2003) for applications to power planning problems. For the particular case of bidding into sequential electricity markets, see Olsson and Söder (2008) who include the balancing market. Our scenario generation likewise relies on scenario sampling and reduction. However, whereas the existing literature often applies the two methods separately, we alternate between scenario sampling and reduction in a stage-wise fashion with the aim to better preserve the statistical properties of the stochastic processes.

From a practical point of view, there may be further challenges in implementing and solving the coordination problem (e.g. since this requires modeling software). This is finally our motivation for relating its solutions to alternative bidding strategies used in practice, and assessing the gain from coordination without actually solving it.

We consider two sequential markets common in many electricity market designs: A day-ahead market and an hour-ahead market. In the Nordic region, these markets are the spot market Elspot and the balancing market.

The day-ahead spot market is for physical trading of production and consumption. As the name suggests, bidding takes place a day ahead of operation, when the market participants submit a set of price–volume bids for every hour of the following operation day (disregarding so-called block bids and flexible bids). For every such hour, the market interprets the set of bids as a points on a bidding curve. At closure around noon, the market is cleared, i.e. the demand and supply curves from all market participants are aggregated and the equilibrium is determined. Usually, bids are dispatched in merit order until aggregated demand and supply matches (however, taking into account transmission constraints). Bids can either be fully or partially (the marginal bid) accepted, and the marginal bid determines the market price (in the absence of bottlenecks). All trades are settled at this market price. Upon market clearing, the market prices for the following operation day are announced and the market participants are notified of their dispatch. The market participants are committed to comply with their dispatched volumes, and hence must produce or consume accordingly.

Nevertheless, due to unforeseen events such as the inability to perfectly predict supply or demand or deliberate (strategic) non-compliance with the market commitments, expected and realized production and consumption may not fully match. Usually, an electricity system operator is responsible for ensuring physical balance of the power system. Hence, when imbalances occur, the system operator activates additional supply or demand by buying or selling so-called up and down regulating power. In situations of negative system imbalances, i.e. if real-time consumption exceeds production, up regulation (an increase in supply or a decrease in demand) is activated. Likewise, in situations of positive system imbalances, down regulation (a decrease in supply or an increase in demand) is activated.

Up and down regulation is traded in the hour-ahead market, here referred to as the balancing market. This market operates along many of the same principles as the spot market. Thus, for every hour of an operation day, the market participants submit a set of price–volume bids for up and down regulating power. However, bidding takes place during the operation day, with market closure being immediately prior to the delivery hour. This makes the market accessible only to agents that can quickly adjust production or consumption, also known as balance responsible parties. Furthermore, although bidding is on an hourly basis, the market clearing and subsequent dispatch occur continuously throughout the operation day, and are done by the system operator irrespective of the origin of demand for regulation. The total volume dispatched, or equivalently the aggregated net demand for regulation, during the delivery hour determines the sign of the system imbalance, i.e. whether the system has generally been up and down regulated. This is used to establish the hourly balancing market price. In situations where the system has been up regulated, it is the price of the most recently activated up regulation bid (as above, in the absence of bottlenecks). Likewise, in situations where the system has been down regulated, it is the price of the most recently activated down regulation bid. In an up regulated system, the balancing price is automatically higher than the spot price, since less expensive bids have already been dispatched in the spot market, and vice versa in a down regulated system. For this reason, the sign of the system imbalance is revealed from the spot and balancing market prices. If both up and down regulation bids are dispatched within the same delivery hour, special pricing principles apply.

For market participants who do not comply with their dispatched volumes in the spot and balancing markets (in case of trading in both markets), imbalances are penalized. In contrast to the process of balancing market bidding, imbalances are settled following the delivery hour, when realized production and consumption have been metered. Depending on the market design, a one-price or two-price balancing mechanism applies in the settlement. Under a one-price system, metered imbalances, whether positive or negative, are charged or paid the balancing market price. If a two-price system has been implemented, negative imbalances are charged the balancing market price if the overall system needs up regulation, and otherwise the lower spot price. Similarly, positive imbalances are paid the balancing market prices if the system is in need of down regulation, and otherwise the higher spot price. Clearly, this mechanism has been designed to rule out incentives to deliberately create imbalances, and instead encourage market participants to help the system. As an example, in Western Denmark, the one-price system has been implemented for consumption, whereas the two-price system applies to production.

We consider a market participant who submits bidding curves to the spot and balancing markets over a time horizon of a day. The day is discretized into hourly time intervals according to the bidding practice in both markets. Although regulation is activated continuously throughout the delivery hour, we assume that only either up or down regulation is activated within the same hour, which makes it possible to settle all accounts on an hourly basis. The following assumptions hold for both markets. When the market participant can decide on both bid prices and volumes, the problem is non-linear, and we therefore discretize the price range, and fix a number of bid prices. Moreover, although we will later relax this assumption, we initially assume that the market participant take market prices as given. This makes it possible to determine a priori whether a bid is accepted or rejected. We assume that all bids are either fully accepted or rejected (i.e. the market participant never submits the marginal bid). Finally, we use system-wide market prices, and ignore any transmission constraints and potential bottlenecks.

As indicated above, both spot and balancing market prices are unknown at the time (day-ahead) of bidding into the spot market for the following operation day. However, once the spot market has cleared, spot market prices are revealed. Likewise, the balancing market price is unknown at the time (hour-ahead) of bidding into the balancing market for the following hour of operation, but is revealed once this market has cleared. Finally, both spot and balancing market prices are known when imbalances are settled following the hour of operation. Taking into account the sequential clearing of the markets, we formulate the bidding problem as a multi-stage stochastic program. The first stage consists of spot market bidding, stages 2–25 of balancing market bidding, and stages 3–26 consists of operation and settlement of imbalances. By assuming a discrete distribution of market prices, the gradual realization of uncertainty can be represented by a so-called scenario tree.

We use the following notation for the bidding problem. A 24hour operation day is divided into hourly time intervals 
                        
                           [
                           t
                           -
                           1
                           ,
                           t
                           ]
                           ,
                           
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      with 
                        
                           T
                           =
                           24
                        
                     , where the interval 
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                      represents the hour 00:00–01:00, 
                        
                           [
                           1
                           ,
                           2
                           ]
                        
                      represents the hour 01:00–02:00, etc. In the following, however, we refer to the time interval 
                        
                           [
                           t
                           -
                           1
                           ,
                           t
                           ]
                        
                      simply as t.

We denote the random spot and balancing market prices in time interval t by 
                        
                           
                              
                                 ρ
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 μ
                              
                              
                                 t
                              
                           
                        
                     , respectively. Accordingly, we assume that 
                        
                           
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      is a stochastic process on some probability space 
                        
                           (
                           Ω
                           ,
                           F
                           ,
                           P
                           )
                        
                     , where 
                        
                           Ω
                        
                      is the sample space, 
                        
                           F
                        
                      is the 
                        
                           σ
                        
                     -algebra, and 
                        
                           P
                        
                      is the probability measure. This probability space is equipped with a filtration given by the 
                        
                           σ
                        
                     -fields 
                        
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 spot
                              
                           
                           
                           ≔
                           
                           {
                           ∅
                           ,
                           Ω
                           }
                           ⊆
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 spot
                              
                           
                           
                           ≔
                           
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 reg
                              
                           
                           ⊆
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 reg
                              
                           
                           ⊆
                           ⋯
                           ⊆
                           
                              
                                 F
                              
                              
                                 T
                              
                              
                                 reg
                              
                           
                           
                           ≔
                           
                           F
                        
                     , where 
                        
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 spot
                              
                           
                        
                      is generated by 
                        
                           
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                     , and 
                        
                           
                              
                                 F
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                        
                      is generated by 
                        
                           
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 {
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 }
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                              
                              
                                 t
                              
                           
                        
                      for 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . Hence, the 
                        
                           σ
                        
                     -fields 
                        
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 spot
                              
                           
                        
                      and 
                        
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 spot
                              
                           
                        
                      represent the information available before (first stage) and after (second stage) the day-ahead spot market clearing, respectively, and likewise 
                        
                           
                              
                                 F
                              
                              
                                 t
                                 -
                                 1
                              
                              
                                 reg
                              
                           
                        
                      and 
                        
                           
                              
                                 F
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                        
                      represent the information available before (stages 2–25) and after (stages 3–26) the hour-ahead balancing market clearing in time interval t, for 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     .

We represent the decisions of the sequential bidding problem by the multi-dimensional process 
                        
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                     , where the processes (some of which are also multi-dimensional) 
                        
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      are the volumes bid in the day-ahead spot market and the hour-ahead balancing market, respectively, 
                        
                           
                              
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      are the corresponding volumes dispatched, 
                        
                           
                              
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      represent the imbalances and 
                        
                           
                              
                                 {
                                 
                                    
                                       q
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      are the actual net production levels (a positive level indicates production, a negative level consumption). As for market prices, the sequence of decisions in the bidding problem forms a stochastic process on 
                        
                           (
                           Ω
                           ,
                           F
                           ,
                           P
                           )
                        
                     . We assume that this process is adapted to the filtration of 
                        
                           σ
                        
                     -fields, or equivalently, that the decisions are non-anticipative. Non-anticipativity implies that decisions made at a given stage depend only on the information available in this stage. Hence, the decisions 
                        
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      are made before (first stage) and after (second stage) the observation of spot prices 
                        
                           
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                     , respectively, and likewise the decisions 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                           ,
                           
                           
                              
                                 z
                              
                              
                                 t
                              
                           
                           ,
                           
                           
                              
                                 q
                              
                              
                                 t
                              
                           
                        
                      are made before (stages 2–25) and after (stages 3–26) the observation of the balancing price 
                        
                           
                              
                                 ρ
                              
                              
                                 t
                              
                           
                        
                      in time interval t, for 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . Technically speaking, we assume that 
                        
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      is 
                        
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 spot
                              
                           
                        
                     -measurable, 
                        
                           
                              
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      is 
                        
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 spot
                              
                           
                        
                     -measurable, 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                        
                      is 
                        
                           
                              
                                 F
                              
                              
                                 t
                                 -
                                 1
                              
                              
                                 reg
                              
                           
                        
                     -measurable and 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                           ,
                           
                           
                              
                                 z
                              
                              
                                 t
                              
                           
                           ,
                           
                           
                              
                                 q
                              
                              
                                 t
                              
                           
                        
                      are 
                        
                           
                              
                                 F
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                        
                     -measurable for 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     .

For computational reasons, we assume that the process 
                        
                           
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                      follows a discrete distributions with finite support, which we refer to as a set of scenarios. With the above assumptions, the scenarios form a tree with a finite set of nodes. Although we implement the nodal formulation of the multi-stage stochastic programming problem, for ease of exposition, we present the scenario formulation of the problem. Thus, we denote the realizations of the random prices by 
                        
                           
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                           ,
                           
                           s
                           =
                           1
                           ,
                           …
                           ,
                           S
                        
                      and their corresponding probabilities by 
                        
                           
                              
                                 π
                              
                              
                                 s
                              
                           
                           ,
                           
                           s
                           =
                           1
                           ,
                           …
                           ,
                           S
                        
                     . We refer to the realizations and their probabilities as scenarios. The decisions of the bidding problem are assigned to scenarios accordingly, i.e. 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             reg
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             reg
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             q
                                          
                                          
                                             t
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                           ,
                           
                           s
                           =
                           1
                           ,
                           …
                           ,
                           S
                        
                     , and we enforce the non-anticipativity explicitly by a set of linear constraints.

We consider both selling to and buying from the spot market such that the market participant submits a supply or demand curve for every hour of the following operation day. We assume that the bid prices are fixed, i.e. these are parameters, whereas the bid volumes are decision variables. We let the discretization of the price range be indexed by 
                           
                              1
                              ,
                              …
                              ,
                              I
                           
                        . For a given hour t, the supply curve is then defined by the prices 
                           
                              
                                 
                                    p
                                 
                                 
                                    it
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           
                        , where 
                           
                              
                                 
                                    p
                                 
                                 
                                    it
                                 
                                 
                                    +
                                 
                              
                              ⩽
                              
                                 
                                    p
                                 
                                 
                                    i
                                    +
                                    1
                                    t
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                    t
                                 
                                 
                                    +
                                 
                              
                              =
                              0
                              ,
                              
                              
                                 
                                    p
                                 
                                 
                                    I
                                    +
                                    1
                                    t
                                 
                                 
                                    +
                                 
                              
                              =
                              +
                              ∞
                           
                        , and the volumes 
                           
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              ⩾
                              0
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                         (note that bid volumes are defined as the accumulated volumes at a particular bid price. Occasionally, we may however also refer to a bid as the incremental volume). When minimum and maximum bid volumes apply, we denote these by 
                           
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                           
                        , and include the decision variables 
                           
                              
                                 
                                    δ
                                 
                                 
                                    it
                                 
                                 
                                    +
                                    ,
                                    s
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                         such that 
                           
                              
                                 
                                    δ
                                 
                                 
                                    it
                                 
                                 
                                    +
                                    ,
                                    s
                                 
                              
                              =
                              1
                           
                        , when 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    +
                                    1
                                    t
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              >
                              0
                           
                        , and 
                           
                              
                                 
                                    δ
                                 
                                 
                                    it
                                 
                                 
                                    +
                                    ,
                                    s
                                 
                              
                              =
                              0
                           
                        , when 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    +
                                    1
                                    t
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              =
                              0
                           
                         (minimum and maximum apply to incremental bid volumes). Likewise, for a given hour t, the demand curve is defined by the prices 
                           
                              
                                 
                                    p
                                 
                                 
                                    it
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           
                        , where 
                           
                              
                                 
                                    p
                                 
                                 
                                    it
                                 
                                 
                                    -
                                 
                              
                              ⩽
                              
                                 
                                    p
                                 
                                 
                                    i
                                    -
                                    1
                                    t
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                    t
                                 
                                 
                                    -
                                 
                              
                              =
                              +
                              ∞
                              ,
                              
                              
                                 
                                    p
                                 
                                 
                                    It
                                 
                                 
                                    -
                                 
                              
                              =
                              0
                           
                        , and the volumes 
                           
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    spot
                                    ,
                                    -
                                    ,
                                    s
                                 
                              
                              ⩾
                              0
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        . The same minimum and maximum bidding volumes may apply, with the corresponding decision variables 
                           
                              
                                 
                                    δ
                                 
                                 
                                    it
                                 
                                 
                                    -
                                    ,
                                    s
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        . Obviously, if the producer could perfectly predict market prices, it would be unnecessary to submit bidding curves. However, market prices are unknown at the time of bidding. Once these become known, we can determine which (incremental) bids are accepted. For a given hour t, we denote the total volumes dispatched by 
                           
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    spot
                                    ,
                                    -
                                    ,
                                    s
                                 
                              
                              ⩾
                              0
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        , so that these decision variables represent the accumulated volume of accepted supply or demand bids, respectively.

In the following, we present only the supply side constraints, and refer the reader to Appendix A for the corresponding demand side constraints. Volumes bid are related to volumes dispatched through the bidding curve. Depending on the market rules, this curve may be a step-wise bidding curve, for which supply bids are accepted if the bid price is below the market price. This implies that
                           
                              (1)
                              
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                 if
                                 
                                 
                                    
                                       p
                                    
                                    
                                       it
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       +
                                       1
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        The market rules may alternatively prescribe a piece-wise linear bidding curve (this is the case in the Nordic market), which is given by
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             t
                                          
                                          
                                             s
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             it
                                          
                                          
                                             +
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             it
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                       t
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       
                                          
                                             ρ
                                          
                                          
                                             t
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             +
                                             1
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             it
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                 if
                                 
                                 
                                    
                                       p
                                    
                                    
                                       it
                                    
                                    
                                       +
                                    
                                 
                                 ⩽
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       +
                                       1
                                       t
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 -
                                 1
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 ,
                              
                           
                        and 
                           
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    It
                                 
                                 
                                    spot
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                           
                         if 
                           
                              
                                 
                                    p
                                 
                                 
                                    It
                                 
                                 
                                    +
                                 
                              
                              ⩽
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                           
                        . In case of both a step-wise and piece-wise linear bidding curve, for a price-taker, we can determine a priori whether a bid is accepted or rejected, and express the relation between volumes bid and volumes dispatched as a linear constraint. The market rules usually require bidding curves to be monotone (e.g. that the supply curve is non-decreasing) such that
                           
                              (2)
                              
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                       t
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 -
                                 1
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        
                     

When minimum and maximum bid volumes apply, these constraints can be replaced by
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       min
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       it
                                    
                                    
                                       +
                                       ,
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                       t
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       max
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       it
                                    
                                    
                                       +
                                       ,
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 -
                                 1
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        To rule out speculation, and since the purpose of the spot market is the physical exchange of power, we further impose the constraints that a market participant who is active only on the supply side cannot sell more than full production capacity and cannot buy in the spot market. We assume that similar constraints hold on the demand side (Note, however, that some market participants may be active on both the supply and demand sides).

Now, the spot market bidding problem is two-stage, with bidding and dispatch taking place before and after market clearing, respectively. We explicitly enforce this structure by imposing the non-anticipativity constraints
                           
                              (3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 ,
                              
                           
                        and
                           
                              (4)
                              
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 if
                                 
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       T
                                    
                                    
                                       s
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 …
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       T
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        
                     

Finally, for every hour of the operation day, the spot market profit is calculated as the market price times total volume dispatched. Thus, the expected total daily spot market revenue is
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                spot
                                                ,
                                                +
                                                ,
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                spot
                                                ,
                                                -
                                                ,
                                                s
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As for the spot market, we consider both selling to and buying from the balancing market, and hence the market participant submits a supply or demand curve for the following hour of operation. We again assume that bid prices are fixed, and for ease of exposition, we use the same discretization of the price range. For a given hour t, the volumes bid are represented by the decision variables 
                           
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    reg
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    reg
                                    ,
                                    -
                                    ,
                                    s
                                 
                              
                              ⩾
                              0
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        , and the volumes dispatched by 
                           
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    reg
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    reg
                                    ,
                                    -
                                    ,
                                    s
                                 
                              
                              ⩾
                              0
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        . At the time of bidding into the balancing market, the spot market price is known, but the balancing market price is unknown. Once both the spot and balancing market prices become known, we can determine which bids are accepted.

We present only the up regulation constraints, and refer the reader to Appendix B for the corresponding down regulation constraints. We confine ourselves to step-wise bidding curves (the use of piece-wise bidding curves, however, follows along the same lines) and consider the relation between volumes bid and volumes dispatched. In the balancing market, up regulation bids are accepted if the bid price is below the market price and the system is up regulated, which is revealed from the spot and balancing market prices. In situations where the system is up regulated, the balancing market price is higher than spot price, and thus, we have that
                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   t
                                                
                                                
                                                   reg
                                                   ,
                                                   +
                                                   ,
                                                   s
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     reg
                                                                     ,
                                                                     +
                                                                     ,
                                                                     s
                                                                  
                                                               
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               ⩽
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               <
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                     t
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               
                                                               and
                                                               
                                                               
                                                                  
                                                                     ρ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               ⩽
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               ,
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                               <
                                                               
                                                                  
                                                                     ρ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             I
                                             ,
                                             
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Again, for a price-taker, we can determine a priori whether a bid is accepted or rejected. It should be remarked that in the balancing market, the market participant faces an additional risk of not being dispatched, if offering up regulating in situations of a positive system imbalance. As above, the bidding curves must be monotone, and so
                           
                              (6)
                              
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       +
                                       1
                                       t
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 -
                                 1
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        Minimum and maximum bid volumes may also apply. To rule out excessive speculation, we further impose the constraints that a market participant cannot buy or sell more balancing power than available up or down regulating capacity (On the supply side, we define up regulation capacity as production capacity in excess of the spot market dispatch and down regulation capacity as the capacity dispatched in the spot market. We assume that similar definitions hold on the demand side).

In balancing market bidding, bidding and dispatch likewise take place before and after market clearing, respectively. However, whereas the spot market is day-ahead, the balancing market is hour-ahead, making the balancing market bidding problem multi-stage. We enforce this by the following non-anticipativity constraints
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 if
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                1
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 ,
                              
                           
                        and
                           
                              (8)
                              
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 if
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                1
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                T
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        
                     

Based on balancing market prices and dispatched volumes, the expected total daily balancing market revenue can be calculated as
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                reg
                                                ,
                                                +
                                                ,
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                reg
                                                ,
                                                -
                                                ,
                                                s
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Imbalances occur when total spot and balancing market commitments do not comply with realized production and consumption. For a given hour t, positive and negative imbalances are represented by the decision variables 
                           
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                                 
                                    +
                                    ,
                                    s
                                 
                              
                              ,
                              
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                                 
                                    -
                                    ,
                                    s
                                 
                              
                              ⩾
                              0
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        , respectively, and net production by 
                           
                              
                                 
                                    q
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              s
                              =
                              1
                              ,
                              …
                              ,
                              S
                           
                        . Since imbalances are settled following the delivery hour, both spot and balancing market prices are known, and thus, the balancing costs are also known at the time of settlement.

The settlement of imbalances is formulated as
                           
                              (9)
                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       -
                                       ,
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                    
                                       +
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       spot
                                       ,
                                       -
                                       ,
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                       ,
                                       +
                                       ,
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                       ,
                                       -
                                       ,
                                       s
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                                 .
                              
                           
                        Positive and negative imbalances may, respectively, be charged or paid the balancing market price. Under this one-price system, expected total daily balancing costs are
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                -
                                                ,
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                +
                                                ,
                                                s
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        A two-price system implies that imbalances are charged or paid the balancing market price when these are of the same sign as system imbalances and otherwise the spot price. In this case, balancing costs sum to
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             max
                                          
                                          {
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                          }
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                -
                                                ,
                                                s
                                             
                                          
                                          -
                                          
                                             min
                                          
                                          {
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                          }
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                +
                                                ,
                                                s
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        For ease of notation, we denote balancing prices by 
                           
                              
                                 
                                    γ
                                 
                                 
                                    t
                                 
                                 
                                    1
                                    ,
                                    -
                                    ,
                                    s
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    t
                                 
                                 
                                    1
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                           
                         under a one-price system and by 
                           
                              
                                 
                                    γ
                                 
                                 
                                    t
                                 
                                 
                                    2
                                    ,
                                    -
                                    ,
                                    s
                                 
                              
                              =
                              max
                              {
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              }
                           
                         and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    t
                                 
                                 
                                    2
                                    ,
                                    +
                                    ,
                                    s
                                 
                              
                              =
                              min
                              {
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              }
                           
                         under a two-price system.

We proceed to formulate the multi-stage stochastic programming problem of coordinated spot and balancing market bidding under balancing price mechanism k for 
                           
                              k
                              =
                              1
                              ,
                              2
                           
                        .

Since existing market rules (except for maybe the balancing price mechanism) apply to any market participant, the bidding model can be used irrespective of the production or consumption technology. However, bidding must be coordinated with operation for the technology considered. For a general representation of the operational part of the problem, we assume that 
                           
                              
                                 
                                    g
                                 
                                 
                                    t
                                 
                              
                           
                         captures the state of operation in time interval 
                           
                              t
                              ,
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         denotes the operating costs, and 
                           
                              
                                 
                                    g
                                 
                                 
                                    t
                                 
                              
                              ∈
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         represents the operational constraints in time interval t, including the relation between state of operation and net production.

The first stage of the bidding problem consists of day-ahead spot market bidding such as to maximize expected future revenues from the actual spot market dispatch, i.e.
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          E
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  spot
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  T
                                                               
                                                               
                                                                  spot
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                
                                             
                                          
                                          :
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        In response to the realization of spot market prices, the second stage consists of hour-ahead balancing market bidding such as to maximize the expected difference between future revenues from actual balancing market dispatch and balancing costs, and so
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                    
                                       spot
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                spot
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                             
                                                spot
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         spot
                                                         ,
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         spot
                                                         ,
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          E
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         reg
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           spot
                                                                        
                                                                     
                                                                     ,
                                                                     …
                                                                     ,
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                        
                                                                           spot
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           reg
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         reg
                                                      
                                                   
                                                
                                             
                                          
                                          :
                                          
                                             (1), (6)
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where (6) applies to time interval 1.

Upon the realization of balancing market prices, the market participant aims to produce or consume accordingly. If net production does not comply with the market commitments, imbalances are settled. The process repeats such that stages 2–25 consists of hour-ahead balancing market bidding, whereas production and consumption occur and imbalances are settled in stages 3–26, i.e.
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       t
                                    
                                    
                                       reg
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                             
                                                spot
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                T
                                             
                                             
                                                spot
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                t
                                             
                                             
                                                reg
                                             
                                          
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         reg
                                                         ,
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         reg
                                                         ,
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          (
                                          
                                             
                                                γ
                                             
                                             
                                                t
                                             
                                             
                                                k
                                                ,
                                                -
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                          -
                                          
                                             
                                                γ
                                             
                                             
                                                t
                                             
                                             
                                                k
                                                ,
                                                +
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                             
                                                +
                                             
                                          
                                          )
                                          -
                                          
                                             
                                                C
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          +
                                          E
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                      
                                                         reg
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           spot
                                                                        
                                                                     
                                                                     ,
                                                                     …
                                                                     ,
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           T
                                                                        
                                                                        
                                                                           spot
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           t
                                                                           +
                                                                           1
                                                                        
                                                                        
                                                                           reg
                                                                        
                                                                     
                                                                     ,
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         reg
                                                      
                                                   
                                                
                                             
                                          
                                          :
                                          
                                             (5), (6),(9),
                                          
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                q
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                              
                           
                        where (5) and (9) apply to time interval t, (6) applies to time interval 
                           
                              t
                              +
                              1
                           
                         and 
                           
                              
                                 
                                    Q
                                 
                                 
                                    T
                                    +
                                    1
                                 
                                 
                                    reg
                                 
                              
                              
                              ≔
                              
                              0
                           
                        .

Using the same notation as above, the so-called deterministic equivalent is
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                
                                                   S
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         spot
                                                         ,
                                                         +
                                                         ,
                                                         s
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         spot
                                                         ,
                                                         -
                                                         ,
                                                         s
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  reg
                                                                  ,
                                                                  +
                                                                  ,
                                                                  s
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  reg
                                                                  ,
                                                                  -
                                                                  ,
                                                                  s
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   (
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         ,
                                                         -
                                                         ,
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         -
                                                         ,
                                                         s
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         ,
                                                         +
                                                         ,
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         +
                                                         ,
                                                         s
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          :
                                          
                                             (1)–(9),
                                          
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                             
                                                s
                                             
                                          
                                          =
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          if
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         T
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         T
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                          s
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          S
                                       
                                    
                                 
                                 ,
                              
                           
                        for 
                           
                              k
                              =
                              1
                              ,
                              2
                           
                        .

By taking into account operational aspects by linear or mixed-integer linear modeling, the deterministic equivalent is a linear or mixed-integer linear program. It should be remarked that the objective function and constraints of the bidding problem are separable with respect to time periods. However, the operational constraints most likely introduce temporal dependencies.

So far, we assumed that the market participant is a price-taker. This is a valid assumption for many spot market participants, but may be questionable for the balancing market, where market participants tend to be larger players. We therefore relax the price-taker assumption by letting market prices respond linearly to the volumes dispatched. Denote by 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         the spot and balancing prices that realize if the producer or consumer does not participate in the market. The spot price decreases with increased supply or decreased demand volumes dispatched in the spot market, whereas the balancing price responds to both spot and balancing market trades. Hence, we let
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   t
                                                
                                                
                                                   s
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   s
                                                
                                             
                                             -
                                             
                                                
                                                   α
                                                
                                                
                                                   spot
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            spot
                                                            ,
                                                            +
                                                            ,
                                                            s
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            spot
                                                            ,
                                                            -
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   t
                                                
                                                
                                                   s
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   s
                                                
                                             
                                             -
                                             
                                                
                                                   β
                                                
                                                
                                                   spot
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            spot
                                                            ,
                                                            +
                                                            ,
                                                            s
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            spot
                                                            ,
                                                            -
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   β
                                                
                                                
                                                   reg
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            reg
                                                            ,
                                                            +
                                                            ,
                                                            s
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            reg
                                                            ,
                                                            -
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                             ,
                                             
                                             s
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             S
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    α
                                 
                                 
                                    spot
                                 
                              
                              ,
                              
                              
                                 
                                    β
                                 
                                 
                                    spot
                                 
                              
                              ,
                              
                              
                                 
                                    β
                                 
                                 
                                    reg
                                 
                              
                              >
                              0
                           
                         are parameters. For simplicity, we incorporate the price response only in spot and balancing revenues, and use 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                           
                         in the constraints and for the calculation of balancing costs (Had we included variable prices in the constraints (1) and (5), the model would no longer be linear). For 
                           
                              4
                              
                                 
                                    α
                                 
                                 
                                    spot
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    reg
                                 
                              
                              >
                              
                                 
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          spot
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        , the bidding problem becomes a convex quadratic program.

Although we allow for price response in the following, for simplicity of notation, we denote the prices 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             +
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             -
                                             ,
                                             s
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             +
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             -
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             reg
                                             ,
                                             +
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             reg
                                             ,
                                             -
                                             ,
                                             s
                                          
                                       
                                    
                                 
                              
                           
                         simply by 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                           
                        .

The aim of the operational part of the problem is to produce or consume in accordance with the market commitments, while complying with operational constraints and minimizing costs. For simplicity, we assume that this problem is deterministic, and hence, disregard operational uncertainty such as reservoir inflow, wind power production, and availability of generating plants. We provide two examples.

In hydro-power operation, the problem is to determine water releases from a network of reservoirs such as to maximize the final value of water in storage subject to storage balancing and capacity restrictions. We denote by 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 J
                              
                            the reservoirs, and assume for simplicity that these are serially connected. The decision variables 
                              
                                 
                                    
                                       l
                                    
                                    
                                       jt
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       v
                                    
                                    
                                       jt
                                    
                                    
                                       s
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                              
                            represent the storage and discharge levels for a given hour t. Upper and lower bounds on storage and discharge are denoted by the parameters 
                              
                                 
                                    
                                       l
                                    
                                    
                                       j
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       l
                                    
                                    
                                       j
                                    
                                    
                                       max
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                    
                                       max
                                    
                                 
                              
                           . Assuming constant water value and electricity generation efficiency, these are denoted by 
                              
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       η
                                    
                                    
                                       j
                                    
                                 
                              
                           , respectively. Finally, in addition to potential inflows from upstream reservoirs, we assume that all reservoirs have external inflows and denote the inflow in hour t by 
                              
                                 
                                    
                                       ν
                                    
                                    
                                       jt
                                    
                                 
                              
                           . Then, the operational part of the problem is
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  s
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  S
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               jT
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         :
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               jt
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               jt
                                                               +
                                                               1
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               jt
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               ν
                                                            
                                                            
                                                               jt
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               j
                                                               -
                                                               1
                                                               t
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               jt
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      min
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      min
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      max
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      s
                                                   
                                                
                                                =
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      s
                                                   
                                                
                                                =
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                if
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               T
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               T
                                                            
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         j
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         J
                                                         ,
                                                         
                                                         t
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         T
                                                         ,
                                                         
                                                         s
                                                         ,
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         S
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Note that the first set of constraints ensure compliance with the market commitments, and so these commitments can be viewed as a type of demand. For further details on the modeling of hydro-power operation, see for example Fleten and Kristoffersen (2008).

The thermal generation problem is concerned with the optimal operation of a number of production units. We denote these units by 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 J
                              
                           . Production levels for a given hour t are represented by the decision variables 
                              
                                 
                                    
                                       g
                                    
                                    
                                       jt
                                    
                                    
                                       s
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 S
                              
                           , and their upper and lower bounds by 
                              
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                    
                                       max
                                    
                                 
                              
                           . The variable operation cost is denoted by 
                              
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                              
                           . As a result, the operational part of the problem is
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  s
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  S
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  t
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               jt
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         :
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  I
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               jt
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ,
                                                         
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               min
                                                            
                                                         
                                                         ⩽
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               jt
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         ⩽
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               max
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      s
                                                   
                                                
                                                =
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      jt
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                if
                                                
                                                (
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      T
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      s
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      s
                                                   
                                                
                                                )
                                                =
                                                (
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      T
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         j
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         J
                                                         ,
                                                         
                                                         t
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         T
                                                         ,
                                                         
                                                         s
                                                         ,
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         S
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           As above, it should be remarked that the first set of constraints ensure compliance with the market commitments. This problem may be further subject to ramping restrictions, reserve constraints and include start-up costs.

We account for uncertainty in spot and balancing prices and for the sign of the system imbalance. As already indicated, however, the sign of the imbalance is revealed by spot and balancing prices, and so scenario generation reduces to describing a two-dimensional price process.

Spot and balancing prices exhibit strong autocorrelations and cross-correlations. The former are highly important for technologies with start-up costs, storage ability, ramping restrictions or other temporal dependencies in the operational constraints, whereas the latter are obviously relevant to market participants who engage in both the spot and balancing markets. We therefore put efforts into preserving these correlations in the scenario generation.

We begin by fitting the two price processes. We describe spot and balancing prices by autoregressive processes that capture their autocorrelations. Moreover, since spot prices are known at the time of balancing market clearing, we include these as exogenous variables in the balancing price process, and thereby also capture their cross-correlations.

The problem of electricity spot price modeling is a subject of extensive study in the literature, see for example (Contreras, Espinola, Nogales, & Conejo, 2003; Garcia, Contreras, Akkeren, & Garcia, 2005; Haldrup & Nielsen, 2006; Nogales, Conejo, & Espinola, 2002), whereas the modeling of balancing market prices is relatively unexplored, a few references being (Klæboe, Eriksrud, & Fleten, 2013; Olsson & Söder, 2008; Skytte, 1999). With only spot and balancing price data available, structural analysis (e.g. the inclusion of exogenous variables such as consumption) is infeasible. Like in most of the cited references, we instead fit autoregressive models, although ignoring more complex characteristics such as jumps, regime switching and volatility clustering. Prior to model fitting, we de-trend and de-seasonalize the data, using hourly, daily and monthly seasonal dummies. We then adjust for non-stationarity in de-seasonalized and de-trended market prices by applying hourly differencing (We also tested logarithmic transformation of the data, which however did not improve stationarity).

We fit spot prices to the SARIMA
                        
                           (
                           2
                           ,
                           1
                           ,
                           0
                           )
                           ×
                           
                              
                                 (
                                 1
                                 ,
                                 0
                                 ,
                                 1
                                 )
                              
                              
                                 24
                              
                           
                        
                      process
                        
                           
                              
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                ϕ
                                             
                                             
                                                24
                                             
                                             
                                                spot
                                             
                                          
                                          L
                                       
                                    
                                 
                                 
                                    24
                                 
                              
                              
                                 
                                    
                                       1
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             1
                                          
                                          
                                             spot
                                          
                                       
                                       L
                                       -
                                       
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                          
                                             spot
                                          
                                       
                                       L
                                    
                                 
                              
                              (
                              1
                              -
                              L
                              )
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                θ
                                             
                                             
                                                24
                                             
                                             
                                                spot
                                             
                                          
                                          L
                                       
                                    
                                 
                                 
                                    24
                                 
                              
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                                 
                                    spot
                                 
                              
                              ,
                           
                        
                     where the L is the backshift operator, i.e. 
                        
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                           
                              
                                 ρ
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ρ
                              
                              
                                 t
                                 -
                                 k
                              
                           
                           ,
                           
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                              
                                 spot
                              
                           
                           ,
                           
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                              
                                 spot
                              
                           
                           ,
                           
                           
                              
                                 ϕ
                              
                              
                                 24
                              
                              
                                 spot
                              
                           
                        
                      and 
                        
                           
                              
                                 θ
                              
                              
                                 24
                              
                              
                                 spot
                              
                           
                        
                      are model parameters, and the innovations 
                        
                           
                              
                                 ∊
                              
                              
                                 t
                              
                              
                                 spot
                              
                           
                           ,
                           
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      are independent and identically distributed 
                        
                           N
                           (
                           0
                           ,
                           
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       spot
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                           )
                        
                     . Several other model specifications were tested, but none were found superior to this model. The model describes hourly and daily cycles in the data (which are mainly due variations in consumption patterns). The best fit to balancing prices is the ARMAX
                        
                           (
                           1
                           ,
                           0
                           ,
                           0
                           )
                        
                      process, including exogenous spot prices
                        
                           
                              (
                              1
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                                 
                                    reg
                                 
                              
                              L
                              )
                              (
                              
                                 
                                    μ
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    ψ
                                 
                                 
                                    reg
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                                 
                                    reg
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 ψ
                              
                              
                                 reg
                              
                           
                        
                      and 
                        
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                              
                                 reg
                              
                           
                        
                      are model parameters, and the innovations 
                        
                           
                              
                                 ∊
                              
                              
                                 t
                              
                              
                                 reg
                              
                           
                           ,
                           
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      are identically distributed 
                        
                           N
                           (
                           0
                           ,
                           
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       reg
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                           )
                        
                     , mutually independent and independent of the above innovations.

In our Nordic case study, we use historical spot and balancing prices from January 1 2009–December 31 2010 and obtained from the Danish transmission system operator (Energinet, 2012). Parameter estimates for the SARIMA and ARMAX models can be found in Table 1
                     . To test the validity of the fitted models, we check that the residuals are independent and identically Normally distributed with zero mean and constant variance. Moreover, we check the goodness of fit with the following test statistics. The R-square, the MAE (mean absolute error) and RMSE (root mean square error) are 0.79, 2.42Euro/megawatthour, and 4.12Euro/megawatthour for spot prices, and 0.50, 6.44Euro/megawatthour, and 17.86Euro/megawatthour for balancing prices. We consider this to be a reasonable fit.

We proceed with scenario tree sampling and reduction. Whereas the existing literature applies the two methods separately, we alternate between scenario sampling and reduction in a stage-wise fashion. By sampling current prices conditional on previous ones, we preserve autocorrelations for both spot and balancing prices. Likewise, by sampling balancing market prices conditional on spot prices, we preserve cross-correlations. To accurately describe the distribution of the two-dimensional price process, we generate a large fan of samples, and for computational reasons, we subsequently reduce this fan. The idea is, however, to apply sampling and reduction in a stage-wise fashion in order not to alter correlations too much in the process. Furthermore, for a multi-stage problem, separate scenario tree sampling and reduction require the storing of an enormous number of scenario samples prior to reduction, whereas with the stage-wise approach it is sufficient to store the scenario samples for the current stage.

Recall that S denotes the total number of spot and balancing price scenario paths. We denote by 
                        
                           
                              
                                 S
                              
                              
                                 spot
                              
                           
                        
                      the number of spot price scenario paths generated, and by 
                        
                           
                              
                                 S
                              
                              
                                 reg
                              
                           
                        
                      the number of balancing price scenario values generated conditional on a previous spot and balancing price scenario path. The stage-wise scenario generation approach can then be summarized as follows:
                        
                           •
                           Sample a fan of spot price scenario paths (vectors), and reduce this fan by clustering to obtain 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          T
                                       
                                       
                                          s
                                       
                                    
                                    )
                                    ,
                                    
                                    s
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          spot
                                       
                                    
                                 
                              . Keep the 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          spot
                                       
                                    
                                 
                               spot price scenario paths.

For 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     :
                        
                           •
                           Conditional on each previous spot and balancing price scenario path 
                                 
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          T
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    …
                                 
                              , 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          s
                                       
                                    
                                    )
                                 
                              , sample a fan of balancing price scenario values (scalars), and reduce this fan by clustering to obtain 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          reg
                                       
                                    
                                 
                              .

Further reduce the total number of balancing price scenario values 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          spot
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          S
                                       
                                       
                                          reg
                                       
                                    
                                 
                               at time t by keeping only the 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          spot
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                 
                               largest clusters, where l is such that 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          spot
                                       
                                    
                                    ×
                                    
                                       
                                          l
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    S
                                 
                              .

Note that we sample and cluster spot price scenario paths (vectors), since an entire spot price path is realized upon day-ahead market clearing (recall that the day-ahead market clears once a day), whereas we sample and cluster balancing price scenario values (scalars), since only a single balancing price is realized upon intra-day market clearing (recall that the intra-day market clears once an hour). The approach is illustrated in Fig. 1
                     .

We elaborate on the approach below. To generate scenarios, we first sample a fan of spot price scenario paths from the SARIMA process. We reduce this fan using a k-medoids clustering algorithm. Hence, we partition the scenario paths into 
                        
                           k
                           =
                           
                              
                                 S
                              
                              
                                 spot
                              
                           
                        
                      clusters by iteratively assigning paths to clusters such that the distance from path to medoid is minimal, and subsequently updating the medoids. As distance measure, we use the Euclidian distance. Hence, the distance between two spot price scenario paths 
                        
                           (
                           
                              
                                 ρ
                              
                              
                                 1
                              
                              
                                 s
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ρ
                              
                              
                                 T
                              
                              
                                 s
                              
                           
                           )
                        
                      and 
                        
                           (
                           
                              
                                 ρ
                              
                              
                                 1
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ρ
                              
                              
                                 T
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           )
                        
                      is
                        
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    |
                                    
                                       
                                          ρ
                                       
                                       
                                          t
                                       
                                       
                                          s
                                       
                                    
                                    -
                                    
                                       
                                          ρ
                                       
                                       
                                          t
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     We next sample a fan of balancing price scenario values from the ARMAX process (conditional on each previous spot price scenario path), and apply the clustering algorithm with 
                        
                           k
                           =
                           
                              
                                 S
                              
                              
                                 reg
                              
                           
                        
                     . We repeat this for all 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . Thus, we sample balancing price scenario values (conditional on each previous spot and balancing price scenario path), and apply the clustering algorithm with the same k. The distance between two balancing price scenario values 
                        
                           
                              
                                 μ
                              
                              
                                 t
                              
                              
                                 s
                              
                           
                        
                      and 
                        
                           
                              
                                 μ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      is 
                        
                           |
                           
                              
                                 μ
                              
                              
                                 t
                              
                              
                                 s
                              
                           
                           -
                           
                              
                                 μ
                              
                              
                                 t
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           |
                        
                     .

Since the number of scenarios increases exponentially with the number of stages in the multi-stage problem, we further reduce the size of the scenario tree as follows. In the spot market stage (second stage), we keep the 
                        
                           
                              
                                 S
                              
                              
                                 spot
                              
                           
                        
                      scenario paths obtained by clustering. However, in the balancing market stages (stages 3–26), we do the following. For 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     , we further reduce the total number of scenario values 
                        
                           
                              
                                 S
                              
                              
                                 spot
                              
                           
                           ×
                           
                              
                                 l
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ×
                           
                              
                                 S
                              
                              
                                 reg
                              
                           
                        
                      at time t by keeping only the 
                        
                           
                              
                                 S
                              
                              
                                 spot
                              
                           
                           ×
                           
                              
                                 l
                              
                              
                                 t
                              
                           
                        
                      (rounded) largest clusters, where l is such that 
                        
                           
                              
                                 S
                              
                              
                                 spot
                              
                           
                           ×
                           
                              
                                 l
                              
                              
                                 T
                              
                           
                           =
                           S
                        
                      and S is the total number of spot and balancing price scenario paths.

The scenario tree sampling and reduction has been implemented in the Python programming language. We generate results for the Nordic case study. In the spot market stage (second stage), we sample 500 spot price scenario paths and reduce these to 10. In the balancing market stages (stages 3–26), we likewise sample 500 balancing price scenario values for each previous spot and balancing price scenario path and reduce these to 10. However, for 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      we further reduce the total number of balancing price scenario values 
                        
                           10
                           ×
                           
                              
                                 l
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ×
                           10
                        
                      at time t to 
                        
                           10
                           ×
                           
                              
                                 l
                              
                              
                                 t
                              
                           
                        
                      (rounded), where 
                        
                           l
                           =
                           1.18
                        
                     . For example, in stage 3, we generate a total of 
                        
                           10
                           ×
                           500
                        
                      samples and reduce these to 
                        
                           10
                           ×
                           10
                        
                      and then to 
                        
                           10
                           ×
                           1.18
                        
                     . In stage 26, we generate a total of 
                        
                           10
                           ×
                           
                              
                                 1.18
                              
                              
                                 23
                              
                           
                           ×
                           500
                        
                      and reduce these to 
                        
                           10
                           ×
                           
                              
                                 1.18
                              
                              
                                 23
                              
                           
                           ×
                           10
                        
                      and then to 
                        
                           10
                           ×
                           
                              
                                 1.18
                              
                              
                                 24
                              
                           
                           =
                           500
                        
                     . The reason for reducing the scenario tree to 500 scenarios is the computational tractability of the bidding model.


                     Table 2
                      shows the statistical properties of the stochastic processes prior to and as a result of the scenario reduction for December 15 2010. As can be seen, the properties of spot prices are well preserved. The mean changes by only 0.28Euro/megawatthour when applying scenario reduction and the standard deviation is reduced by 2.92Euro/megawatthour, in spite of a significant reduction from 500 to 10 spot price scenarios. Furthermore, the first order autocorrelation changes by only 0.0111. The mean of balancing prices is likewise well preserved with a change of only 0.82Euro/megawatthour and the standard deviation is reduced by 3.29Euro/megawatthour. The first order autocorrelation changes by 0.2107, which is due to the enormous reduction from 
                        
                           
                              
                                 500
                              
                              
                                 24
                              
                           
                        
                      to 500 balancing price scenarios. Finally, the cross-correlation changes by a more moderate 0.1033 when applying scenario reduction. It should be remarked that we see smaller changes in standard deviations and correlations, when the reduction of the scenario tree is less significant.

The generation of spot price scenario paths is illustrated in Fig. 2
                     . For the two selected days December 14–15 2010, the figure shows historical spot prices for the hours 1–24, conditional on which future scenario paths are sampled for the hours 25–48. The figure to the left displays the sample paths prior to scenario reduction, and that to the right shows the result of the scenario reduction. For illustration purposes, the scenario fan before scenario reduction consists of only 20 out of the 500 scenarios, whereas after scenario reduction, the scenario fan consists of all 10 scenarios.

In this section, we examine the profit gain from coordinated spot and balancing market bidding. More specifically, we assess the performance of the separately derived bidding strategies often used in practice. We do this by deriving bounds on the profits obtained from coordinated and separate bidding.

Recall that the optimal value of the coordination problem under balancing price mechanism k is denoted by 
                        
                           
                              
                                 z
                              
                              
                                 k
                              
                           
                        
                      for 
                        
                           k
                           =
                           1
                           ,
                           2
                        
                     .

To resemble that practitioners often derive the bidding strategies separately, we solve the spot and balancing market bidding problems in a sequential fashion. The spot market bidding problem under balancing price mechanism k is
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                spot
                                                ,
                                                k
                                             
                                          
                                          =
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   E
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  spot
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    x
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 
                                                                                    x
                                                                                 
                                                                                 
                                                                                    T
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  0
                                                               
                                                               
                                                                  spot
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   :
                                                   (
                                                   2
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                             
                                                spot
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         T
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  spot
                                                                  ,
                                                                  +
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  spot
                                                                  ,
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   E
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    y
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 
                                                                                    y
                                                                                 
                                                                                 
                                                                                    T
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  0
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   :
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    Q
                                 
                                 
                                    t
                                 
                                 
                                    reg
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                          
                                             spot
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             T
                                          
                                          
                                             spot
                                          
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 max
                              
                              
                                 
                                    
                                       -
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             t
                                          
                                          
                                             k
                                             ,
                                             -
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       -
                                       
                                          
                                             γ
                                          
                                          
                                             t
                                          
                                          
                                             k
                                             ,
                                             +
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       +
                                       E
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                   
                                                      reg
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        spot
                                                                     
                                                                  
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        spot
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        g
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      reg
                                                   
                                                
                                             
                                          
                                       
                                       :
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             -
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       =
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             +
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             spot
                                             ,
                                             -
                                          
                                       
                                       -
                                       
                                          
                                             q
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             g
                                          
                                          
                                             t
                                          
                                       
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     for 
                        
                           k
                           =
                           1
                           ,
                           2
                        
                     . We denote the optimal volumes dispatched in the spot market by the (stochastic) vector 
                        
                           (
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 1
                              
                              
                                 spot
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 T
                              
                              
                                 spot
                              
                           
                           )
                        
                     .

In solving the problems sequentially, balancing bidding is conditional on the optimal volumes dispatched in the spot market. Hence, the balancing bidding problems under balancing price mechanism k are
                        
                           (11)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                reg
                                                ,
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   E
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          y
                                                                                       
                                                                                       
                                                                                          ¯
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          y
                                                                                       
                                                                                       
                                                                                          ¯
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    T
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                              ,
                                                                              
                                                                                 
                                                                                    x
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                                 
                                                                                    reg
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  0
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   :
                                                   
                                                      (6)
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                t
                                             
                                             
                                                reg
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                      
                                                         spot
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         reg
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  reg
                                                                  ,
                                                                  +
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  reg
                                                                  ,
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   (
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         ,
                                                         -
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         ,
                                                         +
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   +
                                                   E
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  t
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          y
                                                                                       
                                                                                       
                                                                                          ¯
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    1
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                              ,
                                                                              …
                                                                              ,
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          y
                                                                                       
                                                                                       
                                                                                          ¯
                                                                                       
                                                                                    
                                                                                 
                                                                                 
                                                                                    T
                                                                                 
                                                                                 
                                                                                    spot
                                                                                 
                                                                              
                                                                              ,
                                                                              
                                                                                 
                                                                                    x
                                                                                 
                                                                                 
                                                                                    t
                                                                                    +
                                                                                    1
                                                                                 
                                                                                 
                                                                                    reg
                                                                                 
                                                                              
                                                                              ,
                                                                              
                                                                                 
                                                                                    g
                                                                                 
                                                                                 
                                                                                    t
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  reg
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   :
                                                   
                                                      (5), (6),
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         spot
                                                         ,
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         spot
                                                         ,
                                                         -
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         reg
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         reg
                                                         ,
                                                         -
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  g
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     for 
                        
                           k
                           =
                           1
                           ,
                           2
                        
                     .

The expected profit from using the resulting spot market bids provides a lower bound on the profit in the coordination problem. However, to compute the expected profit from using the spot market bids, one must solve a number of bidding problems. A much less computationally expensive, though less tight, lower bound is provided by solving only the spot market bidding problem. This is formalized in the following, the proof of which is provided in Appendix C.
                        Proposition 1
                        
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          spot
                                          ,
                                          k
                                       
                                    
                                    ⩽
                                    E
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            spot
                                                            ,
                                                            +
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            spot
                                                            ,
                                                            -
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   z
                                                
                                                
                                                   reg
                                                   ,
                                                   k
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     spot
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     T
                                                                  
                                                                  
                                                                     spot
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   0
                                                
                                                
                                                   spot
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    .
                                 
                              
                           
                        

When the market participant is a price-taker, an upper bound on the profit in the coordination problem is provided by solving the spot market bidding problem, assuming a one-price balancing mechanism. For the proof, see Appendix D.
                        Proposition 2
                        
                           Assume that 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                            
                           (fixed prices). Then,
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          k
                                       
                                    
                                    ⩽
                                    
                                       
                                          z
                                       
                                       
                                          spot
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    .
                                 
                              
                           
                        

Note that the gain from coordinated bidding can be bounded without actually solving the coordination problem, but by solving at most two variations of the spot market bidding problem (under the one-price and two-price balancing mechanisms).


                     Propositions 1 and 2 apply irrespective of the balancing price mechanism. Hence, when the market participant is a price-taker, and under a one-price mechanism, it is evident that one cannot obtain higher profits through balancing market bidding and, hence, it is sufficient to bid in the spot market.
                        Corollary 1
                        
                           Assume that 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                              
                            
                           (fixed prices). Then, under a one-price balancing price mechanism,
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          spot
                                          ,
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        

In the following section, we investigate the quality of the bounds numerically.

@&#RESULTS AND DISCUSSION@&#

In this section, we investigate whether higher risk exposure may cause hesitation to bid into the balancing market, even in cases of more advantageous expected price levels. Furthermore, we quantify the gain from coordinated spot and balancing market bidding, and on the basis of the bounds derived in the previous section, assess the performance of alternative bidding strategies used in practice.

We illustrate the results from the bidding model in a Nordic case study. We consider the spot market at Nord Pool and the common Nordic balancing power market. As already mentioned, we use spot and balancing prices from January 1 2009–December 31 2010 as obtained from the Danish transmission system operator, Energinet (2012). For the generation of market price scenarios, see the previous section. We estimate the price response parameters from aggregate data and find their values to be 
                           
                              
                                 
                                    α
                                 
                                 
                                    spot
                                 
                              
                              =
                              0.0027
                              ,
                              
                              
                                 
                                    β
                                 
                                 
                                    spot
                                 
                              
                              =
                              0.0057
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    reg
                                 
                              
                              =
                              0.15
                           
                         Euro/megawatthour, which implies that the condition for convexity is satisfied. Since the empirical aggregate price response is weak and have little effect on the results (the gain from coordinated bidding changes from 8.03 to 7.93 by taking into account the empirical price response), we investigate the effect of a much stronger price response in our results and multiply the parameter values by 10. We discretize the range of bid prices such that the probability that the spot price is between any two consecutive price points is as close as possible to being the same. To limit the size of the bidding model, we use 10 price points, but allow for different price discretizations in different hours. In the optimization of market exchange, the market rules prescribe minimum bids of 0.1megawatthour in the spot market, and minimum and maximum balancing market bids of 10 and 50megawatthour, respectively, cf. the documents (Energinet, 2008; Nord Pool, 2004). To illustrate the optimization of operation, the case study is based on a Norwegian hydro-power plant. We use real data when available, i.e. for reservoir storage and discharge capacities, generation efficiencies and external inflows. This plant has two serially connected reservoirs such that upstream water releases contribute to downstream inflows, and both reservoirs also have external inflow. We assume that minimum and initial storage levels are 10% and 50% of full reservoir capacity, respectively. The water value function is assumed to be piece-wise linear and concave, with a water value of 45Euro/megawatthour at 50% of full reservoir capacity.

The multi-stage stochastic programming problem has been implemented in the modeling software package GAMS (GAMS, 2012), and run on a 1.7gigahertz Intel Core i5 processor. Running times are less than a minute, and so this model can easily be used for daily planning. It should be taken into account, however, that the modeling of operation could be much more complex, which will significantly increase running times and justify the scenario reduction.

The results from the bidding model can be found in Table 3
                        . This table shows the results for a weekday in the middle of each month (the 15th, or the closest weekday) throughout 2010, and assuming a price-taker. We first discuss columns 1–4, 10 and 11. The results include empirical means and standard deviations of spot and balancing prices (columns 1 and 2), the mean of up regulation prices adjusted for the risk that the system imbalance is positive (in which case up regulation bids are not accepted, column 3), and likewise the mean of down regulation prices adjusted for the risk that the system imbalance is negative (in which case down regulation bids are not accepted, column 4). It further includes the percentage traded up and down regulation volumes out of total absolute trading volumes (columns 10 and 11).

We observe the following from the results under a two-price balancing mechanism. In our test instances, only limited up regulation volumes are traded in the balancing market, whereas down regulation volumes are significant. For instance, for December 2010, the up and down regulation volumes are 4.18% and 29.26%, respectively. The reason is that average balancing prices are lower than average spot prices (see columns 1 and 2). We therefore made further test runs in which we increased balancing prices. For December 2010, we considered an increase of 5% and found up and down regulation volumes of 19% and 23%, of 10% and found volumes of 66% and 11% and of 20% with volumes of 84.88% and 4.35%. Hence, when average balancing prices are higher than average spot prices, more limited down regulation volumes are traded, whereas up regulation volumes are highly significant. When expected price levels in the two markets are almost identical (when balancing prices are increased by 5%, average spot and balancing prices differ by only 1.13%), up and down regulation volumes are likewise almost identical but remain relatively large. The explanation for such large trading volumes is the value of being able to defer bidding decisions in the balancing market until an hour ahead of operation, which makes it possible to better adapt volumes to prices than in the day-ahead spot market. For instance, if in some scenarios, the balancing price turns out to be higher than the spot price, it is profitable to offer up regulation, and vice versa, if the balancing price turns out to be lower, it is profitable to offer down regulation. This value of waiting is partly offset by the additional risk of not being dispatched in the balancing market, as indicated by the fact that up regulation is not at its full capacity, even if average price levels are higher. The reason is that the expected balancing revenues faced by a market participant are effectively lower when adjusted for the risk of not being dispatched. For example, for December 2010, the risk adjusted up regulation price is only 32.40Euro/megawatthour, whereas the spot and balancing market prices are 72.27 and 68.05Euro/megawatthour (se columns 1–3). Similarly, down regulation is not at its full capacity, even if average price levels are lower. The risk of not being dispatched may therefore to some extend cause a hesitation to enter and bid into the balancing market. However, our model results show that the cost of this additional risk is largely offset by the value of waiting. In reality, a hesitation may also be caused by substantial transaction costs (e.g. learning costs) for new entrants in the balancing market. Furthermore, to prohibit excessive speculation in the balancing market, existing market rules require that physical exchange of power mainly takes place in the spot market, although no explicit restrictions apply to the volume allowance in the balancing market. Our model does not capture these aspects.

We proceed to discuss columns 5–9 in Table 3. The results further include the profits under a two-price balancing system, considering respectively spot market bidding, separate spot and balancing market bidding (the lower bounds of Proposition 1, denoted LB1 and LB2, columns 5 and 6), and coordinated bidding (column 7). The latter are equivalent to profits under a one-price balancing system, irrespective of spot market bidding (the upper bound of Proposition 2, which we denote UB), separate spot and balancing market bidding, or coordinated bidding. Hence, in the given test instances, the upper bound is binding. This does, however, not hold in case of further restrictions on the provision of regulating power, which is the reason we do not state this as a general result. Finally, the table shows the percentage gain from coordinated bidding (which is equivalent to (UB−LB2)/LB2, column 8) and the percentage difference between the upper and lower bounds ((UB−LB1)/LB1, column 9).

The profitability of offering regulation is clearly reflected by the gain from entering the balancing market (see column 9) and the gain from coordinating bidding (see column 8). For instance, for December 2010, the gains are 9.60% and 8.03%, respectively. Note that average spot and balancing prices differ by 5.84%. To further investigate the size of the gain from coordinated bidding, we again made additional test runs in which we increased balancing prices by 5% (average spot and balancing prices differ by 1.13%) and found gains of 4.88% and 4.23%, by 10% (average prices differ by 3.58%) and found gains of 5.29% and 4.75%, and by 20% (average prices differ by 12.99%) with gains of 9.93% and 9.81%. Observe that the size of the gains do not necessarily increase with an increase in balancing prices (as this increases the value of up regulation but decreases the value of down regulation) but rather with an increase in the difference between balancing and spot prices. When average price levels in the two markets are almost identical, the gains are moderate. However, the larger the difference between average balancing and spot prices, the larger the gain. The results therefore indicate that coordinated bidding may become increasingly important in a future power system, given that the expected growth in fluctuating renewable production is expected to increase the value of balancing power relative to the spot market dispatch.

The profitability in our bidding model of offering regulation in the balancing market is further confirmed from the bidding curves. In Fig. 3
                        , we show examples of optimal spot market supply curves for two selected hours, using separate and coordinated bidding strategies, respectively (Note that the small number of steps on the bidding curves is due to the simplistic modeling of hydropower operation, assuming a constant generation efficiency and a small number of line segments to define the piece-wise linear water value function). It is clear from the figure that for some hours large volumes are bid into the spot market under coordinated bidding in order to facilitate subsequent offering of down regulation in some scenarios. For other hours the spot market bidding curves are almost the same under separate and coordinated bidding.

Finally, we consider the bounds on the profits obtained from separate and coordinated bidding derived in Propositions 1 and 2. Under a one-price balancing mechanism, the upper and lower bounds collapse, and the value of entering the balancing market is zero, cf. Corollary 1. Thus, this market design provides no incentives for market participants to relieve system imbalances. In contrast, under a two-price balancing mechanism, such incentive does indeed exist as reflected by the significant gain from coordination addressed above. Furthermore, we find the difference between the upper and lower bounds (column 9) to be a good indicator for this gain. Thus, assuming a practitioner already solves the spot market bidding problem, he/she may assess the profitability of entering the balancing market and from coordinated bidding without actually solving the coordination problem, but merely by solving two variations of his/her problem (under the one-price and two-price balancing mechanisms). If the difference between upper and lower bounds is found to be small, there is no need to formulate and solve the coordination problem. It should again be remarked that in the given test instances the upper bound is binding. In case of restrictions on the provision of balancing power, however, the upper bound is no longer binding, and the quality of the bounds may not be as good. If, for example, we impose the constraint that only 50% of production capacity is available for balancing services in December 2010, the gain is 5.89%, whereas the differences between upper and lower bounds are 9.60% and 8.41%.

The price-taker assumption is questionable in reality, and so we allow for price response in the results of Table 4
                        . In this table, we provide the profit from coordinated bidding under both the one-price (column 5) and two-price balancing systems (column 7), as these are no longer the same. Under a two-price system, regulation volumes are only somewhat lower for a price-making market participant than for a price-taker. However, we observe that the gain from coordination is much smaller, the reason being that balancing prices decrease with the dispatch of up-regulation bids and increase with the down-regulation dispatch. In spite of allowing for price response, gain from coordination remains zero under a one-price system.

@&#CONCLUSION@&#

In this paper, we proposed a multi-stage stochastic programming model for coordinated bidding into two sequential markets, namely the Nordic spot and balancing markets, and put efforts into generating market price scenarios that preserve autocorrelations and cross-correlations. Our main objective was to quantify the gain from coordinated bidding, and we derived bounds on this gain that can be computed without actually solving the coordination problem.

We show that there is no incentive to enter and bid into the balancing market under a one-price balancing mechanism. Under a two-price balancing mechanism, however, our bidding model indicates that there is a significant gain from entering the balancing market and from coordinating bidding in the spot and balancing markets. When average balancing prices exceed average spot prices, it is optimal to hold back capacity in the spot market to facilitate subsequent offering of up regulation, and in the opposite situation, to put forward capacity in the spot market such as to offer down regulation. Coordinated bidding may therefore become increasingly important in a future power system, given that the expected growth in fluctuating renewable production is expected to increase the value of balancing power.

Our model can be improved by the inclusion of risk measures in the objective or constraints in order to reflect a potential risk aversion of practitioners. Further improvements include more advanced price models. Finally, our model can be modified to support bidding in other near real-time markets such as ancillary services markets. Following continuing discussions on the relevance of a so-called capacity market, an interesting extension of our model is the reservation of balancing power capacity on longer contracts.

@&#ACKNOWLEDGEMENTS@&#

The authors gratefully acknowledge support from the ENSYMORA project funded by the Danish Council for Strategic Research. Furthermore, we wish to thank an anonymous referee for many valuable comments and useful suggestions, which we believe have significantly improved the paper. Finally, the corresponding author wishes to thank Wouter Boomsma for invaluable assistance with the Python programming.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.04.027.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

