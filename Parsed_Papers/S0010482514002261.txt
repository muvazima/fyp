@&#MAIN-TITLE@&#Evaluation of robust wave image processing methods for magnetic resonance elastography

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Addressing wave image processing and enhancement in MRE.


                        
                        
                           
                           Investigating various solutions for phase unwrapping, directional filtering and noise suppression.


                        
                        
                           
                           Carrying out both quantitative and qualitative experiments for performance evaluation and comparison.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Directional filtering

Magnetic resonance elastography

Noise suppression

Phase unwrapping

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

There is a long tradition of soft tissue palpation in clinic for health evaluation and disease diagnosis. Manual palpation is not only limited to surface organs such as throat, breast and prostate for cancer screening, but also of major importance when diagnosing possible infection of liver and spleen [1]. Other than functional diagnosis [2], elasticity is essential for many emerging biomedical applications. For example, tactile sensation is important during surgical operation but it is difficult for medical robotics [3]. However, the outcomes of anatomical imaging, including ultrasound, computed tomography (CT) and magnetic resonance imaging (MRI), do not have explicit connections with soft tissue elasticity, in particular at the early stage of physiological alterations [4]. It is thus attractive to develop novel modalities to measure and visualize soft tissue elasticity quantitatively. This information is contributive to health evaluation, disease diagnosis, and medical robotics as well. Magnetic resonance elastography (MRE) is a promising technology in this regard [5].

For noninvasive palpation, MRE employs low-frequency mechanical waves as a virtual probe. Once being imported into soft objects, mechanical waves propagate with various complicated phenomena of refraction and diffraction. The pattern of wave propagation varies according to local biomechanical properties. With specially-programmed pulse sequences, MRI is able to capture varying wave patterns, from which it is possible to reconstruct or estimate soft tissue elasticity. In other words, MRE involves not only wave image reconstruction but also elasticity estimation. The first part is indispensable in most phase-contrast imaging, but the latter one is a challenging inverse problem of wave equation [6,7].

There have been several very good reviews on MRE [8–11], including those from the perspectives of method, technique and applications, respectively. Nevertheless, there is a lack of inspective study on wave image processing for MRE. Here we firstly introduce some popular techniques for MRE wave imaging, and then concentrate on the solutions for MRE wave image processing and analysis. The remainder of this paper is organized as follows. The second section briefs how wave images come into being in MRE and why they are prone to noise and artifacts. The third one describes some useful techniques for wave image enhancement, and how they assist elasticity reconstruction is explained with examples in the fourth section. Concluding remarks are drawn in the last section.

MRE is designed to quantify soft tissue elasticity by noninvasive imaging techniques. It usually comprises an actuator for motion excitation, a specially-programmed magnetic resonance modality for motion imaging, and the software for elasticity interpretation [12]. There are two kinds of distinct MRE paradigms, one is static and the other one is dynamic. The static or quasi-static solutions track the tissues before and after deformation by using displacement-encoding or tagging pulse sequences [13]. They have widespread applications in evaluating myocardial stain. Note that both tagging and displacement-encoding pulse sequences are sensitive to large deformation only. Nevertheless, most soft tissues are nearly incompressible; hence substantial deformation is not easy. In addition, it is difficult to derive out quantitative strain maps because there is no information of force distribution [14].

Both imaging pulse sequences of static and dynamic MRE paradigms make use of the Stejskal–Tanner bipolar gradient pairs (BGPs) that are commonly found in phase contrast imaging. The Stejskal–Tanner BGPs are a group of balanced preparatory dephasing and rephasing gradients. If the tissues of interest are stationary in the encoding direction, there would be no accumulated difference in phase. In contrast, if the tissues are moving or vibrating, the resultant phase difference might encode such motion information. However, BGP has to be synchronized with external vibration in dynamic solutions [8–10]. The subsequent discussion is then limited to dynamic MRE, where the patterns of wave propagation in different soft tissues are imaged and quantitative elasticity is derivable.

Mechanical wave propagation is refractory and difficult to control [15]. In heterogeneous viscoelastic soft tissues, propagation has to confront attenuation, reflection and refraction [16]. MRE encodes wave propagation into phase; hence imaging parameters including BGP duration and strength have to be appropriate [17]. As shown in 
                     Fig. 1(a) through (d), if too small, signals would be too weak; if too big, they are prone to being wrapped. Also, in MRE wave images, there are other noise and outliers from wave interference [18], electromagnetic turbulence [19] or chemical phase shifts.

One of the biggest challenges in MRE wave imaging lies in low signal-to-noise ratio (SNR). There has been an intrinsic mechanism since the beginning [5], namely, employing multiple synchronized BGPs to amplify weak elastic vibrations inside heterogeneous soft tissues. As shown in Fig. 1(e) through (h), SNR usually increases with more pairs of Stejskal–Tanner gradients. Nevertheless, the pairs of BGPs are limited to other imaging parameters including repetition time (TR) and echo time (TE). In particular, the more pairs of Stejskal–Tanner gradients, the more demanding to MRI hardware. As a consequence, a scanning with multiple BGPs is often subjected to field inhomogeneity, electromagnetic noise and phase wrapping. In other words, it might be more effective to enhance tissue motion directly. Usually, low-frequency shear waves penetrate deeper into soft tissues, while high-frequency shear waves have higher spatial resolution. Then, there is another dilemma between penetration and resolution [20]. It is yet an open issue on efficiently delivering shear waves to a specific region of interest (ROI) [19].

Imaging speed is another big issue in MRE that involves multiple steps of phase delay for wave field reconstruction. In some cases, it has to capture the information of wave propagation in all three directions. Therefore, for a dedicated low-field MRE system [21], it is not surprising to take about 80min for wave imaging. Although MRE is theoretically insensitive to unsynchronized motion, it inevitably results in low SNR [22] and, in particular, is not reasonable to keep objects static for such a long time. It is thus attractive to speed up MRE wave imaging. Ultrafast pulse sequences including [17] and [23] are helpful, but their outcomes often suffer from low SNR. Murphy et al. [32] found that, for relatively low spatial frequency content and low amplitude of the shear waves in the brain, it is possible to significantly reduce acquisition time by subsampling k-space while maintaining a mean error of elasticity reconstruction less than 10%.

After obtaining a series of wave images with different phase delays {θ|θ
                     1, θ
                     2,…,θ
                     
                        n
                     }, harmonic analysis is employed to extract the complex-number wave field Φ, with which the elasticity distribution of soft tissues that support mechanical wave propagation can be numerically estimated. Nevertheless, acquiring perfect wave images with sufficiently good SNR is not easy in practice [6], [24]. It might be due to imaging noise, wave interference and/or inappropriate modeling. They are either inherent to MRE (e.g., phase wrapping and wave interference) or extrinsic due to accessory components (e.g., motion instability and electromagnetic artifacts). Before MRE elasticity reconstruction, preprocessing is necessary because noise and artifacts are misleading. The methods of phase unwrapping, directional filtering and noise suppression have been implemented and evaluated for wave image enhancement.

Phase wrapping is a commonly encountered problem in MRI. Any signal in an MRI phase image is rounded within the interval [−π, π] or [0, 2π], namely
                           
                              (1)
                              
                                 φ
                                 =
                                 (
                                 ϕ
                                 +
                                 ε
                                 )
                                 mod
                                 (
                                 2
                                 π
                                 )
                                 .
                              
                           
                        
                     

Here Φ is the unknown true phase, ε phase error, and φ denotes the phase measured by MRI. The objective of phase unwrapping is to recover Φ by adding to (or subtracting from) φ a multiple times of 2π. In other words, phase unwrapping is mathematically straightforward via
                           
                              (2)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       Ω
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       Ω
                                    
                                 
                                 +
                                 
                                    
                                       η
                                    
                                    
                                       Ω
                                    
                                 
                                 (
                                 2
                                 π
                                 )
                                 ,
                              
                           
                        where the subscript Ω denotes the domain of phase image, and η
                        Ω is an integer array assigning the unwrapping constant in each pixel.

The so-called Itoh condition assumes that the absolute phase difference between neighboring pixels should be less than π 
                        [25]. It is not technically difficult to find out η
                        Ω if a phase image is sufficiently smooth. As a matter of fact, there have been some intrinsic mechanisms including susceptibility weighted imaging [26] for phase unwrapping in most commercial modalities. However, there are always noise and artifacts in MRE wave images, which makes phase unwrapping an ill-posed problem. The following experiments will show that phase unwrapping is often not as straightforward as expected.

The methods of quality guidance, discontinuity minimization and graph cuts have been proposed to tackle the issues of noise and artifacts in phase unwrapping [25]. We implemented and evaluated the algorithms of phase unwrapping via max-flow/min-cut (PUMA) [27] and Goldstein׳s branch cut (GBC) other than the classical Itoh one. PUMA provides a framework of energy minimization and pursues the optimization by a series of max-flow/min-cut calculations. It is functional with or without quality guidance. However, the latter is indispensable for GBC. Similarly, the performance of Itoh algorithms relies on the choice of seed phase substantially.

Wave interference is another refractory problem in MRE. Wave reflection and refraction happen between heterogeneous tissues and also in the peripheral boundaries. Both reflection and refraction interfere in wave propagation, and thus confuse the subsequent algorithms for elasticity reconstruction. Moreover, the interference between forward and backward waves would counteract tissue displacement, and thus result in low SNR. There have been different algorithms proposed for wave inversion and elasticity reconstruction. Most algorithms do not take boundary conditions into account in that no boundary information could be imaged [8], [28]. As a consequence, they cannot deal with wave reflection and refraction well [18].

In mathematics, the wave with a specific frequency corresponds to two peaks in the Fourier domain: one at ω(k
                        
                           x
                        ,k
                        
                           y
                        ) and the other one at ω(−k
                        
                           x
                        ,−k
                        
                           y
                        ) in the opposite half-space. The waves traveling in the opposite directions are represented as these symmetric peaks in the Fourier domain. It is thus possible to design a directional spatiotemporal filter to separate them, and then interpret them one by one. The lognormal Gabor filters have been proposed for wave interference suppression in [18]. As shown in 
                        Fig. 2(a), the lognormal Gabor filters, defined in the log-polar coordinate of the Fourier domain, are spatiotemporally directional.

In order to suppress the aforementioned interfering artifacts, a wave image first undergoes band-pass filtering in Fig. 2(b) that cuts off both ultralow- and ultrahigh-frequency components. In general, high-frequency components come from random noise only, while ultralow-frequency ones are possibly due to longitudinal waves and bulk motion. It is then selected by a cos2-dependent directional spatiotemporal filter. For example, the filter in Fig. 2(c) may separate the wave components traveling from bottom to top. Another important property of such spatiotemporal filters is that they can be recombined into the original band-pass filter. However, as shown in Fig. 2(d), there is substantial difference between the reconstructed filter and the original band-pass one. In other words, this is not a lossless filter, whose effect would be validated in the following experiments. It is thus attractive to introduce more advanced directional spatiotemporal filters [29] for wave interference suppression.

Other than phase wrapping and wave interference, there is contamination due to noise and outliers. Most algorithms of MRE elasticity reconstruction including algebraic inversion of differential equation (AIDE) and local frequency estimation (LFE) have intrinsic mechanisms of noise suppression. For example, the algorithm AIDE is established on the point-by-point inversion of complex-number Laplacian
                           
                              (3)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Ω
                                    
                                 
                                 =
                                 −
                                 ρ
                                 
                                    
                                       (
                                       2
                                       π
                                       
                                          
                                             f
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             Ω
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∇
                                          
                                          2
                                       
                                       
                                          
                                             u
                                          
                                          
                                             Ω
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where μ denotes shear modulus, ρ tissue density, f
                        m vibration frequency and u the first harmonic displacement. The Laplacian operator is sensitive to noise, but AIDE does not directly calculate this high-order differential. Instead, it approximates Laplacian by using a Savitzky–Golay filter or a matched filter. The algorithm LFE employs a series of lognormal Gabor filters to estimate local wavelengths λ
                        s, and relates to shear moduli via
                           
                              (4)
                              
                                 μ
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                    2
                                 
                                 .
                              
                           
                        
                     

The lognormal Gabor filters may accomplish noise suppression similar to wavelet thresholding. In other words, most MRE algorithms are robust to modest white noise.

However, noise suppression in MRE is not as straightforward as expected. Conventional Gaussian or wavelet smoothing filters assume that noise amounts to trivial high-frequency components, which could be reduced or simply removed. They often destroy important features, such as edge, texture and fine structures, while reducing noise and outliers. Denoising by anisotropic diffusion or total variation aims at balanced structure preservation and noise suppression [30]. Here images are supposed to have a simple geometric description, namely, a set of connected smooth objects with jumping interfaces.

All of them nonetheless do not characterize MRE contamination well. On one hand, noise in MRE is subjected to speckle or Rician distributions. On the other hand, MRE images contain complicated information of wave propagation that is eventually confusing with noise. In other words, MRE noise and outliers mix with varying wave propagation, which makes it challenging for locally adaptive techniques including anisotropic diffusion and wavelet thresholding. Here the NL-means algorithm [31] is introduced to denoise MRE wave images. Its performance is evaluated against that of three popular mechanisms of noise suppression, namely Gaussian smoothing, wavelet filtering and anisotropic diffusion.

@&#PERFORMANCE EVALUATION@&#

The methods and techniques introduced above for wave image processing were evaluated on two MRE datasets. The first one was produced with a simulator and the details have been reported in [6]. As shown in 
                        Fig. 3(a), the phantom (R1) was a rectangular plate (11×11cm2) enclosing two inclusions (R3: 6×6cm2; R4: 3×3cm2). It was excited by a 200Hz planar shear wave. The harmonic motion was subjected to the Helmholtz equation with Neumann boundary condition
                           
                              (5)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         Ω
                                                      
                                                   
                                                   +
                                                   j
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         Ω
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         ∇
                                                      
                                                      2
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         Ω
                                                      
                                                   
                                                   =
                                                   −
                                                   
                                                      
                                                         (
                                                         2
                                                         π
                                                         200
                                                         )
                                                      
                                                      2
                                                   
                                                   ρ
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         Ω
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         Ω
                                                      
                                                   
                                                   
                                                      n
                                                      
                                                         →
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where the subscript Ω denotes the field of interest, ρ the tissue density (default 1000kg/m3), u the unknown wave field, µ and ζ are the shear modulus and the attenuation coefficient respectively. Here the variational stiffness map µ was set as
                           
                              (6)
                              
                                 μ
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       0
                                    
                                 
                                 H
                                 (
                                 R
                                 1
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 H
                                 (
                                 R
                                 3
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 H
                                 (
                                 R
                                 4
                                 )
                                 ,
                              
                           
                        where µ
                        0=2.5kPa, µ
                        1=5.0kPa, µ
                        2=7.5kPa, and H(∙) is a Heaviside function. The attenuation coefficient ζ was set as 2% of the shear modulus map µ.

The wave field in Fig. 3(b) was simulated by solving Eq. (5). In order to evaluate the effects of phase unwrapping and noise suppression, the wave field was contaminated with 25% speckle noise. As shown in Fig. 3(c), the wave field was clearly visible despite of substantial noise. Furthermore, the effects of phase wrapping were simulated by following
                           
                              (7)
                              
                                 u
                                 ′
                                 =
                                 arctan
                                 
                                    {
                                    
                                       
                                          
                                             sin
                                             (
                                             10
                                             u
                                             )
                                          
                                          
                                             cos
                                             (
                                             10
                                             u
                                             )
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     


                        Fig. 3(d) and (e) illustrate the wrapped clean and noisy wave fields.

In addition, an MRE dataset was collected from a 2.0T MRI modality (Bruker BioSpin, Rheinstetten, Germany) at the National Institute of Advanced Industrial Science and Technology (AIST, Tsukuba, Japan). 
                        Fig. 4(a) illustrates a cylindrical phantom that was composed of different modular layers with 1%, 1.5% and 2% agar gel, respectively. In general, the denser the agarose gel is, the harder the modular layer is [6]. There was an actuator exerting 200Hz harmonic vibration at the left side. A spin-echo motion-sensitizing pulse sequence was employed to capture the information of wave propagation with the controlling parameters: TR 400ms, TE 15.2ms, flip angle 30°, acquisition matrix 256×256, field-of-view (FOV) 13cm×13cm, and phase offsets 8.

In contrast to conventional methods, MRE incorporates wave information into phase images. It takes the corresponding magnitude images for a reference only while interpreting phase images. As shown in Fig. 4(b), the phase images manifesting wave propagation are obviously different from the static one in Fig. 4(a). In order to recover the complete field of wave propagation, a series of wave images were snapshot with regularly spaced phase delays. Although seemingly complicated, the wave images in Fig. 4(c) turn readable after removing the phase information of motionless components.

As shown in Fig. 3(e), the unfavorable effects of noise and phase wrapping often mix together. In practice, it is used to carry out phase unwrapping first because the effect is more serious. The basic Itoh algorithm attempts to unwrap wave images point by point and line by line; hence it is susceptible to noise. However, as shown in 
                        Fig. 5(b) and (c), error propagation is merely limited within a specific direction, no matter vertical or horizontal. In contrast, GBC and PUMA pursue a global minimization for phase unwrapping. As a consequence, there is no isolated artifact in Fig. 5(d) and (e). Comparatively, PUMA is more robust than GRC with respect to noise.

After phase unwrapping, four representative algorithms including Gaussian smoothing, wavelet filtering, anisotropic diffusion and NL-means were evaluated for noise suppression. In reference to [31], the Gaussian smoother was a rotationally symmetric lowpass filter with size 3 and standard deviation 2. The discrete stationary wavelet transform with soft thresholding was adopted for noise suppression. The threshold was adaptively configured as one tenth of the maximum phase. It was applied to diagonal, vertical and horizontal details respectively after 3-order wavelet decomposition. We controlled the anisotropic diffusion by that threshold, too. At last, NL-means was configured with a searching window 7, a similarity window 5 and the degree of filtering 1.


                        
                        Fig. 6(a) illustrates the effects of noise suppression by using the preceding algorithms. On one hand, the noise is not clearly visible any longer. On the other hand, the effects are not differentiable in the wave field. Therefore, other than visual evaluation, the contributions were further clarified in Fig. 6(b) and (c). The latter is a vertical line along the middle of the elastograms. It seems that the elastogram reconstructed from the noisy wave field has very low SNR. All denoising algorithms are helpful, but NL-means achieved a better performance from the perspectives of contrast and smoothness. Meanwhile, it is noteworthy that the Gaussian smoother had a comparable contribution against wavelet filtering and anisotropic diffusion.

As shown in Fig.4(c), there are annoying noise and artifacts in the unprocessed wave images. They might be due to phase wrapping, wave interference or imaging noise. PUMA [27] unwrapped MRE phase images without manual intervention. It is shown in Fig. 4(d) that most noise and artifacts should come from phase wrapping. Despite of visible noise, the propagation of mechanical waves is now clearly visible from left to right. Therefore phase unwrapping is indispensable for MRE wave image enhancement.


                        
                        Fig. 7 shows that the patterns of wave propagation vary in the composing modules, but a question remains whether such phenomena came from wave interference. Given there was complicated wave interference, we developed the lognormal Gabor filters and separated the wave field into spatiotemporal directional components. For example, the wave field was decomposed into two horizontal and two vertical components by using 0°, 90°, 180° and 270° lognormal Gabor filters respectively. The top row in Fig. 7 exhibits the main wave from left to right and the reflected wave from right to left. There is apparent wave refraction, which would confuse subsequent elasticity reconstruction, in the other two vertical components. Note that the individual wave components are not physical, but the wave field can be recovered by recomposing these spatiotemporal directional components. It is thus possible to process those wave components one by one and then derive the final elasticity distribution after appropriate weighting [18].

The first column in Fig. 7 shows that there is annoying noise in the extracted wave field no matter before or after lognormal Gabor filtering. The abovementioned four mechanisms of noise suppression were applied with the same controlling parameters. There is no too much visible distinction between NL-means and other techniques. Nevertheless, the subsequent elasticity reconstruction differentiated their contributions (
                        Fig. 8).

LFE has intrinsic mechanisms to cope with modest noise and outliers. However, they are not effective for phase wrapping and wave interference. Fig. 8(b) shows the elasticity reconstruction on the complex-number wave field extracted from Fig. 4(c) without enhancement. There is little information about the structural or functional composition of this agarose phantom. As shown in Fig. 8(c), the situation seems not promising after phase unwrapping although it enhanced wave images substantially. Fig. 8(d) shows that the spatiotemporal directional filtering did a good favor to elasticity reconstruction. There are fewer interfering artifacts, and in particular, the contrast is better. If taking the magnitude image in Fig. 8(a) for a reference, all denoising algorithms are helpful for elasticity reconstruction.

The NL-means algorithm is most suitable for the images with abundant periodic patterns, for example leaves, bricks and texture. For every textural component one can find many samples with a very similar configuration. It leads to noise reduction and feature preservation. We supposed that the periodic patterns in MRE wave images are similar to texture ones; hence we evaluated NL-means for noise suppression. It is found in Figs. 6–8 that, firstly, all denoising techniques were helpful in wave image enhancement, and secondly, NL-means did achieve an optimal performance.

@&#CONCLUSION@&#

MRE involves two phases of reconstruction, namely translating k-space data into wave images and estimating tissue elasticity from wave images. We introduced some fundamental solutions that are helpful for wave image enhancement before elasticity reconstruction. Phase unwrapping corrects inappropriate wave imaging settings; spatiotemporal directional filters suppress wave interference; noise suppression enhances wave images. The results in this study show that all of them are indispensable in case of low-SNR MRE imaging.

Note that elasticity reconstruction was not consistent with the magnitude image in Fig. 8. In practice, this man-made agarose phantom, different from simulation, might have a heterogeneous mechanical composition. In addition, if elastic vibration was too weak, the current imaging techniques could not capture and recover the patterns of wave propagation. If so, current elasticity reconstruction algorithms were not robust enough to reconstruct elasticity accurately. In practice, MRE interpretation often takes the supplementary information of elasticity and anatomy into consideration. In the future, we will further work on better algorithms for elasticity reconstruction, and investigate how to integrate the methods for wave image enhancement with the ones for MRE elasticity reconstruction.

None declared.

@&#ACKNOWLEDGMENT@&#

The authors are grateful of technical supports from Dr. Tomokazu Numano, Dr. Toshikatsu Washio and Prof. Kazuhiro Homma from the National Institute of Advanced Industrial Science and Technology (AIST), Tsukuba East, Japan. This works was supported by the National Natural Science Foundation of China (Grant nos: 61271123 and 61101022), the Department of Science and Technology of Anhui (Grant no: 1201B0403019), and the Fundamental Research Funds for the Central Universities (Grant no: 2013HGCH0009).

@&#REFERENCES@&#

