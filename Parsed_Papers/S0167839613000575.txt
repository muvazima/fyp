@&#MAIN-TITLE@&#Some properties of LR-splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A polynomial representation formula for the LR B-spline collection is shown.


                        
                        
                           
                           The number of functions of the LR B-spline collection whose support contains a point is studied.


                        
                        
                           
                           The close relation between the above properties is asserted.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Locally refinable splines

Linear independence

Polynomial representation

Quasi-interpolant

Overlap

@&#ABSTRACT@&#


               
               
                  Recently a new approach to piecewise polynomial spaces generated by B-spline has been presented by T. Dokken, T. Lyche and H.F. Pettersen, namely Locally Refined splines. In their recent work (Dokken et al., 2013) they define the LR B-spline collection and provide tools to compute the space dimension. Here different properties of the LR-splines are analyzed: in particular the coefficients for polynomial representations and their relation with other properties such as linear independence and the number of B-splines covering each element.
               
            

@&#INTRODUCTION@&#

B-splines are a basis of piecewise polynomials on tensor-product meshes. Their rational counterpart, the NURBS, are the standard tool to represent shapes in Computers Aided Design. This choice was motivated both by the flexibility of B-splines and NURBS for the parametrization of relevant geometric shapes, and by the existence of efficient and stable algorithms to modify, refine and evaluate them. B-splines are available for any polynomial degree and allow different choices of smoothness on the inter-element boundaries. Because of these properties B-splines are a promising choice for the development of Galerkin methods for both ODEs and PDEs. This choice has been proposed in Hughes et al. (2005) under the name of isogeometric analysis (the same functions are used for geometry and analysis). Isogeometric analysis has given a new momentum to the research both in the field of geometric design and numerical analysis of PDEs. A more comprehensive description of isogeometric analysis can be found in Cottrell et al. (2009). The main advantages of the isogeometric method are:
                        
                           •
                           the NURBS geometry is exactly represented within the solver, and is preserved by refinements;

the refinement of the space is flexible: both p-, h- and k-refinement are possible, the latter being a combination of the first two (Hughes et al., 2005);

it is possible to use highly smooth functions that enjoy superior approximation properties (Evans et al., 2009; Beirão da Veiga et al., 2011) and are the foundation of many isogeometric analysis schemes (Buffa et al., 2011a, 2011b; Evans and Hughes, 2012a, 2012b).

The weakness of the B-spline basis, both as design and as analysis tool, is the tensor-product structure of the underlying mesh that hinders local refinements, and thus forces the use of big discrete spaces and causes a loss in efficiency. In the last two decades there were many attempts to overcome this limitation: in 1988 Forsay and Bartels introduced the hierarchical-splines (Forsey and Bartels, 1988), in 2003 Sederberg introduced T-splines (Sederberg et al., 2003, 2004) (see also the extension in Finnigan, 2008), in 2008 Deng, Chen, Li, Hu, Tong, Yang and Feng introduced PHT-splines (Deng et al., 2008), and in 2012 Dokken, Lyche, and Pettersen introduced LR-splines (Dokken et al., 2013). T-splines are the currently preferred framework for refinement in isogeometric analysis (Bazilevs et al., 2010). T-splines were initially introduced for Computer Aided Design and, at the beginning, their use in analysis has shown some difficulties. Indeed the generators can be linearly dependent (Buffa et al., 2010), they may produce severe fill-in of the mesh (Dörfel et al., 2010) and their properties are difficult to study. These problems were and are being addressed by researchers. For bivariate T-splines, most of these problems were solved by identifying a subset of T-meshes for which some fundamental properties hold. This subset is called analysis suitable T-splines (Scott et al., 2012; da Beirão et al., 2012; Li et al., 2012; Beirão da Veiga et al., 2012; Li and Scott, 2012). The development of LR-splines started in parallel to find an alternative refinement strategy. Contrarily to AS T-splines, LR-splines are defined from the description of the discrete space in terms of Bezier domains and continuity conditions. This point of view makes the theory more structured and organized.

The present manuscript extends the work in Dokken et al. (2013) and provides some theoretical results about the LR B-spline collection. The following issues are addressed:
                        
                           1.
                           the number of LR-splines with overlapping support;

the partition of unity property of LR-splines;

the adaptation of the blossoming formula for the representation of polynomials and the construction of quasi-interpolants on LR-splines spaces.

In particular here it is proved that if there are not two B-splines in the LR B-spline collection whose supports are nested then the number of B-spline on each element equals the space dimension, moreover the LR B-spline collection is a partition of unity and the coefficients for polynomial representation are the same as in tensor product case. Actually all the properties above are equivalent to the more technical condition that there are no nested (see Definition 2.4) B-splines in the LR B-spline collection.

These properties have a clear impact on the use of LR-splines in isogeometric analysis applications. E.g., from 1 it is possible to obtain a bound for the number of nonzero entries in mass and stiffness matrices in applications to PDEs and from 3 it is possible to define quasi-interpolants on the space spanned by the LR B-spline collection.

This text is structured in the following way: Section 2 contains preliminary material about B-splines and box-meshes; this is a review of the content of Dokken et al. (2013). Section 3 contains the study of the overlap, that is the number of nonzero B-spline in each point of the domain. Section 4 deals with the coefficients of polynomial representations by reducing it to the tensor-product case. Section 5 summarizes the previous results and link them together.

Note that all the results are valid for general box-meshes and not only for LR-meshes.

This section contains a selection of the concepts and results from Dokken et al. (2013). There are few modifications and additions that are due the different focus. They are always highlighted and commented.

This subsection shows the used notation for B-splines and introduces the concept of nested B-splines.

A B-spline function 
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                           :
                           R
                           →
                           R
                         of degree p is a right continuous piecewise polynomial of degree p uniquely identified by a knot vector 
                           Ξ
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ⩽
                           ⋯
                           ⩽
                           
                              
                                 ξ
                              
                              
                                 p
                                 +
                                 2
                              
                           
                           )
                         such that 
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           <
                           
                              
                                 ξ
                              
                              
                                 p
                                 +
                                 2
                              
                           
                        . Given ζ the multiplicity of ζ in Ξ is 
                           
                              
                                 m
                              
                              
                                 Ξ
                              
                           
                           (
                           ζ
                           )
                           =
                           #
                           {
                           j
                           :
                           
                              
                                 ξ
                              
                              
                                 j
                              
                           
                           =
                           ζ
                           }
                         and it is related with the regularity of 
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                         in ζ. Indeed 
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                         is 
                           
                              
                                 C
                              
                              
                                 p
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       Ξ
                                    
                                 
                                 (
                                 ζ
                                 )
                              
                           
                         on ζ. The support of 
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                         is 
                           supp
                           
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                           =
                           [
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 p
                                 +
                                 2
                              
                           
                           ]
                        . Multivariate B-splines are obtained by multiplying univariate B-splines. In particular 
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                           →
                           R
                         with 
                           Ξ
                           =
                           (
                           
                              
                                 Ξ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Ξ
                              
                              
                                 d
                              
                           
                           )
                         and 
                           
                              
                                 Ξ
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 i
                                 ,
                                 1
                              
                           
                           ⩽
                           ⋯
                           ⩽
                           
                              
                                 ξ
                              
                              
                                 i
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 2
                              
                           
                           )
                         is the B-spline of degree 
                           p
                           =
                           (
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 d
                              
                           
                           )
                         defined by
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    d
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             Ξ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

The basic B-spline refinement method is knot insertion and consists in adding a new knot to the knot vector in order to obtain two new knots vectors of the same length. Here the knot insertion is seen as an operation on B-splines (it is described as knot vector refinement in Dokken et al., 2013).


                        
                           Definition 2.1
                           The knot insertion operator associated to a direction 
                                 k
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 d
                                 }
                               is 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 :
                                 {
                                 B-splines
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 →
                                 R
                                 }
                                 ×
                                 R
                                 ×
                                 {
                                 1
                                 ,
                                 2
                                 }
                                 →
                                 {
                                 B-splines
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 →
                                 R
                                 }
                               defined by
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             Ξ
                                          
                                       
                                       ,
                                       
                                          ξ
                                          ¯
                                       
                                       ,
                                       σ
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         Ξ
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ∉
                                                   ]
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   [
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               σ
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                               where the components of 
                                 
                                    
                                       Θ
                                    
                                    
                                       σ
                                    
                                 
                               are
                                 
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             σ
                                             ,
                                             i
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   i
                                                   ≠
                                                   k
                                                   ,
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                                
                                                   i
                                                   =
                                                   k
                                                   ∧
                                                   σ
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                                
                                                   i
                                                   =
                                                   k
                                                   ∧
                                                   σ
                                                   =
                                                   2
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Definition 2.2
                           A knot insertion is a triplet 
                                 ℵ
                                 =
                                 (
                                 B
                                 ,
                                 k
                                 ,
                                 
                                    ξ
                                    ¯
                                 
                                 )
                               where B is a B-spline 
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 →
                                 R
                              , 
                                 k
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 d
                                 }
                               is a direction and 
                                 
                                    ξ
                                    ¯
                                 
                                 ∈
                                 R
                               is a knot. It is said that ℵ refines B and produces 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 B
                                 ,
                                 
                                    ξ
                                    ¯
                                 
                                 ,
                                 1
                                 )
                               and 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 B
                                 ,
                                 
                                    ξ
                                    ¯
                                 
                                 ,
                                 2
                                 )
                              .


                        
                           Proposition 2.3
                           
                              For all knot insertions operators 
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                              
                              , all 
                              
                                 
                                    ξ
                                    ¯
                                 
                                 ∈
                                 R
                               
                              and B-spline 
                              
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 →
                                 R
                               
                              it holds
                              
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             Ξ
                                          
                                       
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             Ξ
                                          
                                       
                                       ,
                                       
                                          ξ
                                          ¯
                                       
                                       ,
                                       1
                                       )
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             Ξ
                                          
                                       
                                       ,
                                       
                                          ξ
                                          ¯
                                       
                                       ,
                                       2
                                       )
                                       ,
                                    
                                 
                               
                              where
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                         −
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ∈
                                                   ]
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                   ]
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   >
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                   ;
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               +
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               +
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   ∈
                                                   ]
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   ]
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   
                                                      ξ
                                                      ¯
                                                   
                                                   >
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              Note that both 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                               
                              are strictly positive when 
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 B
                                 ,
                                 
                                    ξ
                                    ¯
                                 
                                 ,
                                 {
                                 1
                                 ,
                                 2
                                 }
                                 )
                                 ≠
                                 {
                                 B
                                 }
                              
                              .
                           


                        
                           Definition 2.4
                           A B-spline 
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                               is nested in a B-spline 
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                               and it is written 
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                                 
                                    ⊂
                                    N
                                 
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                               if there exists a sequence of B-splines 
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                               such that for all 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                               there is a knot insertion 
                                 
                                    
                                       ℵ
                                    
                                    
                                       i
                                    
                                 
                               that refines 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                               and produces 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              .

Nestedness is a partial order relation on B-splines and it implies the nestedness of the supports: 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           
                              ⊂
                              N
                           
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           ⇒
                           supp
                           
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ⊂
                           supp
                           
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                        . The converse is false. A counter-example is 
                           supp
                           
                           
                              
                                 B
                              
                              
                                 (
                                 0
                                 ,
                                 
                                    1
                                    3
                                 
                                 ,
                                 1
                                 )
                              
                           
                           ⊂
                           supp
                           
                           
                              
                                 B
                              
                              
                                 (
                                 0
                                 ,
                                 
                                    2
                                    3
                                 
                                 ,
                                 1
                                 )
                              
                           
                        , but 
                           
                              
                                 B
                              
                              
                                 (
                                 0
                                 ,
                                 
                                    1
                                    3
                                 
                                 ,
                                 1
                                 )
                              
                           
                           
                              ⊄
                              N
                           
                           
                              
                                 B
                              
                              
                                 (
                                 0
                                 ,
                                 
                                    2
                                    3
                                 
                                 ,
                                 1
                                 )
                              
                           
                        .


                        
                           Proposition 2.5
                           
                              Let 
                              
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                               
                              be B-splines then 
                              
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                                 
                                    ⊂
                                    N
                                 
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                               
                              if and only if the following hold for 
                              
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       ⩾
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       
                                       ∀
                                       ζ
                                       ∈
                                       ]
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       [
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       ⩽
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       
                                       ∀
                                       ζ
                                       ∉
                                       ]
                                       
                                          
                                             ξ
                                          
                                          
                                             k
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       [
                                       .
                                    
                                 
                              
                           

Box-meshes are the basis of the LR-spline theory. A box is the generalization to any dimension of vertexes, edges, faces and elements that are usually associated to a quadrilateral mesh. There are minor differences compared to Dokken et al. (2013): here the multiplicity of mesh faces is not restricted to be greater that 0, and the definitions of boundary and interior of a box in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         are extended to boxes of arbitrary codimension.


                        
                           Definition 2.6
                           A box in 
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               is a Cartesian product
                                 
                                    
                                       [
                                       a
                                       ,
                                       b
                                       ]
                                       =
                                       
                                          ⨉
                                          
                                             i
                                             =
                                             1
                                          
                                          d
                                       
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                 
                               where for 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                               
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                               and thus 
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ]
                               is a nonempty closed finite interval. The dimension of β is
                                 
                                    
                                       dim
                                       [
                                       a
                                       ,
                                       b
                                       ]
                                       =
                                       #
                                       {
                                       i
                                       :
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       <
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       }
                                       .
                                    
                                 
                               A box of dimension k is called k-box.

Usually boxes are denoted with Greek letters such as 
                           α
                           ,
                           β
                           ,
                           …
                         etc.


                        
                           Definition 2.7
                           The boundary of a box 
                                 β
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                               is
                                 
                                    
                                       ∂
                                       β
                                       =
                                       
                                          ⋃
                                          
                                             
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                d
                                                :
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                <
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                J
                                                ˆ
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             J
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                               where 
                                 
                                    
                                       
                                          J
                                          ˆ
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 }
                              .


                        
                           Definition 2.8
                           The interior of box β is
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       β
                                       ∖
                                       ∂
                                       β
                                       .
                                    
                                 
                              
                           

Note that the boundary and interior of a k-box β are those corresponding to the topology induced on the k-dimensional affine subspace containing β.


                        
                           Definition 2.9
                           Let 
                                 Ω
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                               be a d-box in 
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                              . A box partition of Ω is a finite collection of d-boxes 
                                 E
                               such that:
                                 
                                    •
                                    
                                       
                                          
                                             
                                                ⋃
                                             
                                             
                                                β
                                                ∈
                                                E
                                             
                                          
                                          β
                                          =
                                          Ω
                                       ;


                                       
                                          ∀
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                2
                                             
                                          
                                          ∈
                                          E
                                        it holds 
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          ∩
                                          
                                             
                                                β
                                             
                                             
                                                2
                                             
                                             
                                                0
                                             
                                          
                                          =
                                          ∅
                                       .


                        
                           Definition 2.10
                           Let 
                                 E
                               be a box partition of Ω and 
                                 q
                                 ∈
                                 Ω
                              . Then 
                                 
                                    
                                       β
                                    
                                    
                                       q
                                    
                                 
                               is
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             q
                                          
                                       
                                       (
                                       E
                                       )
                                       =
                                       
                                          ⋂
                                          
                                             
                                                β
                                                ∈
                                                E
                                                :
                                             
                                             
                                                q
                                                ∈
                                                β
                                             
                                          
                                       
                                       β
                                       .
                                    
                                 
                              
                           

The above definition formalizes the intuitive description of the mesh a composition of vertexes, segments, …elements. Indeed 
                           
                              
                                 β
                              
                              
                                 q
                              
                           
                         is the least dimensional box containing q of this intuitive decomposition. To make this formalization work for points q that are in ∂Ω it is necessary to use the auxiliary partition 
                           E
                           ∪
                           
                              
                                 Ω
                              
                              
                                 +
                              
                           
                         where for 
                           Ω
                           =
                           [
                           a
                           ,
                           b
                           ]
                        
                        
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    ×
                                    ⋯
                                    ×
                                    
                                       
                                          J
                                       
                                       
                                          d
                                       
                                    
                                    :
                                    
                                       
                                          J
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       {
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       1
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                       ,
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                       ,
                                       [
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       ]
                                       }
                                    
                                    }
                                 
                                 ∖
                                 {
                                 Ω
                                 }
                                 .
                              
                           
                        
                     


                        
                           Definition 2.11
                           Given a box partition 
                                 E
                               of Ω let
                                 
                                    
                                       F
                                       (
                                       E
                                       )
                                       =
                                       
                                          
                                             {
                                             
                                                
                                                   β
                                                
                                                
                                                   q
                                                
                                             
                                             
                                                (
                                                E
                                                ∪
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                             
                                             }
                                          
                                          
                                             q
                                             ∈
                                             Ω
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       E
                                       )
                                       =
                                       
                                          
                                             {
                                             
                                                
                                                   β
                                                
                                                
                                                   q
                                                
                                             
                                             
                                                (
                                                E
                                                ∪
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                             
                                             }
                                          
                                          
                                             q
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             {
                                             
                                                
                                                   β
                                                
                                                
                                                   q
                                                
                                             
                                             (
                                             E
                                             )
                                             }
                                          
                                          
                                             q
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       E
                                       )
                                       =
                                       
                                          {
                                          β
                                          ∈
                                          F
                                          (
                                          E
                                          )
                                          :
                                          dim
                                          β
                                          =
                                          k
                                          }
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       E
                                       )
                                       =
                                       
                                          {
                                          β
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          E
                                          )
                                          :
                                          dim
                                          β
                                          =
                                          k
                                          }
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Definition 2.12
                           
                              μ-extended box-mesh


                           A μ-extended box-mesh on the d-box Ω in 
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               is a couple 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               where:
                                 
                                    •
                                    
                                       
                                          M
                                        is 
                                          
                                             
                                                F
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                M
                                             
                                          
                                          )
                                        for some box partition 
                                          
                                             
                                                E
                                             
                                             
                                                M
                                             
                                          
                                        of Ω;


                                       
                                          μ
                                          :
                                          M
                                          →
                                          N
                                        is a function.

The above definition is slightly more general than the corresponding Definition 2.5 in Dokken et al. (2013). Indeed in Dokken et al. (2013) 
                        μ is not allowed to take the value 0, this forbids L shaped Bezier domains. Here this restriction is not imposed.


                        
                           Definition 2.13
                           
                              μ-extended tensor mesh


                           A μ-extended box-tensor mesh in 
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               is a μ-extended box-mesh 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               such that
                                 
                                    •
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                M
                                             
                                          
                                          =
                                          {
                                          [
                                          
                                             
                                                a
                                             
                                             
                                                1
                                                ,
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                a
                                             
                                             
                                                1
                                                ,
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                1
                                             
                                          
                                          ]
                                          ×
                                          ⋯
                                          ×
                                          [
                                          
                                             
                                                a
                                             
                                             
                                                d
                                                ,
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                a
                                             
                                             
                                                d
                                                ,
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      d
                                                   
                                                
                                                +
                                                1
                                             
                                          
                                          ]
                                          :
                                          1
                                          ⩽
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          ⩽
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                          ,
                                          
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          d
                                          }
                                        where the 
                                          
                                             
                                                a
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                          
                                        are real number such that for 
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          d
                                        and 
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                        
                                       
                                          
                                             
                                                a
                                             
                                             
                                                k
                                                ,
                                                i
                                             
                                          
                                          <
                                          
                                             
                                                a
                                             
                                             
                                                k
                                                ,
                                                i
                                                +
                                                1
                                             
                                          
                                       ;

for all 
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                2
                                             
                                          
                                          ∈
                                          M
                                        contained in the same hyperplane H
                                       
                                          
                                             
                                                μ
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                =
                                                μ
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    


                        
                           Definition 2.14
                           A polynomial of degree 
                                 p
                                 =
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       d
                                    
                                 
                                 )
                               is a polynomial of degree at most 
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                               in the variable 
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                               for 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              . The space of polynomials of degree p is 
                                 
                                    
                                       P
                                    
                                    
                                       p
                                    
                                 
                               and it is the tensor-product 
                                 
                                    
                                       ⨂
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                               where 
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                               is the space of univariate polynomials in the variable 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                               of degree at most 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              .


                        
                           Definition 2.15
                           The spline space of degree p associated to an extended box mesh 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               is 
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               and it contains the 
                                 f
                                 :
                                 Ω
                                 →
                                 R
                               satisfying
                                 
                                    •
                                    
                                       f is right continuous in each variable 
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                        and continuous on ∂Ω;


                                       
                                          f
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                        is a polynomial of degree p for all 
                                          β
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          M
                                          )
                                       ;


                                       f is 
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                μ
                                                (
                                                β
                                                )
                                             
                                          
                                        in 
                                          
                                             
                                                β
                                             
                                             
                                                0
                                             
                                          
                                        for all 
                                          β
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          M
                                          )
                                        orthogonal to the k-th canonical vector 
                                          
                                             
                                                e
                                             
                                             
                                                k
                                             
                                          
                                       , 
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          d
                                       .

Note that all spline spaces corresponding to extended box-meshes contain the polynomials of degree p, i.e. 
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                           ⊂
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                        .


                        
                           Proposition 2.16
                           
                              A B-spline function 
                              
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                               
                              of degree 
                              p 
                              is in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               
                              if and only if the following propositions hold true
                              
                                 
                                    1.
                                    
                                       for all 
                                       
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          d
                                        
                                       and 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                k
                                                ,
                                                i
                                             
                                          
                                          ∈
                                          
                                             
                                                Ξ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                q
                                                ∈
                                                supp
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      Ξ
                                                   
                                                
                                                :
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      k
                                                      ,
                                                      i
                                                   
                                                
                                                }
                                                ⊂
                                                
                                                   ⋃
                                                   
                                                      β
                                                      ∈
                                                      M
                                                   
                                                
                                                β
                                                ;
                                             
                                          
                                       
                                    


                                       for all 
                                       
                                          β
                                          ∈
                                          
                                             
                                                F
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          M
                                          )
                                        
                                       such that 
                                       
                                          β
                                          ⊂
                                          {
                                          q
                                          ∈
                                          supp
                                          
                                          
                                             
                                                B
                                             
                                             
                                                Ξ
                                             
                                          
                                          :
                                          
                                             
                                                q
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                ξ
                                             
                                             
                                                k
                                                ,
                                                i
                                             
                                          
                                          }
                                       
                                       
                                          
                                             
                                                μ
                                                (
                                                β
                                                )
                                                ⩾
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      
                                                         
                                                            Ξ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      k
                                                      ,
                                                      i
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    

The most interesting subclass of box-meshes are the LR-meshes. They are meshes that can be obtained by subsequent refinements of a tensor mesh. Given a μ-extended box-mesh 
                           (
                           M
                           ,
                           μ
                           )
                         and a 
                           (
                           d
                           −
                           1
                           )
                        -box α it is possible to define 
                           (
                           M
                           ,
                           μ
                           )
                           +
                           α
                         as the μ-extended box-mesh 
                           (
                           
                              M
                              ˜
                           
                           ,
                           
                              μ
                              ˜
                           
                           )
                         corresponding to the partition
                           
                              
                                 
                                    E
                                    ˜
                                 
                                 =
                                 
                                    {
                                    
                                       X
                                       ¯
                                    
                                    :
                                    X
                                     is a connected component of 
                                    β
                                    ∖
                                    α
                                    ,
                                    β
                                    ∈
                                    
                                       
                                          F
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    M
                                    )
                                    }
                                 
                              
                           
                         and map
                           
                              
                                 
                                    μ
                                    ˜
                                 
                                 (
                                 β
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             ∄
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             ∈
                                             M
                                             :
                                             β
                                             ⊂
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             μ
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             +
                                             1
                                             ,
                                          
                                          
                                             ∃
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             ∈
                                             M
                                             :
                                             β
                                             ⊂
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             ⊂
                                             α
                                             ,
                                          
                                       
                                       
                                          
                                             μ
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ,
                                          
                                          
                                             ∃
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             ∈
                                             M
                                             :
                                             β
                                             ⊂
                                             
                                                
                                                   β
                                                
                                                
                                                   ′
                                                
                                             
                                             ⊄
                                             α
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           Definition 2.17
                           LR-mesh


                           A μ-extended LR-mesh is a μ-extended box-mesh 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               such that either 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               is a tensor mesh or 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 =
                                 (
                                 
                                    M
                                    ˆ
                                 
                                 ,
                                 
                                    μ
                                    ˆ
                                 
                                 )
                                 +
                                 α
                               for an LR-mesh 
                                 (
                                 
                                    M
                                    ˆ
                                 
                                 ,
                                 
                                    μ
                                    ˆ
                                 
                                 )
                               and a 
                                 (
                                 d
                                 −
                                 1
                                 )
                              -box α.

This definition is equivalent to that in Dokken et al. (2013) where it is also required that after the insertion of a 
                           (
                           d
                           −
                           1
                           )
                        -box α 
                        
                           μ
                           (
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                           )
                           =
                           μ
                           (
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                           )
                         for all 
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                           ⊂
                           α
                        . This requirement does not change the space of LR-meshes, but forces the use of a longer sequence of smaller insertions. This is linked with their main results: if all the insertions of a 
                           (
                           d
                           −
                           1
                           )
                        -box α have the above property and some other conditions are met, then 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         is generated by the LR B-spline collection. See Dokken et al. (2013) for details.

The B-spline graph was originally introduced in Appendix A of Dokken et al. (2013) to prove that the LR B-spline collection is well defined. Since it plays a central role in the results reported in this paper its definition is formalized. By using the B-spline graph it is possible to generalize the LR B-spline collection to arbitrary box-meshes. Indeed it can be viewed as the set of the reachable sinks of the B-spline graph associated to the mesh.


                        
                           Definition 2.18
                           A knot insertion 
                                 ℵ
                                 =
                                 (
                                 B
                                 ,
                                 k
                                 ,
                                 
                                    ξ
                                    ¯
                                 
                                 )
                               is compatible with a set of B-splines X when
                                 
                                    •
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          B
                                          ,
                                          
                                             ξ
                                             ¯
                                          
                                          ,
                                          1
                                          )
                                          ≠
                                          B
                                          ≠
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          B
                                          ,
                                          
                                             ξ
                                             ¯
                                          
                                          ,
                                          2
                                          )
                                       ;


                                       
                                          B
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          B
                                          ,
                                          
                                             ξ
                                             ¯
                                          
                                          ,
                                          1
                                          )
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                          (
                                          B
                                          ,
                                          
                                             ξ
                                             ¯
                                          
                                          ,
                                          2
                                          )
                                          ∈
                                          X
                                       .

Usually X will be 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         and, in this case, it will be subsumed. Note also that if X is a linear space then, by Proposition 2.3, it is sufficient that any two of B, 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           (
                           B
                           ,
                           
                              ξ
                              ¯
                           
                           ,
                           1
                           )
                         and 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           (
                           B
                           ,
                           
                              ξ
                              ¯
                           
                           ,
                           2
                           )
                         are in X to conclude that 
                           (
                           B
                           ,
                           k
                           ,
                           
                              ξ
                              ¯
                           
                           )
                         is compatible with X. From Proposition 2.16 it follows that a knot insertion 
                           (
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                           ,
                           k
                           ,
                           ζ
                           )
                         with 
                           
                              
                                 B
                              
                              
                                 Ξ
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         and a 
                           ζ
                           ∈
                           ]
                           
                              
                                 ξ
                              
                              
                                 k
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 k
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 2
                              
                           
                           [
                         is compatible with 
                           S
                           (
                           M
                           ,
                           μ
                           )
                         if and only if
                           
                              
                                 ∀
                                 β
                                 ∈
                                 M
                                 :
                                 β
                                 ⊂
                                 {
                                 x
                                 :
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 ζ
                                 }
                                 ∩
                                 supp
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                                 ,
                                 
                                 μ
                                 (
                                 β
                                 )
                                 >
                                 
                                    
                                       m
                                    
                                    
                                       
                                          
                                             Ξ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 ζ
                                 )
                                 .
                              
                           
                         This fact will be used in the form of the following proposition.


                        
                           Proposition 2.19
                           
                              Let 
                              
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               
                              be an extended box-mesh then the following implications hold for all 
                              
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               
                              such that 
                              
                                 supp
                                 
                                 
                                    
                                       B
                                    
                                    
                                       Θ
                                    
                                 
                                 ⊂
                                 supp
                                 
                                 
                                    
                                       B
                                    
                                    
                                       Ξ
                                    
                                 
                              :
                                 
                                    1.
                                    
                                       
                                          ζ
                                          ∈
                                          ]
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                2
                                             
                                          
                                          [
                                          ∧
                                          
                                             
                                                m
                                             
                                             
                                                
                                                   
                                                      Ξ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          (
                                          ζ
                                          )
                                          >
                                          
                                             
                                                m
                                             
                                             
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          (
                                          ζ
                                          )
                                        
                                       implies that 
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                Θ
                                             
                                          
                                          ,
                                          k
                                          ,
                                          ζ
                                          )
                                        
                                       is compatible;


                                       
                                          ζ
                                          ∈
                                          ]
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                2
                                             
                                          
                                          [
                                          ∧
                                          
                                             
                                                m
                                             
                                             
                                                
                                                   
                                                      Ξ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          (
                                          ζ
                                          )
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          (
                                          ζ
                                          )
                                          ∧
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                Ξ
                                             
                                          
                                          ,
                                          k
                                          ,
                                          ζ
                                          )
                                        
                                       compatible implies that 
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                Θ
                                             
                                          
                                          ,
                                          k
                                          ,
                                          ζ
                                          )
                                        
                                       is compatible.
                                    


                        
                           Definition 2.20
                           The B-spline-graph of 
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               is the directed graph 
                                 
                                    
                                       G
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               whose vertexes are all the B-spline of degree p in 
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              , and whose arrows are the couples 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 )
                               such that 
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    ξ
                                    ¯
                                 
                                 ,
                                 σ
                                 )
                               for some k, 
                                 
                                    ξ
                                    ¯
                                 
                               and σ. An example is shown in Fig. 1
                              .

By definition a unique compatible knot insertion 
                           (
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           k
                           ,
                           
                              ξ
                              ¯
                           
                           )
                         corresponds to each arrow 
                           (
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                           )
                         with 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ≠
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                        . A couple of arrows 
                           (
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              ξ
                              ¯
                           
                           ,
                           1
                           )
                           )
                         and 
                           (
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           ,
                           
                              ξ
                              ¯
                           
                           ,
                           2
                           )
                           )
                         corresponds to each compatible knot insertion.


                        
                           Definition 2.21
                           A path in a directed graph is a succession of vertexes 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 )
                               such that for all 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                               
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                               is an arrow of the graph. A vertex 
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                               is a predecessor of a vertex 
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                               if there exist a path 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 )
                               and a successor if there exists a path 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . It is a direct predecessor when 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 )
                               is an arrow and 
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              . Likewise it is a direct successor when 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is an arrow and 
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              . A vertex ϕ is reachable from a set of vertexes Ψ if there exists a path from a vertex in Ψ to ϕ.

For all extended box-mesh and degree the corresponding B-spline-graph is oriented, finite and acyclic. This implies that it corresponds to a partial order relation. This partial order relation is a subset of the nestedness relation, i.e. 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                         is a successor of 
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                         implies 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           
                              ⊂
                              N
                           
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                        , but the converse is not true.


                        
                           Definition 2.22
                           A vertex of a directed graph 
                                 G
                               that has no direct predecessors is called a source. The set of all sources of 
                                 G
                               is 
                                 
                                    Sr
                                 
                                 (
                                 G
                                 )
                              . The set of sources of a B-spline graph 
                                 
                                    
                                       G
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               is shortened with 
                                 
                                    
                                       Sr
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              .

A vertex that have no direct successors is called a sink. The set of all sinks is denoted with 
                                 
                                    Sk
                                 
                                 (
                                 G
                                 )
                              . The set of sinks of a B-spline graph 
                                 
                                    
                                       G
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               is shortened with 
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              .

Note that for all degree p and mesh 
                           (
                           M
                           ,
                           μ
                           )
                         the set of the sources 
                           
                              
                                 Sr
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         contains the Bernstein polynomial basis of 
                           
                              
                                 P
                              
                              
                                 p
                              
                           
                         for Ω. The set of the Bernstein polynomials is denoted with 
                           
                              
                                 B
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                        . See Fig. 1.


                        
                           Definition 2.23
                           A vertex of a B-spline-graph B that is a successor of any of the Bernstein polynomials is said to be reachable. The set of reachable sinks is
                                 
                                    
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       .
                                    
                                 
                               For an example of mesh such that 
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 ≠
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               see Fig. 2
                              .

The set 
                           
                              
                                 Sk
                              
                              
                                 p
                              
                              
                                 r
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         is a generalization to arbitrary box-meshes of the LR B-spline collection for LR-meshes. The problem is that for general box-meshes (also LR-meshes) it is not true that 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         admits a basis composed of B-splines. Thus the approach in Dokken et al. (2013) is to define the LR B-spline collection and study when it spans the whole 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                        . To be useful the LR B-spline collection must depend only on the mesh and must be easily computable. Because of this it is defined in Dokken et al. (2013) as the result of an algorithm that corresponds to update iteratively the set of generators (of possibly a subspace) as the mesh is constructed. See Section 3.2 of Dokken et al. (2013).

A variation of this procedure that is unrelated to the mesh construction and thus suitable to arbitrary box-meshes is shown in Algorithm 2.25. Both the original procedure and Algorithm 2.25 admit arbitrary choices. To prove that the result was independent of the choices the authors of Dokken et al. (2013) introduced the B-spline graph (see Appendix A of Dokken et al., 2013). Their proof works for Algorithm 2.25 without modification. Anyway an alternative proof is contained in this section.


                        
                           Definition 2.24
                           LR B-spline collection


                           The LR B-spline collection relative to a LR-mesh 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               and a degree p is the set 
                                 B
                               obtained with the following algorithm.


                              
                                 
                                    
                                 
                              
                           

Roughly speaking to choose a compatible knot insertion is equivalent to searching for a B-spline in the temporary collection whose support is cut in two by a mesh-face that either it is not in its knot vector or it has higher multiplicity than the corresponding knot.

The difference with the procedure in Dokken et al. (2013) is that there the choice of a compatible knot insertion 
                           (
                           B
                           ,
                           k
                           ,
                           
                              ξ
                              ¯
                           
                           )
                         is mandated to follow the iterative construction of the LR-mesh.


                        
                           Theorem 2.26
                           
                              For all extended box-mesh 
                              
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               
                              and degree 
                              p 
                              the result of 
                              
                                 Algorithm 2.25 
                              is 
                              
                                 B
                                 =
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              
                              .
                           


                        
                           Lemma 2.27
                           
                              Let 
                              
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               
                              be an extended box-mesh and 
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 )
                               
                              be a path in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                               
                              such that 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              
                              . Then for all compatible knot insertions 
                              
                                 ℵ
                                 =
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                               
                              there exists a path 
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 )
                               
                              such that 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                               
                              is produced by ℵ.
                           


                        
                           Proof
                           The proof is constructive and the new path is built by selecting 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                               between 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 1
                                 )
                               and 
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 2
                                 )
                              . Thus it is possible to simplify the notation by describing only the 
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              -th component of the knot vector of 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                              , let it be
                                 
                                    
                                       
                                          
                                             Ξ
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                               Let 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                               be the knot insertion corresponding to the arrow 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              . The construction is done by backward induction: it starts from 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                               and goes back till 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                              . Let ℓ be
                                 
                                    
                                       ℓ
                                       =
                                       max
                                       
                                          {
                                          i
                                          :
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ∈
                                          ]
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                +
                                                2
                                             
                                          
                                          [
                                          ∧
                                          
                                             
                                                m
                                             
                                             
                                                
                                                   
                                                      Ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                
                                                   
                                                      Ξ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          }
                                       
                                       .
                                    
                                 
                               Necessarily 
                                 ℓ
                                 <
                                 n
                               and 
                                 
                                    
                                       k
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              . Otherwise, by Proposition 2.19 and using that 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    ⊂
                                    N
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                              , it would follow that 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                               is compatible and thus 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 ∉
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              . For 
                                 i
                                 =
                                 ℓ
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                               set 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                              .

From Proposition 2.19 it follows that for 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 ℓ
                               the knot insertion 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                                 )
                               is compatible. Then set 
                                 
                                    
                                       ϕ
                                    
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                               to
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             ℓ
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ℓ
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         
                                                            
                                                               Ξ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                   +
                                                   1
                                                   =
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         
                                                            
                                                               Ξ
                                                            
                                                            
                                                               ℓ
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   1
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         +
                                                         1
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   2
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         +
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               The 
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              -th component of the knot vector of 
                                 
                                    
                                       ϕ
                                    
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                               is thus
                                 
                                    
                                       
                                          
                                             Ξ
                                          
                                          
                                             ℓ
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         ℓ
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         
                                                            
                                                               Ξ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                   +
                                                   1
                                                   =
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         
                                                            
                                                               Ξ
                                                            
                                                            
                                                               ℓ
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         ,
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         +
                                                         1
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         ,
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         2
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ℓ
                                                         +
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               Then 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       ℓ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                               is compatible and produces 
                                 
                                    
                                       ϕ
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                              .

For 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 ℓ
                                 −
                                 1
                               
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                               are defined based on 
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                              . When 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ≠
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                               then set
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   1
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   1
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   2
                                                   )
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            ξ
                                                            ¯
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   2
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               Otherwise 
                                 
                                    
                                       Ξ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                               is obtained from 
                                 
                                    
                                       Ξ
                                    
                                    
                                       i
                                    
                                 
                               by inserting the two knots 
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       
                                          ξ
                                          ¯
                                       
                                    
                                    
                                       i
                                    
                                 
                              , thus 
                                 
                                    
                                       Ξ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       ′
                                    
                                 
                               is in one of the following groups of possibilities
                                 
                                    1.
                                    
                                       
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       , 
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                +
                                                1
                                             
                                          
                                          )
                                       ;


                                       
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                +
                                                2
                                             
                                          
                                          )
                                       , 
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                +
                                                2
                                             
                                          
                                          )
                                       ;


                                       
                                          (
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   ξ
                                                   ¯
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                +
                                                1
                                             
                                          
                                          )
                                       ,

To complete the proof of Theorem 2.26 it is enough to apply iteratively Lemma 2.27. Indeed the set of sinks reachable from 
                           B
                           =
                           
                              
                                 B
                              
                              
                                 m
                              
                           
                         is 
                           B
                         and from the above lemma it equals the set of sinks reachable from 
                           
                              
                                 B
                              
                              
                                 m
                                 −
                                 1
                              
                           
                        . Proceeding by induction it follows that 
                           B
                         equals the set of sinks reachable from 
                           
                              
                                 B
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 B
                              
                              
                                 p
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                         and thus 
                           B
                           =
                           
                              
                                 Sk
                              
                              
                                 p
                              
                              
                                 r
                              
                           
                           (
                           M
                           ,
                           μ
                           )
                        .

In this section the results about the number of B-splines that are non-null in the points of the domain are collected. The number of 
                        B
                        ∈
                        
                           
                              Sk
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      such that 
                        B
                        (
                        q
                        )
                        ≠
                        0
                      depends on q. In order to avoid special cases for 
                        q
                        ∈
                        
                           
                              ⋃
                           
                           
                              β
                              ∈
                              M
                           
                        
                        β
                      the position and overlap are defined.


                     
                        Definition 3.1
                        The position of a point q with respect of a B-spline 
                              
                                 
                                    B
                                 
                                 
                                    Ξ
                                 
                              
                            of degree p is
                              
                                 
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                Ξ
                                             
                                          
                                       
                                    
                                    (
                                    q
                                    )
                                    =
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    ∈
                                    
                                       ⨉
                                       
                                          i
                                          =
                                          1
                                       
                                       d
                                    
                                    {
                                    0
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    2
                                    }
                                 
                              
                            where 
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              =
                              #
                              {
                              j
                              :
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ⩽
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              }
                           . The position is a right continuous function of q and it is constant on 
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                              
                            for all 
                              β
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    d
                                 
                              
                              (
                              M
                              )
                           .

Note that if 
                        
                           
                              pos
                           
                           
                              B
                           
                        
                        (
                        q
                        )
                        ∈
                        
                           
                              ⨉
                           
                           
                              i
                              =
                              1
                           
                           
                              d
                           
                        
                        {
                        1
                        ,
                        …
                        ,
                        
                           
                              p
                           
                           
                              i
                           
                        
                        +
                        1
                        }
                      then 
                        q
                        ∈
                        supp
                        
                        B
                     . The converse can be false only if 
                        q
                        ∈
                        ∂
                        supp
                        
                        B
                     . In particular if 
                        q
                        ∉
                        
                           
                              ⋃
                           
                           
                              β
                              ∈
                              M
                           
                        
                        β
                      then
                        
                           
                              #
                              
                                 {
                                 B
                                 ∈
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 :
                                 
                                    
                                       pos
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 q
                                 )
                                 ∈
                                 
                                    ⨉
                                    
                                       i
                                       =
                                       1
                                    
                                    d
                                 
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 1
                                 }
                                 }
                              
                              =
                              #
                              
                                 {
                                 B
                                 ∈
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 :
                                 q
                                 ∈
                                 supp
                                 B
                                 }
                              
                              =
                              #
                              
                                 {
                                 B
                                 ∈
                                 
                                    
                                       Sk
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 :
                                 B
                                 (
                                 q
                                 )
                                 ≠
                                 0
                                 }
                              
                              .
                           
                        
                     
                  


                     
                        Definition 3.2
                        The overlap of point 
                              q
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                            for the B-spline graph 
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            is
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          p
                                          ,
                                          M
                                          ,
                                          μ
                                       
                                    
                                    (
                                    q
                                    )
                                    =
                                    #
                                    
                                       {
                                       B
                                       ∈
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       :
                                       
                                          
                                             pos
                                          
                                          
                                             B
                                          
                                       
                                       (
                                       q
                                       )
                                       ∈
                                       
                                          ⨉
                                          
                                             i
                                             =
                                             1
                                          
                                          d
                                       
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       }
                                       }
                                    
                                    .
                                 
                              
                            The reachable overlap 
                           
                              
                                 
                                    O
                                 
                                 
                                    p
                                    ,
                                    M
                                    ,
                                    μ
                                 
                                 
                                    r
                                 
                              
                              (
                              β
                              )
                            is the same with 
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           . The overlaps on the elements of a mesh 
                              (
                              M
                              ,
                              μ
                              )
                            such that 
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              ≠
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            are shown in Fig. 3
                           .


                     
                        Definition 3.3
                        The overlap of an extended box-mesh 
                              (
                              M
                              ,
                              μ
                              )
                            for the degree p is
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                    =
                                    
                                       max
                                       
                                          q
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          p
                                          ,
                                          M
                                          ,
                                          μ
                                       
                                    
                                    (
                                    q
                                    )
                                    .
                                 
                              
                            The reachable overlap is 
                              
                                 
                                    O
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              =
                              
                                 
                                    max
                                 
                                 
                                    q
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              
                              
                                 
                                    O
                                 
                                 
                                    p
                                    ,
                                    M
                                    ,
                                    μ
                                 
                                 
                                    r
                                 
                              
                              (
                              q
                              )
                           .


                     
                        Lemma 3.4
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh on Ω and 
                           p 
                           be a degree. For every 
                           
                              q
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                            
                           and 
                           
                              c
                              ∈
                              
                                 
                                    ⨉
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              }
                            
                           there exists a unique 
                           
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           such that
                           
                              
                                 •
                                 
                                    
                                       
                                          
                                             pos
                                          
                                          
                                             B
                                          
                                       
                                       (
                                       q
                                       )
                                       =
                                       c
                                    ;


                                    
                                       ∀
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                     
                                    such that 
                                    
                                       
                                          
                                             pos
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       (
                                       q
                                       )
                                       =
                                       c
                                     
                                    it holds 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       B
                                    
                                    .
                                 


                     
                        Proof
                        Let 
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                            be the unique B-spline in 
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            such that 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              c
                           . Let 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                              )
                            be a path such that 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              c
                            for 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                            and 
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           . A path with the above properties can be constructed iteratively: if 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ∉
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            then choose a compatible knot insertion 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       ξ
                                       ¯
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                            and set
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   ξ
                                                   ¯
                                                
                                                ,
                                                1
                                                )
                                                ,
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                >
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   ξ
                                                   ¯
                                                
                                                ,
                                                2
                                                )
                                                ,
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                         ¯
                                                      
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            In this way 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              c
                           . The B-spline 
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                            is the unique B-spline of the thesis.

Let 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            such that 
                              
                                 
                                    pos
                                 
                                 
                                    B
                                 
                              
                              (
                              q
                              )
                              =
                              c
                           . Since 
                              supp
                              
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ⊂
                              Ω
                            then 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                           . It is possible to show that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                            by induction. Let 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       ξ
                                       ¯
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                            be the knot insertion corresponding to 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           , 
                              Θ
                            be the knot vector of 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           , 
                              
                                 
                                    Ξ
                                 
                                 
                                    i
                                 
                              
                            be that of 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                           , and assume 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                           . The following propositions hold because of Proposition 2.5
                           
                              
                                 •
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       ⩾
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                     for all 
                                       ζ
                                       ∈
                                       ]
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       [
                                    ;


                                    
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       ⩽
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                     for all 
                                       ζ
                                       ∉
                                       ]
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       [
                                    .


                                    
                                       #
                                       {
                                       ζ
                                       ∈
                                       
                                          
                                             Ξ
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             k
                                          
                                       
                                       :
                                       ζ
                                       ⩽
                                       
                                          
                                             q
                                          
                                          
                                             k
                                          
                                       
                                       }
                                       =
                                       #
                                       {
                                       ζ
                                       ∈
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                          
                                       
                                       :
                                       ζ
                                       ⩽
                                       
                                          
                                             q
                                          
                                          
                                             k
                                          
                                       
                                       }
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                     and thus 
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       ⩽
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                     for all 
                                       ζ
                                       ∈
                                       ]
                                       −
                                       ∞
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             k
                                             ,
                                             1
                                          
                                       
                                       ]
                                    ;


                                    
                                       #
                                       {
                                       ζ
                                       ∈
                                       
                                          
                                             Θ
                                          
                                          
                                             k
                                          
                                       
                                       :
                                       ζ
                                       >
                                       
                                          
                                             q
                                          
                                          
                                             k
                                          
                                       
                                       }
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       2
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             k
                                          
                                       
                                     and thus 
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                       ⩽
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       ζ
                                       )
                                     for all 
                                       ζ
                                       ∈
                                       [
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             k
                                             ,
                                             2
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       ,
                                       ∞
                                       [
                                    .


                     
                        Definition 3.5
                        The B-spline of Lemma 3.4 corresponding to a point q and a position c is denoted with 
                              
                                 
                                    B
                                 
                                 
                                    q
                                    ,
                                    c
                                 
                              
                           .


                     
                        Corollary 3.6
                        
                           For all extended box-mesh 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           and degree 
                           p 
                           it holds
                           
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                    ⩾
                                    
                                       
                                          O
                                       
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                    ⩾
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       d
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        Given 
                              q
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                            there is 
                              
                                 
                                    B
                                 
                                 
                                    q
                                    ,
                                    c
                                 
                              
                            for all 
                              c
                              ∈
                              
                                 
                                    ⨉
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              }
                           . Since they are all distinct 
                              
                                 
                                    O
                                 
                                 
                                    p
                                    ,
                                    M
                                    ,
                                    μ
                                 
                                 
                                    r
                                 
                              
                              (
                              q
                              )
                              ⩾
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                           . The other inequality follows from 
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              ⊂
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           . □


                     
                        Corollary 3.7
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh, 
                           p 
                           be a degree and 
                           
                              q
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                            
                           be a point such that 
                           
                              
                                 
                                    O
                                 
                                 
                                    p
                                    ,
                                    M
                                    ,
                                    μ
                                 
                                 
                                    r
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                           
                           . Then for all 
                           
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           such that 
                           
                              
                                 
                                    pos
                                 
                                 
                                    B
                                 
                              
                              (
                              q
                              )
                              =
                              c
                              ∈
                              
                                 
                                    ⨉
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              }
                            
                           it holds
                           
                              
                                 
                                    B
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          q
                                          ,
                                          c
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Corollary 3.8
                        
                           For all extended box-mesh 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           and degree 
                           p 
                           it holds
                           
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                    =
                                    
                                       ∏
                                       
                                          i
                                          =
                                          1
                                       
                                       d
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                    )
                                    
                                    ⇒
                                    
                                    
                                       
                                          Sk
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                    =
                                    
                                       
                                          Sk
                                       
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                    .
                                 
                              
                           
                        

To study the relations between overlap and nestedness it is convenient to introduce the following syntax to represent the set of components in which the positions relative to two B-splines 
                        
                           
                              B
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              B
                           
                           
                              2
                           
                        
                      agree at a point q:
                        
                           
                              J
                              (
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              q
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          j
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          d
                                          }
                                          :
                                       
                                       
                                          
                                             
                                                pos
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                q
                                                )
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          1
                                          }
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                pos
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                q
                                                )
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                pos
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                q
                                                )
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                              .
                           
                        
                     
                  


                     
                        Lemma 3.9
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           
                           , 
                           
                              q
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                            
                           such that
                           
                              
                                 H1.
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    ;


                                    
                                       
                                          
                                             O
                                          
                                          
                                             p
                                             ,
                                             M
                                             ,
                                             μ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       q
                                       )
                                       =
                                       
                                          
                                             ∏
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       )
                                    ;


                                    
                                       
                                          
                                             pos
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       q
                                       )
                                       ∈
                                       
                                          
                                             ⨉
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       }
                                    ;


                                    
                                       #
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       q
                                       )
                                       <
                                       d
                                    
                                    .
                                 


                                    
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                    ;


                                    
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       ≠
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    ;


                                    
                                       
                                          
                                             pos
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             ⨉
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       }
                                    ;


                                    
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⊋
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       q
                                       )
                                    
                                    .
                                 


                     
                        Proof
                        The proof is constructive and is based on the existence of paths 
                              (
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              )
                            in the B-spline graph such that 
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and for all 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           , 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              x
                              )
                              =
                              c
                            for some point x and 
                              c
                              ∈
                              
                                 
                                    ⨉
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              }
                           . Such paths can be constructed iteratively as done in the proof of Lemma 3.4.

Let 
                              (
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    m
                                 
                              
                              )
                            be a path from 
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            such that for all 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                            
                           
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              q
                              )
                           . From H2 and Corollary 3.7 it follows that 
                              
                                 
                                    ψ
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           . The proof is done by showing by induction that for all 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                            there exists 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            such that:
                              
                                 P1.
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                    ;


                                    
                                       
                                          
                                             pos
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       q
                                       )
                                       =
                                       
                                          
                                             pos
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       q
                                       )
                                    ;


                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                     is a successor of 
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                    ;


                                    
                                       ∃
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       q
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                     such that 
                                       J
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ⊃
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       q
                                       )
                                       ∪
                                       {
                                       
                                          
                                             k
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    ;


                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                     is reachable.

Then 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            can be obtained from 
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                            by following a path 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              )
                            such that for 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                            
                           
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                              )
                            and 
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           . Indeed for 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                            and 
                              
                                 
                                    q
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    m
                                 
                              
                            then T1 follows from P5, T2 follows from P1 and P3, T3 and T4 follow from P4.

The first step is to prove the existence of 
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                           . Let 
                              (
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              )
                            be a path such that 
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           , 
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           . From H2 and Corollary 3.7 it follows that 
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                            and thus starting from some index s all the 
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                            for 
                              i
                              ⩾
                              s
                            are nested in 
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                           . Define 
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                            to be 
                              
                                 
                                    η
                                 
                                 
                                    s
                                 
                              
                           . By construction 
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                            is reachable (P5), it is nested in 
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                            (P1), and has properties P2 and P3.

Let 
                              
                                 
                                    Θ
                                 
                                 
                                    i
                                 
                              
                            be the knot vector of 
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                           , 
                              Ξ
                            be that of 
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                            and 
                              (
                              
                                 
                                    η
                                 
                                 
                                    s
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 θ
                                 ¯
                              
                              )
                            be the knot insertion corresponding to 
                              (
                              
                                 
                                    η
                                 
                                 
                                    s
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    s
                                 
                              
                              )
                           . Since 
                              
                                 
                                    η
                                 
                                 
                                    s
                                    −
                                    1
                                 
                              
                              
                                 ⊄
                                 N
                              
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                            it follows from Proposition 2.5 that at least one of the following is true:
                              
                                 •
                                 
                                    
                                       ∃
                                       
                                          ζ
                                          ¯
                                       
                                       ∈
                                       ]
                                       
                                          
                                             θ
                                          
                                          
                                             s
                                             −
                                             1
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             s
                                             −
                                             1
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       [
                                       :
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   s
                                                   −
                                                   1
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       
                                          ζ
                                          ¯
                                       
                                       )
                                       <
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       
                                          ζ
                                          ¯
                                       
                                       )
                                    ;


                                    
                                       ∃
                                       
                                          ζ
                                          ¯
                                       
                                       ∈
                                       {
                                       
                                          
                                             θ
                                          
                                          
                                             s
                                             −
                                             1
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             s
                                             −
                                             1
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       }
                                       ∖
                                       ]
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             2
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       [
                                       :
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Θ
                                                
                                                
                                                   s
                                                   −
                                                   1
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       
                                          ζ
                                          ¯
                                       
                                       )
                                       >
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       
                                          ζ
                                          ¯
                                       
                                       )
                                    .

Assume now that 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                            are given and let 
                              (
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 k
                                 ¯
                              
                              ,
                              
                                 ξ
                                 ¯
                              
                              )
                            be the knot insertion corresponding to the arrow 
                              (
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           . If 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 k
                                 ¯
                              
                              ,
                              
                                 ξ
                                 ¯
                              
                              )
                            is compatible set 
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                            to the B-spline produced by 
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 k
                                 ¯
                              
                              ,
                              
                                 ξ
                                 ¯
                              
                              )
                            and such that 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                           . Otherwise set 
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                            to 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                           . Let 
                              (
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              )
                            be a path such that 
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           . Again from H2 and Corollary 3.7 it follows that 
                              
                                 
                                    η
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                            and thus starting from some index s all the 
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                            for 
                              i
                              ⩾
                              s
                            are nested in 
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           . Set 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    s
                                 
                              
                           . Also in this case P1, P2, P3 and P5 are consequences of the construction.

Let 
                              
                                 
                                    Θ
                                 
                                 
                                    i
                                 
                              
                            be the knot vector of 
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                            and 
                              Ξ
                            be that of 
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           . By construction the only knot that can have greater multiplicity in the knot vector of 
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            compared to that of 
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                            is 
                              
                                 ξ
                                 ¯
                              
                            in the 
                              
                                 k
                                 ¯
                              
                           -th component of 
                              Ξ
                           . Thus from 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                           , Proposition 2.5, Proposition 2.19 and the construction of 
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                            it follows that for all 
                              k
                              =
                              1
                              ,
                              …
                              ,
                              d
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              s
                            and 
                              ζ
                              ∈
                              ]
                              
                                 
                                    θ
                                 
                                 
                                    i
                                    ,
                                    k
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    i
                                    ,
                                    k
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    2
                                 
                              
                              [
                            it holds
                              
                                 (2)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    ζ
                                    )
                                    ⩾
                                    
                                       
                                          m
                                       
                                       
                                          
                                             
                                                Ξ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    ζ
                                    )
                                    .
                                 
                              
                           
                        

When 
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              
                                 ⊄
                                 N
                              
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            then the existence of 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            that realizes P4 is proved with the same argument as for 
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                           . In this case 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            is a translation of q along the direction 
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            of the refinement corresponding to 
                              (
                              
                                 
                                    η
                                 
                                 
                                    s
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    s
                                 
                              
                              )
                           . From Eq. (2) it follows also that for 
                              k
                              ∈
                              J
                              (
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              q
                              )
                            and 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                            it holds that 
                              
                                 
                                    Θ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                            is a refinement of 
                              
                                 
                                    Ξ
                                 
                                 
                                    k
                                 
                              
                            and thus that 
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ∉
                              J
                              (
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              q
                              )
                           .

When 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            there are two cases: 
                              
                                 k
                                 ¯
                              
                              ≠
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 k
                                 ¯
                              
                              =
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           . In the first case for 
                              k
                              ∈
                              J
                              (
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              q
                              )
                              ∪
                              {
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              }
                            it holds 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    k
                                 
                              
                            and thus P4 holds setting 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                           . Indeed from H3 
                              q
                              ∈
                              supp
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            and thus also 
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              ∈
                              supp
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            because the extension of 
                              supp
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            along the 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                            axis equals that of 
                              supp
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                           . The last case is when 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 k
                                 ¯
                              
                              =
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           . In this case 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            can be different from 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . When they are equal P4 holds setting 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                           . When 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              +
                              1
                            then 
                              
                                 
                                    q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              <
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 ξ
                                 ¯
                              
                              ∈
                              ]
                              
                                 
                                    q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ]
                           . From the definition of position it follows
                              
                                 
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    #
                                    
                                       {
                                       θ
                                       ∈
                                       
                                          
                                             Θ
                                          
                                          
                                             s
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ∈
                                       ]
                                       
                                          
                                             q
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ]
                                       }
                                    
                                    .
                                 
                              
                            Using Eq. (2) gives
                              
                                 
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    1
                                    .
                                 
                              
                            But since at most one knot has been inserted also the other inequality holds:
                              
                                 
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    1
                                 
                              
                            and thus
                              
                                 
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          pos
                                       
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          q
                                          )
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                            from which it follows 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . Thus if 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              <
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              +
                              2
                            then P4 holds with 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                           . Otherwise it means that 
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                            was in the last knot span and the last knots along the 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           -th axis of both 
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                            had multiplicity 1. Together with Eq. (2) this implies that the multiplicities of the last knots along the 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           -th axis of both 
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            and 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            are equal and thus it is possible to find 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            by setting 
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                            to a translation of q along the 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           -th axis such that
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          1
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                    
                                       ]
                                       max
                                       {
                                       ζ
                                       ∈
                                       
                                          
                                             Ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ∪
                                       
                                          
                                             Θ
                                          
                                          
                                             s
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       :
                                       ζ
                                       <
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       }
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             +
                                             2
                                          
                                       
                                       [
                                    
                                    .
                                 
                              
                           
                        

Similarly when 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              −
                              1
                            then 
                              
                                 
                                    q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              >
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 ξ
                                 ¯
                              
                              ∈
                              ]
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ]
                           . As above if the positions do not change or if 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              
                              
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              >
                              0
                            then P4 holds with 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                           . Otherwise 
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            can be chosen as a translation of q along the 
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                            axis such that
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                    
                                       ]
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       min
                                       {
                                       ζ
                                       ∈
                                       
                                          
                                             Ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ∪
                                       
                                          
                                             Θ
                                          
                                          
                                             1
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       :
                                       ζ
                                       >
                                       
                                          
                                             ξ
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       }
                                       [
                                    
                                    .
                                    
                                    □
                                 
                              
                           
                        


                     
                        Theorem 3.10
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh and 
                           p 
                           be a degree, then the following two equivalences hold
                           
                              
                                 1.
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       =
                                       
                                          
                                             ∏
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       )
                                       ⇔
                                       ∄
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       :
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    ;


                                    
                                       
                                          
                                             O
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       =
                                       
                                          
                                             ∏
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       )
                                       ⇔
                                       ∄
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       :
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                    .
                                 


                     
                        Proof
                        If 
                              
                                 
                                    O
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              >
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                            then there exists 
                              q
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                            such that 
                              
                                 
                                    O
                                 
                                 
                                    p
                                    ,
                                    M
                                    ,
                                    μ
                                 
                                 
                                    r
                                 
                              
                              (
                              q
                              )
                              >
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                           . Thus there exist 
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            such that 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              c
                           . At least one between 
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                            is different from 
                              
                                 
                                    B
                                 
                                 
                                    q
                                    ,
                                    c
                                 
                              
                            and thus nested in it (Lemma 3.4). To complete the proof of the first equivalence it is enough to show that the propositions “
                              
                                 
                                    O
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                           ” and “
                              ∃
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              :
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           ” are in contradiction. Assuming both and applying iteratively Lemma 3.9 it is possible to find 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            such that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                            and there exists q such that 
                              #
                              J
                              (
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ,
                              q
                              )
                              =
                              d
                           . This means that 
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    pos
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              q
                              )
                              =
                              c
                            and thus 
                              
                                 
                                    O
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              >
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                            contrarily to the assumption.

When 
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              =
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            the second equivalence is the first one. Otherwise there exists 
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              ∖
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and for 
                              c
                              =
                              
                                 
                                    pos
                                 
                                 
                                    B
                                 
                              
                              (
                              q
                              )
                              ∈
                              
                                 
                                    ⨉
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              }
                            
                           
                              B
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    B
                                 
                                 
                                    q
                                    ,
                                    c
                                 
                              
                            by Lemma 3.4; moreover from Corollary 3.8 it follows 
                              
                                 
                                    O
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              >
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              )
                           .  □

This section studies the representation of polynomials as linear combinations of the sinks of a B-spline graph. The motivation is the construction of projectors and quasi-interpolants to the LR-spline space. Quasi-interpolants are linear approximation operators that are constructed using a collection of local approximation operators (Lyche and Schumaker, 1975). They can be used to give constructive proofs for the spline approximation results. While the results in this section allow the construction of quasi-interpolants that preserve polynomials, further investigation is needed to understand the local approximation properties of these operators.

One of the problems in the study of the coefficients for polynomial representation is that for a general box and LR-mesh 
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      is not always a set of linearly independent functions, and thus the set of coefficients is not unique (see Section 6 of Dokken et al. (2013) for an example). In Dokken et al. (2013) the authors used a combination of Algorithm 2.25 and Proposition 2.3 to study the partition of unity property of the LR B-spline collection. Here the same tools are used to study the coefficients for the representation of general polynomials.

Let 
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      be the set of functions from the vertexes of 
                        
                           
                              G
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      to 
                        R
                     . A spline 
                        
                           
                              f
                           
                           
                              ρ
                           
                        
                        ∈
                        
                           
                              S
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      given by
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    ρ
                                 
                              
                              =
                              
                                 ∑
                                 
                                    B
                                    ∈
                                    
                                       
                                          G
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                 
                              
                              ρ
                              (
                              B
                              )
                              B
                           
                        
                      corresponds to an element 
                        ρ
                        ∈
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     . The support of 
                        ρ
                        ∈
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      is thus a subset of the vertexes of 
                        
                           
                              G
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     . This formalism allows us to distinguish between different linear combinations 
                        
                           
                              ρ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              ρ
                           
                           
                              2
                           
                        
                        ∈
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      that correspond to the same functions 
                        
                           
                              f
                           
                           
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                 
                              
                           
                        
                        =
                        
                           
                              f
                           
                           
                              
                                 
                                    ρ
                                 
                                 
                                    2
                                 
                              
                           
                        
                     .

A positive projection 
                        ℵ
                        :
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                        →
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      defined by
                        
                           
                              ℵ
                              ρ
                              =
                              ρ
                              −
                              ρ
                              (
                              B
                              )
                              (
                              
                                 
                                    1
                                 
                                 
                                    {
                                    B
                                    }
                                 
                              
                              −
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    {
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    B
                                    ,
                                    
                                       ξ
                                       ¯
                                    
                                    ,
                                    1
                                    )
                                    }
                                 
                              
                              −
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    {
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    B
                                    ,
                                    
                                       ξ
                                       ¯
                                    
                                    ,
                                    2
                                    )
                                    }
                                 
                              
                              )
                           
                        
                      corresponds to a compatible knot insertion 
                        ℵ
                        =
                        (
                        B
                        ,
                        k
                        ,
                        
                           ξ
                           ¯
                        
                        )
                     , where 
                        
                           
                              c
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              c
                           
                           
                              2
                           
                        
                      are the coefficients from Proposition 2.3 and 
                        
                           
                              1
                           
                           
                              X
                           
                        
                      is the characteristic function of X i.e.
                        
                           
                              
                                 
                                    1
                                 
                                 
                                    X
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                          ,
                                       
                                       
                                          x
                                          ∈
                                          X
                                          ,
                                       
                                    
                                    
                                       
                                          0
                                          ,
                                       
                                       
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                      These projections preserve the associated splines in 
                        
                           
                              S
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     , that is for all ρ and ℵ
                     
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    ρ
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    ℵ
                                    ρ
                                 
                              
                              .
                           
                        
                      The positive linear map 
                        Γ
                        :
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                        →
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      obtained by composing the 
                        
                           
                              ℵ
                           
                           
                              i
                           
                        
                     
                     
                        
                           
                              Γ
                              =
                              
                                 
                                    ℵ
                                 
                                 
                                    m
                                 
                              
                              ∘
                              ⋯
                              ∘
                              
                                 
                                    ℵ
                                 
                                 
                                    1
                                 
                              
                           
                        
                      corresponds to a sequence of knot insertions 
                        Γ
                        =
                        (
                        
                           
                              ℵ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              ℵ
                           
                           
                              m
                           
                        
                        )
                     . Also for sequences of knot insertions it holds 
                        
                           
                              f
                           
                           
                              Γ
                              ρ
                           
                        
                        =
                        
                           
                              f
                           
                           
                              ρ
                           
                        
                     .


                     
                        Definition 4.1
                        Let V be a subspace of 
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and 
                              
                                 
                                    G
                                 
                                 
                                    V
                                 
                              
                            be the subgraph of 
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            containing the B-splines in V. A sequence 
                              Γ
                              =
                              (
                              
                                 
                                    ℵ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ℵ
                                 
                                 
                                    m
                                 
                              
                              )
                            of knot insertions is said to be exhaustive for 
                              
                                 
                                    G
                                 
                                 
                                    V
                                 
                              
                            when
                              
                                 •
                                 for all 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       m
                                     
                                    
                                       
                                          
                                             ℵ
                                          
                                          
                                             i
                                          
                                       
                                     is compatible with 
                                       
                                          
                                             G
                                          
                                          
                                             V
                                          
                                       
                                    , i.e. it refines and produces functions of V;

for all 
                                       ρ
                                       :
                                       supp
                                       
                                       ρ
                                       ⊂
                                       
                                          
                                             G
                                          
                                          
                                             V
                                          
                                       
                                     it holds 
                                       supp
                                       
                                       Γ
                                       ρ
                                       ⊂
                                       
                                          Sk
                                       
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             V
                                          
                                       
                                       )
                                    .

Let V and 
                        
                           
                              G
                           
                           
                              V
                           
                        
                      be as above. Then when the sinks of 
                        
                           
                              G
                           
                           
                              V
                           
                        
                      are linearly independent the same map Γ is associated to all exhaustive sequences. Indeed given a function in V there exists a unique linear combination of 
                        
                           Sk
                        
                        (
                        
                           
                              G
                           
                           
                              V
                           
                        
                        )
                      that represents it. This is always the case for tensor B-spline spaces. Moreover, in the tensor case, the result of Γρ is known from general B-spline theory. In particular if 
                        
                           
                              f
                           
                           
                              ρ
                           
                        
                        
                           
                              |
                           
                           
                              
                                 
                                    β
                                 
                                 
                                    0
                                 
                              
                           
                        
                        =
                        g
                        ∈
                        
                           
                              P
                           
                           
                              p
                           
                        
                      for some 
                        β
                        ⊂
                        supp
                        
                        B
                      then
                        
                           
                              (
                              Γ
                              ρ
                              )
                              (
                              B
                              )
                              =
                              B
                              [
                              g
                              ]
                              (
                              B
                              )
                              ,
                           
                        
                      where 
                        B
                        [
                        g
                        ]
                        (
                        B
                        )
                      is the blossom of g evaluated in the internal knots of B (Ramshaw, 1987). In order to exploit this knowledge for general box-meshes it is useful to associate to each B-spline in 
                        
                           
                              Sk
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      an auxiliary tensor mesh.


                     
                        Definition 4.2
                        Let 
                              (
                              M
                              ,
                              μ
                              )
                            be an extended box-mesh and 
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            be a B-spline. Let 
                              Ξ
                            be the knot vector of B. The tensor mesh associated to B is 
                              (
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    B
                                 
                              
                              )
                            defined by:
                              
                                 •
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             B
                                          
                                       
                                     corresponds to the sequences 
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             k
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             k
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                     
                                    
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       d
                                     containing all the k-th coordinates 
                                       
                                          
                                             a
                                          
                                          
                                             k
                                             ,
                                             i
                                          
                                       
                                     of the 
                                       β
                                       ∈
                                       M
                                     orthogonal to 
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                     and such that
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                   ,
                                                   i
                                                
                                             
                                             ∈
                                             {
                                             a
                                             <
                                             
                                                
                                                   ξ
                                                
                                                
                                                   k
                                                   ,
                                                   1
                                                
                                             
                                             }
                                             ∪
                                             
                                                
                                                   Ξ
                                                
                                                
                                                   k
                                                
                                             
                                             ∪
                                             {
                                             a
                                             >
                                             
                                                
                                                   ξ
                                                
                                                
                                                   k
                                                   ,
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   2
                                                
                                             
                                             }
                                             ;
                                          
                                       
                                    
                                 

for 
                                       β
                                       ∈
                                       
                                          
                                             M
                                          
                                          
                                             B
                                          
                                       
                                     let 
                                       
                                          
                                             H
                                          
                                          
                                             β
                                          
                                       
                                       =
                                       {
                                       x
                                       :
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             k
                                             ,
                                             i
                                          
                                       
                                       }
                                     be the hyperplane containing β, then
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   B
                                                
                                             
                                             (
                                             β
                                             )
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     Ξ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         b
                                                         )
                                                         ,
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               k
                                                               ,
                                                               i
                                                            
                                                         
                                                         ∈
                                                         ]
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               k
                                                               ,
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               +
                                                               2
                                                            
                                                         
                                                         [
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         max
                                                         {
                                                         μ
                                                         (
                                                         α
                                                         )
                                                         :
                                                         α
                                                         ∈
                                                         M
                                                         ∧
                                                         α
                                                         ⊂
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               β
                                                            
                                                         
                                                         }
                                                         ,
                                                      
                                                      
                                                         otherwise
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                     
                        Lemma 4.3
                        
                           Given a sequence 
                           
                              Γ
                              =
                              (
                              
                                 
                                    ℵ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ℵ
                                 
                                 
                                    m
                                 
                              
                              )
                            
                           of compatible knot insertions and 
                           
                              ρ
                              ∈
                              
                                 
                                    Λ
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           it holds that
                           
                              
                                 
                                    supp
                                    Γ
                                    ρ
                                    ⊂
                                    {
                                    B
                                    :
                                    B
                                     
                                       reachable from 
                                    
                                    supp
                                    ρ
                                    }
                                    .
                                 
                              
                            
                           Moreover if Γ is exhaustive for 
                           
                              
                                 
                                    G
                                 
                                 
                                    V
                                 
                              
                           
                           , the subgraph associated to a subspace V of 
                           
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           
                           , 
                           
                              supp
                              
                              ρ
                              ⊂
                              G
                            
                           and 
                           
                              ρ
                              ⩾
                              0
                           
                           , then
                           
                              
                                 
                                    supp
                                    Γ
                                    ρ
                                    =
                                    
                                       {
                                       B
                                       ∈
                                       
                                          Sk
                                       
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             V
                                          
                                       
                                       )
                                       :
                                       B
                                        
                                          reachable from 
                                       
                                       supp
                                       ρ
                                       }
                                    
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        It is enough to observe that the coefficient of unreachable B-splines are unchanged and that the coefficients 
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                            of Proposition 2.3 are strictly positive for compatible knot insertions. □

Let 
                        
                           
                              Γ
                           
                           
                              B
                           
                        
                      be an exhaustive sequence for 
                        
                           
                              G
                           
                           
                              p
                           
                        
                        (
                        
                           
                              M
                           
                           
                              B
                           
                        
                        ,
                        
                           
                              μ
                           
                           
                              B
                           
                        
                        )
                     . Since 
                        (
                        
                           
                              M
                           
                           
                              B
                           
                        
                        ,
                        
                           
                              μ
                           
                           
                              B
                           
                        
                        )
                      is a tensor mesh the associated map 
                        
                           
                              Γ
                           
                           
                              B
                           
                        
                      does not depend on the sequence and can be written in term of the blossom. With a notation abuse 
                        
                           
                              Γ
                           
                           
                              B
                           
                        
                      (as a map) will be applied to 
                        ρ
                        ∈
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     : in these cases 
                        
                           
                              Γ
                           
                           
                              B
                           
                        
                        ρ
                      means 
                        
                           
                              Γ
                           
                           
                              B
                           
                        
                        
                           ρ
                           ˜
                        
                      where 
                        
                           ρ
                           ˜
                        
                      is defined by
                        
                           
                              
                                 ρ
                                 ˜
                              
                              (
                              B
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          ρ
                                          (
                                          B
                                          )
                                          ,
                                       
                                       
                                          B
                                          ∈
                                          
                                             
                                                G
                                             
                                             
                                                p
                                             
                                          
                                          (
                                          M
                                          ,
                                          μ
                                          )
                                          ∩
                                          
                                             
                                                G
                                             
                                             
                                                p
                                             
                                          
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                B
                                             
                                          
                                          ,
                                          
                                             
                                                μ
                                             
                                             
                                                B
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          0
                                          ,
                                       
                                       
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        Theorem 4.4
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh, 
                           
                              ρ
                              ∈
                              
                                 
                                    Λ
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           and Γ be an exhaustive sequence of knot insertions. Then for all 
                           
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           it holds
                           
                              
                                 
                                    (
                                    Γ
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    =
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          B
                                       
                                    
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    −
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          B
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          B
                                       
                                    
                                    )
                                    (
                                    B
                                    )
                                    ,
                                 
                              
                            
                           where 
                           
                              
                                 
                                    N
                                 
                                 
                                    B
                                 
                              
                            
                           is defined by
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          B
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                Γ
                                                ρ
                                                )
                                                (
                                                ϕ
                                                )
                                                ,
                                             
                                             
                                                ϕ
                                                ∈
                                                
                                                   
                                                      Sk
                                                   
                                                   
                                                      p
                                                   
                                                
                                                (
                                                M
                                                ,
                                                μ
                                                )
                                                ∧
                                                B
                                                
                                                   ⊂
                                                   N
                                                
                                                ϕ
                                                ∧
                                                B
                                                ≠
                                                ϕ
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                
                                                   otherwise
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        Fix 
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and let V be the subspace of 
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            generated by the B-splines ϕ that lie in a path from supp
                           ρ to B. Let G be the associated subgraph of 
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            and 
                              
                                 
                                    Γ
                                 
                                 
                                    G
                                 
                              
                            be the subsequence of Γ containing only the knot insertions compatible with G. Since Γ is exhaustive then 
                              
                                 
                                    Γ
                                 
                                 
                                    G
                                 
                              
                            is exhaustive for G, moreover by Lemma 4.3 it follows that the knot insertions that are not in 
                              
                                 
                                    Γ
                                 
                                 
                                    G
                                 
                              
                            are irrelevant for the computation of 
                              Γ
                              ρ
                              (
                              B
                              )
                            and thus
                              
                                 (3)
                                 
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          G
                                       
                                    
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    =
                                    (
                                    Γ
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    .
                                 
                              
                            From the definition of 
                              (
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    B
                                 
                              
                              )
                            it follows that G is a subgraph of 
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    B
                                 
                              
                              )
                           . Thus it is possible to complete 
                              
                                 
                                    Γ
                                 
                                 
                                    G
                                 
                              
                            to an exhaustive sequence for 
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    B
                                 
                              
                              )
                            by appending 
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                            to it. Since 
                              (
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    B
                                 
                              
                              )
                            is a tensor mesh it follows
                              
                                 (4)
                                 
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          B
                                       
                                    
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    =
                                    
                                       (
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       ∘
                                       
                                          
                                             Γ
                                          
                                          
                                             G
                                          
                                       
                                       )
                                       ρ
                                       )
                                    
                                    (
                                    B
                                    )
                                    .
                                 
                              
                            Moreover 
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          Sk
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          B
                                       
                                    
                                    ,
                                    
                                       
                                          μ
                                       
                                       
                                          B
                                       
                                    
                                    )
                                 
                              
                            is the identity map and thus
                              
                                 (5)
                                 
                                    
                                       (
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       ∘
                                       
                                          
                                             Γ
                                          
                                          
                                             G
                                          
                                       
                                       )
                                       ρ
                                       )
                                    
                                    (
                                    B
                                    )
                                    =
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          G
                                       
                                    
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    +
                                    
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             G
                                          
                                       
                                       ρ
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             {
                                             B
                                             }
                                          
                                       
                                       ⋅
                                       
                                          
                                             Γ
                                          
                                          
                                             G
                                          
                                       
                                       ρ
                                       )
                                       )
                                    
                                    (
                                    B
                                    )
                                    .
                                 
                              
                            Using Lemma 4.3 it follows that
                              
                                 (6)
                                 
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          G
                                       
                                    
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    +
                                    
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             G
                                          
                                       
                                       ρ
                                       −
                                       
                                          
                                             1
                                          
                                          
                                             {
                                             B
                                             }
                                          
                                       
                                       ⋅
                                       
                                          
                                             Γ
                                          
                                          
                                             G
                                          
                                       
                                       ρ
                                       )
                                       )
                                    
                                    (
                                    B
                                    )
                                    =
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          G
                                       
                                    
                                    ρ
                                    )
                                    (
                                    B
                                    )
                                    +
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          B
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          B
                                       
                                    
                                    )
                                    (
                                    B
                                    )
                                    .
                                 
                              
                            Putting together the equalities (4), (5) and (6), gives 
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              ρ
                              )
                              (
                              B
                              )
                              =
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    G
                                 
                              
                              ρ
                              )
                              (
                              B
                              )
                              +
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    B
                                 
                              
                              )
                              (
                              B
                              )
                           . From here the thesis follows using (3).  □

Let 
                        
                           
                              N
                           
                           
                              i
                           
                        
                      be the subset of 
                        
                           
                              Sk
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      containing the B such that the longest sequence 
                        B
                        =
                        
                           
                              ϕ
                           
                           
                              1
                           
                        
                        
                           ⊂
                           N
                        
                        ⋯
                        
                           ⊂
                           N
                        
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                      with 
                        
                           
                              ϕ
                           
                           
                              j
                           
                        
                        ∈
                        
                           
                              Sk
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      has length i (
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                        ≠
                        
                           
                              ϕ
                           
                           
                              i
                              +
                              1
                           
                        
                     ). The coefficients of the B-splines in 
                        
                           
                              N
                           
                           
                              1
                           
                        
                      can be computed from the coefficients of their predecessors using the blossom (through 
                        
                           
                              Γ
                           
                           
                              B
                           
                        
                     ). Those of the B-splines in 
                        
                           
                              N
                           
                           
                              i
                           
                        
                      can be computed from the coefficients of their predecessors and of the B-splines in 
                        
                           
                              N
                           
                           
                              1
                           
                        
                        ∪
                        ⋯
                        ∪
                        
                           
                              N
                           
                           
                              i
                              −
                              1
                           
                        
                      again using the blossom. The above observations imply that Γρ depends only on the mesh 
                        (
                        M
                        ,
                        μ
                        )
                      and it is independent of the exhaustive sequence Γ. This justifies the following definition.


                     
                        Definition 4.5
                        The map associated to any exhaustive sequence for 
                              
                                 
                                    G
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            is denoted with 
                              
                                 
                                    Γ
                                 
                                 
                                    M
                                 
                              
                           .

Given a box-mesh 
                        (
                        M
                        ,
                        μ
                        )
                      and a degree p it is always possible to write a polynomial 
                        g
                        ∈
                        
                           
                              P
                           
                           
                              p
                           
                        
                      as linear combinations of 
                        
                           
                              B
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     . Let 
                        
                           
                              ρ
                           
                           
                              g
                           
                        
                      be the corresponding function in 
                        
                           
                              Λ
                           
                           
                              p
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      then the canonical coefficients of g are 
                        
                           
                              Γ
                           
                           
                              M
                           
                        
                        
                           
                              ρ
                           
                           
                              g
                           
                        
                     . Note that for all polynomials 
                        supp
                        
                        
                           
                              Γ
                           
                           
                              M
                           
                        
                        
                           
                              ρ
                           
                           
                              g
                           
                        
                        ⊂
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     .

This observation is enough to construct quasi-interpolants to the LR-spline space. Let 
                        Ω
                        =
                        [
                        a
                        ,
                        b
                        ]
                      and 
                        f
                        :
                        Ω
                        →
                        R
                      a function then a quasi-interpolant Q has the form
                        
                           
                              Q
                              f
                              =
                              
                                 ∑
                                 
                                    B
                                    ∈
                                    
                                       
                                          Sk
                                       
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    B
                                 
                              
                              (
                              f
                              )
                              B
                              ,
                           
                        
                      where the 
                        
                           
                              λ
                           
                           
                              B
                           
                        
                      are linear operators that depends only on the shape of f on some set 
                        
                           
                              U
                           
                           
                              B
                           
                        
                        ⊂
                        Ω
                     . The 
                        
                           
                              λ
                           
                           
                              B
                           
                        
                      can be constructed using the following steps
                        
                           •
                           choose a local polynomial approximation method, let 
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                               be the local approximating polynomial for the set 
                                 
                                    
                                       U
                                    
                                    
                                       B
                                    
                                 
                               associated to B;

represent the local polynomials in terms of the Bernstein basis for Ω: 
                                 
                                    
                                       B
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                              ;

apply 
                                 
                                    
                                       Γ
                                    
                                    
                                       M
                                    
                                 
                               to obtain the coefficient of B.

For all quasi-interpolants constructed on this model it holds that if the local approximation operators preserve polynomials then so does the quasi-interpolant:
                        
                           
                              
                                 
                                    (
                                    ∀
                                    B
                                    
                                    f
                                    |
                                 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          B
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                              ⇒
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          B
                                       
                                    
                                 
                              
                              =
                              f
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          B
                                       
                                    
                                 
                              
                              )
                              
                              ⇒
                              
                              (
                              f
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                              ⇒
                              Q
                              f
                              =
                              f
                              )
                              .
                           
                        
                      The above suggests that, as for quasi-interpolants on tensor product B-spline, the same applies to spline preservation. This is false. The problem is that 
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      are not necessarily linearly independent on 
                        
                           
                              U
                           
                           
                              B
                           
                        
                      and thus the coefficient of B given from the local approximation can be incompatible with the value of original spline in 
                        Ω
                        ∖
                        
                           
                              U
                           
                           
                              B
                           
                        
                     .

For instance if 
                        (
                        M
                        ,
                        μ
                        )
                      is such that 
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      are linearly independent and there exist 
                        
                           
                              B
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              B
                           
                           
                              2
                           
                        
                        ∈
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                      such that 
                        
                           
                              B
                           
                           
                              1
                           
                        
                        
                           ⊂
                           N
                        
                        
                           
                              B
                           
                           
                              2
                           
                        
                      then the quasi-interpolant Q based on Taylor expansion cannot preserve splines, but it preserves splines locally on the Bezier elements. Indeed from the properties of 
                        
                           
                              Γ
                           
                           
                              M
                           
                        
                      it follows that 
                        
                           
                              λ
                           
                           
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           
                        
                        (
                        
                           
                              B
                           
                           
                              1
                           
                        
                        )
                        ≠
                        0
                      and thus 
                        Q
                        
                           
                              B
                           
                           
                              1
                           
                        
                        ≠
                        
                           
                              B
                           
                           
                              1
                           
                        
                     .

It is possible to recover the corresponding theorem for spline preservation assuming the following local linear independence property: for all B the set 
                        {
                        ϕ
                        ∈
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                        :
                        supp
                        
                        B
                        ∩
                        
                           
                              U
                           
                           
                              B
                           
                        
                        ≠
                        ∅
                        }
                      contains linearly independent B-splines. With this assumption the following holds
                        
                           
                              
                                 (
                                 ∀
                                 B
                                 
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 ⇒
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                                 =
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                                 )
                              
                              
                              ⇒
                              
                              
                                 (
                                 f
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 M
                                 ,
                                 μ
                                 )
                                 ⇒
                                 Q
                                 f
                                 =
                                 f
                                 )
                              
                              .
                           
                        
                      In particular when the 
                        
                           
                              U
                           
                           
                              B
                           
                        
                      are open this is truth for the meshes 
                        (
                        M
                        ,
                        μ
                        )
                      such that 
                        
                           
                              O
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                        =
                        
                           
                              ∏
                           
                           
                              i
                              =
                              1
                           
                           
                              d
                           
                        
                        (
                        
                           
                              p
                           
                           
                              i
                           
                        
                        +
                        1
                        )
                     .


                     
                        Theorem 4.6
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh. Then the following propositions are equivalent
                           
                              
                                 1.
                                 
                                    for all 
                                    
                                       g
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             p
                                          
                                       
                                     
                                    it holds
                                    
                                       
                                          
                                             g
                                             =
                                             
                                                ∑
                                                
                                                   B
                                                   ∈
                                                   
                                                      
                                                         Sk
                                                      
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   M
                                                   ,
                                                   μ
                                                   )
                                                
                                             
                                             B
                                             [
                                             g
                                             ]
                                             (
                                             B
                                             )
                                             B
                                             ;
                                          
                                       
                                    
                                 


                                    
                                       ∄
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                       :
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       
                                          ⊂
                                          N
                                       
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    ;


                                    
                                       
                                          
                                             Sk
                                          
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       M
                                       ,
                                       μ
                                       )
                                     
                                    is a partition of unity.
                                 


                     
                        Proof
                        The implication 
                              1
                              ⇒
                              3
                            is obvious knowing that for all B 
                           
                              B
                              [
                              1
                              ]
                              (
                              B
                              )
                              =
                              1
                           .

The implication 
                              2
                              ⇒
                              1
                            follows from Theorem 4.4 and the fact that 
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    g
                                 
                              
                              )
                              (
                              B
                              )
                              =
                              B
                              [
                              g
                              ]
                              (
                              B
                              )
                           .

The implication 
                              3
                              ⇒
                              2
                            follows from Theorem 4.4. Let 
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                 
                              
                            be the representation of 1 in the Bernstein basis, then
                              
                                 
                                    1
                                    =
                                    
                                       ∑
                                       
                                          B
                                          ∈
                                          
                                             
                                                Sk
                                             
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          M
                                          ,
                                          μ
                                          )
                                       
                                    
                                    B
                                    =
                                    
                                       ∑
                                       
                                          B
                                          ∈
                                          
                                             
                                                Sk
                                             
                                             
                                                p
                                             
                                          
                                          (
                                          M
                                          ,
                                          μ
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          Γ
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    (
                                    B
                                    )
                                    B
                                    =
                                    
                                       ∑
                                       
                                          B
                                          ∈
                                          
                                             
                                                Sk
                                             
                                             
                                                p
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          M
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       (
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       (
                                       B
                                       )
                                       −
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       (
                                       B
                                       )
                                       )
                                    
                                    B
                                    =
                                    
                                       (
                                       
                                          ∑
                                          
                                             B
                                             ∈
                                             
                                                
                                                   Sk
                                                
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             M
                                             ,
                                             μ
                                             )
                                          
                                       
                                       B
                                       )
                                    
                                    −
                                    
                                       (
                                       
                                          ∑
                                          
                                             B
                                             ∈
                                             
                                                
                                                   Sk
                                                
                                                
                                                   p
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             M
                                             ,
                                             μ
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             Γ
                                          
                                          
                                             B
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       (
                                       B
                                       )
                                       B
                                       )
                                    
                                    .
                                 
                              
                            Thus 
                              
                                 
                                    ∑
                                 
                                 
                                    B
                                    ∈
                                    
                                       
                                          Sk
                                       
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                 
                              
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    B
                                 
                              
                              )
                              (
                              B
                              )
                              B
                              =
                              0
                           . Note that for all 
                              B
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    B
                                 
                              
                              )
                              (
                              B
                              )
                              ⩾
                              0
                            because 
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                            is a positive projection. Thus, since B-splines are positive functions, 
                              (
                              
                                 
                                    Γ
                                 
                                 
                                    B
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    B
                                 
                              
                              )
                              (
                              B
                              )
                              =
                              0
                            for all B and this implies 
                              {
                              ϕ
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              :
                              B
                              
                                 ⊂
                                 N
                              
                              ϕ
                              }
                              =
                              ∅
                            (Lemma 4.3). Since B is arbitrary then 2 holds. □


                     
                        Theorem 5.1
                        
                           Let 
                           
                              (
                              M
                              ,
                              μ
                              )
                            
                           be an extended box-mesh, then
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       }
                                    
                                    
                                    ⟹
                                    
                                    
                                       
                                          Sk
                                       
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    M
                                    ,
                                    μ
                                    )
                                     
                                       are locally linearly independent
                                    
                                 
                              
                            
                           Moreover if 
                           
                              ∄
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                            
                           such that 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              
                                 ⊂
                                 N
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                            
                           then 
                           
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                                 
                                    r
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                              =
                              
                                 
                                    Sk
                                 
                                 
                                    p
                                 
                              
                              (
                              M
                              ,
                              μ
                              )
                           
                           .
                        

In particular when 
                        (
                        M
                        ,
                        μ
                        )
                      is an LR-mesh the above equivalence holds for the LR B-spline collection 
                        B
                        =
                        
                           
                              Sk
                           
                           
                              p
                           
                           
                              r
                           
                        
                        (
                        M
                        ,
                        μ
                        )
                     .

@&#ACKNOWLEDGEMENTS@&#

This paper is the fruit of a work begun during a stay in Oslo. I thank Tor Dokken, Tom Lyche and Kjell Fredrik Pettersen for introducing me to the subject and in particular Tom for his teaching and advice. This study and in particular my stay was partially supported by the European Research Council through the FP7 Ideas Starting Grant 205004 
                  GeoPDEs – Innovative compatible discretization techniques for partial differential equations, and by the Italian MIUR through the FIRB “Futuro in Ricerca” Grant RBFR08CZ0S 
                  Discretizzazioni Isogeometriche per la Meccanica del Continuo. This support is gratefully acknowledged.

@&#REFERENCES@&#

