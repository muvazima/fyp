@&#MAIN-TITLE@&#Partial least squares and logistic regression random-effects estimates for gene selection in supervised classification of gene expression data

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Gene selection is needed in supervised classification of gene expression.


                        
                        
                           
                           Respecting the characteristics of data is a key aspect to consider in gene selection.


                        
                        
                           
                           Selection based on logistic regression estimates is recommended in general.


                        
                        
                           
                           Selection based on PLS estimates is recommended when the number of samples is low.


                        
                        
                           
                           Selection based on modified t-statistics performs well on data with high variability.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supervised classification

Gene selection

Filtering

Partial least squares

Logistic regression

Random effects

@&#ABSTRACT@&#


               
               
                  Our main interest in supervised classification of gene expression data is to infer whether the expressions can discriminate biological characteristics of samples. With thousands of gene expressions to consider, a gene selection has been advocated to decrease classification by including only the discriminating genes. We propose to make the gene selection based on partial least squares and logistic regression random-effects (RE) estimates before the selected genes are evaluated in classification models. We compare the selection with that based on the two-sample t-statistics, a current practice, and modified t-statistics. The results indicate that gene selection based on logistic regression RE estimates is recommended in a general situation, while the selection based on the PLS estimates is recommended when the number of samples is low. Gene selection based on the modified t-statistics performs well when the genes exhibit moderate-to-high variability with moderate group separation. Respecting the characteristics of the data is a key aspect to consider in gene selection.
               
            

@&#INTRODUCTION@&#

In supervised classification of gene expression data, our main interest is to classify samples’ characteristics based on the gene expression, for description or prediction purposes. For example, whether the gene expression can be used to predict the malignancy of a tumor. In this regard, logistic regression, discriminant rule, and neural networks have been successfully employed in classification and prediction (e.g. [1–3]). With thousands of gene expressions to consider, many of them are not relevant for the classification because they do not have enough information to discriminate the samples’ characteristics. So, selecting the genes that are relevant for classification, or gene selection, is a critical issue in the classification using gene expression data (e.g. [4–6]). This is simply because classification performance, in terms of number of samples that are classified, depends on which genes that are selected into the classification model. In this paper, our main focus is to investigate how different gene selection methods determine the discriminating quality of the selected genes, which, when evaluated in a classification model, would determine the overall classification performance.

For this purpose, the process of gene selection combined with supervised classification can generally be identified to fall into three different approaches: wraper method, embedded method, and filtering method (see [7] for a review). The wrapper method takes the performance of genes as the evaluation criterion of selection. Two examples of this method are genetic algorithm and k-nearest neighbor (e.g. [8,9]). The embedded method builds classification model and gene selection simultaneously, such as support vector machine (e.g. [10]).

In this study, we concentrate and limit ourselves in the context of filtering method. In the filtering method, we ‘score’ and rank the genes based on their importance using a gene selection method, and we select the top few genes to be included and evaluated in a classification model. The gene selection method is separated from the classification model. We introduce new selection methods based on partial least squares (PLS) and logistic regression random-effects (RE) estimates. Specifically, we perform PLS and logistic regression on all of the genes once to obtain gene-wise statistics, and we select the top genes to be included in classification models based on those statistics.

PLS itself can be regarded as a classification model [11–14]. However, as we will discuss later, when we look into the individual PLS estimates, they contain gene-wise discriminating information that are useful for gene selection. In this setting, we perform a PLS regression on all of the genes, and the estimate for each gene is used to rank the genes based on their importance for classification. Hence, the use of PLS in this case is not for evaluating the selected genes for classification, but rather for producing gene-wise statistics, on which our gene selection will be based.

As outlined in the methods section, gene selection based on the PLS estimates ignores the correlations between genes. When relatively high correlations between genes are present, a gene selection method that exploits the correlations is expected to produce genes with better discriminating power. For this purpose, we also consider the logistic regression RE estimates as the basis to rank the genes in the gene selection. In this context, we perform a logistic regression on all of the gene expressions to obtain gene-wise parameter estimates. If a gene exhibits a high estimate, it indicates that the gene has high information in the classification, given the correlation that the gene has with other genes in the data. Based on the estimates, we rank and select only the top genes to be included in a classification model. The use of logistic regression to obtain gene-wise statistics is separated from the use of logistic regression to evaluate selected genes as a classification model. In the former, logistic regression is performed once where all of the genes are included in the model.

The proposed methods for gene selection will be compared to a common practice where we rank and select the genes based on gene-wise t-statistic (two-sample Student’s t-test) or ranking of the Pearson correlation of each gene expression with the group labels. For example, in West et al. [15], the top genes are selected by taking the ones that are most correlated with the group labels before employing them in a probit regression. van’t Veer et al. [2] also select the top genes into a classification model based on the ranking of Pearson correlation with the group labels, which is equivalent with the selection based on the ranking of t-statistics. Nguyen and Rocke [11] also select the top genes based on the ranking of t-statistics prior to evaluating them in the partial least squares (PLS) and principal component analysis (PCA) models for discrimination of tumor samples. Dudoit et al. [3] use the ranking of BW criterion to select the top genes, where BW is the (gene-wise) ratio of between- over within-groups sum-of-squares. This is also equivalent to select the top genes based on the ranking of t-statistics. Selection based on the t-statistics has also been considered in Liu et al. [16] and Wu et al. [17]. Another statistic related to the t-statistics that has been considered for selection is F-statistics as described in Bhanot et al. [18].

In our study, we propose to select the genes based on the PLS estimates, logistic regression RE estimates and standardized RE estimates, and modified t-statistics. We also perform a gene selection based on the commonly used t-statistics. The top genes are then included one-at-a-time into a classification model and the classification errors are recorded for an increasing number of genes in the model [19]. By looking at the classification error across different number of genes, we expect to have better understanding of the behavior of the top genes selected by the different statistics. The classification models that we consider are logistic regression, discriminant analysis (DA), and neural networks (NN). The main reason that we consider these models is because they are regularly used in common practice to perform supervised classification and prediction.

The outline of the paper is as follows. The different statistics to rank the genes are discussed in Section 2 and datasets involved are described in Section 3. The results are presented in Section 4 and Section 5 presents the discussion.

@&#METHODS@&#

We firstly describe the notation that we use in this paper. We summarize the expression of p genes from n samples or individuals into a matrix 
                           
                              X
                              =
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    …
                                    
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    ′
                                 
                              
                           
                        , where 
                           
                              x
                           
                         is a p-vector and ′ denotes the transpose operator. So, 
                           
                              X
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              )
                           
                         where 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                         is the expression of gene j from sample or individual i. Each sample or patient’s expression profile 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         corresponds to a response variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        . The response variable y is a binary variable of samples’ status or class labels.

Our setting can be described in the context of cross-validation as follows. We randomly split the dataset into training set and validation set. Let X be the expression matrix as described above. We can write
                           
                              
                                 X
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         t
                                                         (
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ×
                                                         p
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         v
                                                         (
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                         ×
                                                         p
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    n
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              =
                              n
                              ,
                              
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    X
                                 
                                 
                                    v
                                 
                              
                           
                         are the training set and validation set, respectively. In a similar way, the response variable y is split into 
                           
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    v
                                 
                              
                           
                         corresponding to 
                           
                              
                                 
                                    X
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    X
                                 
                                 
                                    v
                                 
                              
                           
                        , respectively.

The steps taken in our analysis can be summarized in Fig. 1
                        . First, we perform the different gene selection methods in the training set to obtain gene-wise statistics. From here, we have the configuration of top genes. Secondly, with this information, the classifier will take those genes in the validation data to be included and evaluated in the different classifiers, one at a time. This is an external validation, as the gene expressions to perform prediction are external to those used for the gene selection [19,20]. Hence, the gene selection in performed only in the training set, and the assessment of classification performance is done using the validation set only. Thirdly, we obtain the prediction performance as the number of genes in the classification model increases. The idea here is that the way we select the top genes will determine their quality, which is represented in how well they predict the class when evaluated in a classification model.

From our experience on some gene expression data, including the ones we considered in this study, selecting top 30–50 genes in the first step above is generally sufficient to see the trend of misclassification as the number of genes increases in the classification models. Some datasets may exhibit further improvement in the classification error after hundreds of genes are included in the model. Therefore, our conclusion here applies to cases where we have limited number of genes that discriminate the groups. In the next Section (2.2), we discuss the different statistics to rank the genes before putting the top genes into a classification model. The classification models we consider are described further in Section 2.3.

In this section, we outline our proposed statistics which are the bases for ranking and selecting the genes: PLS estimates, logistic regression RE estimates and standardized RE estimates, and modified t-statistics. We also mention briefly the t-statistics, as a current gene selection statistic, in Section 2.2.3 to highlight the characterstics of genes selected based on the statistic.

PLS is a regression based on new explanatory variables, often called factors or components, that have maximal covariance with the outcome variable. The main reason we consider the PLS estimates to rank and select the top genes is because the estimates contain some information for discrimination. To proceed, we perform a PLS algorithm on all of the genes to obtain gene-wise estimates and use the estimates (in absolute value) to rank and select the top genes. For more details about PLS, Hoskuldsson [21] and Geladi and Kowalski [22] discussed the PLS regression technique in details, including the computational algorithm that we use here, while Garthwaite [23] discussed the technique from the univariate regression point of view (see the supplementary material for the computation procedure of PLS).

For our purpose to see the usage of PLS for discrimination, let us define y to be a vector of class labels. In a general context of having g groups or classes, we can write y in two different ways as discussed in Barker and Rayens [24]:
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          ×
                                          g
                                       
                                    
                                    
                                    or
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          ∗
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋮
                                                      
                                                      
                                                         ⋱
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     n
                                                                  
                                                                  
                                                                     g
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          n
                                          ×
                                          (
                                          g
                                          -
                                          1
                                          )
                                       
                                    
                                 
                              
                           where 
                              
                                 g
                              
                            is the number of groups, 
                              
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                              
                            is the number of observation in kth group, and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 n
                              
                           .

Let 
                              
                                 y
                              
                            be the above response variable (whether coded as 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ∗
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ∗
                                       ∗
                                    
                                 
                              
                           ) of size 
                              
                                 (
                                 n
                                 ×
                                 q
                                 )
                              
                           , 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       xx
                                    
                                 
                              
                            of size 
                              
                                 (
                                 p
                                 ×
                                 p
                                 )
                              
                            be the dispersion matrix of 
                              
                                 X
                              
                            and 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       xy
                                    
                                 
                              
                            of size 
                              
                                 (
                                 p
                                 ×
                                 q
                                 )
                              
                            be the covariance matrix of 
                              
                                 X
                              
                            and 
                              
                                 y
                              
                           . PLS can be thought of as canonical covariance analysis where we would like to maximize
                              
                                 (1)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             xy
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             yx
                                          
                                       
                                    
                                    a
                                 
                              
                           with the constraints 
                              
                                 
                                    
                                       a
                                    
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 1
                              
                            and 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 0
                              
                            for 
                              
                                 i
                                 
                                 ≠
                                 
                                 j
                              
                           . The PLS can be derived as the eigensolutions of
                              
                                 (2)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          xy
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          yx
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    ψ
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       S
                                    
                                    
                                       xy
                                    
                                 
                              
                            is the sample covariance matrix of 
                              
                                 X
                              
                            and 
                              
                                 y
                              
                           . It is important to note that the objective function to maximize in Eqs. (1) and (2) do not involve the expression on 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       xx
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       S
                                    
                                    
                                       xx
                                    
                                 
                              
                           , variance–covariance matrix of X, indicating that the PLS estimates for discrimination do not take into account the correlation between genes.

It can be shown that
                              
                                 (3)
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   xy
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   yx
                                                
                                             
                                          
                                          
                                             y
                                             =
                                             
                                                
                                                   Y
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                (
                                                n
                                                -
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             g
                                          
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           (proof and further details on the case of 
                              
                                 y
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       ∗
                                       ∗
                                    
                                 
                              
                            are available in the supplementary material). Note that 
                              
                                 
                                    
                                       S
                                    
                                    
                                       xy
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       yx
                                    
                                 
                              
                            is a modified version of 
                              
                                 B
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                    
                                       ′
                                    
                                 
                              
                           , the between-groups sum-of-squares and cross-products matrix in Fisher linear discriminant analysis [25,3]. Ref. [24] established the relation (for 
                              
                                 g
                                 =
                                 2
                              
                           )
                              
                                 (4)
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          n
                                          -
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    B
                                    .
                                 
                              
                           
                        

Now, we describe the discriminant rule developed using PLS method that will show the meaning of PLS estimates to rank and select the genes. We derive the rule for number of components 
                              
                                 l
                                 =
                                 1
                              
                            and number of groups 
                              
                                 g
                                 =
                                 2
                              
                           . Note that the eigensolutions in (2) are the same as maximizing 
                              
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       ∗
                                    
                                 
                                 a
                              
                            with the constraint 
                              
                                 
                                    
                                       a
                                    
                                    
                                       m
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 1
                              
                           . The matrix 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is of rank 1 and following the relation in (4), we can write
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          n
                                          -
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    B
                                    =
                                    
                                       
                                          n
                                          -
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          dd
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 d
                                 =
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           . Then, matrix 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ∗
                                    
                                 
                              
                            has one non-zero eigenvalue trace 
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       ∗
                                    
                                 
                                 }
                                 =
                                 
                                    
                                       
                                          
                                             
                                                n
                                                -
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ′
                                    
                                 
                                 d
                              
                            corresponding to eigenvector 
                              
                                 a
                                 =
                                 d
                              
                           . The discrimination rule becomes: allocate 
                              
                                 x
                              
                            to group 1 if
                              
                                 (5)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             x
                                             -
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    >
                                    0
                                 
                              
                           and to group 2 otherwise. We can see that using PLS with single factor 
                              
                                 (
                                 l
                                 =
                                 1
                                 )
                              
                            and number of groups 
                              
                                 g
                                 =
                                 2
                              
                           , the discriminant rule is based solely on the difference between group means. In relation to the Fisher linear discriminant analysis [25,3], the discriminant rule in PLS is not weighted by the within-group sum-of-squares and cross-products matrix 
                              
                                 W
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       kj
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             kj
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       ′
                                    
                                 
                              
                           . In the latter, the discriminant rule developed is to allocate x to group 1 if
                              
                                 (6)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          
                                             x
                                             -
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    >
                                    0
                                 
                              
                           and to group 2 otherwise. Further details are described in the supplementary material.

This indicates that, for number of groups 
                              
                                 g
                                 =
                                 2
                              
                            and number of component 
                              
                                 l
                                 =
                                 1
                              
                           , ordering the genes based on the PLS estimates means that the genes are ranked based on the group mean diferences in each gene, or commonly known as log fold-change only. In this specific case, the top genes that are selected into a classification model are the genes that have large group mean differences (or log fold changes), regardless of their gene-wise variance, or their correlation with other genes. In practice, we rank the genes based on the magnitude, in absolute value, of their loading vector 
                              
                                 w
                              
                            (see the supplementary material for the different vectors involved in PLS algorithm).

Logistic regression has been widely used to perform classifications and its parameter estimates indicate the magnitude of effects each gene has for discrimination. Due to 
                              
                                 n
                                 ≪
                                 p
                              
                           , we assume in the logistic regression that the parameter follows a normal distribution with mean zero and variance–covariance matrix D, hence the estimates are random effects estimates. It can be shown (see the supplementary material) that the random effects estimates 
                              
                                 
                                    
                                       b
                                    
                                    
                                       ˆ
                                    
                                 
                                 ≡
                                 {
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 }
                              
                            are estimated as
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          X
                                          +
                                          
                                             
                                                D
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          Σ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          c
                                       
                                    
                                 
                              
                           where, in an iterative procedure, 
                              
                                 Σ
                              
                            is a diagonal weight matrix, and 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       c
                                    
                                 
                              
                            is a working vector corresponding to the group labels.

The estimates carry (gene-wise) information of weighted correlation between the genes and the group labels, so that a high parameter estimate (in absolute value) shows a high correlation between the gene and group label, adjusted for variability between the genes. This is contrary to the selection of genes based on the PLS estimates, in which the variability between genes is ignored. We also consider to rank the genes based on the standardized parameter estimates 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       se
                                       (
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 p
                              
                           , where 
                              
                                 se
                                 (
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                            is the approximate standard error of 
                              
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                           . Standardising parameter estimates has previously been considered in variable selection [26]. The details of the parameter estimation are described further in the supplementary material.

There is one thing to be noted. The use of logistic regression to rank and select the genes is separate from the use of logistic regression as a classification model in evaluating the top genes. In the former, logistic regression is performed once on all of the genes in the training set to obtain gene-wise statistics, which will be used to rank and select the top genes. In the latter, we perform logistic regression to obtain the number of misclassification in the validation set using the selected top genes only, regardless the statistics used to rank and select the genes.

The two-sample t-test statistic has been used widely to rank and select top genes. Genes are selected into the model based on the ordering of the absolute value of the t-statistic
                              
                                 (7)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                2
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           for each j, where 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             1
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             s
                                          
                                          
                                             2
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kj
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       kj
                                    
                                    
                                       2
                                    
                                 
                              
                            are the respective sample mean and variance of expression values of gene j in group k, and 
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                            are number of observations in group 1 and group 2, respectively. Using the t-statistics to rank the genes means that the top genes are those genes with big difference between group means, weighted by its standard error. This is currently a common practice that we select the genes with high absolute values of t-statistics and then include the top genes in a classification model.

The t-statistic in (7) is vulnerable, as it can inflate when the variance is badly under-estimated by chance. This often happens when the sample size is small, as noted in Tusher et al. [27], Efron et al. [28], Tibshirani et al. [29], and Lonnstedt and Speed [30]. To deal with this situation, the modified t-statistic is defined by adding a constant term c in the denominator of (7). This constant c is the same for all of the genes and will guard the t-statistic to become large due to the small variance but no difference in the true means.

The statistic can be written as
                              
                                 (8)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                2
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          c
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kj
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                              
                            are the same as defined in (7), and c is the added constant. The above formulation of the modified t-statistic varies in several references, for example in the definition of 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                              
                            into a pooled standard deviation of 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       2
                                       j
                                    
                                 
                              
                           . However, this difference is not of our main interest. There are several ways also to select c, and we use the guideline in Efron et al. [28] to select c to be the 90th percentile of the distribution of 
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                              
                           .

We describe here briefly the classification models considered in this study. From the training set, we have the configuration of selected top genes. We use this information to include those genes from the validation set and evaluate them in a classification model, to obtain the number of misclassification or misprediction. We describe these models in more details in the supplementary material.

The use of logistic regression to evaluate selected top genes is separated from the use of logistic regression on all the genes in the training set to obtain gene-wise statistics for gene ranking and selection. In the logistic regression, we model the binary class as a function of gene expressions via a logit link function. There is an important assumption on the logistic regression to deal with the number of variables that exceeds the number of samples. We assume that the regression parameters follow a normal distribution with zero mean and some positive variance. This assumption is not present in the ordinary logistic regression. For more details, see e.g. Eilers et al. [1], van’t Veer et al. [2], and West et al. [15] (under probit link).

We also consider maximum likelihood (ML) discriminant rule to make prediction in the validation set based on the configuration of selected to genes obtained in the training set. There are four different special cases of ML discriminant rule that we use: Quadratic discriminant analysis (QDA), Linear discriminant analysis (LDA), Diagonal quadratic discriminant analysis (DQDA), and Diagonal linear discriminant analysis (DLDA). These methods differ in the way variance–covariance matrix in each group is taken into account in the discriminant rule. For further description on discriminant analysis see Mardia et al. [31], Dudoit et al. [3], and the supplementary material.

Neural network is a flexible classification technique. The idea is to extract linear combination of gene expression, and mode the binary class as a non-linear function of those features. It does not impose any parametric restriction in order to recognize between classes of interest using microarray dataset or any different dataset. Here, we concentrate on feed forward neural network, namely the signal flows in a forward direction. In this paper, the neural network is based on a set of logistic activation functions with a single hidden layer of units followed by a layer of output units, where each output unit corresponds to each class of interest. Further details are presented in the supplementary material, and can be seen in Ripley [32] and Hastie et al. [33].

We consider two real datasets to illustrate the methods. To represent the spectrum of microarray experiments, the datasets we considered have, to some extent, opposite characteristics. Gene expression data can exhibit different structures of gene-wise variance and other experimental factors that cannot be taken into account in the normalization step. For example, in cancer experiments, the genes generally exhibit high variability of expressions, while in other experiments, the genes exhibit subtle differences of expression. Majority of the microarray datasets in the public domain fall inbetween or around those characteristics. Here, we consider datasets from a cancer study and a study on coronary artery disease (CAD), and we expect that the conclusions we derive in our study will be applicable more generally.

The first dataset is from a study of transcription profiling of human monocytes from individuals with different collateral flow index (CFI) obtained during angioplasty [34], accessible from the gene expression omnibus with the accession number GSE7638. The study compared two groups of individuals: a group of patients with coronary artery disease (CAD) and a group of individuals without CAD. The gene expressions from 22,277 probesets on 160 samples using Affymetrix arrays were obtained, out of which, 110 have CAD and 50 do not have CAD. We use a standard method, including quantile normalization, in the preprocessing step [35]. The samples exhibit relatively low gene expressions and subtle differences of expressions between genes as well as between samples. As a result, the correlations between genes are higher than what we usually deal with in a microarray data.

The second dataset is from a study of diffuse large-B-cell lymphoma as described in Rosenwald et al. [36]. The lymphoma dataset contains 240 cases, which were collected on a custom-made DNA microarray chip generating gene expressions from 7399 probes, and preprocessed as the one used in the main article. The average clinical followup for patients was 4.4years, with 138 deaths occurring during this period. For our purposes, we ignore the censoring information and only compare expression between the 102 survivors and the 138 non-survivors. In this dataset, the samples exhibit relatively high gene expressions with high variability between genes as well as between samples. The correlations between genes and between samples are relatively moderate to low.

We also perform a simulation study to better understand the effects of gene ranking and selection based on the different statistics to the classification error in the validation set. We generated two different type of datasets in the simulation. The first one is using the CAD dataset. To mimic realistic correlation structures between genes, we sample the error distribution from the residuals of the CAD dataset as follows:
                           
                              •
                              we subtract the group-wise means for each gene;

for genes with different group means, we add an effect size 
                                    
                                       ±
                                       
                                          
                                             Ds
                                          
                                          
                                             i
                                          
                                       
                                    
                                  in group 2, with equal proportions of positive and negative differences and 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                    
                                  the sample standard deviation of gene i.

The number of samples in each group is still the same in this simulated dataset, with 
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              =
                              110
                           
                         and 
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              50
                           
                        .

For the second simulated data, we simulate normal data with constant standard deviation 
                           
                              σ
                              =
                              1
                           
                         across 10,000 genes and fixed effect size 
                           
                              D
                              =
                              1
                           
                        . We set the proportion of genes with differences in their group means as 
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                              =
                              0.99
                           
                         in the data. The sign of the effect is equally and randomly split between positive and negative differences, and effects are added to the second group. In this dataset, the quantities that vary are only the number of samples in each group, n
                        1=n
                        2=100, 50, and 20. The construction of the simulated datasets are repeated 100 times, and the median of classification error across the repetition is recorded.

In the last scenario 
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              20
                              )
                           
                        , we perform an analysis of variance at given number of genes (5, 10, and 20 genes) in the classification models to test whether there is any interaction between the way we select the genes and how we evaluate them in the classification models. The main reason of using the last scenario is to test the interaction in a difficult situation where the number of samples is low. We expect that when the number of samples is limited, the choice of statistics for gene selection becomes more important.

@&#RESULTS@&#

We present the results for the CAD dataset in Fig. 2
                        . In the figure, we can infer that the classification error of the top genes selected by the t-statistics is higher than those selected by the other statistics, when the number of genes in the classification model is low. As we have more genes in the classification models, especially in discriminant analysis (DA), the classification errors for gene selection based on the t-statistics decreases and the error based on the other statistics increases. When the top genes are evaluated in a neural network model, the classification error for gene selection based on the t-statistics tends to stay flat as we have more genes in the model and, on the other hand, the error of genes selected based on the other statistics increases. For the evaluation in logistic regression, the ranking and selection of genes using the t-statistic and PLS estimates give the lowest classification error compared to the selection of genes based on the other statistics.

The above results indicate that the first gene selected by the t-statistics has low power to discriminate the two groups when evaluated in DA and neural network. When the gene is evaluated in the logistic regression it gives the lowest classification error; the same error achieved by the first gene selected by the PLS estimates. However, after the first gene is included in a classification model, our interest is to see whether the subsequent genes are of the same expression characteristics.


                        Fig. 3
                         presents the maximum (Pearson) correlation of a newly selected gene with all of the genes already in the model. Our focus in the figure is how the classification error changes as the number of genes included in the model increases, and not in comparison between classification models.

The figure indicates that the top genes selected by the t-statistics generally have lower correlation structure compared to the top genes selected based on the other statistics. Using the t-statistics to select them, the maximum correlation between a newly selected gene and the other genes already selected in the model is in a moderate level of 0.4–0.5, compared to 0.85–0.95 when the genes are selected by the other statistics. In the CAD dataset, many genes are correlated (although they have low expression), and this result suggests that selection based on the t-statistics do not produce correlated top genes for classification.

When we evaluate the top genes selected by the t-statistics, they have a relatively high classification error and the error decreases further as the number of selected genes increases in the classification models. This indicates that the selected top genes with moderate correlation give more information to the classification models to discriminate the two groups. One exception is that when the top genes are evaluated in the logistic regression, the classification error does not improve further because it is already relatively low at the start.

On the other hand, the top genes selected based on the other statistics give a relatively low classification error, but the error increases as the number of genes in the classification models increases and stay approximately level. In Fig. 3, subsequent genes selected based on other than the t-statistics have high correlation with the top genes already in the model. This correlation makes the variance–covariance matrix close to singular, which in turn makes its inverse slightly unstable. This instability results in higher classification error. The figure also indicates that, as the subsequent genes have lower correlation, the classification errors tend to stay approximately level (see also Fig. 2).

In summary, the following table (Table 1
                        ) presents the minimum classification errors in Fig. 2, from top genes selected based on the ranking of different statistics and evaluated in DA, logistic regression, and neural network. The table indicates that across the different evaluation methods, selection of genes based on the PLS estimates and random effects estimates produce lower classification error compared to the gene selection based on the t-statistics, modified t-statistics, and standardized random effects estimates.

We present the results of analysis on the Lymphoma data in this section. Fig. 4
                         presents the classification error under different gene selection methods when we evaluate the top genes in discriminant analysis, logistic regression, and neural network.

The figure indicates that, when evaluated in the discriminant analysis, the gene selection based on the logistic-regression random-effects estimates and modified t-statistics lead to the lowest classification error, while the selection based on the PLS estimates leads to the highest classification error. This is more noticeable for low number of variables. The classification error based on different selection methods converged when the number of selected variables increases. The selection based on the t-statistics has somehow intermediate classification error between the selection based on PLS and random effects estimates.

When evaluated in the logistic regression and neural network, the classification errors between the different gene selection methods are almost undistinguishable. Although less noticable, the selection based on the random effects estimates gives relatively lower classification error from the start of the number of variables in the classification model.

To see the characteristics of genes selected by the different selection methods, Fig. 5
                         shows the maximum (Pearson) correlation between a newly entered gene and those genes which are already in the model. The figure indicates that gene selection based on the PLS estimates produces a configuration of genes that are highly correlated at the start of model extension. This is a result of selecting the genes based on the separation of means between groups and ignoring the variability within a gene. This translates into relatively higher classification error at low number of variables, and the error gradually decreases as the number of variables increases.

The figure also indicates that the gene selection based on the random effects estimates and modified t-statistics resulted in the lowest classifcation error at the start. This is a result of the characteristics of both selection methods that take into account the correlation between genes, and coupled by the low correlated genes being selected. In contrary, although gene selection based on the t-statistics also produces low correlated genes, the selection ignores the correlation between genes. In the lymphoma data, the correlation between genes proves to be an important consideration when we perform gene filtering. Selection methods that respect this property resulted in lower classification error.

The minimum classification errors in Fig. 4 are summarized in Table 2
                        . The table indicates that the top genes selected based on the modified t-statistics and random effects estimates achieve lower classification error than those genes selected based on the other statistics. With regard to the gene selection based on the random effects estimates, our conclusion on Tables 2 and 1 are effectively alike. However, for the gene selection based on the PLS estimates, the two tables show a different conclusion. In the lymphoma data, selection of top genes based on the PLS estimates results in the highest classification error. We will visit this again in the discussion.

For the first simulated data, we use the CAD data and include simulated group mean differences (only on some genes). The differences are put to see whether we have the same pattern of classification error between different statistics to rank and select the top genes when the groups are well separated. The observed group mean differences in the CAD dataset is relatively low compared to common gene expression data. The results from the first simulated dataset can be seen in Fig. 6
                           . In the figure, we can generally see that, apart from gene selection based on the standardized random effects estimates, the classification errors of genes selected based on the other statistics are similar. When evaluated in the logistic regression, the top genes selected based on the PLS estimates and t-statistics give the lowest classification error. This result is similar to the result in Fig. 2 on the CAD data. We can conclude from the results of our first simulated data in Fig. 6 that, when the group mean differences are well separated, the preference of gene selection procedure is somewhat less crucial.

Our second simulated data are from simulating independent normal data with two groups having moderate-to-low mean differences on some genes. These moderate group mean differences were set to resemble a more difficult situation than the well-separated case in the first simulated data. The only quantity that varies is the number of samples per group: 100, 50, and 20. Our intention with this simulation is to identify the effect of sample size to the classification error, across different statistics for gene ranking and selection. Varying the number of samples is effectively similar to varying the group mean differences. However, we are also interested in this simulated data to describe the classification error when the genes are independent, with no complicated correlation pattern between genes.

The results for the second simulation are presented in Figs. 7 and 8
                           
                           . In Fig. 7 we can infer that when the number of samples in each group are 100 and 50 (left and middle columns), the classification errors for genes selected based on all of the statistics are close to each other and quite similar when evaluated in the discriminant analysis (DA). In the case of 
                              
                                 n
                                 =
                                 50
                              
                           , we can see that the classification error of genes selected based on the standardized random effects estimates starts to show a separation from the others. When the number of samples in each group drops further to 20, we can see a separation of the classification errors between different statistics to select the top genes. In this case, selection of top genes using the t-statistics gives the highest classification error, while selection based on the PLS estimates gives the lowest and the selection based on the other statistics results in classification errors in between the PLS estimates and t-statistics.

Similar results can be inferred in Fig. 8, when the genes are evaluated in the logistic regression and neural network. For 
                              
                                 n
                                 =
                                 100
                              
                           , the classification errors of genes selected based on the different statistics are similar. However, as the numbers of samples in each group decrease further to 
                              
                                 n
                                 =
                                 50
                              
                            and 
                              
                                 n
                                 =
                                 20
                              
                           , the separation of classification errors between different statistics to select the top genes becomes more visible. Similar to the evaluation of genes in the discriminant analysis, Fig. 8 shows that selection of genes based on the PLS estimates give the lowest classification error. The highest classification error occurs when the genes are selected by the standardized random effects estimates.

We test the effects of interaction between the different gene selection methods and classification models to the classification errors. This is done for five, ten, and 20 selected genes in the classification models. For five selected genes in the model, we found the interaction is significant 
                              
                                 (
                                 F
                                 =
                                 5.22
                                 ,
                                 
                                 df
                                 =
                                 {
                                 20
                                 ,
                                 570
                                 }
                                 ,
                                 
                                 p
                                 -
                                 value
                                 =
                                 3.85
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       12
                                    
                                 
                                 )
                              
                           . When we exclude the quadratic and linear DA (these two methods use the off-diagonal elements of the variance–covariance matrix), the interaction is still significant 
                              
                                 (
                                 F
                                 =
                                 4.77
                                 ,
                                 
                                 df
                                 =
                                 {
                                 12
                                 ,
                                 380
                                 }
                                 ,
                                 
                                 p
                                 -
                                 value
                                 =
                                 2.67
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       7
                                    
                                 
                                 )
                              
                           .

When we have ten selected genes in the classification models, the interaction is in the borderline of significance 
                              
                                 (
                                 F
                                 =
                                 1.69
                                 ,
                                 
                                 df
                                 =
                                 {
                                 12
                                 ,
                                 380
                                 }
                                 ,
                                 
                                 p
                                 -
                                 value
                                 =
                                 0.066
                                 )
                              
                           . Although this is close to the borderline significance, when we investigate every possible orthogonal contrasts between the interactions, we found some significant differences (after multiplicity correction), and some of them involved selection of genes based on t-statistics and PLS estimates. However, the interaction becomes significant again when we have 20 selected genes in the classification models 
                              
                                 (
                                 F
                                 =
                                 2.93
                                 ,
                                 
                                 df
                                 =
                                 {
                                 12
                                 ,
                                 380
                                 }
                                 ,
                                 
                                 p
                                 -
                                 value
                                 =
                                 6.54
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       4
                                    
                                 
                                 )
                              
                           .

@&#DISCUSSION@&#

A crucial problem in performing supervised classification of gene expressions is to identify a small collection of genes from thousands of them that will discriminate the groups well. One of the main selection approaches is gene filtering where we first obtain their gene-wise statistics. The genes are then ranked based on the statistics and the top genes are selected for inclusion in a classification model. In this study we proposed the partial least squares estimates and (random effects) estimates from logistic regression as a basis for gene selection and compare their performance with selection based on the t-statistics.

PLS estimates take into account only the group mean differences in the gene expressions. On the other extreme, the random effects estimates take into account the group mean differences (taken as correlation between the gene and group labels), gene-wise variance, and correlation between genes. While t-statistics take into account the group mean differences and gene-wise variance. This is summarized in Table3
                     . Since each microarray experiment produces different characteristics of gene expression, respecting the characteristics is an important aspect in choosing the statistics on which the selection will be based.

The results in our investigation reflect the above principle. The CAD dataset has low and similar expressions within each gene that leads to high correlation between genes, and moderate-to-low group mean differences. With these characteristics, we found that gene selection based on the PLS estimates and random effects estimates from logistic regression exhibits lower classification error across the different classification models compared to those based on other statistics. The PLS and logistic-regression random-effects estimates are able to find top discriminating genes based on the group mean differences.

In the lymphoma dataset, high variability of expressions between genes and between samples are present, and gene selection based on the random effects estimates and modified t-statistics show lower classification error. The selection based on PLS estimates ignores these variabilities and results in a higher classification error compared to the selection based on the other statistics. Instead, the selection of genes based on the modified t-statistics is favorable. Unlike the (standard) t-statistics, the modified t-statistics regularise the variability of group mean differences. Hence, the gene selection based on the modified t-statistics looks for a compromise between ignoring (e.g. PLS estimates) and fully respecting (two-sample t-statistics) gene-wise variance.

In both datasets, the selection based on the random effects estimates shows lower classification error. The random effects estimates represent associations between each gene and the group labels, weighted by the regularised correlation between genes. The amount of regularisation depends on the estimate of 
                        
                           λ
                           ≡
                           
                              
                                 1
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     . This is one step further than the moderated t-statistics, which take into account the correlation between genes indirectly. Because of this difference, the selection based on the random effects estimates has an advantage compared to that based on the moderated t-statistics. This advantage is clearly shown in the CAD dataset. Because of the high correlation between genes and low variability within genes, the regularisation of variance alone in the modified t-statistics is not sufficient. In the lymphoma data, where we have high variability between genes, the gene selection based on both statistics show the lowest classification error as shown in Table 2.

Our simulation study indicated that the above considerations somehow become less relevant when the group mean differences are large or the number of sample size is large. On the other extreme, when the number of samples is low, the gene selection based on t-statistics performs poorly. This is because the gene-wise variance can be badly estimated by chance, in which case the list of top genes are contaminated by genes that have low discriminating power. However, the modified t-statistics can improve the performance of selection based on the t-statistics. In this small sample situation, gene selection based on PLS has lower classification error because it ignores the gene-wise variance and produces a collection of genes that better discriminate the two groups. The genes selected based on the random effects estimates have an intermediate performance between those selected based on the PLS estimates and t-statistics.

@&#CONCLUSION@&#

We investigated the use of PLS estimates and logistic regression (random effects) estimates to rank and select the top genes before they are evaluated in a classification model, under a cross-validation procedure. The performance of the genes are compared to those selected based on the two-sample t-statistics and its modified version. The results indicate that when the groups are well separated, in terms of either large group mean differences or high number of samples, the choice of statistics to select the top genes is not crucial. In a common situation with moderate group separation, respecting the group variances or correlation between genes in the gene selection is necessary to obtain top genes that best discriminate the groups. With this principle, selecting the genes based on the modified t-statistics or random effects estimates is recommended. The gene selection based on the latter is also beneficial in the situation where we have highly correlated genes. Lastly, in the most difficult situation where we have a low sample size, the selection of genes based on the PLS estimates is recommended because the statistics ignore the gene-wise variance that can be badly estimated. Moreover, the gene selection based on the random effects estimates and modified t-statistics is still more beneficial than the selection based on the t-statistics.

@&#ACKNOWLEDGMENT@&#

AG and FS would like to thank Charles Taylor for a valuable discussion.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.jbi.2013.05.008.


                     
                        
                           Supplementary material
                           
                        
                     
                  

@&#REFERENCES@&#

