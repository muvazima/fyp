@&#MAIN-TITLE@&#Global optimization of open pit mining complexes with uncertainty

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A stochastic global optimization framework for open pit mining complexes is proposed.


                        
                        
                           
                           The method simultaneously optimizes production schedules and downstream processes.


                        
                        
                           
                           The modeling is flexible and may be applied to numerous types of mining complexes.


                        
                        
                           
                           Three combinations of metaheuristics are tested.


                        
                        
                           
                           Results from an example show a substantial economic benefit when using this approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Open pit mine design

Global optimization

Production scheduling

Metaheuristics

Destination policy

@&#ABSTRACT@&#


               
               
                  Global optimization for mining complexes aims to generate a production schedule for the various mines and processing streams that maximizes the economic value of the enterprise as a whole. Aside from the large scale of the optimization models, one of the major challenges associated with optimizing mining complexes is related to the blending and non-linear geo-metallurgical interactions in the processing streams as materials are transformed from bulk material to refined products. This work proposes a new two-stage stochastic global optimization model for the production scheduling of open pit mining complexes with uncertainty. Three combinations of metaheuristics, including simulated annealing, particle swarm optimization and differential evolution, are tested to assess the performance of the solver. Experimental results for a copper-gold mining complex demonstrate that the optimizer is capable of generating designs that reduce the risk of not meeting production targets, have 6.6% higher expected net present value than the deterministic-equivalent design and 22.6% higher net present value than an industry-standard deterministic mine planning software.
               
            

@&#INTRODUCTION@&#

Global optimization for mining complexes addresses the issue of integrated mining and processing operations with multiple pits or underground mines, multiple metals or minerals, stockpiles, blending options and alternative processing streams to yield distinct products [1,2]. The primary objective of a mining enterprise is to maximize the net present value (NPV) of its cash flows [3,4], which requires optimizing the long-term mine extraction sequences and the use of the materials that have been mined. Extraction sequences define the inventories of raw materials produced from the mines. Downstream optimization defines how to use the mining complex's processing streams to maximize the utility of the available materials, and addresses both the destination policies (where to send material from the mines) and processing stream decisions (where to send stockpiled or processed material). Historically, these components have been optimized independently, leading to sub-optimal solutions for the mining complex as a whole [5]. Many of the existing attempts at global optimization ignore the compounded effect that uncertainty (i.e., geological or economic) has on the value and operational feasibility of the supply chain [6,7]. As the complexity of the supply chain increases, with respect to the number of mines, processing stream options and methods of distribution, it becomes increasingly necessary to integrate all elements simultaneously while considering the uncertainty that arises within the mining complex's various components.

Recent work has focused on integrating geological, or supply, uncertainty into open pit mine production scheduling optimization models. Ramazan and Dimitrakopoulos [8] propose a two-stage stochastic integer programming (SIP) formulation [9] that seeks to maximize the NPV of a production schedule while minimizing the risk of not meeting production targets. By using a risk discounting parameter, the optimizer aims to strike a balance between extracting high-value and low-risk material at the beginning of a mine's life, and deferring riskier material to later periods when more information is available. The basic SIP model has been tested and improved upon [10–14], and results consistently demonstrate that the NPV of the production schedule that considers geological uncertainty can be substantially higher than that of a conventional schedule; this is a direct result of managing the impact of risk to ensure production targets are attained throughout the life of the business.

The previous formulations assume an a-priori decision of what is ore (valuable) and waste material, which is commonly referred to as a cut-off grade policy [15,16]. Some past research has attempted to integrate dynamic destination decisions with long-term deterministic production scheduling by exploiting the structure of the linear optimization model [17–20]. Boland et al. [21] propose a multistage stochastic optimization model that decides the destinations for each scenario; this is overly-optimistic because it assumes perfect knowledge of the material that will be extracted and allocated to the available processing streams. Other research efforts have investigated the use of scenario-independent cut-off grade destination policies [22] and scenario-independent block destinations [23,24]. Each of these methods has a severe limitation. Cut-off grade policies are primarily useful for mining complexes that treat a single metal and do not have material quality constraints in the processing streams. Using scenario-independent block destinations leads to misrepresenting the inherent operational flexibility to change block destinations based on short-term grade control information. This results in material misclassification, where waste is sent for processing. In order to provide a useful destination policy for mining complexes in general, it is necessary to develop new approaches to define destination policies under uncertainty.

One of the underlying challenges for globally optimizing mining complexes is the inherent non-linearity related to the blending and stockpiling of materials [25], as well as the transformations that occur when refining the bulk input material into a set of output products. There have been several attempts to optimize mining complexes [1,2,26–33], however, all models ignore geological uncertainty, and are often limited in the degree of flexibility in modeling the non-linear transformations in the processing streams. Existing optimization approaches avoid non-linear and non-additive geo-metallurgical interactions in the processing streams by preprocessing economic values, recoveries and throughput rates (among other attributes of interest) for each individual block. This assumes that each block is processed independently of others, which is often an unrealistic assumption for mining complexes that require blending and homogenization prior to processing. To provide an alternative assessment of the economic viability of the mining operation, it is necessary to explore new models that shift the focus from the economic value of the blocks that are mined to the economic value of the products that are sold to customers, which ultimately permits integrating non-linear processing transformations directly in the optimization model.

Metaheuristics provide a useful platform for global optimization because of their ability to handle large-scale non-linear optimization models. There has been an increased effort to adapt existing metaheuristics to the open pit mine design and production scheduling problem [14,24,34–41]. These methods have consistently demonstrated the ability to optimize large-scale mine production schedules in a reasonable amount of time, however, most of these works have been limited by defining the destination policy a priori, and only optimize single-tier processing stream configurations (i.e., from the single mine to a final processor, without stockpiles, multiple refinery options, ports or customers).

This work focuses on the global optimization of open pit mining complexes with supply uncertainty, and addresses many limitations of previous work. A new type of destination policy is proposed, which is useful for decision-making under uncertainty and mining complexes with blending constraints on secondary elements. Moreover, a new global optimization model is developed, which can be used to model multi-tier processing stream configurations with non-linear transformations. In the following section, an overview of the modeling approach is given. Subsequently, a novel two-stage SIP formulation is proposed, where the first-stage decisions optimize the extraction sequence and destination policies, and second-stage recourse decisions are used to optimize the various processing streams of the supply chain. Following this, three metaheuristic solvers are discussed, which use a combination of simulated annealing, particle swarm optimization and differential evolution. The solvers are then tested and compared for a copper-gold mining complex. Finally, conclusions and future work are presented.

This section discusses a generalized modeling framework for mining complexes with uncertainty. First, definitions for materials and related attributes in the context of mining complexes with uncertainty are provided. Following this, the decision variables that govern the extraction sequence, destination policies and processing streams are discussed.

In a mining complex, materials are products that are mined or generated through blending or processing. Materials are considered to have unique mineralogy or metallurgical attributes and, as a result, may only be sent to a set of certain locations in a mining complex for further treatment. In order to define the flow of materials from the sources (mines) to the final products (refined metals), it is useful to describe a mining complex as a directed graph. Let the graph 
                           G
                           (
                           N
                           ,
                           A
                           )
                         represent the flow of materials through the mining complex. The set of nodes, 
                           N
                        , is comprised of three disjoint subsets:
                           
                              1
                              
                                 
                                    C
                                 : clusters of materials at the mines that have similar attributes (e.g., metal content). See Section 2.3 for a detailed description.


                                 
                                    S
                                 : destinations that are able to stockpile material over time. The input material is not treated or transformed at these nodes.


                                 
                                    P
                                 : destinations that process (transform) and send all output material to the subsequent nodes, if available.


                        Attributes are used to quantify information of interest in the optimization model, such as metal quantities and costs. Uncertainty in the attributes may be quantified using a set of joint scenarios 
                           
                              
                                 S
                              
                           
                           =
                           {
                           1
                           ,
                           .
                           .
                           .
                           ,
                           S
                           }
                        , where a scenario defines a realization, or sampling, from all sources of uncertainty. Attributes are categorized into two classes:
                           
                              1.
                              Primary attributes (
                                    p
                                    ∈
                                    
                                       
                                          ℙ
                                       
                                    
                                 ): fundamental variables of interest to the entire model (e.g., metal and total tonnages) that are sent from node 
                                    i
                                    ∈
                                    N
                                  to a node 
                                    j
                                    ∈
                                    O
                                    (
                                    i
                                    )
                                 . The quantity of the attribute is denoted by 
                                    
                                       v
                                       
                                          p
                                          ,
                                          i
                                          ,
                                          t
                                          ,
                                          s
                                       
                                    
                                  
                                 
                                    ∀
                                    i
                                    ∈
                                    S
                                    ∪
                                    P
                                    ∪
                                    
                                       
                                          M
                                       
                                    
                                    ,
                                    t
                                    ∈
                                    
                                       
                                          T
                                       
                                    
                                    ,
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                    
                                 . These often originate at the mines (
                                    
                                       M
                                    
                                 ), and may flow through the mining complex to the final products. The amount of attribute recovered after treatment is denoted by r
                                 
                                    p,i,t,s
                                 .

Hereditary attributes (
                                    h
                                    ∈
                                    
                                       
                                          ℍ
                                       
                                    
                                 ): information that is relevant to the optimization model, but is not necessarily passed from node i to j (e.g., feed material chemistry, processing costs, throughput rates, energy consumption and revenues from sales). These attributes may be expressed as (non-) linear functions, 
                                    
                                       f
                                       
                                          h
                                          ,
                                          i
                                       
                                    
                                    (
                                    
                                       v
                                       
                                          p
                                          ,
                                          i
                                          ,
                                          t
                                          ,
                                          s
                                       
                                    
                                    )
                                 , of the primary attributes 
                                    p
                                    ∈
                                    
                                       
                                          ℙ
                                       
                                    
                                 . The quantity of a hereditary attribute is denoted by 
                                    
                                       v
                                       
                                          h
                                          ,
                                          i
                                          ,
                                          t
                                          ,
                                          s
                                       
                                    
                                  
                                 
                                    ∀
                                    i
                                    ∈
                                    S
                                    ∪
                                    P
                                    ∪
                                    
                                       
                                          M
                                       
                                    
                                    ,
                                    t
                                    ∈
                                    
                                       
                                          T
                                       
                                    
                                    ,
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                    
                                 .

Mines are the suppliers of bulk materials to the mining complex, and are represented by the set 
                           
                              M
                           
                        . Each mine 
                           m
                           ∈
                           
                              
                                 M
                              
                           
                         is discretized into volumes of material called blocks, 
                           
                              
                                 
                                    B
                                 
                              
                              m
                           
                        . To quantify the geological uncertainty for both the materials and attributes, it is assumed that each block 
                           b
                           ∈
                           
                              
                                 
                                    B
                                 
                              
                              m
                           
                         has a simulated material classification and simulated attributes, β
                        
                           p,b,s
                         
                        
                           ∀
                           p
                           ∈
                           
                              
                                 ℙ
                              
                           
                           ,
                           s
                           ∈
                           
                              
                                 S
                              
                           
                        . Fig. 1
                         shows a cross-section of two stochastic simulations of a real-world copper-gold deposit used in the case study (Section 4). It is noted that there are large differences in the material classifications and copper grades for the same block between the two simulations.

The extraction sequence is determined by the decision variables x
                        
                           b,t
                        
                        ∈{0, 1}, which define whether (1) or not (0) block 
                           b
                           ∈
                           
                              
                                 
                                    B
                                 
                              
                              m
                           
                         is extracted in period 
                           t
                           ∈
                           
                              
                                 T
                              
                           
                        . In order to safely extract a block 
                           b
                           ∈
                           
                              
                                 
                                    B
                                 
                              
                              m
                           
                        , it is necessary to uncover b by extracting a set of overlying blocks, 
                           
                              
                                 
                                    O
                                 
                              
                              b
                           
                        , in their entirety. The overlying blocks may be identified for each block b in a preprocessing step by creating an inverted cone from the center of b and verifying which blocks lie inside the cone. In more complex cases, there may be multiple geotechnical zones in a deposit, each requiring variable slope angles for the North, East, South and West walls. Fig. 2
                         gives a 2D example of how the overlying blocks are defined with variable slope angles. For a more detailed description of the 3D preprocessing algorithm, the reader is referred to Khalokakaie et al. [42].

In this work, each material from the mines is decomposed into sub-groups based on attributes with similar quantities (e.g., valuable or deleterious metal content). A destination policy outlines where each sub-group of material is sent for all scenarios. A similar concept is introduced by Menabde et al. [22], who separate the univariate distribution of the metal content (grades) into “bins” (i.e., categories based on ranges of metal content), and create a time-varied cut-off grade policy based on the bins (Fig. 3
                        A). Rather than looking at the individual blocks in the mine [21,23,24], the optimizer requires substantially fewer decision variables because it focuses on the distribution of grades. In the more general case proposed herein, the sub-groupings of materials, called clusters, may be created on multivariate distributions, which permit a higher degree of flexibility when defining the policies (Fig. 3B). In both cases, the destination of a single block may change between simulations, depending on the simulated attributes. The general method, however, addresses many of the limitations of cut-off grade destination policies because it is able to consider the impacts of deleterious elements, blending and stockpiling on the performance of the value chain.

In order to define destination policies, it is necessary to classify the simulated blocks into clusters, 
                           C
                           ⊂
                           N
                        . The k-means++ clustering algorithm [43,44] is a useful method for grouping information with similar attributes. The algorithm first creates a predetermined number of cluster centroids for each mine and material based on the simulated attributes. For a given scenario, a block's cluster membership is determined by the closest centroid, measured using a Euclidean distance from the block's simulated attributes to the centroid's multivariate attributes. This cluster membership is subject to change for a block, given that the material classification and attributes may vary between simulations. Let θ
                        
                           b,c,s
                         represent the preprocessed parameter that defines whether (1) or not (0) block 
                           b
                           ∈
                           
                              
                                 
                                    B
                                 
                              
                              m
                           
                         is a member of cluster 
                           c
                           ∈
                           C
                         in scenario 
                           s
                           ∈
                           
                              
                                 S
                              
                           
                        . The destination policies are determined using the variable z
                        
                           c,j,t
                        
                        ∈{0, 1}, which represents the decision of whether (1) or not (0) cluster 
                           c
                           ∈
                           C
                         is sent to destination 
                           j
                           ∈
                           O
                           (
                           c
                           )
                         in period t. It is noted that the set of candidate destinations, 
                           O
                           (
                           c
                           )
                        , is determined by the type of material that the cluster belongs to.

The destination policy variables described in Section 2.3 define where to send material after it is mined. Depending on the configuration of the processing streams for a given mining complex, it may be necessary to model the transfer of materials between two locations. Processing stream decision variables, y
                        
                           i,j,t,s
                        
                        ∈[0, 1], define the proportion of an output material sent from 
                           i
                           ∈
                           S
                           ∪
                           P
                         to destination 
                           j
                           ∈
                           O
                           (
                           i
                           )
                         in period 
                           t
                           ∈
                           
                              
                                 T
                              
                           
                         and scenario 
                           s
                           ∈
                           
                              
                                 S
                              
                           
                        . It is noted that, unlike the extraction sequence and destination policies, these decisions are designed to be adaptive to uncertainty; after the material is received at the initial destination and the uncertainty is revealed, it is assumed that the mining complex can adapt appropriately. Given that the primary attributes of interest are assumed to be linear and additive, the recovered quantity of the primary attribute sent from destination 
                           i
                           ∈
                           S
                           ∪
                           P
                         to 
                           j
                           ∈
                           O
                           (
                           i
                           )
                         is calculated using 
                           
                              y
                              
                                 i
                                 ,
                                 j
                                 ,
                                 t
                                 ,
                                 s
                              
                           
                           ·
                           
                              v
                              
                                 p
                                 ,
                                 i
                                 ,
                                 t
                                 ,
                                 s
                              
                           
                           ·
                           
                              r
                              
                                 p
                                 ,
                                 i
                                 ,
                                 t
                                 ,
                                 s
                              
                           
                        .

Similar to existing deterministic models in long-term production planning, the primary objective is to maximize the NPV [1,3,4,26]. To introduce risk management as a critical objective, the proposed mathematical formulation is based on existing two-stage stochastic integer programming [9] models developed for mine planning [8,10,11,13]. The proposed model discussed herein, however, differs substantially from existing SIP formulations because it is generalized to optimize all aspects of the mining complex holistically. Both the long-term extraction sequence and destination policies are defined as first-stage decision variables, which are designed to be robust to the fluctuations that arise from the uncertainty of geological attributes. Recourse (second-stage) variables are used to adapt to the first-stage decisions, which include the processing stream variables and penalties for excessive risk or inability to meet specified targets.

To determine discounted revenues and expenses, any attribute in the mining complex may be directly included in the objective function with an associated discounted value, p
                        
                           h,i,t
                        
                        =
                        p
                        
                           h,i,1/(1+
                        d)
                           t
                        , where d is a discount rate. Deviation variables, 
                           
                              d
                              
                                 h
                                 ,
                                 i
                                 ,
                                 t
                              
                              +
                           
                         and 
                           
                              d
                              
                                 h
                                 ,
                                 i
                                 ,
                                 t
                              
                              −
                           
                        , are penalized using their related penalty costs, 
                           
                              c
                              
                                 h
                                 ,
                                 i
                                 ,
                                 t
                              
                              +
                           
                         and 
                           
                              c
                              
                                 h
                                 ,
                                 i
                                 ,
                                 t
                              
                              −
                           
                        , respectively. Similar to a discount rate used to calculate the NPV, these penalty costs are be defined to be monotonically decreasing with respect to time, i.e., 
                           
                              c
                              
                                 h
                                 ,
                                 i
                                 ,
                                 t
                              
                              +
                           
                           =
                           
                              c
                              
                                 h
                                 ,
                                 i
                                 ,
                                 1
                              
                              +
                           
                           /
                           
                              
                                 (
                                 1
                                 +
                                 rd
                                 )
                              
                              t
                           
                        . This phenomenon, referred herein as risk discounting, attempts to defer riskier material to later periods in the mine life. The risk discount rate, rd, is a parameter that may be used to describe the modeler's desire to balance the ability to meet production targets in the short- and long-terms. The penalty costs relate to the willingness to pay for a unit of deviation from a capacity constraint, or may be determined experimentally by running the optimization model multiple times to obtain a desirable risk profile for all of the constraints of interest [12]. The general global optimization formulation for open pit mining complexes is defined as follows:

Objective:


                        
                           
                              (1)
                              
                                 
                                    
                                       
                                          max
                                          
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                         |
                                                         
                                                            
                                                               S
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         S
                                                         ∪
                                                         P
                                                         ∪
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            ∈
                                                            
                                                               
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               h
                                                               ∈
                                                               
                                                                  
                                                                     ℍ
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  p
                                                                  
                                                                     h
                                                                     ,
                                                                     i
                                                                     ,
                                                                     t
                                                                  
                                                               
                                                               ·
                                                               
                                                                  v
                                                                  
                                                                     h
                                                                     ,
                                                                     i
                                                                     ,
                                                                     t
                                                                     ,
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︸
                                             
                                             Discounted revenues and costs
                                          
                                       
                                       
                                       
                                    
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                         |
                                                         
                                                            
                                                               S
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         S
                                                         ∪
                                                         P
                                                         ∪
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            t
                                                            ∈
                                                            
                                                               
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               h
                                                               ∈
                                                               
                                                                  
                                                                     ℍ
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                        
                                                                           h
                                                                           ,
                                                                           i
                                                                           ,
                                                                           t
                                                                        
                                                                        +
                                                                     
                                                                     ·
                                                                     
                                                                        d
                                                                        
                                                                           h
                                                                           ,
                                                                           i
                                                                           ,
                                                                           t
                                                                           ,
                                                                           s
                                                                        
                                                                        +
                                                                     
                                                                     +
                                                                     
                                                                        c
                                                                        
                                                                           h
                                                                           ,
                                                                           i
                                                                           ,
                                                                           t
                                                                        
                                                                        −
                                                                     
                                                                     ·
                                                                     
                                                                        d
                                                                        
                                                                           h
                                                                           ,
                                                                           i
                                                                           ,
                                                                           t
                                                                           ,
                                                                           s
                                                                        
                                                                        −
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ︸
                                             
                                             Risk-discounted penalties for deviations
                                          
                                       
                                       
                                       
                                    
                                 
                              
                           
                        
                     

Subject to:
                           
                              I.
                              
                                 Capacity constraints are used to calculate the value of the hereditary attributes and evaluate the surplus or shortage from an upper- (U
                                 
                                    h,i,t
                                 ) or lower-bound (L
                                 
                                    h,i,t
                                 ) at the various locations in the mining complex. Examples of typical constraints may include, but are not limited to, mine production capacity, stockpile capacity, processing hours and grade blending constraints.
                                    
                                       (2)
                                       
                                          
                                             v
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          =
                                          
                                             f
                                             
                                                h
                                                ,
                                                i
                                             
                                          
                                          (
                                          
                                             v
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          )
                                          
                                          ∀
                                          h
                                          ∈
                                          
                                             
                                                ℍ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ∪
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (3)
                                       
                                          
                                             v
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          −
                                          
                                             d
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                             +
                                          
                                          ≤
                                          
                                             U
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                          ∀
                                          h
                                          ∈
                                          
                                             
                                                ℍ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ∪
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (4)
                                       
                                          
                                             v
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          +
                                          
                                             d
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                             −
                                          
                                          ≥
                                          
                                             L
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                             
                                          
                                          
                                          ∀
                                          h
                                          ∈
                                          
                                             
                                                ℍ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ∪
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                              


                                 Reserve and block access constraints ensure a block is extracted at most once, and that the overlying blocks have also been extracted.


                                 
                                    
                                       (5)
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                x
                                                
                                                   b
                                                   ,
                                                   t
                                                
                                             
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          b
                                          ∈
                                          
                                             
                                                
                                                   B
                                                
                                             
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       (6)
                                       
                                          
                                             x
                                             
                                                b
                                                ,
                                                t
                                             
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                
                                                   t
                                                   ′
                                                
                                                =
                                                1
                                             
                                             t
                                          
                                          
                                             
                                                x
                                                
                                                   u
                                                   ,
                                                   
                                                      t
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                          ∀
                                          b
                                          ∈
                                          
                                             
                                                
                                                   B
                                                
                                             
                                             m
                                          
                                          ,
                                          u
                                          ∈
                                          
                                             
                                                
                                                   O
                                                
                                             
                                             b
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              


                                 Destination policy constraints calculate the quantities of the primary attributes for each cluster from the blocks, and ensure that a cluster is sent to only one destination in the mining complex.


                                 
                                    
                                       (7)
                                       
                                          
                                             γ
                                             
                                                p
                                                ,
                                                c
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                b
                                                ∈
                                                
                                                   
                                                      
                                                         B
                                                      
                                                   
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                θ
                                                
                                                   b
                                                   ,
                                                   c
                                                   ,
                                                   s
                                                
                                             
                                             ·
                                             
                                                β
                                                
                                                   p
                                                   ,
                                                   b
                                                   ,
                                                   s
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   b
                                                   ,
                                                   t
                                                
                                             
                                          
                                          
                                          ∀
                                          m
                                          ∈
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          p
                                          ∈
                                          
                                             
                                                ℙ
                                             
                                          
                                          ,
                                          c
                                          ∈
                                          C
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (8)
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                O
                                                (
                                                c
                                                )
                                             
                                          
                                          
                                             
                                                z
                                                
                                                   c
                                                   ,
                                                   j
                                                   ,
                                                   t
                                                
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          c
                                          ∈
                                          C
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              


                                 Mine extraction constraints are used to determine the quantities of the primary attributes that are extracted from each mine (e.g., annual tonnage).


                                 
                                    
                                       (9)
                                       
                                          
                                             v
                                             
                                                p
                                                ,
                                                m
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                b
                                                ∈
                                                
                                                   
                                                      
                                                         B
                                                      
                                                   
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                β
                                                
                                                   p
                                                   ,
                                                   b
                                                   ,
                                                   s
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   b
                                                   ,
                                                   t
                                                
                                             
                                          
                                          
                                          ∀
                                          m
                                          ∈
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          p
                                          ∈
                                          
                                             
                                                ℙ
                                             
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                              


                                 Processing stream flow constraints calculate the quantity of the primary attributes that are retained or received at each location, and ensure mass balancing for materials sent from the stockpiles and processors to subsequent destinations in the mining complex.


                                 
                                    
                                       (10)
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      
                                                         p
                                                         ,
                                                         j
                                                         ,
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                         ,
                                                         s
                                                      
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         (
                                                         I
                                                         (
                                                         j
                                                         )
                                                         \
                                                         C
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         r
                                                         
                                                            p
                                                            ,
                                                            i
                                                            ,
                                                            t
                                                            ,
                                                            s
                                                         
                                                      
                                                      ·
                                                      
                                                         v
                                                         
                                                            p
                                                            ,
                                                            i
                                                            ,
                                                            t
                                                            ,
                                                            s
                                                         
                                                      
                                                      ·
                                                      
                                                         y
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            t
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         c
                                                         ∈
                                                         (
                                                         I
                                                         (
                                                         j
                                                         )
                                                         ∩
                                                         C
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                         
                                                            p
                                                            ,
                                                            c
                                                            ,
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                            ,
                                                            s
                                                         
                                                      
                                                      ·
                                                      
                                                         z
                                                         
                                                            c
                                                            ,
                                                            j
                                                            ,
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      v
                                                      
                                                         p
                                                         ,
                                                         j
                                                         ,
                                                         t
                                                         ,
                                                         s
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  O
                                                                  
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  y
                                                                  
                                                                     j
                                                                     ,
                                                                     k
                                                                     ,
                                                                     t
                                                                     ,
                                                                     s
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ∀
                                                   p
                                                   ∈
                                                   
                                                      
                                                         ℙ
                                                      
                                                   
                                                   ,
                                                   j
                                                   ∈
                                                   S
                                                   ∪
                                                   P
                                                   ,
                                                   t
                                                   ∈
                                                   
                                                      
                                                         T
                                                      
                                                   
                                                   ,
                                                   s
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                
                                                
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (11)
                                       
                                          
                                             r
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          p
                                          ∈
                                          
                                             
                                                ℙ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (12)
                                       
                                          
                                             r
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          =
                                          
                                             f
                                             
                                                h
                                                ,
                                                i
                                             
                                          
                                          (
                                          
                                             v
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          )
                                          
                                          ∀
                                          p
                                          ∈
                                          
                                             
                                                ℙ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          P
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13)
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                O
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                y
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   t
                                                   ,
                                                   s
                                                
                                             
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          i
                                          ∈
                                          S
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                O
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                y
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   t
                                                   ,
                                                   s
                                                
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          i
                                          ∈
                                          P
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                              

End-of-year stockpile quantities are used to calculate the quantities of materials that remain in the stockpile at the end of the production period.
                                    
                                       (15)
                                       
                                          
                                             v
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          =
                                          
                                             v
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         O
                                                         
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            t
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          ∀
                                          i
                                          ∈
                                          S
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                              

Binary constraints for the extraction sequence (x
                                 
                                    b,t
                                 ) enure that blocks are not partially mined in any given period. Binary constraints for the destination policies variables (z
                                 
                                    c,j,t
                                 ) ensure that a cluster c is only sent to a single destination 
                                    j
                                    ∈
                                    O
                                    (
                                    c
                                    )
                                  in period t.
                                    
                                       (16)
                                       
                                          
                                             x
                                             
                                                b
                                                ,
                                                t
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          
                                          ∀
                                          b
                                          ∈
                                          
                                             
                                                
                                                   B
                                                
                                             
                                             m
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (17)
                                       
                                          
                                             z
                                             
                                                c
                                                ,
                                                j
                                                ,
                                                t
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          
                                          ∀
                                          c
                                          ∈
                                          C
                                          ,
                                          j
                                          ∈
                                          O
                                          (
                                          c
                                          )
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              

Other variable definitions
                                    
                                       (18)
                                       
                                          
                                             γ
                                             
                                                p
                                                ,
                                                c
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          ∈
                                          
                                             
                                                ℝ
                                             
                                          
                                          
                                          ∀
                                          p
                                          ∈
                                          
                                             
                                                ℙ
                                             
                                          
                                          ,
                                          c
                                          ∈
                                          C
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (19)
                                       
                                          
                                             y
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          ∈
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                          
                                          ∀
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ,
                                          j
                                          ∈
                                          O
                                          (
                                          i
                                          )
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (20)
                                       
                                          
                                             r
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          ∈
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                          
                                          ∀
                                          p
                                          ∈
                                          
                                             
                                                
                                                   B
                                                
                                             
                                             m
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (21)
                                       
                                          
                                             v
                                             
                                                p
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          ∈
                                          
                                             
                                                ℝ
                                             
                                          
                                          
                                          ∀
                                          p
                                          ∈
                                          
                                             
                                                ℙ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ∪
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (22)
                                       
                                          
                                             v
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                          
                                          ∈
                                          
                                             
                                                ℝ
                                             
                                          
                                          
                                          ∀
                                          h
                                          ∈
                                          
                                             
                                                ℍ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ∪
                                          
                                             
                                                M
                                             
                                          
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (23)
                                       
                                          
                                             d
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                             +
                                          
                                          ,
                                          
                                             d
                                             
                                                h
                                                ,
                                                i
                                                ,
                                                t
                                                ,
                                                s
                                             
                                             −
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          h
                                          ∈
                                          
                                             
                                                ℍ
                                             
                                          
                                          ,
                                          i
                                          ∈
                                          S
                                          ∪
                                          P
                                          ,
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                          
                                          ,
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                              

The generalized global optimization formulation can be challenging to solve using conventional mathematical programming methods, particularly when the models include non-linear functions. Metaheuristics are algorithms that are useful for such cases because they do not require linear formulations or a special structure in the optimization problem. Metaheuristics do not guarantee a mathematically optimal solution, but have provided useful solutions for mining-related problems [14,24,34,36–41,45,46]. These models and solution methods, however, have not been extended to the global optimization of mining complexes.

Simulated annealing [47–49] is selected as a base algorithm for comparison purposes because of previous success using the method for extraction sequencing [24,34,37,38]. While simulated annealing is often used for discrete optimization problems, the algorithm has been adapted to accommodate the continuous processing stream decision variables (y
                        
                           i,j,t,s
                        ) [50,51]. One of the primary concerns with applying a single metaheuristic is the possibility of getting trapped in local optima, particularly in the context of a mining complex with three distinct sets of decision variables that are interrelated. The ability to optimize both discrete and continuous variables is an important feature when selecting metaheuristics for the model at hand. Both particle swarm optimization (PSO) [52,53] and differential evolution (DE) [54,55] are known for their ability to optimize mixed integer non-linear optimization models, without the need for complex encoding and decoding schemes.

PSO has been used for mine extraction sequencing [39] by encoding the extraction sequence as a two-dimensional surface. The decision variables relate to the depth mined at an (x, y) coordinate pair (column) in a given period [36,41]. While this encoding scheme is particularly suitable for population-based metaheuristics, initial tests for the proposed global optimization model using purely PSO or DE indicate that the method is sensitive to the initial sequences and destination policies generated for the population. Additionally, these methods require a substantial computational effort in order to normalize the extraction sequence and enforce the slope constraints (Eq. (6)). These methods, however, remain appealing, particularly for optimizing the destination policies and processing streams (i.e., downstream optimization), given that they simultaneously modify both sets of interrelated decision variables. To assess the performance of the basic simulated annealing (SA) algorithm, two additional variants are tested: simulated annealing with downstream particle swarm optimization (SA-D-PSO), and simulated annealing with downstream differential evolution (SA-D-DE). Algorithm 1 (see Appendix) provides an overview of the global optimization metaheuristic developed. Computational results for a copper-gold mining complex are discussed in Section 4.2.

A solution vector, Φ
                        ={x, z, y}, is used to store all decision variables. The extraction sequence vector (x) stores an encoded version of all x
                        
                           b,t
                         variables, where a discrete-valued element x
                        
                           b
                        
                        ∈
                        x represents the extraction period of block 
                           b
                           ∈
                           
                              
                                 
                                    B
                                 
                              
                              m
                           
                        , and may take on any value in 
                           
                              
                                 T
                              
                           
                           ∪
                           {
                           T
                           +
                           1
                           }
                        , where an extraction period of T
                        +1 indicates that the block is not mined. The destination policy vector (z) stores an encoded version of the z
                        
                           c,j,t
                         variables, where each element z
                        
                           c,t
                        
                        ∈
                        z represents the encoded destination for cluster 
                           c
                           ∈
                           C
                         in period 
                           t
                           ∈
                           
                              
                                 T
                              
                           
                        , and may be in the range 
                           [
                           1
                           ,
                           …
                           ,
                           |
                           O
                           (
                           c
                           )
                           |
                           ]
                        . A decoding scheme is used to convert the value to the appropriate destination for the cluster. Finally, the processing stream vector (y) stores all y
                        
                           i,j,t,s
                         variables, where each element y
                        ∈
                        y maps directly to a y
                        
                           i,j,t,s
                         variable, and may lie in the range [0, 1]. To initialize the algorithm, an initial sequence (x) may be used, or may be initialized with all blocks un-mined; the destination policies and processing stream variables are randomly generated within their bounds.

It is noted that Eqs. (3) and (4) are inherently modeled as soft constraints in the original mathematical formulation; in these cases, deviations from the capacity constraints are penalized in the objective function. While other deterministic models solved with metaheuristics [36,39,41] treat penalties as a tool to eliminate constraint violations, penalties are used as a tool to manage the distribution of risk through time in the stochastic approach [8,10–14]. The slope constraints in Eq. (6) are guaranteed during the perturbation mechanism of the algorithm [37], and the reserve constraints in Eq. (5) are guaranteed through the encoding scheme (x). Similarly, the single-destination constraints in Eq. (8) are inherent in the encoding scheme (z). Finally, the processing stream proportion constraints from Eqs. (13) and (14) are guaranteed by normalizing the values after the optimizer makes any changes. It follows that all other constraints are automatically feasible because they are simply calculations derived from other variables.

The basic algorithm uses a modified SA algorithm (Algorithm 2) to improve the global best solution vector, Φ
                        
                           g
                        . Three classes of perturbations (solution changes) are considered during annealing:
                           
                              1.
                              Extraction sequence perturbations (x
                                 ∈
                                 Φ): a block is randomly selected, and its mining period is changed (possibly to not being mined at all). Blocks that would violate the slope constraints as a result of this change are also considered [37].

Destination policy perturbations (z
                                 ∈
                                 Φ): a cluster destination decision variable is randomly selected and sent to a different destination, if possible.

Processing stream perturbations (y
                                 ∈
                                 Φ): a processing stream variable is randomly selected and the value is modified using a random normal number, N(y
                                 
                                    i,j,t,s
                                 , 0.1). Note that the variance of the normal distribution is sufficiently small to permit both local and global exploration. All processing stream variables are then normalized to respect Eqs. (13) and (14).

The perturbation mechanism is outlined in Algorithm 3. Two parameters, prob
                        
                           seq
                         and prob
                        
                           dest
                        , are used to determine the probability of selecting a sequencing, destination policy perturbation or processing stream perturbation. The probability of accepting a perturbation of the solution vector for a maximization problem is based on the following distribution:


                        
                           
                              (24)
                              
                                 P
                                 (
                                 g
                                 (
                                 
                                    
                                       Φ
                                    
                                 
                                 )
                                 ,
                                 g
                                 (
                                 
                                    
                                       Φ
                                    
                                 
                                 ′
                                 )
                                 ,
                                 δ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                      
                                                    g(Φ ′) ≥ g(Φ)
                                                
                                             
                                             
                                                
                                                   exp
                                                   (
                                                   −
                                                   |
                                                   g
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                   
                                                   ′
                                                   )
                                                   −
                                                   g
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                   
                                                   )
                                                   |
                                                   /
                                                   δ
                                                   )
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where g(Φ) and g(Φ′) are the objective function values before and after the perturbation, respectively, and δ is the annealing temperature. As the algorithm progresses, the temperature is gradually reduced until only minor changes are accepted. This is often controlled by the initial temperature at the start of the algorithm, δ(0), the cooling schedule, which is defined by a reduction factor, k
                        ∈[0, 1), and a number of iterations before the reduction factor is applied, n
                        
                           iter
                        . Fig. 4
                         shows a comparison of the cumulative distributions between the changes in objective function values (g(Φ)−
                        g(Φ′)) for non-improving perturbations for the three neighborhoods. When using a single temperature in the classic SA algorithm, for a very large temperature, the optimizer may limit the number of sub-optimal changes in the destination policy, but will likely accept all extraction sequence and processing stream changes. As the temperature decreases, it becomes more likely that only non-improving processing stream changes are accepted. This behavior is not desirable, given that the neighborhoods are strongly related.

In the proposed modified SA algorithm, the cumulative probability distributions (cdf
                        
                           seq
                        , cdf
                        
                           dest
                         and cdf
                        
                           proc
                        ), shown in Fig. 4, are constructed by proposing random perturbations to the solution. Rather than using a single temperature, δ, for the neighborhoods in Eq. (24), the optimizer uses a single parameter, ρ
                        ∈[0, 1], which represents a probability of accepting a non-improving perturbation. For a fixed ρ, the correct temperature variable δ is retrieved from the appropriate cumulative probability distribution using a look-up function (
                           
                              cdf
                              seq
                              
                                 −
                                 1
                              
                           
                           (
                           ρ
                           )
                        , 
                           
                              cdf
                              dest
                              
                                 −
                                 1
                              
                           
                           (
                           ρ
                           )
                         or 
                           
                              cdf
                              proc
                              
                                 −
                                 1
                              
                           
                           (
                           ρ
                           )
                        ). The cooling schedule (k, n
                        
                           iter
                        ) is then applied to ρ, rather than δ. As the algorithm progresses, the information garnered from any new proposed non-improving perturbations is used as feedback to update the cumulative distributions; this better reflects the current search space, rather than the search space when the SA algorithm commenced.

In the global optimization algorithm (Algorithm 1), once SA is complete, the acceptance probability ρ is reset to its initial value, and the algorithm is re-started from the global best solution Φ
                        
                           g
                        . This diversification strategy is repeated until no improvement is found. In order to assess the performance of the basic SA algorithm, two variations (PSO and DE) are proposed to improve the solution of the downstream variables (z, y
                        ∈
                        Φ
                        
                           g
                        ) prior to diversifying with annealing. An outline of the downstream optimization is provided in Algorithm 4. Both PSO and DE are population-based metaheuristics that employ unique approaches to modify existing solutions. Both approaches require defining the size of the population, NP, as a parameter.

In PSO, a member of the population (particle) is comprised of three equally-sized vectors: its solution vector, Φ
                        
                           q
                        , its best solution vector, 
                           
                              
                                 
                                    Φ
                                 
                              
                              q
                              best
                           
                        , and its velocity vector, v
                        
                           q
                        . Initially, the vectors Φ
                        
                           q
                         and v
                        
                           q
                         are randomly generated. To maintain a high-quality solution in the swarm and reduce the chance of premature convergence, the last particle's best vector, 
                           
                              
                                 
                                    Φ
                                 
                              
                              NP
                              best
                           
                        , is initialized to the global best solution previously found from annealing (Φ
                        
                           g
                        ). Algorithm 5 provides an outline of how the particle's vectors are updated. The key parameters that need to be calibrated for PSO are c
                        1, c
                        2 and c
                        3, which represent the weights for the particle's inertia, its best solution and the local-best solution, respectively. It is noted that in this algorithm, a local-best ring topology [56] using the nearest NP
                        
                           local
                         particles on either side of particle q is used. The local-best solution, 
                           
                              
                                 
                                    Φ
                                 
                              
                              lbest
                              best
                           
                        , represents the best solution of the particles with adjacent indices, i.e., 
                           
                              
                                 q
                                 −
                                 
                                    
                                       NP
                                       local
                                    
                                 
                                 ,
                                 …
                                 ,
                                 q
                                 +
                                 
                                    
                                       NP
                                       local
                                    
                                 
                              
                           
                        , and is determined experimentally to delay swarm convergence.

The DE algorithm operates similar to the PSO algorithm. The population is represented by a set of agents. Algorithm 6 provides an outline of how an agent's solution vector is modified. In order to update an agent q, three other agents (a, b and c) are randomly selected from the population. An agent's best solution vector, 
                           
                              
                                 
                                    Φ
                                 
                              
                              q
                              best
                           
                        , is modified by randomly selecting variables to be crossed over with agent a and a weighted difference between agents b and c. While there are several types of variations that may be used to modify the solution [57,58], it has been determined experimentally that a simple modification structure provides adequate results. This algorithm requires calibrating two parameters: CR, a cross-over ratio that defines a probability for modifying a decision variable, and F, a parameter that defines the weight applied to a difference between the two solution vectors, b and c. Unlike PSO, DE only modifies a proportion of the decision variables for each agent in each iteration; it has been found through testing that this helps to prevent the population from converging prematurely.

The proposed integrated mine planning optimization framework is demonstrated on a real-world copper-gold mining complex.

In the given case study, a single mine supplies materials to a mining complex that produces gold and copper. Fig. 5
                         summarizes the definition of the mine's materials and the processing options. The mine contains three main material groups: sulfides, transition and oxides. In order to respect the chemistry requirements at the sulfide heap leach (processor), the sulfide and transition material groups are both separated into two different material types based on being above or below 0.2% copper. The oxide materials are classified as ore or waste based on chemistry. The deposit's uncertainty is represented by a set of 25 equally probable geological simulations with variable copper, gold, tonnages and material types.

With the exception of the oxide waste dump, all destinations (processors) have variable grade-recovery curves that are based on the average grade of the incoming material at a process in a given period (Fig. 6
                        ). The non-linear grade-recovery relationships have interesting implications when considering the transition materials: for a given block or cluster that has (hypothetically) similar economic values for two processing options, the selected destination is the one that profits the most from an increase in recovery. As a result, one cannot assume that the destinations can be specified a-priori in a greedy manner because it is the recovery of the aggregated material sent to a given processor that determines the potential value. For this reason, the model never considers the economic value of a block; the economic values are evaluated using only the recovered copper and gold at the processors (mill and leach pads).

The objective for the optimizer is to maximize the NPV of the mining complex, which considers the sale of copper and gold from each of the destinations, along with the processing and mining costs. All cost-related parameters in Table 1
                         are expressed relative to the mining cost for confidentiality purposes. Table 2
                         summarizes the constraints and penalty costs used for the deterministic and stochastic optimization models. A risk discount rate [8] of 10% is used to penalize the deviations from the production capacities, and ensures that riskier material is deferred to later periods when more geological information is available. The mine model contains 34,057 blocks that may be scheduled over 22 years, and a slope angle of 45° is used [42].

A deterministic orebody model is created by averaging the grades in the given simulations and re-classifying the material types in the same manner that the simulations are classified. This model is herein referred to as the “E-type orebody model” [59]. A base-case design is first obtained using the E-type orebody model and an industry-standard commercial mine planning software package. The results from optimizing the deterministic model with the proposed optimizer will be referred to as the “deterministic-equivalent” design. For the deterministic-equivalent model, each material is clustered into 15 groups, with the exception of the oxide waste material, which only considers one. As a result, there are 1672 encoded destination policy variables (z), along with 34,057 encoded block extraction decisions (x) and 22 stockpile processing stream variables (y).


                        Table 3
                         summarizes the parameters used for the simulated annealing, particle swarm optimization and differential evolution algorithms. It is noted that in the first iteration of SA (i
                        
                           gopt
                        
                        =0, Algorithm 1), a different set of parameters is used to compensate for the large number of new blocks that are introduced into the extraction sequence. Table 4
                         shows a comparison of the SA, SA-D-PSO and SA-D-DE algorithms, where 10 trials are performed for each method. All trials are run on Amazon's EC2 c4.8xlarge virtual machines with 36 virtual CPUs (Intel Xeon E5-2666 v3) and 60 GB RAM. Each trial is initialized without the use of an initial extraction sequence (i.e., all x
                        
                           b,t
                        
                        =0), and the downstream solution vectors (z and y) have been randomly generated. It is apparent that the SA-D-PSO and SA-D-DE algorithms consistently outperform the algorithm that only uses simulated annealing, with an average increase in net present value (NPV) of 1.91% and 2.57%, respectively. It is noted that the final solutions do not contain capacity constraint violations, thus the NPV is analogous to the objective function value. These slight improvements, however, come with a drastically longer computing time. On average, it takes over 2.4 and 2.9 times longer to run the SA-D-PSO and SA-D-DE algorithms, respectively, than the basic SA algorithm. The basic SA algorithm converges after an average of 14.7 diversifications. When SA is combined with another metaheuristic to optimize the downstream variables, the number of diversification iterations increases. Despite the SA-D-DE algorithm having a smaller initial population than SA-D-PSO (16 agents versus 30 particles), the average run time is higher due to the fact that more diversifications are performed, and the SA algorithm requires more iterations to catch up and improve upon the global best solution after optimizing with DE.


                        Fig. 7
                         (left) shows a comparison for the sulfide mill, the sulfide heap leach and the cumulative discounted cash flows for the commercial and deterministic-equivalent extraction sequences. It is noted that the deterministic-equivalent solution generates a 13.8% higher NPV than the solution generated by the commercial mine planning tool, and the life of the mine is extended by a year. This drastic increase is largely a result of the global optimization approach, whereby the production schedule, destination policy and stockpiles are optimized simultaneously, rather than the commercial approach, which relies on an iterative approximation (ultimate pit limit and phase design definition prior to scheduling) and heuristics in order to provide a production schedule.

A risk analysis is performed by taking the schedule and destination policies generated from the deterministic optimizer and testing how the 25 geological simulations perform. It is noted that the extraction sequence and destination policies remain fixed, however, the stockpile variables (y) are optimized for each scenario using the DE algorithm. Fig. 7 (left) also provides the risk profiles, which are defined by the exceedance probabilities for 10%, 50% and 90% (P90, P50, P10, respectively) of the simulations’ responses to the deterministic-equivalent design. The simulations indicate that the deterministic design performs noticeably worse than the E-type orebody model indicates, which is attributed to the differences in the univariate grade distributions between the estimated model and the simulations. The spikes in sulfide mill tonnage above the capacity are in the order of 5–10%, and are related to the fact that the simulations contain excessive quantities of high-grade material in the production schedule; these tonnage spikes are unrealistic and inflate the NPV of the risk analysis. Moreover, the risk analysis indicates that the deterministic design is consistently unable to meet the production targets at the sulfide heap leach. Interestingly, the NPV of the risk analysis is unaffected by its inability to fill the sulfide heap leach to capacity. This is a result of sending excessive and higher valued materials to the sulfide mill, which leads to an increased recovery and profits from the sulfide mill, despite the underutilization of the sulfide heap leach.

The stochastic optimizer aims to optimize the extraction sequence, destination policies and the use of the stockpile while considering the geological uncertainty. Table 2 outlines the penalty costs and constraint bounds that are used to guide the risk profiles. A total of 10 trials are run for the stochastic example using the SA-D-DE optimizer. The average computing time for the stochastic optimizer is 75.6h, with a standard deviation of 8.6h. When comparing the objective function value of the best stochastic design to the simulations through the best deterministic design (calculated using the same penalty costs and constraint bounds), the best stochastic design has a 16.6% higher value, with an average of 15% across all 10 trials. This is a direct result of being able to manage the impact of risk on the sulfide mill and sulfide heap leach tonnages over time.

To elucidate these results, Fig. 7 (right) shows the risk profiles of the stochastic solution for the sulfide mill tonnages, sulfide heap leach tonnages and the cumulative discounted cash flows. It is apparent that the stochastic design is capable of meeting the target capacity of 3Mtpa at the sulfide mill on average, with substantially less risk than the deterministic design (Fig. 7, left). The stochastic design also meets the target sulfide heap leach tonnage over the first 12 periods, after which, the quantities begin to decline. This implies that the riskier sulfide heap leach material is being deferred until the end of the mine life, which is a result of incorporating risk discounting in the stochastic optimization model. Finally, it is noted that the NPV of the stochastic design is 6.6% higher than the deterministic-equivalent design, when comparing the P-50 values, and 22.6% higher than the commercial (deterministic) mine planning software.

@&#CONCLUSIONS@&#

This work presents a framework for global asset optimization of mining complexes under uncertainty, whereby the solutions provide robust long-term open-pit mine extraction sequences and destination policies. The proposed framework permits a high degree of flexibility and detail in modeling a mining complex, including the opportunity to integrate non-linear relationships that are generally ignored in existing models because of the challenges associated with non-linear optimization. As a result, the proposed method overcomes a major limitation of existing global optimization models: modeling the economic value of the products sold, rather than the value of the blocks mined. A new form of destination policies is also developed that overcomes the severe limitations of other methods, such as quality constraints on secondary elements in the processing streams. Three solvers, based on a combination of simulated annealing, particle swarm optimization and differential evolution, are developed and compared.

The method is tested on a copper-gold mining complex. When optimizing the deterministic example, the global optimizer achieves a design with 13.8% higher net present value than an industry-standard mine planning tool. While optimizing with both simulated annealing and differential evolution demonstrated improved results, this comes at the expense of a substantially longer computing time. For the stochastic optimization, results indicate that the stochastic design is able to satisfy the target tonnage capacities, thus ensuring that the mine is able treat profitable material over the life of mine. Additionally, the stochastic solution indicates a 6.6% higher net present value when compared to the deterministic-equivalent design and 22.6% higher value than the industry-standard software. Given that the proposed method seeks to generate a single set of destination policies, future research will investigate the use of multistage stochastic optimization in order to permit adaptive policies under both supply (geological) and demand (metal price) uncertainty, which will likely lead to higher economic value.

@&#ACKNOWLEDGEMENTS@&#

The work in this paper was funded by NSERC CRD 411270, NSERC Discovery Grant 239019, and the industry members of the COSMO Stochastic Mine Planning Laboratory: AngloGold Ashanti, Barrick Gold, BHP Billiton, De Beers, Newmont Mining, and Vale.


                     
                        Algorithm 1
                        Algorithm for the global optimization of mining complexes. 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Algorithm 2
                        Simulated annealing for open pit mining complexes. 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Algorithm 3
                        Perturb the current solution and the retrieve the appropriate annealing temperature with respect to the selected perturbation neighborhood. 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Algorithm 4
                        Downstream optimization using particle swarm optimization or differential evolution. 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Algorithm 5
                        Particle swarm optimization update for particle q. 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Algorithm 6
                        Differential evolution (“DE/rand/1/bin”) for agent q. 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

@&#REFERENCES@&#

