@&#MAIN-TITLE@&#Quantitative breast lesion classification based on multichannel distributions in shear-wave imaging

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A computer-aided diagnosis (CAD) system based on the quantified color distributions in shear wave elastography (SWE) was developed.


                        
                        
                           
                           The combination of the proposed CAD system using SWE features and BI-RADS assessment would provide a promising diagnostic suggestion.


                        
                        
                           
                           Spatial correlation was combined with the kPa-weighted color information as a feature to reduce the influence of noises far from tumor.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Breast cancer

Shear-wave elastography

Computer-aided diagnosis

Histogram moment

Vector quantification

@&#ABSTRACT@&#


               
               
                  Background and objectives
                  A computer-aided diagnosis (CAD) system based on the quantified color distributions in shear-wave elastography (SWE) was developed to evaluate the malignancies of breast tumors.
               
               
                  Methods
                  For 57 benign and 31 malignant tumors, 18 SWE features were extracted from regions of interest (ROI), including the tumor and peritumoral areas. In the ROI, a histogram in each color channel was described using moments such as the mean, variance, skewness, and kurtosis. Moreover, three color channels were combined as a vector to evaluate tissue elasticity. The SWE features were then combined in a logistic regression classifier for breast tumor classification.
               
               
                  Results
                  The performance of the CAD system achieved an accuracy of 81%. Combining the CAD system with a BI-RADS assessment obtained an Az improvement from 0.77 to 0.89 (p-value <0.05).
               
               
                  Conclusions
                  The combination of the proposed CAD system based on SWE features and the BI-RADS assessment would provide a promising diagnostic suggestion.
               
            

@&#INTRODUCTION@&#

Breast lesion characteristics identified with B-mode ultrasound (US) are interpreted to distinguish between benign and malignant lesions in a clinical examination [1]. The description criteria and categories are defined in the Breast Imaging Reporting and Data System (BI-RADS) lexicon, which was developed by the American College of Radiology [2]. These descriptors, which are quantified in various computer-aided diagnosis (CAD) systems [3–10] to evaluate tumor malignancy, can be classified as morphology and texture characteristics. Recently, elasticity assessment was added as an associated feature of breast US in the fifth edition of BI-RADS [2]. Breast cancers such as scirrhous carcinoma and invasive cancers tend to be stiffer than many benign tumors [11,12]. On clinical examination, elastography as an imaging modality provides additional elasticity information by a cine loop or a single image [13,14]. Tissue elasticity information can be estimated based on the tissue displacements under a manual or automatic force [15]. According to the elasticity modulus, tissue elasticity is mapped to pixel values in the color elastographic images for display.

Shear-wave elastography (SWE) is an emerging technique that automatically emits the radiation force to estimate elasticity with less operator dependence than conventional elastography, which is based on manual compression [15]. Additionally, an observer can evaluate tissue stiffness via only one SWE image rather than a complete image cine loop as in conventional elastography. The SWE image provides tissue elasticity as the velocity of shear waves propagating in tissue and displays the corresponding kilopascals (kPas) on a color map. Using the elasticity information in the map, radiologists can re-evaluate the malignancies of tumors to reduce unnecessary biopsies [16–18]. However, the qualitative assessment of SWE images through visual observation is user dependent. To provide an objective evaluation, a quantitative analysis for interpreting elastography images would be helpful. Additionally, manually calculating the kPa value of each pixel is time consuming because the number of pixels in a region of interest (ROI) is usually greater than ten thousand (ex: 100×100). In this study, an automated method was proposed to analyze the color patterns in SWE images using individual colors or a combination of color channels. The quantified elasticity information was then used in a CAD system for breast tumor classification. Finally, the performance of a combined CAD system and BI-RADS assessment was evaluated. Using the quantified elasticity features, tumor malignancy could be better evaluated in a more efficient way for clinical use.

Our institution review board approved this study, and informed consent was obtained from all patients. From November 2012 to December 2013, 81 patients had undergone elastography examinations. Three of them had two tumors, and two had three tumors. By core needle biopsy or fine-needle aspiration cytology, the 88 biopsy-proven cases were classified into 57 benign and 31 malignant tumors. Patients with benign tumors ranged in age from 26 to 77 years (mean=50±11). The pathology types were 25 fibrocystic changes, 22 fibroadenomas, and 10 papillomas. The measured sizes were 1.42±1.20cm. For malignant tumors, patients ranged in age from 30 to 76 years (mean=54±13). They exhibited 27 invasive ductal carcinomas (IDC), 1 invasive lobular carcinoma (ILC), and 3 ductal carcinoma in situ (DCIS), with measured sizes of 1.51±0.76cm. Radiologists who were blinded to the pathology report classified the tumors into BI-RADS assessment categories by B-mode findings. There were 2 (2%) tumors in BI-RADS 2 (benign), 17 (19%) in BI-RADS 3 (probably benign), 52 (59%) in BI-RADS 4 (suspicious abnormality), and 17 (19%) in BI-RADS 5 (highly suggestive of malignancy).

Both B-mode and elastography images were acquired using the Aixplorer ultrasound system (SuperSonic Image, Les Jardins de la Duranne, Aix en Provence, France) with a 5–14MHz linear broadband transducer (SL15-4). During acquisition, the B-mode image was displayed first to show the anatomical information surrounding the target tumor. A ROI was centered on the target tumor and included tissues around the peritumoral areas to generate an SWE image. The elasticity information is described using Young's modulus, defined as E
                        =
                        σ/ɛ where ɛ is the deformation of the tissue under the applied compression σ. For all cases, the default maximum kPa was 180 (7.7m/s) in the color display, which is mapped from the value of the elasticity modulus.

The acquired SWE images were color maps that conveyed elasticity information about the tissues. In this study, we proposed extracting a series of quantitative SWE features from the color maps to evaluate tumor elasticity automatically. SWE features included histogram distributions in individual and multiple color channels of the color map. Spatial correlation was also considered to generate more accurate elasticity features.


                           Fig. 1(a) and (b) show shear-wave elastographic images for benign and malignant breast tumors. The elasticities of various tissues are shown in different colors. Tissues inside or around the benign tumor in Fig. 1(a) are soft and are shown in colors in the blue range. By separating the colors in the image into red (R), green (G), and blue (B) channels, the value distributions of different channels are distinct. As shown in the histograms in Fig. 1(a), the R and G histograms are left-biased, and the B histogram is center-weighted. In contrast, tissues around the malignant tumor in Fig. 1(b) are shown in various colors, with more well-distributed histograms in the R, G, and B channels. Consequently, we can compare the differences between histograms to reveal the color composition, which is the key characteristic to distinguish between benign and malignant tumors in elastography.

By regarding the color distribution in an SWE image as a probability distribution, the color image histogram can be characterized by its moments [19]. Moments [20,21] are specific quantitative measures of the shape. In the experiment, the 24-bit depth color was decomposed into 8-bit R, G, and B channels. The first-, second-, third-, and fourth-order central moments of the histograms in each channel were calculated to indicate the histogram shape (i.e., mean, variance, skewness, and kurtosis).
                              
                                 (1)
                                 
                                    
                                       
                                          Mean
                                          c
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             P
                                             
                                                c
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       
                                          Variance
                                          c
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   P
                                                   
                                                      c
                                                      i
                                                   
                                                
                                                −
                                                
                                                   Mean
                                                   c
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3)
                                 
                                    
                                       
                                          Skewness
                                          c
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   P
                                                   
                                                      c
                                                      i
                                                   
                                                
                                                −
                                                
                                                   Mean
                                                   c
                                                
                                                )
                                             
                                             3
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       
                                          Kurtosis
                                          c
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   P
                                                   
                                                      c
                                                      i
                                                   
                                                
                                                −
                                                
                                                   Mean
                                                   c
                                                
                                                )
                                             
                                             4
                                          
                                       
                                    
                                 
                              
                           where c is the color channel of R, G or B. P
                           
                              i
                            is the pixel value. Mean is the center location of a distribution calculated by adding up all pixel values and dividing the sum by the number of pixels. Variance is a measure of spread about the mean. Skewness indicates whether the histogram is a symmetric distribution or skewed to one side (left or right side). Kurtosis is a single-peaked histogram with heavy weight in the tails relative to the normal distribution.

A total of 12 single-channel features, including four moments of each of three channels, were calculated: Rmean, Gmean, Bmean, Rvar, Gvar, Bvar, Rskew, Gskew, Bskew, Rkur, Gkur, and Bkur.

The elasticity levels are shown in different colors in an SWE image. From soft to hard, the colors are continuously encoded from blue to red. The middle color transitions include blue to green, green to yellow, and yellow to red. To emphasize the existence of hard tissues, such as those indicated by yellow and red, vector quantization [22,23] was used to reduce the continuous color levels into these four relevant colors for elasticity presentation. The R, G, and B channels of a pixel were joined as a color vector. Based on the vector distances between a color and the four main colors, the image pixels were classified into four clusters. Euclidean distance was used as the similarity metric in the quantization using the following formula:
                              
                                 (5)
                                 
                                    
                                       E
                                       
                                          D
                                          
                                             P
                                             M
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      R
                                                   
                                                   −
                                                   
                                                      M
                                                      
                                                         i
                                                         R
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      G
                                                   
                                                   −
                                                   
                                                      M
                                                      
                                                         i
                                                         G
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      B
                                                   
                                                   −
                                                   
                                                      M
                                                      
                                                         i
                                                         B
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where ED
                           
                              PMi
                            is the vector difference between a pixel color P and one of the main colors M
                           
                              i
                           
                           ={blue, green, yellow, red} in the R, G, and B channels. Each pixel is reassigned a new color according to the nearest color. Fig. 2
                            shows the quantized color maps of Fig. 1. The numbers of the four-color clusters were divided by the total number of pixels to estimate their ratios in an image: Bdensity, Gdensity, Ydensity, and Rdensity. A weighted ColorAvg was also calculated by taking the original kPa value into consideration. The definition is:
                              
                                 (6)
                                 
                                    
                                       C
                                       o
                                       l
                                       o
                                       r
                                       A
                                       v
                                       g
                                       =
                                       
                                          
                                             
                                                B
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             ×
                                             36
                                             +
                                             
                                                G
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             ×
                                             72
                                             +
                                             
                                                Y
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             ×
                                             108
                                             +
                                             
                                                R
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             ×
                                             144
                                          
                                          
                                             
                                                B
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             +
                                             
                                                G
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             +
                                             
                                                Y
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                             +
                                             
                                                R
                                                
                                                   N
                                                   u
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where Num is the number of each color after vector quantization.

In addition to the color information, spatial correlation was observed to have an influence on elasticity estimation. In some cases, the areas close to the skin were displayed in stiffness colors relative to the peritumoral areas, as shown in Fig. 3(a). This phenomenon can be regarded as noise because the areas were far from the target tumor. Spatial correlation was thus combined with the kPa-weighted color information to correct for the possible influence automatically. As shown in Fig. 3(b), the spatial weights from the ROI middle to the border are defined as an intensity decreasing function. This feature is defined as following:
                              
                                 (7)
                                 
                                    
                                       S
                                       p
                                       a
                                       t
                                       i
                                       a
                                       l
                                       A
                                       v
                                       g
                                       =
                                       
                                          
                                             
                                                ∑
                                                P
                                             
                                             
                                                
                                                   P
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                (
                                                k
                                                P
                                                a
                                                )
                                                ×
                                                (
                                                (
                                                H
                                                M
                                                i
                                                d
                                                +
                                                W
                                                M
                                                i
                                                d
                                                )
                                                −
                                                (
                                                |
                                                |
                                                
                                                   P
                                                   i
                                                
                                                −
                                                W
                                                M
                                                i
                                                d
                                                |
                                                |
                                                +
                                                |
                                                |
                                                
                                                   P
                                                   j
                                                
                                                −
                                                H
                                                M
                                                i
                                                d
                                                |
                                                |
                                                )
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                P
                                             
                                             
                                                (
                                                (
                                                H
                                                M
                                                i
                                                d
                                                +
                                                W
                                                M
                                                i
                                                d
                                                )
                                                −
                                                (
                                                |
                                                |
                                                
                                                   P
                                                   i
                                                
                                                −
                                                W
                                                M
                                                i
                                                d
                                                |
                                                |
                                                +
                                                |
                                                |
                                                
                                                   P
                                                   j
                                                
                                                −
                                                H
                                                M
                                                i
                                                d
                                                |
                                                |
                                                )
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where P
                           
                              ij
                           (kPa) is the kPa value of a pixel with i and j as the coordinates; HMid and WMid are the half values of the ROI height and width, respectively; P
                           
                              i
                            is the coordinate value of a pixel in horizontal; and P
                           
                              j
                            is the coordinate value of a pixel in vertical.

@&#PERFORMANCE EVALUATION@&#

The proposed SWE features were evaluated to determine whether they were statistically significant in distinguishing between benign and malignant tumors. The Kolmogorov–Smirnov test [24] was first used to determine if the value distribution of a feature was normal. Normal-distributed features were tested by Student's t-test [24], and non-normal features were tested by the Mann–Whitney U test [24]. A p-value of less than 0.05 indicates statistical significance.

Tumor classification was based on the combination of the SWE features. Based on the biopsy-proven pathology, relevant subsets of features were selected in a binary logistic regression model [25]. During backward elimination, features with the lowest error rate were picked in the trained classifier. For the generalization ability, the leave-one-out cross-validation method [26] was used for evaluation. Each time, one case was left out of all N cases and used to test the trained result with the remaining N
                        −
                        1 cases.

Using the logistic regression formula with the selected features, the probability of the malignancy being a cancer was generated. Different probability thresholds may result in different combinations of sensitivity and specificity. Az, the area under the receiver operating characteristic (ROC) curve, was used to show the overall trade-offs between sensitivity and specificity. Performance differences were compared by chi-square test in SPSS software (version 16 for Windows; SPSS, Chicago, IL, USA).

In addition to classifying all cases directly, the possible combination of the CAD system and BI-RADS assessment was also explored in the experiment. Because the elasticity information is only one of many tumor characteristics, elastography features should be combined with B-mode features to obtain more reliable diagnostic results from clinical examinations. The commonly used BI-RADS assessment categories are BI-RADS 3 (probably benign, ≦2%), BI-RADS 4 (suspicious abnormality, <95%), and BI-RADS 5 (highly suggestive of malignancy). In other words, the malignancies of tumors in the BI-RADS categories under 5 may need further evaluation with more findings. Therefore, the proposed CAD system was combined with the BI-RADS assessment in the experiment to show the complementary advantages.

@&#RESULTS@&#

The differential ability of each SWE feature to distinguish between benign and malignant lesions was tested and is shown in Table 1
                     . p-value <0.05 is the threshold to determine whether the result is statistically significant. These features were combined in a binary logistic regression model for diagnosis. A tumor with a predicted probability >0.5 was regarded as malignant in the results. The diagnostic performance in different BI-RADS assessment categories was evaluated, as shown in Table 2
                     . In the classification, the CAD system performed poorly in classifying BI-RADS 5 cases but achieved accuracies of 100%, 94%, and 83% for BI-RADS 2, 3, and 4 cases, respectively. Because the BI-RADS 5 cases were highly suggested to be malignant, the CAD system was combined with the BI-RADS assessment by classifying the BI-RADS 5 cases as malignancies. As shown in Table 3
                     , the performance of the CAD system improved, with accuracy rising from 81% to 88% (Az=0.77 vs. 0.89, p-value <0.05). The Az difference can be observed in Fig. 4
                     .

@&#DISCUSSION@&#

The American College of Radiology suggests elasticity assessment as a tool to evaluate breast tumor malignancy in the fifth edition of BI-RADS, released in 2013 [2]. The suggestion indicates that elastography provides additional diagnostic information over conventional B-mode imaging. On clinical examination, a newly developed SWE emits the radiation force to obtain more reproducible results than conventional manual compression. Based on SWE, we extracted various quantitative features in this study to provide a more objective and efficient elasticity evaluation. Twelve features were tested for statistical significance in distinguishing between benign and malignant breast lesions (Table 1). In particular, SpatialAvg, which combined spatial and color information, was better than using color information alone (ColorAvg). The use of SpatialAvg would be helpful in reducing the effect of artifacts in the ROI border. Fig. 1 is a simple example showing that extracting features from the R, G, and B channels to distinguish between benign and malignant tumors is practical. In the experiment, using the mean and standard deviation of the pixel values from the R, G, and B channels resulted in an accuracy of 68%, which is lower than the performance achieved by the 18 SWE features (81%). Therefore, it is necessary to use all 18 proposed SWE features.

In addition to the original RGB color space, HSV was also applied in the experiment to provide performance comparisons with different color spaces [27]. The Az achieved by HSV was 0.70, which was lower than the 0.77 achieved by RGB. Combining both color spaces simultaneously resulted in no better performance (Az=0.77). The corresponding ROC curves are illustrated in Fig. 5
                     . HSV is useful in distinguishing between different colors in natural images. However, in the color elastographic images, pixels having similar saturation and brightness values are only different in hue. Therefore, the analysis of RGB may already provide sufficient information. Additionally, using the original RGB values without further color space transformation is efficient.

The performance of the CAD system based on the proposed SWE features achieved an accuracy of 81% with a sensitivity of 61% and a specificity of 91%. The high specificity shows that the elasticity information may be helpful in avoiding unnecessary biopsies. To evaluate the clinical use of the CAD system, the performances of the CAD system on different BI-RADS assessment categories are listed in Table 2. Although tissue elasticity is useful in diagnosis, it is only one of numerous characteristics of malignant tumors. BI-RADS 5 tumors have B-mode findings such as taller-than-wide, irregular shape, spiculation, and hypoechogenicity [1], which could not definitely indicate hard tissues in the tumor area. Therefore, the assessments from elastography and B-mode imaging may not be consistent in the same cases. However, BI-RADS 5 cases are regarded as highly suggestive of malignancy. It is reasonable to keep the B-mode results for BI-RADS 5 cases and combine the classification results of other cases from the CAD system (Table 3). The combined sensitivity improved from 61% to 81%, and the combined Az improved from 0.77 to 0.89 (p-value=0.0048). The results are consistent with the studies [16,17,28,29] conducted by human observation showing that tumor elasticity provides additional diagnostic information over B-mode imaging.

The only manual step to generate the proposed SWE features is defining an ROI, which is also a necessary step to generate the elasticity color map in the Aixplorer ultrasound system. Previous CAD systems using SWE features [30] achieved Az=0.97, which is higher than Az=0.77 in this study. The combinations of BI-RADS assessments achieved Az=0.973 and Az=0.89, respectively. The performance difference may depend on the types of lesions in individual databases. For the image database used in this study, the result suggested to use SWE features for BI-RADS cases with uncertain malignancy to improve the Az from 0.77 to 0.89 (p-value <0.05). The advantages of the proposed method are convenience and efficiency. Users may want to use the proposed method if they do not have sophisticated skills for determining whether the segmented contour is good or bad. This method also provides another tool for users who are unsatisfied with the segmentation results in previous studies [30] because they already have their preferences for contour description. Using user-defined ROI to specify tumor area is a necessary step to generate an SWE image. Consequently, we believe that the proposed method based on ROIs is appropriate for all types of users and has the least operator dependence.

A limitation of this study is how to appropriately select the tumor ROI. To the best of our knowledge, there is no published paper indicating the best way to define the ROI. Prior studies only suggested including peritumoral areas in addition to the tumor itself [31] or using an adaptive ROI size for different tumors [18]. In this experiment, we compared the performances of SWE features extracted from the whole ROI (81%) and the ROI center (72%), which was one-fourth the size of the whole ROI. The results showed that defining the ROI by extending the half size of the tumor from the tumor boundary provides more diagnostic information than using only the tumor itself, which may not provide sufficiently robust results. In future experiments exploring this issue, we will perform tumor segmentation to delineate the tumor contour and explore the effects of different sizes of ROIs derived from the tumor contour for a more complete evaluation.

A possible improvement of the CAD system could be quality inspection. As mentioned previously, artifacts may be induced by overcompression on the probe. An artifact is shown as stiffness color in the skin area, i.e., the boundary of a ROI. CAD can detect an artifact automatically and trigger a quality alarm or ignore the inaccurate information. Another future study will integrate the quantitative features in B-mode imaging into the CAD system. A totally automated diagnostic procedure, including the information from SWE and B-mode images, would be an efficient tool in clinical use.

@&#CONCLUSIONS@&#

A CAD system based on the quantitative SWE features was developed in this study to distinguish malignant from benign breast tumors. Combining the CAD system with a BI-RADS assessment achieved an improved Az=0.89 (p-value <0.05) which would provide promising diagnostics in clinical use.

The authors declare that they have no financial and personal relationships with other people or organizations that could inappropriately influence their work.

@&#ACKNOWLEDGMENTS@&#

The authors thank the Ministry of Science and Technology (MOST 103-2221-E-002-170-MY3) and Ministry of Education (AE-00-00-06) of the Republic of China for the financial support.

@&#REFERENCES@&#

