@&#MAIN-TITLE@&#Unsupervised multiphase color–texture image segmentation based on variational formulation and multilayer graph

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new color texture feature is constructed.


                        
                        
                           
                           Multiphase successive active contour model (MSACM) is proposed.


                        
                        
                           
                           MSACM can be discretely optimized by multilayer graph.


                        
                        
                           
                           The combined energy of local and global is iteratively optimized.


                        
                        
                           
                           Performances are assessed through the qualitative and quantitative comparisons.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Variational formulation

Multiphase successive active contour model (MSACM)

Unsupervised color–texture image segmentation

Multilayer graph

@&#ABSTRACT@&#


               
               
                  This paper proposes an unsupervised variational segmentation approach of color–texture images. To improve the description ability, the compact multi-scale structure tensor, total variation flow, and color information are integrated to extract color–texture information. Since heterogeneous image object and nonlinear variation exist in color–texture image, it is not appropriate to use one single/multiple constant in the Chan and Vese (CV) model to describe each phase [1,2]. Therefore, a multiphase successive active contour model (MSACM) based on the multivariable Gaussian distribution is presented to describe each phase. As geodesic active contour (GAC) has a stronger ability in capturing boundary. To inherit the advantages of edge-based model and region-based model, we incorporate the GAC into the MSACM to enhance the detection ability for concave edge. Although multiphase optimization of our proposed MSACM is a NP hard problem, we can discretely and approximately solve it by a multilayer graph method. In addition, to segment the color–texture image automatically, an adaptive iteration convergence criterion is designed by incorporating the local Kullback–Leibler distance and global phase label, so that we can control the segmentation process converges. Comparing to state-of-the-art unsupervised segmentation methods on a substantial of color texture images, our approach achieves a significantly better performance on capture ability of homogeneous region/smooth boundary and accuracy.
               
            

@&#INTRODUCTION@&#

Image segmentation based on variational method recently attracted a widespread concern, and it has been extensively used in the computer vision field including visual tracking, object detection, scene understanding, industrial testing, content-based image retrieval, medical image analysis [3,4], etc. The main reason for that is that the variational method can provide some smooth and enclosed contours, and meanwhile it can easily integrate with prior knowledge. As we know, a natural image usually contained a wealth of color–texture information, if we only use color information or texture information to implement segmentation, though some specific segmentation tasks can be achieved, usually, we are confronted with difficulty in capturing satisfactory segmentation results. As a result, incorporating the color information and texture information into the segmentation process may be more effective. With regard to multiphase segmentation, some methods [1,8] have been presented to tackle with color image. Although they were accurate, and have achieved some impressive segmentation results, however, they are all confronted with user interaction by using many initial curves enclosed with interested objects or sub-objects. Additionally, the initialization process of these mentioned methods is tedious and time consuming. Consequently, a fully automatic partitioning method should be designed to segment the color–texture image into some significant regions, distinct scenes, or desired object boundaries, thus it is still an opening problem, yet not solved effectively.

Generally, a variational method can be categorized as edge-based model [9–12] and region-based model [5,6,13]. The edge-based model uses local gradient information to attract the active contour toward the object boundaries. A well-known and successful active contour/snake model was initially proposed by Kass, Witkin and Terzopoulos [10]. Then, Cohen and Kimmel [9] presented an interactive edge-based segmentation approach by putting a single point close to the boundary of the target, and then the corresponding energy minimization was converted into a cost accumulation problem, consequently, a global minimal path will be produced between two end points. Appleton and Talbot [14] developed an interactive segmentation process by adopting minimal paths to find an optimal geodesic after user initialized a single point inside the interested object, and then induce a cut. Caselles et al. [12] proposed a geodesic active contour (GAC) model by defining an energy function along a curve C and minimizing the evolving curve in the normal direction. Li et al. [15] designed a new variational formulation for geometric active contours to force the level set function close to a signed distance function, and then the costly re-initialization procedure is eliminated completely. Although these mentioned edge-based approaches have achieved some impressive segmentation results, there exist some problems about the segmentation which are greatly dependent on the initial curves and points, and the corresponded global optimization is easily sank into local minimization. Besides, the initialized location placed in different parts of the image will capture the different objects or targets. More importantly, it has been proven that its final segmentation results are very sensitive to image noise, as well.

Region-based method posses many advantages when compared with the edge-based method, such as robustness against initial placement of curve, and insensitivity to image noise. A well-known example of the region-based method is the Mumford–Shah model [5]. As it is known, its smoothness term is hard to minimize as gradients introduce, thus, a simplified version of the MS model has been studied by Chan and Vese [16], then, an image can be described with a piecewise constant function, and it can be minimized with level set simultaneously. Herein, the constants can be calculated through the average value of the interior region and exterior region of curve C respectively, and then the curve is attracted to evolve toward the ground truth boundary. More recently, active contour methods have focused on the region-based flow that is inspired by the region competition idea of Zhu and Yuille [17]. This approach models the interior region and exterior region statistically, and meanwhile it assumes that these regions are constant intensities, and homogeneous. However, this strategy is using global constant statistics for region modeling that is usually not ideal when segmenting heterogeneous objects. Moreover, if the provided image contains some complex and inhomogeneous objects, finally, the segmented results will be degenerated seriously. Lankton and Tannenbaum [18] proposed an approach to overcome the intensity inhomogeneity by adopting a localized energy function that is based on the CV model [16]. Although the localization information can be used to improve the segmentation performance; nevertheless, the sensitivity of the initialized placement of curve will be increased greatly due to losing some global characteristics. Additionally, the scale size is also hard to choose for distinct objects adaptively. More importantly, the segmentation task of multiple objects cannot be effectively achieved by employing these local methods, unless multiple initialized curves are placed around the interested objects, simultaneously. Vese and Chan [8] proposed a new multiphase level set [19] approach to fulfill the multi-class segmentation task as multiple objects appeared. The proposed method is a generalize case of the CV model. It can overcome the problem such as vacuum and overlap automatically. Nonetheless, the number of multiphase must be configured as even, and meanwhile it is hard to capture the concave edge precisely because it is very sensitive to noise and shadows.

Majority of the segmentation algorithms mentioned above used either edge-based model or region-based model. Here, we should note that edge-based model owns better capture ability on boundary; however, it is sensitive to initial placement. While region-based segmentation algorithm has robustness contrast with the initial curve and is less susceptible to local minima, but it neglects the spatial constrain. As a result, a variety of methods have been proposed to integrate them together [1,2,7,20]. Paragios and Deriche [21] developed an early unifying model (integrate the edge-based model and region-based model), however, this method is time consuming, and hard to deal with heterogeneous objects. Tao [1] presented a multiple piecewise constant (MPC) active contour model, and it is extended to deal with multiphase case (MMPC). Although this proposed multiphase model can be optimized efficiently by computing minimum cuts, the corresponding segmentation process needs to label the interested objects with scribbles in advance. Liu [7] presented an iteratively unsupervised image segmentation algorithm which is based on multiphase multiple piecewise constant model and graph cuts optimization. This method adopts the four-color theorem to re-label the segmented regions in subsequent iteration, so that the segmentation results can represent an arbitrary phase number in just four colors. However, these mentioned methods do not consider the texture information during the multiphase segmentation process.

For the above reasons, a lot of color–texture segmentation approaches [22–24,27,28] have been developed in the last decade. For instance, Brox et al. [29] integrated the color, texture, and movement information into the framework of level set, and evolved the contours of objects through minimizing a specific designed energy function. Although this method can divide an image into two phases or multiphase, however, the accuracy that is acquired greatly depends on user interaction. Moreover, the segmentation process needs user interaction many times toward interested objects or sub-objects; actually, this is unrealistic to achieve the segmentation task for image sequence. Nevertheless, Deng and Manjunath put forward an unsupervised segmentation method for color–texture images and video (JSEG) [23], which has been considered as a benchmark in the field of computer vision. In [23], the segmentation process of JSEG is divided into two stages. For one thing, the color will be quantified into 10 to 20 prototypes, and then each pixel obtains a prototype label. For the other thing, it calculates the local homogeneity in a quantitative J-image, and then uses the multi-scale region growing method for clustering. The authors of this paper argue that extracting color information and texture information in succession is beneficial, but it is hard to analyze the color similarity and spatial relationship between the neighboring pixels simultaneously. Yang et al. [28] proposed a color–texture image segmentation approach named compression-based texture merging (CTM). It extracts texture information from each channel in Lab color space with a constant sized window, and then reduces the dimension of texture to eight using principal component analysis (PCA). After that, it uses the degenerated Gaussian mixture distribution to describe the probability density function (PDF). Nevertheless, its segmentation performance greatly depends on the choice of difference texture threshold during the clustering. A small threshold will lead to some scattered regions which without any visual entirety or consistency, vice versa; the long and narrow interested regions will be lost. Abeles et al. [24] presented a contour detection and hierarchical image segmentation approach; it can provide some detailed results in different scales, and acquire a significant accuracy [25], but the texture information was extracted involving in high dimension and information redundancy. Li et al. [26] designed a bipartite graph partitioning approach (SAS). Although it used super pixels to provide powerful grouping cues for guiding segmentation, and achieved the best performance on the Berkeley Segmentation Database compared to state-of-the-art techniques, the initialized number of multiphase (class) has to be manually set (semi-supervised method) in advance. Additionally, Chen et al. [27] used the maximum a posteriori and maximum likelihood (MAP–ML) estimation method to achieve the color–texture segmentation task. It regarded image segmentation as a labeling problem in the framework of probability maximization. Meanwhile, it extracted the texture using contrast information. Although this approach can unsupervisedly segment color–texture images in multiphase, the valid number of multiphase still needs to be set manually. Moreover, the simplified texture information will lead to some problems, such as rich color–texture objects cannot be divided out. What causes these different segmentation results? The reason for that is that the methods mentioned above do not possess the description ability for main texture information in multi-scale. Furthermore, they do not own the boundary detection ability to keep the spatial change successively.

To alleviate these problems, we propose an unsupervised color–texture image segmentation approach by integrating edge-based model and region-based model into energy functional together, so that we can greatly improve the effectiveness of color–texture image segmentation. Due to the complexity, randomness and heterogeneity of color–texture image, the compact multi-scale structure tensor, total variation flow and color information are extracted, and then combined to enhance the description ability for color–texture. In addition, as heterogeneous objects and nonlinear variation existed in color–texture image, using one single/multiple constant to describe each phase is not appropriate, therefore, a multiphase successive active contour model (MSACM) incorporated with GAC is presented by adopting the multivariable Gaussian distribution to describe each phase. For the proposed MSACM, it can not only describe the nonlinear variation of color–texture image, but also capture the concave boundaries more precisely and robustly. Especially, to achieve the unsupervised segmentation, the valid multiphase number of our proposed MSACM can be acquired through the component-wise expectation-maximization for mixtures (CEM2) [30] algorithm. Since the minimization of our proposed MSACM is a NP hard problem, we cannot directly use the multiphase level set method for getting an optimal solution. As a result, based on cut metric in graph theory [31], a discrete representation of the MSACM is presented. Meanwhile, the proposed variational model can be approximately optimized using multilayer graph [1,7,32–34]. However, one round of segmentation process is not stable, thus, an iteratively unsupervised convergence criterion is developed by adopting a local Kullback–Leibler (KL) [35] distance among multiphase regions, and then combined with global phase label, so that we can acquire a better segmentation result, unsupervisedly.

The outline of this paper is organized as follows. In Section 2, the compact MSST texture, TV flow and RGB color information are extracted to represent the color–texture feature. In Section 3 we introduce a multiphase successive active contour model (MSACM). And then the energy functional of MSACM can be discretely represented and approximately minimized adopting multilayer graph in Section 4. In Section 5 we put forward a new adaptive iteration convergence criterion to control the segmentation process automatically. We validate our model by extensive experiments on a large number of color–texture images in Section 6, and going after by a brief conclusion in Section 7.

With regard to color–texture image, the color-alone or texture-alone [36] information is not sufficiently robust to describe the image content in many practical scenes. The reason for that is that color–texture image exhibits significant inhomogeneities in color and texture, and contained contents are often characterized with a high degree of complexity, randomness and irregularity. To understand these impacts deeply, a natural image which contains rich texture information is used for illustration. As we know, the color-alone information can provide visual sensitive information, however, if we only use color information for color–texture description, it may produce some discrete and small regions which without any visual semantics. Comparatively, if we adopt the traditional Gabor wavelet [36,37] to extract texture information, although the extracted feature has a powerful multi-scale analytical ability, it is hard to choose a suitable scale number and direction number. Therefore, the segmentation performance is heavily dependent on the choice of Gabor filters, furthermore, the overlarge scale number and direction number that are selected will lead to the extracted texture feature owing overly-high dimension and excessive information redundancy. In contrast, [38] proposes an interactive color–texture image segmentation method which combines the L*a*b* color and the multi-scale nonlinear structure tensor (MSNST) texture. Here, the MSNST can effectively avoid the choice of direction number, and meanwhile it can compact the whole orientation information contrasted with the Gabor wavelet. Nevertheless, the whole segmentation process of [38] treats the color and texture separately, which ignores the intrinsic relationship and holistic nature between color and texture. More importantly, the mentioned MSNST texture descriptor can discriminate regular and concentrated texture regions effectively, but, it does not work well in an area with large-scale texture. To compensate this, the total variation (TV) flow [39] can be auxiliarily used to extract local scale information. Consequently, a combination formation of color, texture, and local scale is raised. In the following section, we will illustrate the detailed extraction process about a color–texture descriptor.

Given MSST (MSNST [38] without nonlinear filtering), it can extract the multi-scale texture information effectively and avoid the choosing of direction number completely, and meanwhile it owns the ability to compact the whole orientation information. Thus, for an image I, we can calculate the MSST by using the non-orthogonal discrete wavelet [40]. Let Γ
                        s
                      as the sth scale tensor of MSST, which can be formulated using the tensor product of gradient as:
                        
                           (1)
                           
                              
                                 
                                    Γ
                                    s
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          
                                             ∇
                                             
                                                
                                                   
                                                      I
                                                      ∗
                                                      
                                                         θ
                                                         s
                                                      
                                                   
                                                
                                                n
                                             
                                             ∇
                                             
                                                
                                                   
                                                      
                                                         I
                                                         ∗
                                                         
                                                            θ
                                                            s
                                                         
                                                      
                                                   
                                                   n
                                                
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    σ
                                    
                                       −
                                       2
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         D
                                                         
                                                            n
                                                            ,
                                                            s
                                                         
                                                         x
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      D
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                      x
                                                   
                                                   
                                                      D
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      D
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                      y
                                                   
                                                   
                                                      D
                                                      
                                                         n
                                                         ,
                                                         s
                                                      
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         D
                                                         
                                                            n
                                                            ,
                                                            s
                                                         
                                                         y
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 s
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 ⋯
                                 ,
                                 S
                                 −
                                 1
                              
                           
                        
                     where I
                     ∗
                     θs
                      represents the convolution operation for image I with convolution operator θs
                      in sth scale, and ∇ is used to calculate gradient. S is the total number of scales in multi-scale, which determines the richness of extracted texture. As far as we know, the main texture information is mostly concentrated in the first three scales, therefore, we can set S as 3 in all our experiments. σ is the basis of wavelet, which can be set as 2 to decrease the storage cost and computation. Besides, the notations of Dx
                      and Dy
                      denote the partial derivative in x and y directions respectively. Subscript n is the nth channel of original image I, and superscript N represents the total channels.

Due to the fact that the color (vector) and MSST texture (matrix) have different feature structures; we cannot integrate them directly. To overcome this problem, firstly, we use the SVD [41] in tensor space for matrix decomposition, then, each scale of MSST can be rewritten as:
                        
                           (2)
                           
                              
                                 
                                    Γ
                                    s
                                 
                                 =
                                 
                                    
                                       
                                          V
                                          s
                                          1
                                       
                                       
                                          V
                                          s
                                          2
                                       
                                    
                                    T
                                 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                                s
                                                1
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                λ
                                                s
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       V
                                       s
                                       1
                                    
                                    
                                       V
                                       s
                                       2
                                    
                                 
                              
                           
                        
                     where V
                     
                        s
                     
                     1 and V
                     
                        s
                     
                     2 are the calculated eigenvectors after using the SVD in tensor space, and λ
                     
                        s
                     
                     1 and λ
                     
                        s
                     
                     2 are the corresponded eigenvalues accordingly, they meet with the constraint condition as λ
                     
                        s
                     
                     1
                     ≥
                     λ
                     
                        s
                     
                     2. Herein, V
                     
                        s
                     
                     1 and λ
                     
                        s
                     
                     1 are the maximal change of direction and amplitude of Γ
                        s
                      respectively, thus, we can obtain the main texture information Λ
                        s
                      as follows:
                        
                           (3)
                           
                              
                                 
                                    Λ
                                    s
                                 
                                 =
                                 η
                                 
                                    
                                       λ
                                       s
                                       1
                                    
                                 
                                 
                                    V
                                    s
                                    1
                                 
                              
                           
                        
                     where η is an enhancement factor, which can properly enhance the description ability of texture in each scale, and meanwhile it can reasonably widen the texture differences among different scales. Consequently, the multi-scale texture information can be represented through connecting the main texture Λ
                        s
                     , then, we can acquire a 2S-dimensional row vector as 
                        
                           Ξ
                           =
                           
                              
                                 
                                    Λ
                                    0
                                 
                                 T
                              
                              ⋯
                              
                                 
                                    Λ
                                    
                                       S
                                       −
                                       1
                                    
                                 
                                 T
                              
                           
                        
                     .

In terms of the difference of various color–texture images, the main multi-scale texture information may be focused on a few scales or some certain scale. Therefore, we can compact the extracted Ξ by using the PCA algorithm [41], it can not only reduce the information redundancy, but also reduce the calculation burden and memory consumption. Under the requirement of saving the major information of Ξ in each pixel, we can compute the compacted multi-scale texture information γ as follows:
                        
                           
                              
                                 
                                    
                                       
                                          ℑ
                                          
                                             u
                                             i
                                          
                                          =
                                          
                                             r
                                             i
                                          
                                          
                                             u
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ArgMin
                                             H
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         H
                                                      
                                                      
                                                         
                                                            r
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            2
                                                            S
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                            n
                                                         
                                                      
                                                   
                                                
                                                −
                                                ξ
                                                ≥
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          ϒ
                                          =
                                          Ξ
                                          ·
                                          
                                             
                                                u
                                                1
                                             
                                             ⋯
                                             
                                                u
                                                H
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where ℑ is a covariance matrix, and it is calculated with all the multi-scale texture information Ξ. ri
                      and ui
                      (a column vector) are the corresponded eigenvalue and eigenvector of ℑ, respectively, by using feature decomposition. ξ is an information compacted factor, set as 95% usually. γ is an acquired compacted multi-scale texture information in final, with H dimensions.

For TV flow [39], it can be used to auxiliarily enhance the description ability of γ in an area with large-scale texture through extracting the local scale information. To extract the local scale, [39] terminates the iterative calculation process of TV flow by manual means, which may greatly impact the flexibility and availability. Consequently, a new iteration convergence criterion is designed to extract the local scale information, more suitably and adaptively. Then, the iteration convergence can be controlled through the change detection of TV value as follows:
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             t
                                          
                                          
                                             u
                                             n
                                          
                                          =
                                          div
                                          
                                             
                                                
                                                   ∇
                                                   
                                                      u
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ∇
                                                      
                                                         u
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                             Max
                                          
                                          =
                                          
                                             
                                                arg
                                                Min
                                             
                                             t
                                          
                                          
                                             
                                                log
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  n
                                                                  =
                                                                  1
                                                               
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        u
                                                                        n
                                                                     
                                                                     −
                                                                     
                                                                        ∂
                                                                        
                                                                           t
                                                                           −
                                                                           2
                                                                        
                                                                     
                                                                     
                                                                        u
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  n
                                                                  =
                                                                  1
                                                               
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                        t
                                                                     
                                                                     
                                                                        u
                                                                        n
                                                                     
                                                                     −
                                                                     
                                                                        ∂
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        u
                                                                        n
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      ϑ
                                                   
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where ∂
                        t
                     u
                        n
                      denotes the TV flow change of the nth image channel in the tth iteration, and the initialized condition meets with ∂(t
                        =0)
                     u
                     
                        n
                     
                     =
                     u
                     
                        n
                     . Meanwhile, ϑ is a proportionality factor which controls the value change of TV flow until stabilization, and TMax
                      is the corresponded maximum iteration number.

Then, the local scale information can be calculated using the accumulative change of TV flow [39] as follows:
                        
                           (5)
                           
                              
                                 
                                    γ
                                    ¯
                                 
                                 =
                                 
                                    
                                       
                                          4
                                          τ
                                          
                                             
                                                ∫
                                                0
                                                
                                                   T
                                                   Max
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      ϕ
                                                      
                                                         
                                                            
                                                               
                                                                  ∂
                                                                  t
                                                               
                                                               
                                                                  u
                                                                  n
                                                               
                                                            
                                                         
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          dt
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       ∫
                                       0
                                       
                                          T
                                          Max
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      t
                                                   
                                                   
                                                      u
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 dt
                              
                           
                        
                     where τ is a step size of diffusion of TV flow, and it can be set as 2 to ensure the extracted local scale stability. Besides, φ(x,0) is a decision function, which is true if x
                     >0, otherwise, φ(x,0)=0. To formulate the color–texture feature reasonably, the extracted local scale should be further scaled to the specified range as [0, 255], this makes sure that the finally extracted local scale information has the same range as RGB color.

From our knowledge, the visual completeness and accuracy of the segmentation result are greatly dependent on the feature expression. Therefore, a reliable and efficient color–texture feature ΓSC can be constructed through integrating the compact MSST vector Υ, local scale 
                        
                           γ
                           ¯
                        
                     , and RGB color together (it is well known that all colors are perceived by humans as combinations of three primary colors red (R), green (G), and blue (B). The RGB is considered to meet with the spectral primary system, and meanwhile almost all color image acquisition devices can easily output the vector valued images in RGB space, as a consequence, we use the RGB to describe the color) as 
                        
                           ΓSC
                           =
                           
                              
                                 ϒ
                                 
                                    γ
                                    ¯
                                 
                                 R
                                 G
                                 B
                              
                              T
                           
                        
                     . Furthermore, the extracted feature ΓSC contains a substantial of noise. In order to smooth the noise and enhance the region boundary simultaneously, we apply the nonlinear diffusion filtering to strengthen the description ability of ΓSC as:
                        
                           (6)
                           
                              
                                 
                                    ∂
                                    t
                                 
                                 
                                    ΓSC
                                    j
                                 
                                 =
                                 div
                                 
                                    
                                       R
                                       
                                          
                                             
                                                ∑
                                                
                                                   g
                                                   =
                                                   1
                                                
                                                
                                                   H
                                                   +
                                                   4
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         
                                                            ΓSC
                                                            g
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       ∇
                                       
                                          ΓSC
                                          j
                                       
                                    
                                 
                              
                           
                        
                     where R(•) is a coefficient function of diffusion filtering, and it has the representation as R(|∇u|)=1/(|∇u|
                        ρ
                     
                     +ε). The small positive constant ε is introduced to avoid division by zero, and constant ρ is usually used to balance the edge enhancement and denoising. Additionally, the additive operator splitting (AOS) scheme [42] is also adopted to accelerate the corresponded implementation, effectively. Then, a much more powerful color–texture feature is acquired as ΓSC⁎
                     .

For the typical variational methods, such as Mumford and Shah (MS) [5] model, and Chan and Vese (CV) [6] model, due to the fact that these two models can provide some smooth and enclosed contours, they have been extensively applied in the image segmentation field. Taking the MS model for example, its target is to search an approximated minimal solution with smoothness piecewise and minimum edge length, and meanwhile it can achieve the denoising. However, there is a large gap between the fine theoretical application and its practical application, since the corresponding MS energy function is hard to optimize actually. Consequently, a simplified formation of the MS model was proposed, namely, the CV model [6]. It can describe the image with piecewise constant functions instead of piecewise smooth functions.

Given a color–texture image u0
                     , Ω→
                     R corresponds to the image u0
                      domain. Here, Ω is consisted by a finite unconnected region components Ω
                        j
                      and an enclosed smooth curves subset C, then, Ω can be represented as 
                        
                           Ω
                           =
                           
                              ∪
                              
                                 j
                                 =
                                 1
                              
                              
                                 N
                                 
                                    Ω
                                 
                              
                           
                           
                              Ω
                              j
                           
                           ∪
                           C
                        
                     . Where N(Ω) denotes the total number of sub-regions, and any two regions meet with 
                        
                           
                              
                                 
                                    Ω
                                    i
                                 
                                 ∩
                                 
                                    Ω
                                    j
                                 
                              
                              
                                 i
                                 ≠
                                 j
                              
                           
                           =
                           ϕ
                        
                     . For the CV model [6], the corresponded energy function can be represented as:
                        
                           (7)
                           
                              
                                 
                                    F
                                    CV
                                 
                                 
                                    
                                       c
                                       1
                                    
                                    
                                       c
                                       2
                                    
                                    C
                                 
                                 =
                                 α
                                 
                                    
                                       ∬
                                       
                                          Ω
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   0
                                                
                                                −
                                                
                                                   c
                                                   1
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          2
                                       
                                    
                                 
                                 +
                                 β
                                 
                                    
                                       ∬
                                       
                                          Ω
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   0
                                                
                                                −
                                                
                                                   c
                                                   2
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          2
                                       
                                    
                                 
                                 +
                                 ν
                                 
                                    
                                       ∫
                                       0
                                       
                                          L
                                          
                                             
                                                C
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       ds
                                    
                                 
                              
                           
                        
                     where the total region number N(Ω)=2, α and β denote the tuning weights between interior region Ω1 and exterior region Ω2 respectively, and ν is a constraint coefficient of the boundary length L(C). Usually, these parameters are fixed as constants in advance. Constants c
                     1 and c
                     2 are the calculated mean intensity of regions Ω1 and Ω2 accordingly. Here, the CV model becomes two phases, however, it can extend to multiphase, such as the Multiple Piecewise Constant (MPC) [2] model and Multiphase Multiple Piecewise Constant (MMPC) [1,7] model. These techniques also assume that multiple regions can be described with multiple piecewise constant functions. However, they cannot provide a precise description about PDF (Probability Density Function), because there exist a nonlinear variation of each region Ω
                        j
                     . In addition, these proposed models will reduce the correlation and continuity between regions. As a result, we cannot accurately describe the complexity and randomness of color–texture image by adopting the constant functions due to the most features that meet with the Gaussian distribution. Consequently, the multivariable Gaussian distribution is applied to describe the phase intensity; it may be more suitable instead of constant intensity cj
                     . Then, we proposed a multiphase successive active contour model (MSACM) which can be described as follows.
                        
                           (8)
                           
                              
                                 
                                    F
                                    
                                       M
                                       
                                       S
                                       
                                       A
                                       
                                       C
                                       
                                       M
                                    
                                 
                                 
                                    
                                       Θ
                                       1
                                    
                                    
                                       Θ
                                       2
                                    
                                    ⋯
                                    
                                       Θ
                                       
                                          K
                                          Phase
                                       
                                    
                                    C
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                          Phase
                                       
                                    
                                    
                                       
                                          α
                                          k
                                       
                                       
                                          
                                             ∫
                                             
                                                Ω
                                                k
                                             
                                          
                                          
                                             −
                                             log
                                             
                                                
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     2
                                                                     π
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  H
                                                                  +
                                                                  4
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  Σ
                                                                  k
                                                               
                                                            
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   exp
                                                   
                                                      
                                                         −
                                                         
                                                            1
                                                            2
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     u
                                                                     0
                                                                  
                                                                  
                                                                     x
                                                                  
                                                                  −
                                                                  
                                                                     u
                                                                     k
                                                                  
                                                               
                                                            
                                                            T
                                                         
                                                         
                                                            
                                                               Σ
                                                               k
                                                            
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  u
                                                                  0
                                                               
                                                               
                                                                  x
                                                               
                                                               −
                                                               
                                                                  u
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                       dx
                                    
                                 
                                 +
                                 ν
                                 
                                    
                                       ∫
                                       0
                                       
                                          L
                                          
                                             
                                                C
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       ds
                                    
                                 
                              
                           
                        
                     where KPhase
                      denotes the total number of phases, and each phase can be statistically described with a multivariable Gaussian Θ
                     
                        k
                     
                     ={α
                     
                        k
                     ,u
                     
                        k
                     ,Σ
                     
                        k
                     }. These statistical parameters αk
                     , uk
                      and Σ
                        k
                      are corresponded to the regional weight, mean, and covariance matrix of the kth phase respectively. Usually, it is not easy to set some suitable initialized values for statistical parameters 
                        
                           
                              
                                 Θ
                                 k
                              
                              
                                 
                                    1
                                    ≤
                                    k
                                 
                              
                              ≤
                              
                                 Θ
                                 
                                    K
                                    Phase
                                 
                              
                           
                        
                      and valid number of multiphase KPhase
                      in advance. Therefore, the common strategy is to build up the image description in the Gaussian mixture model (GMM) with a large initialized value KPhase
                      
                     [27]. But, the initialized value KPhase
                      that will cause the segmentation process is not accurate and flexible. To address this problem, the CEM2 algorithm [30,59] is adopted for getting the valid phase number. And meanwhile, the CEM2 algorithm can improve the convergence speed by updating the statistical parameters sequentially rather than on the large completed data space simultaneously. If one phase was removed, its probability mass will be redistributed to the other phases immediately. Therefore, the CEM2 algorithm can be extended to select the valid multiphase number KPhase
                      adaptively, and meanwhile it can achieve the initialization process of our proposed MSACM.

In formula (8), the boundary curve is constrained with length ∫
                     0
                     
                        L(C(s))
                     ds, which lacks the gradient information for boundary detection. Therefore, when shadow and noise are close to the contour, this caused the captured boundaries which appeared in the phenomenon as skewing and sharp edged. To acquire a good capture capability and local characteristic for boundary, the geodesic active contour (GAC) model is incorporated into our proposed MSACM in formula (8). Then, the cost function can be rewritten as:
                        
                           (9)
                           
                              
                                 
                                    F
                                    
                                       M
                                       
                                       S
                                       
                                       A
                                       
                                       C
                                       
                                       M
                                    
                                 
                                 
                                    
                                       Θ
                                       1
                                    
                                    
                                       Θ
                                       2
                                    
                                    ⋯
                                    
                                       Θ
                                       
                                          K
                                          Phase
                                       
                                    
                                    C
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                          Phase
                                       
                                    
                                    
                                       
                                          α
                                          k
                                       
                                       
                                          
                                             ∫
                                             
                                                Ω
                                                k
                                             
                                          
                                          
                                             −
                                             log
                                             
                                                
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     2
                                                                     π
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  H
                                                                  +
                                                                  4
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  Σ
                                                                  k
                                                               
                                                            
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   exp
                                                   
                                                      
                                                         −
                                                         
                                                            1
                                                            2
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     u
                                                                     0
                                                                  
                                                                  
                                                                     x
                                                                  
                                                                  −
                                                                  
                                                                     u
                                                                     k
                                                                  
                                                               
                                                            
                                                            T
                                                         
                                                         
                                                            
                                                               Σ
                                                               k
                                                            
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  u
                                                                  0
                                                               
                                                               
                                                                  x
                                                               
                                                               −
                                                               
                                                                  u
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                       dx
                                    
                                 
                                 +
                                 ν
                                 
                                    
                                       ∫
                                       0
                                       
                                          L
                                          
                                             
                                                C
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       g
                                       
                                          
                                             C
                                             
                                                s
                                             
                                          
                                       
                                       ds
                                    
                                 
                              
                           
                        
                     where g(u
                     0)=exp(−
                     ϖ|∇u
                     0|) is a boundary indicator function. The second term of formula (9) is a geodesic active contour instead of the length ∫0
                     
                        L(C(s))
                     ds with an integral function g (along with curve C). As a result, we can detect the boundary more accurately. Except that, the proposed MSACM is incorporated with edge-based model and region-based model, thus, it can further improve the completeness of color–texture segmentation.

With respect to the statistical parameters 
                        
                           
                              Θ
                              1
                           
                           
                              Θ
                              2
                           
                           ⋯
                           
                              Θ
                              
                                 K
                                 Phase
                              
                           
                        
                      in formula (9), the multiphase level set has been proposed in [8], and it can be used to minimize the energy function of our proposed MSACM. To minimize the energy function in formula (9), firstly, we consider M
                     =⌈log(K
                     
                        Phase
                     )⌉ level set functions as ϕk
                     (1≤
                     k
                     ≤
                     M):Ω→
                     R. And then the collected ϕk
                      zero-level sets can be used to represent the segmented boundaries. To express expediently, the vector formation of level set function can be denoted as Φ
                     ={ϕ
                     1,ϕ
                     2, ⋯,ϕ
                     
                        M
                     }, and its corresponded Heaviside function is H(Φ)={H(ϕ
                     1), H(ϕ
                     2), ⋯, H(ϕ
                     
                        M
                     )}. Here, we should specially mention that each component of H(Φ) is either one or zero. Therefore, the corresponded multiphase level set of the energy function in formula (9) can be expressed as follows:
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          F
                                          
                                             
                                             M
                                             
                                             S
                                             
                                             A
                                             
                                             C
                                             
                                             M
                                          
                                       
                                       
                                          
                                             Θ
                                             1
                                          
                                          
                                             Θ
                                             2
                                          
                                          ⋯
                                          
                                             Θ
                                             
                                                K
                                                Phase
                                             
                                          
                                          C
                                       
                                       =
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                                Phase
                                             
                                          
                                          
                                             
                                                α
                                                k
                                             
                                             
                                                
                                                   ∫
                                                   Ω
                                                
                                                
                                                   −
                                                   log
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           2
                                                                           π
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        H
                                                                        +
                                                                        4
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         exp
                                                         
                                                            
                                                               −
                                                               
                                                                  1
                                                                  2
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                           0
                                                                        
                                                                        
                                                                           x
                                                                        
                                                                        −
                                                                        
                                                                           u
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     Σ
                                                                     k
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        u
                                                                        0
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     −
                                                                     
                                                                        u
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             
                                                Π
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                M
                                             
                                             
                                                
                                                   H
                                                   
                                                      
                                                         
                                                            ϕ
                                                            l
                                                         
                                                      
                                                      
                                                         f
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            H
                                                            
                                                               
                                                                  ϕ
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            
                                                               f
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             dx
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                       ν
                                       
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             M
                                          
                                          
                                             
                                                
                                                   ∫
                                                   Ω
                                                
                                                
                                                   
                                                      
                                                         ∇
                                                         H
                                                         
                                                            
                                                               ϕ
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   g
                                                   
                                                      
                                                         C
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                   d
                                                   
                                                   x
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where fk
                      denotes the distance sign of sample x to level set function ϕk
                     , if ϕk
                     
                     >0, fk
                      will be set as one, otherwise, as zero. Then, the gradient decent equation can be acquired by minimizing formula (10) in the Euler–Lagrange equations as
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                ϕ
                                                l
                                             
                                          
                                          
                                             ∂
                                             t
                                          
                                       
                                       =
                                       δ
                                       
                                          
                                             ϕ
                                             l
                                          
                                       
                                       
                                          
                                             ν
                                             
                                             div
                                             
                                                
                                                   g
                                                   
                                                      
                                                         C
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                   ⋅
                                                   
                                                      
                                                         ∇
                                                         
                                                            ϕ
                                                            l
                                                         
                                                      
                                                      
                                                         
                                                            ∇
                                                            
                                                               ϕ
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             −
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                                phase
                                             
                                          
                                          
                                             
                                                α
                                                k
                                             
                                             
                                                
                                                   ∫
                                                   Ω
                                                
                                                
                                                   −
                                                   lo
                                                   g
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           2
                                                                           π
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        H
                                                                        +
                                                                        4
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        Σ
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         exp
                                                         
                                                            
                                                               −
                                                               
                                                                  1
                                                                  2
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                           0
                                                                        
                                                                        
                                                                           x
                                                                        
                                                                        −
                                                                        
                                                                           u
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     Σ
                                                                     k
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        u
                                                                        0
                                                                     
                                                                     
                                                                        x
                                                                     
                                                                     −
                                                                     
                                                                        u
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ⋅
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      k
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            ϕ
                                                            l
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                            k
                                                         
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            H
                                                            
                                                               
                                                                  ϕ
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                               k
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         −
                                                         
                                                            f
                                                            k
                                                         
                                                      
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            ϕ
                                                            l
                                                         
                                                      
                                                      
                                                         f
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            H
                                                            
                                                               
                                                                  ϕ
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            f
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      Π
                                                      
                                                         
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               i
                                                               ≠
                                                               l
                                                            
                                                         
                                                      
                                                      n
                                                   
                                                   H
                                                   
                                                      
                                                         
                                                            ϕ
                                                            i
                                                         
                                                      
                                                      
                                                         f
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            H
                                                            
                                                               
                                                                  ϕ
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            
                                                               f
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             d
                                             
                                             x
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Usually, the gradient decent equation of formula (11) can be used to solve the minimization of formula (10) using an explicit finite difference scheme. Nevertheless, this technique involves the contour evolution only in a local sense, thus, it is easily draped in local minimization. Furthermore, its computing burden is costly. Consequently, to alleviate these problems, we will discrete formula (9) with a multilayer graph for getting an approximate optimal solution in the following section (Actually, here, we provide a uniform expression. If we ignore the computing burden and local minimization, formula (11) can also be used for getting an approximate optimization).

Note that the integral formation of MSACM is complex. Thus, we need to discrete it firstly, then, the discrete optimization can be solved in a multilayer graph.

Let color–texture image u0
                         as a 2D grid graph R, R
                        ={(i,j)|i
                        ∈{1,2, ⋯,W}, j
                        ∈{1,2, ⋯ H}}, where W is width, and H is height. For convenient expression, we can induce an auxiliary function φ(x) as
                           
                              
                                 
                                    φ
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ,
                                             if
                                             
                                             
                                                
                                                   x
                                                   ≠
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             else
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Then, a label function {ψ(m)|ψ(m)∈{1,2, ⋯,K
                        
                           Phase
                        }, m
                        =(i,j)∈
                        R} is defined in the grid graph R. And then, we can discrete the first term of energy functional (9) with the representation as
                           
                              (12)
                              
                                 
                                    
                                       E
                                       1
                                    
                                    =
                                    −
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                             phase
                                          
                                       
                                       
                                          
                                             α
                                             k
                                          
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   R
                                                
                                             
                                             
                                                φ
                                                
                                                   
                                                      ψ
                                                      
                                                         m
                                                      
                                                      −
                                                      k
                                                   
                                                
                                                log
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        2
                                                                        π
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     H
                                                                     +
                                                                     4
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     Σ
                                                                     k
                                                                  
                                                               
                                                               
                                                                  1
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      exp
                                                      
                                                         
                                                            −
                                                            
                                                               1
                                                               2
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        u
                                                                        0
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                     −
                                                                     
                                                                        u
                                                                        k
                                                                     
                                                                  
                                                               
                                                               T
                                                            
                                                            
                                                               
                                                                  Σ
                                                                  k
                                                               
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     u
                                                                     0
                                                                  
                                                                  
                                                                     m
                                                                  
                                                                  −
                                                                  
                                                                     u
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

To simplify the expression of formula (12), we set
                           
                              
                                 
                                    
                                       p
                                       
                                          k
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      π
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                   +
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Σ
                                                   k
                                                
                                             
                                             
                                                1
                                                2
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                      0
                                                   
                                                   
                                                      m
                                                   
                                                   −
                                                   
                                                      u
                                                      k
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                Σ
                                                k
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   u
                                                   0
                                                
                                                
                                                   m
                                                
                                                −
                                                
                                                   u
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where p
                        
                           k,m
                         describes the similarity degree of color–texture feature u
                        0(m)=
                        ΓSC
                        ∗(m) that belongs to the kth phase. However, to further improve the discrimination capability, we can replace p
                        
                           k,m
                         in formula (12) using −log(p
                        
                           k,m
                        ), then,
                           
                              (13)
                              
                                 
                                    
                                       E
                                       1
                                    
                                    =
                                    −
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                             phase
                                          
                                       
                                       
                                          
                                             α
                                             k
                                          
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   R
                                                
                                             
                                             
                                                φ
                                                
                                                   
                                                      ψ
                                                      
                                                         m
                                                      
                                                      −
                                                      k
                                                   
                                                
                                                log
                                                
                                                   
                                                      p
                                                      
                                                         k
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Based on the cut metric theory in [43], the length of the curve C 
                        [44,45] can be written as ∫
                        
                           C
                        
                        n
                        
                           S
                        
                        ds
                        =2|C|
                           E
                        , where n
                        
                           S
                         is the number of times the line S intersects the contour C, and |C|
                           E
                         is the corresponded Euclidean length. To discrete the energy functional in formula (9), the Euclidean length of curve C is approximately calculated by using Q (where Q
                        =4, 8, 16) neighborhood system as Fig. 1
                         presented. Here, we should notice that all the sets of straight lines can be expressed as {(ρ,θ)|x
                        cos(θ)+
                        y
                        sin(θ)=
                        ρ} in polar coordinate plane, and then the length of curve C can be calculated in Cauchy–Crofton formula as follows:
                           
                              (14)
                              
                                 
                                    
                                       
                                          C
                                       
                                       E
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          ∫
                                          
                                             −
                                             ∞
                                          
                                          
                                             +
                                             ∞
                                          
                                       
                                       
                                          
                                             
                                                ∫
                                                0
                                                π
                                             
                                             
                                                
                                                   n
                                                   c
                                                
                                                
                                                   ρ
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                    dρdθ
                                 
                              
                           
                        where n
                        
                           c
                        (ρ,θ) denotes the interaction times between the curve C and the line x
                        cos(θ)+
                        y
                        sin(θ)=
                        ρ. Notice that these lines that intersect with curve C can be categorized into a certain number of types. To calculate the length of curve C, we set Q neighborhood system to a special designed grid graph G. Then, the neighborhood system can be expressed as a set N
                        
                           G
                        
                        ={e
                        
                           k
                        |1≤
                        k
                        ≤
                        n
                        
                           G
                        }, where e
                        
                           k
                         is a direction vector, and n
                        
                           G
                         is the corresponded direction number in Q neighborhood system (Q
                        =2n
                        
                           G
                        ). Let Δθ
                        
                           k
                         as an angular difference between each pair of the nearest direction vector, and it can be represented as 
                           
                              Δ
                              
                                 θ
                                 k
                              
                              =
                              
                                 π
                                 
                                    n
                                    G
                                 
                              
                           
                        . Then, the discrete representation of formula (14) can be further formulated as:
                           
                              (15)
                              
                                 
                                    
                                       
                                          C
                                       
                                       E
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             n
                                             G
                                          
                                       
                                       
                                          
                                             n
                                             c
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             δ
                                             2
                                          
                                          Δ
                                          
                                             θ
                                             k
                                          
                                       
                                       
                                          2
                                          
                                             
                                                e
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where δ is the step size of grid graph G, and 
                           
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    n
                                    G
                                 
                              
                              
                                 
                                    n
                                    c
                                 
                                 
                                    k
                                 
                              
                           
                         is the total number of intersection times between curve C and all the families of edge lines. To calculate the edge weight for each family of lines, we can formulate it with 
                           
                              
                                 ω
                                 k
                              
                              =
                              
                                 
                                    
                                       δ
                                       2
                                    
                                    Δ
                                    
                                       θ
                                       k
                                    
                                 
                                 
                                    2
                                    
                                       
                                          e
                                          k
                                       
                                    
                                 
                              
                           
                        . Then, for an enclosed contour C, 
                           
                              
                                 
                                    
                                       
                                       C
                                       
                                    
                                 
                                 E
                              
                              =
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                       G
                                    
                                 
                                 
                                    
                                    
                                       n
                                       c
                                    
                                    
                                       k
                                    
                                 
                              
                              
                              
                                 ω
                                 k
                              
                           
                         will denote a cut cost on the grid graph G.

Given a 2D flow network G 
                        [46], an optimization of graph cut on G is used to divide out the set of vertices V into two disjoint sets as S (source) and T (sink), and then the corresponded cost of the cut (S,T) of curve C can be defined as
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       G
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   m
                                                   ∈
                                                   S
                                                   ,
                                                   n
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                      n
                                                   
                                                   ∩
                                                   C
                                                   ≠
                                                   ∅
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                             
                                                m
                                                ,
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where (m,n) represents a divided edge, and its cost weight corresponds to w
                        
                           m,n
                        . As the cut metric of |C|
                           G
                         is equivalent to the discrete approximation of the curve length |C|
                           E
                         in formula (15), therefore, we have
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       E
                                    
                                    ≈
                                    
                                       
                                          C
                                       
                                       G
                                    
                                    .
                                 
                              
                           
                        
                     

Based on the cut metric theory [43], the discrete formation of the curve length |C|
                           E
                         in formula (15) can be represented as
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       E
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             m
                                             ∈
                                             R
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      Q
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      φ
                                                      
                                                         
                                                            ψ
                                                            
                                                               m
                                                            
                                                            −
                                                            ψ
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       w
                                       
                                          m
                                          ,
                                          n
                                       
                                    
                                 
                              
                           
                        where N
                        
                           Q
                        (m) denotes the neighbor system of node m, and Q is the neighbor size. In this lecture, Q is set as 8, and w
                        
                           m,n
                         is a weight which depends on the direction of edge (m,n) and neighbor system NQ
                        . By incorporating the length of the curve C and the geodesic active contour g(u
                        0)=exp(−
                        ϖ|∇u
                        0|), the discrete representation of the second term in formula (9) can be expressed as
                           
                              (16)
                              
                                 
                                    
                                       E
                                       2
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             m
                                             ∈
                                             M
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      Q
                                                   
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                   
                                                      m
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   
                                                      1
                                                      −
                                                      φ
                                                      
                                                         
                                                            ψ
                                                            
                                                               m
                                                            
                                                            −
                                                            ψ
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          −
                                          ϖ
                                          
                                             
                                                
                                                   ΓS
                                                   
                                                      C
                                                      ∗
                                                   
                                                   
                                                      m
                                                   
                                                   −
                                                   ΓS
                                                   
                                                      C
                                                      ∗
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where the parameter ϖ can be calculated adaptively as 
                           
                              ϖ
                              =
                              
                                 
                                    
                                       
                                          2
                                          
                                             Z
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                
                                                   m
                                                   n
                                                
                                                ∈
                                                Z
                                             
                                          
                                          
                                             Dis
                                             
                                                
                                                   
                                                      ΓS
                                                      
                                                         C
                                                         ∗
                                                      
                                                      
                                                         m
                                                      
                                                      ,
                                                      ΓS
                                                      
                                                         C
                                                         ∗
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                        . Z is a set of pairs of neighboring grid points in graph R, and |Z| denotes the total pair number of the set Z. dis(•) represents the dissimilarity between color–texture features in Euclidean space. Therefore, the complete discrete representation of MSACM can be denoted as follows
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             F
                                             MSACM
                                          
                                          =
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                
                                                   α
                                                   k
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                         phase
                                                      
                                                   
                                                   
                                                      φ
                                                      
                                                         
                                                            ψ
                                                            
                                                               m
                                                            
                                                            −
                                                            k
                                                         
                                                      
                                                      ⋅
                                                      −
                                                      log
                                                      
                                                         
                                                            p
                                                            
                                                               k
                                                               ,
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         
                                                            N
                                                            Q
                                                         
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ν
                                                            
                                                               w
                                                               
                                                                  m
                                                                  ,
                                                                  n
                                                               
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  1
                                                                  −
                                                                  φ
                                                                  
                                                                     
                                                                        ψ
                                                                        
                                                                           m
                                                                        
                                                                        −
                                                                        ψ
                                                                        
                                                                           n
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            ⋅
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                exp
                                                
                                                   
                                                      −
                                                      ϖ
                                                      
                                                         
                                                            
                                                               ΓS
                                                               
                                                                  C
                                                                  ∗
                                                               
                                                               
                                                                  m
                                                               
                                                               −
                                                               ΓS
                                                               
                                                                  C
                                                                  ∗
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                                +
                                                τ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where τ is a denoising constant that we newly added, and it is used to enhance the robustness of our proposed MSACM. Furthermore, one may ask for an error analysis about the discrete representation. Actually, we can formulate the approximation gap between the continuous solution and discrete solution ranged in [0, πν|L|].

As far as we know, formula (17) corresponds to a multi-label Potts model [47] whose minimization is hard to tackle with actually, namely, it is a NP-hard problem. To address this problem, Boykov [48] proposed the α–β swap method and α-expansion method to minimize the multiphase energy function, and these techniques can acquire an approximate minimization solution quickly. Then, Ishikawa [33] devised a multilayer graph which can exactly optimize the multi-label MRF energy function with convex priors in terms of a linear-ordered label set. Bae [34] proposed a piecewise constant level set method (PCLSM) which has been applied in the multiphase Mumford–Shah model for image segmentation. Tao [1] presented a multiphase model which can be optimized effectively by solving the corresponding minimal cut with a specially devised multilayer graph. Based on the proposed energy function in [1] and its corresponded graph cuts optimization, an interactive multiphase method was presented. Due to the fact that the second term of the proposed MSACM is a multi-label Potts model [44] in formula (17), the methods of multilayer graph in [33,34] cannot provide an exact minimization. But, as an approximate computing, these methods in [1,7,33,48] can be adopted for optimization.

In order to minimize the energy function F
                        
                           MSACM
                        , we can construct a weighted multilayer graph for getting the minimal cut. For instance, a color–texture image with 4 phases is presented in Fig. 2(a), and the corresponded multilayer graph is shown as Fig. 2(b) (with 3 layers). We should notice that the displayed multilayer graph is consisted of K
                        
                           Phase
                        
                        −1 layers, and each layer owns the same n-link, while between each two layers has the different t-link.

Let G
                        =(V,E) represent a multilayer graph, where V is a set of vertices and E is the corresponded set of edges. For each layer of G, it contains the same 2D grid graph P, and then G can be defined as {(m,l)∈
                        R
                        2
                        ×
                        R|m
                        ∈
                        P, l
                        ∈(1, 2, ⋯, K
                        
                           Phase
                        
                        −1)}, where m is a position of any pixel in grid graph P. To facilitate the description, we denote v
                        
                           m,l
                         as a point which is located at the position of m in the lth layer. Consequently, V can be defined as V
                        ={v
                        
                           m,l
                        |m
                        ∈
                        P, l
                        ∈(1, 2, ⋯, K
                        
                           Phase
                        
                        −1)}∪{s,t}. For the set of edges E, we will rearrange it into two groups as ED
                         and ES
                        . Where ED
                         is the set of t-link edges which corresponds to the region-based energy term E
                        1, and it can be denoted as
                           
                              
                                 
                                    
                                       E
                                       D
                                    
                                    =
                                    
                                       ∪
                                       
                                          m
                                          ∈
                                          P
                                       
                                    
                                    
                                       E
                                       m
                                    
                                    ,
                                    
                                       E
                                       m
                                    
                                    =
                                    
                                       
                                          e
                                          
                                             s
                                             
                                                v
                                                
                                                   m
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             ∪
                                             
                                                l
                                                =
                                                1
                                             
                                             
                                                
                                                   K
                                                   Phase
                                                
                                                −
                                                2
                                             
                                          
                                          e
                                          
                                             
                                                v
                                                
                                                   m
                                                   ,
                                                   l
                                                
                                             
                                             
                                                v
                                                
                                                   m
                                                   ,
                                                   l
                                                   +
                                                   1
                                                
                                             
                                          
                                          ∪
                                          e
                                          
                                             
                                                v
                                                
                                                   m
                                                   ,
                                                   
                                                      K
                                                      Phase
                                                   
                                                   −
                                                   1
                                                
                                             
                                             t
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                        Em
                         denotes the set of t-link edges that linked with grid point m. For each t-link edge e(v
                        
                           m,l
                        ,v
                        
                           m,l
                           +1) is weighted as w(e(v
                        
                           m,l
                        ,v
                        
                           m,l
                           +1)) to represent the feature similarity of pixel m to the (l
                        +
                        1)th phase, and the corresponded weight value can be calculated as—log (p
                        
                           l
                           +1,m
                        ). Particularly, w(e(s,v
                        
                           m,1)) and 
                           
                              w
                              
                                 
                                    e
                                    
                                       
                                          v
                                          
                                             m
                                             ,
                                             
                                                K
                                                Phase
                                             
                                             −
                                             1
                                          
                                       
                                       t
                                    
                                 
                              
                           
                         are represented as the feature similarities of pixel m to the first phase and the K
                        
                           Phase
                        th phase respectively. In the same vein, the set of n-link edges ES
                         corresponds to the edge-based energy term E
                        2 which can be represented as
                           
                              
                                 
                                    
                                       E
                                       S
                                    
                                    =
                                    
                                       
                                          e
                                          
                                             
                                                v
                                                
                                                   m
                                                   ,
                                                   l
                                                
                                             
                                             
                                                v
                                                
                                                   n
                                                   ,
                                                   l
                                                
                                             
                                          
                                          
                                             
                                                m
                                                ∈
                                                P
                                                ,
                                                n
                                                ∈
                                                
                                                   N
                                                   m
                                                
                                                
                                                   Q
                                                
                                                ,
                                                l
                                                ∈
                                                
                                                   
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         K
                                                         Phase
                                                      
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Q and N
                        
                           m
                        (Q) follow the definition of formula (16), and the n-link edge e(v
                        
                           m,l
                        ,v
                        
                           n,l
                        ) is weighted as w(e(v
                        
                           m,l
                        ,v
                        
                           n,l
                        )), which indicates the feature similarity between each pair of neighboring pixels (m,n), and meanwhile it can be calculated as w(e(v
                        
                           m,l
                        ,v
                        
                           n,l
                        ))=
                        νw
                        
                           m,n
                        
                        ⋅exp(−
                        ϖ|ΓSC
                        ∗(m)−
                        ΓSC
                        ∗(n)|2)+
                        τ.

Based on the constructed multilayer graph G, each pixel m
                        ∈
                        P is configured with at least one phase label after graph cuts optimization, otherwise, {s} and {t} cannot be separated. Consequently, any cut on G must be severed at least L edges from ED
                         (L is the size of color–texture image u0
                        ). Normally, it is supposed that a cut is admissible [34] just as G severs only one edge in Em
                         for each pixel m
                        ∈
                        P. For instance, Fig. 2(c) presents a 2D multilayer graph which is corresponded to Fig. 2(b), where each 2D layer has been converted as a 1D form. The red line displays a non-admissible cut (ABCDEFGHMNOPQIL) for that the t-link edges that link to nodes X3
                         and X4
                         are divided out three times respectively. Taking the node X3
                         for illustration, it linked t-link edges as 
                           
                              e
                              
                                 s
                                 
                                    v
                                    
                                       
                                          X
                                          3
                                       
                                       ,
                                       1
                                    
                                 
                              
                           
                        , 
                           
                              e
                              
                                 
                                    v
                                    
                                       
                                          X
                                          3
                                       
                                       ,
                                       1
                                    
                                 
                                 
                                    v
                                    
                                       
                                          X
                                          3
                                       
                                       ,
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              e
                              
                                 
                                    v
                                    
                                       
                                          X
                                          3
                                       
                                       ,
                                       2
                                    
                                 
                                 
                                    v
                                    
                                       
                                          X
                                          3
                                       
                                       ,
                                       3
                                    
                                 
                              
                           
                        , we can see that these edges are divided out by the same cut(ABCDEFGHMNOPQIL). Thus, this means that the node X3
                         is configured with three different phase labels as {1, 2, 3}. Obviously, this result is conflicted with the admissible metric. However, we can resort to the idea in [33,34] to exclude the non-admissible cut, and then an admissible cut (A⁎B⁎C⁎D⁎EFGHIL) is obtained as shown by the green line displayed. Through the analysis mentioned above, we can use the max-flow/min-cut algorithm [49,50] to minimize the energy functional E, so that we can acquire an approximately optimized segmentation for any tested color–texture image in multiphase.

Due to the diversity, complexity and randomness of different color–texture images, the parameter ν in energy function E is hard to set adaptively. If a large initialized value is configured to ν, it can dampen the impact of noise, however, some details are also lost simultaneously. Vice versa, a small value ν that is chosen will cause some meaningless, smaller, and discrete regions. To alleviate these problems, we apply the prior information such as region size, and common edge between regions [51] to avoid this phenomenon. In addition, since the segmentation results of one round of segmentation process are not stabilized, we design an iterative segmentation metric to terminate the segmentation process adaptively by incorporating ratio change of multiphase labels and Kullback–Leibler (KL) [35] distance between K
                     
                        Phase
                     
                     (t) phases. During the segmentation process, we should note that the statistical parameters 
                        
                           
                              Θ
                              1
                              
                                 t
                              
                           
                           
                              Θ
                              2
                              
                                 t
                              
                           
                           ⋯
                           
                              Θ
                              
                                 K
                                 Phase
                              
                              
                                 t
                              
                           
                        
                      and the valid phase number K
                     
                        Phase
                     
                     (t) should be updated after each iteration time. Here, the statistical parameters of the kth phase can be updated as follows,
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          
                                             α
                                             
                                                t
                                             
                                          
                                          k
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   x
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      −
                                                      φ
                                                      
                                                         
                                                            ψ
                                                            
                                                               x
                                                            
                                                            −
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      K
                                                      
                                                         t
                                                      
                                                   
                                                   Phase
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            φ
                                                            
                                                               
                                                                  ψ
                                                                  
                                                                     x
                                                                  
                                                                  −
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                             
                                                t
                                             
                                          
                                          k
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      x
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                         −
                                                         φ
                                                         
                                                            
                                                               ψ
                                                               
                                                                  x
                                                               
                                                               −
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             ΓS
                                             
                                                C
                                                ∗
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      K
                                                      
                                                         t
                                                      
                                                   
                                                   Phase
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            φ
                                                            
                                                               
                                                                  ψ
                                                                  
                                                                     x
                                                                  
                                                                  −
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                             
                                                t
                                             
                                          
                                          k
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      x
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                         −
                                                         φ
                                                         
                                                            
                                                               ψ
                                                               
                                                                  x
                                                               
                                                               −
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      ΓS
                                                      
                                                         C
                                                         ∗
                                                      
                                                      
                                                         x
                                                      
                                                      −
                                                      
                                                         
                                                            u
                                                            
                                                               t
                                                            
                                                         
                                                         k
                                                      
                                                   
                                                
                                                T
                                             
                                             
                                                
                                                   ΓS
                                                   
                                                      C
                                                      ∗
                                                   
                                                   
                                                      x
                                                   
                                                   −
                                                   
                                                      
                                                         u
                                                         
                                                            t
                                                         
                                                      
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      K
                                                      
                                                         t
                                                      
                                                   
                                                   Phase
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            −
                                                            φ
                                                            
                                                               
                                                                  ψ
                                                                  
                                                                     x
                                                                  
                                                                  −
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Through these statistical parameters and multiphase labels, we can achieve the segmentation process adaptively by integrating them as follows. Commonly, the straightforward criterion is to check whether the whole ratio change of multiphase labels is less than one predefined threshold. If true, the segmentation process will be terminated, vice versa, it is continue. Here, we can firstly set E
                     
                        L
                     
                     (t) as the whole ratio change of multiphase labels (global information) in the tth iteration, and then it can be calculated as follows:
                        
                           (19)
                           
                              
                                 
                                    E
                                    L
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         P
                                                      
                                                   
                                                   
                                                      φ
                                                      
                                                         
                                                            
                                                               ψ
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               m
                                                            
                                                            −
                                                            
                                                               ψ
                                                               
                                                                  
                                                                     t
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ,
                                             
                                          
                                          
                                             
                                                ,
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          if
                                          
                                             
                                                
                                                   K
                                                   Phase
                                                   
                                                      t
                                                   
                                                
                                                ≠
                                                
                                                   K
                                                   Phase
                                                   
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          else
                                       
                                    
                                 
                              
                           
                        
                     where |L| denotes the total pixel number of provided color–texture image. ψ
                     (t)(m) is denoted as a configured phase label at m position in the tth iteration. To avoid impact on the iteration process, E
                     
                        L
                     
                     (t) will be set as 0 when a valid phase number is changed (the reason for that is that the corresponded relationship between multiphase labels has been lost in two adjacent iterations). Although this strategy is less time consuming and owns the description ability in global, it will lose some local dissimilarity and stability measure. Thus, in this lecture, a criterion based on dissimilarity measure of K
                     
                        Phase
                     
                     (t) phases multivariate Gaussian is designed by using extended KL divergence [35].

For each phase k, it can be described with a multivariate Gaussian as 
                        
                           
                              
                                 Θ
                                 
                                    t
                                 
                              
                              k
                           
                           =
                           
                              
                                 
                                    α
                                    
                                       t
                                    
                                 
                                 k
                              
                              
                                 
                                    u
                                    
                                       t
                                    
                                 
                                 k
                              
                              
                                 
                                    Σ
                                    
                                       t
                                    
                                 
                                 k
                              
                           
                        
                     , where k
                     ∈(1,2, ⋯,K
                     
                        Phase
                     
                     (t)). Then, the KL distance D
                     (t)(k,n) between the kth phase and the nth phase can be calculated as follows
                        
                           (20)
                           
                              
                                 
                                    
                                       
                                          D
                                          
                                             t
                                          
                                       
                                       
                                          k
                                          n
                                       
                                       =
                                       KL
                                       
                                          
                                             Gaussia
                                             
                                                n
                                                
                                                   t
                                                
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   Gaussia
                                                   
                                                      n
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       =
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             log
                                             
                                                
                                                   
                                                      Σ
                                                      n
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      Σ
                                                      k
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             +
                                             tr
                                             
                                                
                                                   
                                                      Σ
                                                      n
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      Σ
                                                      k
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         μ
                                                         k
                                                         
                                                            t
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         n
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                T
                                             
                                             
                                                Σ
                                                n
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      μ
                                                      k
                                                      
                                                         t
                                                      
                                                   
                                                   −
                                                   
                                                      μ
                                                      n
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Let E
                     
                        KL
                     
                     (t) represent the dissimilarity measure of K
                     
                        Phase
                     
                     (t) phases. We can calculate the E
                     
                        KL
                     
                     (t) with the sum of the minimum KL [38] distance between K
                     
                        Phase
                     
                     (t) phases as follows
                        
                           (21)
                           
                              
                                 
                                    E
                                    KL
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                          Phase
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                α
                                                k
                                                
                                                   t
                                                
                                             
                                             ⋅
                                             Min
                                             
                                          
                                          
                                             n
                                             ∈
                                             
                                                1
                                                ⋯
                                                
                                                   K
                                                   Phase
                                                   
                                                      t
                                                   
                                                
                                             
                                             ∩
                                             
                                                
                                                   n
                                                   ≠
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    D
                                    
                                       t
                                    
                                 
                                 
                                    k
                                    n
                                 
                                 .
                              
                           
                        
                     
                  

Due to the fact that the ratio change of E
                     
                        KL
                     
                     (t) can be used to describe the local dissimilarity and stability, then, we can set the ratio change as ΔE
                     
                        KL
                     
                     (t) and it can be computed as
                        
                           (22)
                           
                              
                                 Δ
                                 
                                    E
                                    KL
                                    
                                       t
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       −
                                       
                                          
                                             
                                                Min
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   =
                                                   1
                                                   ,
                                                   ⋯
                                                   ,
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      E
                                                      KL
                                                      
                                                         
                                                            t
                                                            ′
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      E
                                                      KL
                                                      
                                                         
                                                            
                                                               t
                                                               ′
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                E
                                                KL
                                                
                                                   t
                                                
                                             
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        
                     where ΔE
                     
                        KL
                     
                     (t) and E
                     
                        L
                     
                     (t) represent the information change in local and global respectively, and 
                        
                           
                              
                                 E
                                 KL
                                 
                                    t
                                 
                              
                              ′
                           
                           =
                           
                              Max
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 t
                              
                           
                           
                              E
                              KL
                              
                                 j
                              
                           
                        
                     . Then, we can design an adaptive convergence criterion by integrating formula (19) and formula (22) as follows:
                        
                           
                              
                                 
                                    E
                                    L
                                    
                                       t
                                    
                                 
                                 ≥
                                 
                                    β
                                    1
                                 
                                 
                                 and
                                 
                                 Δ
                                 
                                    E
                                    KL
                                    
                                       t
                                    
                                 
                                 ≥
                                 
                                    β
                                    2
                                 
                                 ,
                              
                           
                        
                     where β
                     1 and β
                     2 are the discriminate thresholds, which can be used to control the convergence speed and segmentation accuracy. Through a substantial of experiment testing, we can set them as 0.99 and 0.95, respectively.

@&#EXPERIMENTAL RESULTS@&#

In the following section, we will validate our proposed multiphase unsupervised color–texture image segmentation approach (MSACM) on a large set of real-world color–texture images which come from the image dataset in [52,53] and the well-known Berkeley Segmentation Database (BSD300) [54]. To verify the superior performance of our proposed MSACM method, the other six state-of-the-art unsupervised algorithms are chosen for comparison, including the combination of color, texture, and motion information in level set method (short for CTMLS) [29], Segmentation by Aggregating Superpixels (SAS) [26] method, Normalized Cuts (N-Cuts) [22] method, unsupervised J-images Segmentation (JSEG) [23] method, maximum a posterior and maximum likelihood estimation (MAP–ML) [27] method, and compression-based texture merging (CTM) [28] method. For a fair comparison, the parameter settings of these mentioned methods are given in advance. The diffusion factor in CTMLS is configured with p
                        =1.6 to balance the noise and boundary, and meanwhile we should notice that the color–texture feature applied for comparison is not including motion information (as the provided color–texture image is static). For the SAS method, the affinity coefficient, scale factor, and neighbor numbers of super pixels are default as 0.001, 20 and 1 respectively. The number of phase in N-Cuts is set as 20 (default), which is an average number of marked areas subjectively assigned by humans. The JSEG method is acknowledged as a benchmark in terms of unsupervised color–texture segmentation, and it has three parameters that should be configured, such as color quantization threshold, scale, and merge threshold. Just like the authors suggest, these parameters can be set as 255, 1.0, and 0.4 accordingly. The MAP–ML method which carries out the maximum a posteriori (MAP) and maximum likelihood (ML) evaluation alternately, and the default values of smoothness factor and maximum iteration times are selected as 4000 and 5 respectively. For the CTM method, it is a simple agglomerative clustering algorithm derived from a lossy data compression approach, and the texture difference threshold γ is chosen as 0.15.

For some evaluation methodologies are highly subjective and they greatly depend on intuition, there is not a unique segmented outcome for an arbitrary image. To measure the quality of some segmented outcomes objectively, several proposed evaluation metrics have been chosen for comparison in this lecture, such as the Probabilistic Rand Index (PRI), Normalized Probabilistic Rand (NPR) [55,56] index, Variation Of Information metric (VOI) [60], Global Consistency Error (GCE) [54], and Boundary Displacement Error (BDE) [61]. These techniques are very generic and do not limit the specific application like some earlier ones [57,58] required. Furthermore, they can measure the variability more accurately in human perception. For the PRI and NPR, a tested segmentation result can be quantized to a set of ground truths by using a soft non-uniform weight. For instance, we consider a set of ground truth segmentations which is provided by K persons as T
                        ={S
                        1,S
                        2, ⋯,S
                        
                           K
                        }, and its corresponded original image is consisted of L pixels as X
                        ={x
                        1,x
                        2, ⋯,x
                        
                           L
                        }. And then, 
                           
                              l
                              m
                              
                                 S
                                 k
                              
                           
                         is a corresponded label of pixel x
                        
                           m
                         in the kth ground truth segmentation. Meanwhile, S
                        
                           test
                         is a testing segmentation result. The label of pixel x
                        
                           m
                         in the testing segmentation can be denoted as l
                        
                           m
                        
                        
                           test
                        . In the following, the probabilistic rand index can be defined as
                           
                              
                                 
                                    PRI
                                    
                                       
                                          S
                                          test
                                       
                                       
                                          
                                             S
                                             k
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                             
                                                
                                                   m
                                                   <
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                             
                                                C
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      p
                                                      
                                                         m
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      C
                                                      
                                                         m
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where C
                        
                           m,n
                        
                        =
                        II(l
                        
                           m
                        
                        
                           test
                        
                        ≠
                        l
                        
                           n
                        
                        
                           test
                        ) denotes that each pair of pixels (x
                        
                           m
                        ,x
                        
                           n
                        ) either belongs to the same phase or not in testing segmentation S
                        
                           test
                        . p
                        
                           m,n
                         denotes the probability of each pair of pixels with the same label in T, and then it can be calculated as 
                           
                              
                                 p
                                 
                                    m
                                    ,
                                    n
                                 
                              
                              =
                              1
                              /
                              K
                              
                                 
                                    ∑
                                    
                                       z
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    II
                                    
                                       
                                          
                                             l
                                             m
                                             
                                                S
                                                z
                                             
                                          
                                          =
                                          
                                             l
                                             n
                                             
                                                S
                                                z
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , where II(⋅) is a discrimination function. If y
                        =1, then II(y)=1, Otherwise, as 0. At the same time, the NPR value can be further formulated as
                           
                              
                                 
                                    NPR
                                    =
                                    
                                       
                                          PRI
                                          −
                                          E
                                          
                                             PRI
                                          
                                       
                                       
                                          Max
                                          
                                             PRI
                                          
                                          −
                                          E
                                          
                                             PRI
                                          
                                       
                                    
                                 
                              
                           
                        where Max(PRI) is usually set as one. The expectation value of PRI in [56] is calculated as
                           
                              
                                 
                                    E
                                    
                                       PRI
                                    
                                    =
                                    E
                                    
                                       
                                          PRI
                                          
                                             
                                                S
                                                test
                                             
                                             
                                                
                                                   S
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                             
                                                
                                                   m
                                                   <
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                E
                                                
                                                   
                                                      II
                                                      
                                                         
                                                            l
                                                            m
                                                            
                                                               S
                                                               test
                                                            
                                                         
                                                         
                                                            l
                                                            n
                                                            
                                                               S
                                                               test
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                
                                                   p
                                                   
                                                      m
                                                      ,
                                                      n
                                                   
                                                
                                                +
                                                
                                                   
                                                      1
                                                      −
                                                      E
                                                      
                                                         
                                                            II
                                                            
                                                               
                                                                  l
                                                                  m
                                                                  
                                                                     S
                                                                     test
                                                                  
                                                               
                                                               
                                                                  l
                                                                  n
                                                                  
                                                                     S
                                                                     test
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         p
                                                         
                                                            m
                                                            ,
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Meanwhile, the 
                           
                              E
                              
                                 
                                    II
                                    
                                       
                                          l
                                          m
                                          
                                             S
                                             test
                                          
                                       
                                       
                                          l
                                          n
                                          
                                             S
                                             test
                                          
                                       
                                    
                                 
                              
                           
                         is computed with all the ground truths as follows
                           
                              
                                 
                                    E
                                    
                                       
                                          II
                                          
                                             
                                                l
                                                m
                                                
                                                   S
                                                   test
                                                
                                             
                                             
                                                l
                                                n
                                                
                                                   S
                                                   test
                                                
                                             
                                          
                                       
                                    
                                    =
                                    1
                                    /
                                    Φ
                                    ⋅
                                    
                                       
                                          ∑
                                          
                                             ϕ
                                             =
                                             1
                                          
                                          Φ
                                       
                                       
                                          
                                             
                                                1
                                                /
                                                
                                                   K
                                                   ϕ
                                                
                                                ⋅
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      Kϕ
                                                   
                                                   
                                                      II
                                                      
                                                         
                                                            l
                                                            m
                                                            
                                                               S
                                                               k
                                                               ϕ
                                                            
                                                         
                                                         
                                                            l
                                                            n
                                                            
                                                               S
                                                               k
                                                               ϕ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Kϕ
                         is the number of ground-truth which corresponds to the ϕth image, and Φ is the total number of images in database. Here, we should note that the values of PRI and NPR are ranged from 0 to 1 and from −∞ to 1 respectively, and a larger value acquired means that the machine segmentation is closer to ground truth.

For VOI, it can be defined with the following formulation as:
                           
                              
                                 
                                    VoI
                                    
                                       
                                          S
                                          test
                                       
                                       
                                          
                                             S
                                             k
                                          
                                       
                                    
                                    =
                                    1
                                    /
                                    K
                                    ⋅
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             
                                                H
                                                
                                                   
                                                      S
                                                      k
                                                   
                                                
                                                +
                                                H
                                                
                                                   
                                                      S
                                                      test
                                                   
                                                
                                                −
                                                2
                                                I
                                                
                                                   
                                                      S
                                                      k
                                                   
                                                   
                                                      S
                                                      test
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where functions H and I represent the mutual information and entropy [60] respectively, and they are usually adopted to approximate the distance between each two clusters. Additionally, GCE measures [54] the extent to which one segmentation map can be viewed as a refinement of another segmentation. Comparatively, BDE [61] measures the average displacement error of boundary pixels to the closest boundary pixels in the other segmentation. Through these measure metrics, we can evaluate the accuracy of different segmentation results, comprehensively.

Furthermore, there are some parameters that need to be predefined appropriately. To implement our proposed method, the enhancement factor η of formula (3) is fixed as 5.0. The proportionality factor ϑ in formula (4) is held as 0.005. The small positive constants ε and ρ in formula (6) are set as 10−3 and 0.7 respectively. To acquire the valid phase number, we set the initial phase number as 12 in the CEM2 algorithm [30]. The edge-based weight v and denoising constant τ in formula (17) are chosen as 10.0 and 5.0 respectively. Additionally, to visualize the segmentation results more intuitively, we color the different phase label with random and translucent color.

In order to test the comprehensive qualitative evaluation and quantitative comparison of our proposed unsupervised color–texture image segmentation approach (MSACM) on natural scene images, we carry out some experiments to verify the accuracy and effectiveness of the proposed MSACM.

The first experiment is designed to compare the different strategies of color–texture modeling to verify the performance of our proposed approach. In Fig. 3(a) two color–texture images are provided, which contain rich color and texture information. If we simply rely on color information (RGB/Lab), or use compact MSST texture and TV flow for color–texture modeling, the corresponding segmentation results are shown as Fig. 3(c) and (d) respectively, which are not satisfied. However, Fig. 3(e) indicates that the proposed color–texture descriptor can discriminate the regions of color and texture accurately and has more powerful color–texture discriminating ability when compared with unalloyed used color or texture information. Meanwhile, we can observe that integrating RGB color information and texture information (MSST+TV) acquires more complete regions than using Lab+MSST+TV information in visual. Moreover, the segmentation results of Fig. 3(e) and (b) can be further verified that our proposed color–texture descriptor is more accurate than the traditional Gabor based color–texture modeling. Consequently, the comparisons of Fig. 3 demonstrate the effectiveness of our proposed approach.

In Figs. 4–5
                        
                        , we will validate the effectiveness of capturing ability in concave boundary and boycotting the interference in noise regions and shadows when the MSACM is incorporated with GAC. In Fig. 4(a) three natural color–texture images are presented. The wild deer and flowers contained rich color information in the first and third columns respectively. Comparatively, the zebra image contained rich texture information in the second column. Through the enclosed yellow rectangles of interested sub-regions, we can see that the captured concave boundaries with GAC are more accurate in Fig. 4(c) than that without it in Fig. 4(b). Taking the wild deer image in the first column for illustration, the captured boundaries of our approach are more close to ground truth, in the abdomen and leg parts.

In Fig. 5, due to the interference of shadow and noise region, some phenomena such as skewing and blurring appeared. However, we can tackle with these problems through adding boundary force GAC into edge-based model. Considering the enclosed sub-regions on the left and lower parts of Fig. 5(c), where some shadow regions appeared which is close to the starfish boundary, we can observe that the captured boundaries using MSACM (with GAC) are not skewing. Simultaneously, it avoids the sharp vibration when a small blemished region is close to object boundary, as a sub-region is displayed in the upper part.

In Fig. 6
                        , four synthesis color–texture images are presented to further demonstrate the capturing ability in successive and deep concave boundary with MSACM, and these acquired boundaries are very close to ground truths. Here, we should note that the proposed MSACM acquires the valid phase number as the same as ideal.

To justify the effect of the newly proposed iteration convergence criterion in Section 5, we present an iterative segmentation process of an animal in Fig. 7
                        . Through the change of local energy and global energy in Fig. 7(a), we can observe that the change decreases greatly during iterations, which means that the proposed convergence criterion is identical to the stability segmentation process (in Fig. 7(b)). Furthermore, we can see that the convergence of global energy (needs two times iteration) climbs more quickly than local energy (needs three times iteration); this means that the judgment of convergence by using global label information is more rigid than the KL divergence (local energy). Thus, the local energy is used to control the convergence speed, as it may be more suitable, and meanwhile it can detect the local change more effectively (we can see that the energy is changed sharply between the second time and third time). Therefore, we can conclude that the convergence of the segmentation process can be guaranteed (it will be converged after three times iteration).

For the sake of comparison, we extend the combination of color, texture, and motion information in level set method (CTMLS)[29] and multiphase interactive segmentation method in [1] from supervised to unsupervised, and meanwhile we compare their performance with ours. The final segmentation results are shown in Fig. 8
                        . Here, we should notice that our proposed MSCAM approach and the method in [1] are both multiphase image segmentation methods which are based on multilayer graph optimization. For the CTMLS method [29], it has been extended to multiphase in graph cut for acceleration and optimization. We should note that the three compared methods have the same segmentation framework. However, the difference between our proposed method and theirs is that ours is based on a multiphase successive variational active (MSACM) model, where each phase is described with multivariable Gaussian distribution, and it can describe the nonlinear variation of PDF simultaneously. For the CTMLS method, it describes the PDF of each phase with variance Gaussian distribution; actually, it is a specific case of our PDF. At the same time, the initialization process of statistical parameters and the valid phase number of CTMLS are calculated by using the component-wise EM for mixtures (CEM2) algorithm [30,59]. Comparatively, the extended MMPC method in [1] used the multiple piecewise constants (MPC) and k-means to learn some piecewise constant functions for each phase. But, as the MMPC model is a hard cluster strategy and its sub-phase number of each phase is manually set, it is very sensitive to initial cluster number. Through the compared experiment, we can observe that the segmentation results of our proposed MSACM are more complete and accurate than both the CTMLS and MMPC models. In addition, for the three compared methods, we also provide some detailed boundary evolutions in Figs. 9–10
                        
                        , and these results indicate that the acquired boundaries of our proposed approach are smoother than both the CTMLS and MMPC models in convergence. Moreover, we can further conclude that using the multivariable Gaussian to model each phase is more effective than variance Gaussian and multiphase constant.

To investigate the comprehensive segmentation results and quantitative estimation, we can further test the segmentation performance of our proposed method on some real natural scene images which include some uncertain and complex color–texture patterns. As a result, a variety of natural color–texture images are selected from the 1000 image dataset [53] and the well-known Berkeley Segmentation Database (BSD300) [54]. Meanwhile, the other six unsupervised segmentation methods are also adopted for comparison as well (such as CTMLS, SAS, N-Cuts, JSEG, MAP–ML, and CTM).

Firstly, some relatively simple color–texture images with saliency objects are chosen for testing in Fig. 11
                        . In the provided segmentation results, we can see that a substantial of smaller and scatter segmented regions appear for N-Cuts, MAP–ML and CTM methods, and their segmentation results appear to be seriously over-segmented simultaneously. Comparatively, the CTMLS, SAS and JSEG methods can obtain some more satisfactory segmentation results; nevertheless, there are still some unsmooth boundaries, such as the saliency object in the third row. However, the segmentation results acquired by our approach are better among all the seven compared methods, with smooth boundary and total visual effect.

In addition, we can further utilize some complex color–texture images which are selected from BSD300 for comparison in Fig. 12
                        . Here, we should note that the presented images contain some rich texture information. Through the provided results, we can see that the proposed method has a preferable performance. Taking the cheetah image (in the eleventh row) for instance, the foreground objects (cheetahs) and the background grassland with the extremely similar colors, only the texture features are slightly different. Comparatively, our approach can effectively segment them out, and obtain a satisfactory segmentation result. By contrast, the other six compared methods emerge the over-segmentation and even wrong segmentation phenomenao in some extent. For instance, the N-Cuts method acquires some bigger segmentation regions, relatively. But, the segmentation result is greatly affected by the initialized phase number, and induces over-segmentation. In the similar way, the MAP–ML, CTM and JSEG methods, also appear the same phenomenon. For the CTMLS and SAS methods, they can avoid the over-segmentation in some extent, but, the final obtained results are not very satisfactory in vision. Comparatively, our approach can not only divide out the homogeneous regions completely, but also guarantee that the captured boundary of saliency object is smooth. The reason for that is that our proposed MSACM integrates the region-based model and edge-based model effectively, and meanwhile it can describe the nonlinear variation of color–texture as well. In the same vein, we can further verify the same conclusion as Fig. 13
                         presented.

To objectively evaluate the segmentation performance of the seven compared methods, we will quantize the segmentation results into two aspects. For one thing, we will estimate the segmentation results that are presented in this lecture; actually, they are some more complex patterns and challenging cases. For the other thing, we will analyze the robustness of our approach, and meanwhile we will test the comprehensive quantization scores of the seven compared methods on the Berkeley Segmentation Database (BSD300).

Corresponding to the segmentation results of Figs. 3–13, the quantitative evaluations of the seven compared approaches in PRI and NPR are displayed in Fig. 14
                        . The PRI values and NPR values [55] are calculated using four to seven ground truth images as references. From the displayed curves in Fig. 14(a) and (b), we can observe that the PRI values and NPR values of our approach are higher than the other six compared methods, but, slightly lower than the MAP–ML method in the biggest value. The main reason for that is that the segmented homogeneous regions of our approach are appeared to be more complete, so that the detailed information that is lost contrasted with the ground truths. Certainly, this can be further verified through the distribution of region number, and class number (Due to the compared images with the size of 481×321 or 321×481, the number of segmented regions is focused on five to seven, and the class number is concentrated upon three and four. These results imply that the segmented region has a bigger area) as Fig. 15(a) and (c) displayed respectively. Furthermore, the distribution of PRI score and NPR score indicates that our approach acquires a larger percentage in large values, as Fig. 14(c–d) presented.

In Fig. 16
                        , we will investigate the impact of information compacted factor ξ on the images in the Berkeley Segmentation Database (BSD300). Here, we should specially mention that the segmentation is better if PRI is larger and the other three measures (VOI, GCE, and BDE) are smaller, when compared with ground truths. We can observe that the values of PRI, VOI, and GCE are varied slightly (the change value is almost less than 0.05) when value ξ changed. Comparatively, the change value of BDE is large; however, it can be accepted (as the deviation of average boundary displacement is less than one pixel). These quantitative values indicate that our approach can divide out the natural color–texture image, robustly and steadily Additionally, the total performance and dimension of compacted texture (with two dimensions) are more suitable in ξ=0.95, therefore, it can be configured as a constant (0.95) in all our experiments. Furthermore, as Fig. 15(b) displayed, our approach can be converged quickly.

Lastly, we afford some comprehensive quantization scores of seven compared methods on the Berkeley Segmentation Database (BSD300) in Table 1
                        . It lists the formulated average value of the PRI, VOI, GCE, and BDE. To allow for smaller localization errors in all the seven compared methods and human segmented results, we calculate the comprehensive quantitative values using a distance tolerance of one pixel. Here, we should notice that the performance of human segmented results was computed as an upper bound of the seven compared methods. From Table 1, we can obviously observe that our approach is better than the CTMLS, JSEG, MAP–ML, CTM, and N-Cuts methods, but, it is lower than the SAS method. The main reason for that is that our approach drops some smaller regions and detailed boundaries. However, we can acquire that the homogeneous regions are more complete, and meanwhile the final obtained boundaries are more smooth.

@&#CONCLUSION@&#

In this paper, we propose an unsupervised color–texture image segmentation approach based on variational model and multilayer graph optimization. To improve the discriminating ability for color–texture image, a new color–texture feature is designed by integrating the compact MSST, TV flow and color information. Moreover, the multiphase successive active contour model (MSACM) incorporated with GAC is presented. It can not only enhance the capturing ability for concave boundary, but also boycott the interference of noising regions and shadows. Based on the energy function of our proposed MSACM and its corresponded multilayer graph optimization, an image can be partitioned adaptively into multiple different regions. To terminate the iteration process adaptively, an effective convergence criterion is designed. Lastly, a large number of qualitative and quantitative experiments demonstrate that our proposed approach can effectively obtain some preferable color–texture segmentation results. To obtain a flexible and reliable parameter setting strategy, we would like to study how to adaptively determine the tuning parameter v in energy function E and the scale number S in MSST in the future.

@&#ACKNOWLEDGMENTS@&#

The research has been supported by the National Natural Science Foundation of China (Grant 61073094), the science research program of education department and technology department in Henan province (Grant 14A520054, 20130704), and the Key Laboratory program of technology department of Zhengzhou city, in China. In addition, the author would like to thank D. Luo for providing the meaningful discussion on the paper.

@&#REFERENCES@&#

