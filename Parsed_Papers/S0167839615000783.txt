@&#MAIN-TITLE@&#A new B-spline representation for cubic splines over Powell–Sabin triangulations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider a 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               cubic spline space defined over a Powell–Sabin refined triangulation.


                        
                        
                           
                           The space has some local 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               super-smoothness and can be seen as a close extension of the classical cubic Clough–Tocher spline space.


                        
                        
                           
                           We construct a suitable normalized B-spline representation for this spline space.


                        
                        
                           
                           We also show how to compute the Bézier control net of such a spline in a stable way.


                        
                     
                  
               
            

@&#KEYPHRASES@&#




                     




                        




                           




                              C




                           




                           




                              1




                           




                        




                      cubic splines

Macro-elements

Powell–Sabin splines

Clough–Tocher splines

Normalized B-splines

Bézier control net

@&#ABSTRACT@&#


               
               
                  We consider a 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubic spline space defined over a triangulation with Powell–Sabin refinement. The space has some local 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      super-smoothness and can be seen as a close extension of the classical cubic Clough–Tocher spline space. In addition, we construct a suitable normalized B-spline representation for this spline space. The basis functions have a local support, they are nonnegative, and they form a partition of unity. We also show how to compute the Bézier control net of such a spline in a stable way.
               
            

@&#INTRODUCTION@&#

Smooth (finite element) spline spaces defined over triangulations have been studied extensively and applied in different contexts (see, e.g., Lai and Schumaker, 2007; Nürnberger and Zeilfelder, 2000, and the references quoted therein). Typically, such spline spaces provide good approximation properties and possess a small dimension which can be expressed in terms of geometrically interesting characteristics of the triangulation (like the number of vertices, edges and/or triangles). In addition, a stable basis representation is often required for practical purposes.

For the construction of smooth splines with a low polynomial degree, one often considers triangulations with a particular macro-structure. Each triangle in the triangulation is then split into a number of subtriangles. The Clough–Tocher split (into three subtriangles) and the Powell–Sabin split (into six subtriangles) are commonly used splits. Splines defined on such refined triangulations are referred to as Clough–Tocher splines and Powell–Sabin splines, respectively.


                     Dierckx (1997) has developed an interesting normalized B-spline representation for 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      quadratic Powell–Sabin splines. These splines have been introduced by Powell and Sabin (1977) with the aim of drawing contour lines of bivariate functions. The B-spline representation consists of a set of locally supported basis functions which form a convex partition of unity (i.e., they are nonnegative and sum up to one). The spline coefficients in this representation possess an intuitive geometric interpretation involving tangent control triangles. This normalized B-spline representation has been effective in a wide range of application areas, for example, surface modeling and compression (Dierckx, 1997; Maes and Bultheel, 2006; Speleers et al., 2009), scattered data interpolation and approximation (Manni and Sablonnière, 2007; Sbibih et al., 2009, 2015), the numerical solution of differential problems (Speleers et al., 2006, 2012). Recently, basis functions with similar properties have been constructed for certain Powell–Sabin spline spaces of higher degree and smoothness. In particular, we mention 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubics (Lamnii et al., 2014), 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      quintics (Speleers, 2010a), and a family of splines of smoothness r and polynomial degree 
                        3
                        r
                        −
                        1
                      (Speleers, 2013a). Local super-smoothness has been imposed in order to simplify their construction and to reduce their number of degrees of freedom while maintaining the full approximation order. The quadratic Powell–Sabin spline case has also been extended to the trivariate setting (Sbibih et al., 2012) and the general multivariate setting (Speleers, 2013b).

On the other hand, the construction of a normalized B-spline representation for Clough–Tocher splines is a challenging task. Originally, 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubic Clough–Tocher splines (CT3-splines) have been developed by Clough and Tocher (1965) as a tool for the finite element method. Later on, they were also applied in the area of scattered data interpolation (see, e.g., Farin, 1985; Kashyap, 1996; Mann, 1999). A normalized B-spline basis has been constructed by Speleers (2010b) for a certain subspace of the CT3-spline space. Yet, it is still an open question whether or not it is possible to construct a normalized B-spline basis for the full CT3-spline space. In this paper, we do not answer this question, but we provide a normalized B-spline basis for a slightly enlarged space, so every CT3-spline can be represented with it. We consider a 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubic spline space defined over a triangulation endowed with a Powell–Sabin refinement. The space has specific local 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      super-smoothness to mimic closely the CT3-spline space.

The paper is organized as follows. In Section 2 we review some general concepts of polynomials on triangles, we give the definition of our cubic spline space and point out its relation with the classical Clough–Tocher spline space. Section 3 covers the construction of a normalized B-spline basis and gives a geometric interpretation: we are looking for a set of triangles that contain a specific set of points. In Section 4 we consider spline surfaces and describe how control points can be defined. We also present a stable way to compute the Bézier ordinates of such a spline. Section 5 discusses some strategies to reduce the number of degrees of freedom in the proposed spline space. In particular, we detail the relation with the reduced CT3-splines developed by Speleers (2010b). Finally, in Section 6 we end with some concluding remarks.

In this section we introduce our 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubic spline space. To this end, we first recall some preliminary concepts of bivariate polynomials in Bernstein–Bézier form defined on triangles.

Let 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                         be a non-degenerate triangle. Any point P in the plane of the triangle can be uniquely expressed in terms of the barycentric coordinates 
                           τ
                           =
                           (
                           
                              
                                 τ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 τ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 τ
                              
                              
                                 3
                              
                           
                           )
                         with respect to 
                           T
                        , such that
                           
                              (2.1)
                              
                                 P
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       τ
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       τ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       τ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       τ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                         Let 
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                         denote the linear space of bivariate polynomials of total degree less than or equal to d. Any polynomial 
                           
                              
                                 p
                              
                              
                                 d
                              
                           
                           ∈
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                         defined over the triangle 
                           T
                         has a unique Bernstein–Bézier representation
                           
                              (2.2)
                              
                                 
                                    
                                       p
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 τ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       +
                                       j
                                       +
                                       k
                                       =
                                       d
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 τ
                                 )
                                 ,
                              
                           
                         with
                           
                              (2.3)
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 τ
                                 )
                                 =
                                 
                                    
                                       d
                                       !
                                    
                                    
                                       i
                                       !
                                       j
                                       !
                                       k
                                       !
                                    
                                 
                                 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         the Bernstein polynomials of degree d, which form a convex partition of unity on 
                           T
                        . The coefficients 
                           
                              
                                 b
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         are called Bézier ordinates, and the Bézier domain points 
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         are defined as the points with barycentric coordinates 
                           (
                           
                              i
                              d
                           
                           ,
                           
                              j
                              d
                           
                           ,
                           
                              k
                              d
                           
                           )
                        . The Bernstein–Bézier representation is often visualized in a schematic way by associating each Bézier ordinate 
                           
                              
                                 b
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         with the Bézier domain point 
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        . The piecewise linear interpolant of the Bézier control points, defined as 
                           
                              
                                 b
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           =
                           (
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 i
                                 j
                                 k
                              
                           
                           )
                        , is called the Bézier control net. This control net is tangent to the polynomial surface at the three vertices. Polynomials in their Bernstein–Bézier form can be evaluated in a stable way using the de Casteljau algorithm. This algorithm can also be used to derive smoothness conditions between (the Bézier ordinates of) polynomials defined over adjacent triangles. More details can be found in the works by Farin (1986), Lai and Schumaker (2007).

The disk 
                           
                              
                                 D
                              
                              
                                 r
                              
                           
                         of radius r around vertex 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                         of 
                           T
                         is the set of domain points defined by
                           
                              (2.4)
                              
                                 
                                    
                                       D
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 {
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 :
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 d
                                 −
                                 r
                                 }
                                 .
                              
                           
                         The row 
                           
                              
                                 E
                              
                              
                                 r
                              
                           
                         at distance r parallel to edge 
                           
                              
                                 ε
                              
                              
                                 12
                              
                           
                           =
                           〈
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           〉
                         in 
                           T
                         is the set of domain points defined by
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       12
                                    
                                 
                                 )
                                 =
                                 {
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 :
                                 
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 r
                                 }
                                 .
                              
                           
                         Given a triangulation Δ, the disk 
                           
                              
                                 D
                              
                              
                                 r
                              
                           
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           )
                         in Δ is defined as the set of all domain points in (2.4) for each triangle in Δ having 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                         as a vertex. A row in Δ is defined in a similar way. Hereinafter, if we refer to a Bézier ordinate in a disk or on a row, then we actually mean a Bézier ordinate whose corresponding domain point is in that location.

Let Ω be a closed polygonal domain in 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         and let Δ be a triangulation of Ω. We denote by 
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 n
                              
                              
                                 t
                              
                           
                         and 
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                         the number of vertices, triangles and edges in Δ, respectively. The vertices 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        , in Δ have as Cartesian coordinates 
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        .

A Clough–Tocher (CT-) refinement 
                           
                              
                                 Δ
                              
                              
                                 CT
                              
                           
                         of Δ partitions all triangles in Δ into three smaller triangles (Clough and Tocher, 1965). For each triangle 
                           T
                        , a split point Z is chosen in the interior of 
                           T
                         and it is connected to the three vertices of 
                           T
                         by straight lines (see Fig. 1
                        (left)). The space of piecewise cubic polynomials on 
                           
                              
                                 Δ
                              
                              
                                 CT
                              
                           
                         with global 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        -continuity will be referred to as the cubic Clough–Tocher (CT3-) spline space, i.e.,
                           
                              (2.5)
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       CT
                                    
                                 
                                 )
                                 =
                                 
                                    {
                                    s
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    Ω
                                    )
                                    :
                                    s
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                CT
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          T
                                       
                                       
                                          CT
                                       
                                    
                                    ∈
                                    
                                       
                                          Δ
                                       
                                       
                                          CT
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         The dimension of this space is equal to 
                           3
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                           +
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        . Given a single macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                         in Δ, on each of the three subtriangles the CT3-spline is a cubic polynomial that can be represented in its Bernstein–Bézier form, i.e., with 
                           d
                           =
                           3
                         in equations (2.2) and (2.3). Fig. 1(right) shows the regions inside a macro-triangle where the corresponding Bézier ordinates of a CT3-spline are related by the inherent smoothness conditions. Note that CT3-splines possess a 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         super-smoothness at the split points (see, e.g., Farin, 1986).

A Powell–Sabin (PS-) refinement 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         of Δ is the refined triangulation obtained by subdividing each triangle of Δ into six subtriangles as follows (Powell and Sabin, 1977).
                           
                              1.
                              Select a split point 
                                    
                                       
                                          Z
                                       
                                       
                                          j
                                       
                                    
                                  inside each triangle 
                                    
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    Δ
                                  and connect it to the three vertices of 
                                    
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                  by straight lines.

For each pair of triangles 
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                  and 
                                    
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                  with a common edge, connect the two points 
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                  and 
                                    
                                       
                                          Z
                                       
                                       
                                          j
                                       
                                    
                                 . If 
                                    
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                  is a boundary triangle, then also connect 
                                    
                                       
                                          Z
                                       
                                       
                                          j
                                       
                                    
                                  to an arbitrary point on each of the boundary edges.

The space of piecewise cubic polynomials on 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         with global 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        -continuity is denoted by
                           
                              (2.6)
                              
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                                 =
                                 
                                    {
                                    s
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    Ω
                                    )
                                    :
                                    s
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                PS
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          T
                                       
                                       
                                          PS
                                       
                                    
                                    ∈
                                    
                                       
                                          Δ
                                       
                                       
                                          PS
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         In this paper we focus on a particular subspace of 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                         with additional smoothness around some vertices and edges. Imposing local super-smoothness is an interesting way to reduce the dimension of the space, while maintaining the full approximation order. Let 
                           
                              
                                 Z
                              
                              
                                 PS
                              
                           
                           =
                           
                              
                                 {
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         be the set of triangle split points in 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                        , and let 
                           
                              
                                 E
                              
                              
                                 PS
                              
                           
                         be the set of all edges in 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         that connect a triangle split point 
                           
                              
                                 Z
                              
                              
                                 i
                              
                           
                         to an edge split point 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        . The space 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                         of super-smooth splines on 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         is defined by
                           
                              (2.7)
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                                 =
                                 
                                    {
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          3
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          PS
                                       
                                    
                                    )
                                    :
                                    
                                    s
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    Z
                                    )
                                    ,
                                    
                                    Z
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          PS
                                       
                                    
                                    ;
                                    
                                    s
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    ε
                                    )
                                    ,
                                    
                                    ε
                                    ∈
                                    
                                       
                                          E
                                       
                                       
                                          PS
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         Here, 
                           
                              
                                 C
                              
                              
                                 μ
                              
                           
                           (
                           Z
                           )
                         means that the polynomials on triangles in 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         sharing the vertex Z have common derivatives up to order μ at that vertex. Analogously, 
                           
                              
                                 C
                              
                              
                                 μ
                              
                           
                           (
                           ε
                           )
                         means that the polynomials on triangles in 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         sharing the edge ε have common derivatives up to order μ along that edge. The space 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                         will be referred to as the cubic Powell–Sabin (PS3-) spline space. Fig. 2(right) shows the regions inside a macro-triangle where the corresponding Bézier ordinates of a PS3-spline are related by the inherent smoothness conditions. A spline 
                           s
                           ∈
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                         can be characterized by means of the following Hermite interpolation problem. 
                           Theorem 1
                           
                              For each edge 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       m
                                    
                                 
                               
                              in Δ, let 
                              
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                               
                              be any unit vector that is not parallel to the edge. There exists a unique spline 
                              
                                 s
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ∈
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                               
                              satisfying
                              
                                 
                                    (2.8a)
                                    
                                       s
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             l
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ∂
                                             s
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             x
                                             ,
                                             l
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ∂
                                             s
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             l
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             y
                                             ,
                                             l
                                          
                                       
                                       ,
                                       
                                       l
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             v
                                          
                                       
                                       ,
                                    
                                 
                               
                              and
                              
                                 
                                    (2.8b)
                                    
                                       s
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ∂
                                             s
                                          
                                          
                                             ∂
                                             
                                                
                                                   ν
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             ν
                                             ,
                                             m
                                          
                                       
                                       ,
                                       
                                       m
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             e
                                          
                                       
                                       ,
                                    
                                 
                               
                              for a given set of 
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       x
                                       ,
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       y
                                       ,
                                       l
                                    
                                 
                                 )
                              
                              -values and 
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       ν
                                       ,
                                       m
                                    
                                 
                                 )
                              
                              -values. Hence, a PS3-spline is uniquely defined by means of its function value and first derivatives at the 
                              
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                               
                              vertices 
                              
                                 
                                    
                                       V
                                    
                                    
                                       l
                                    
                                 
                               
                              in Δ and by means of its function value and 
                              
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                              
                              -derivative at the 
                              
                                 
                                    
                                       n
                                    
                                    
                                       e
                                    
                                 
                               
                              edge split points 
                              
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                 
                               
                              in 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                              
                              .
                           

We focus on a single macro-triangle 
                                 T
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 )
                               in Δ, as shown in Fig. 2. On each of the six subtriangles, the PS3-spline s is a cubic polynomial that can be represented in its Bernstein–Bézier form. We will check that the interpolation conditions in (2.8) uniquely specify all the Bézier ordinates of s on the macro-triangle. The conditions (2.8a) determine the Bézier ordinates in the disks 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 )
                              . Because of the 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              -smoothness across the edge 
                                 〈
                                 Z
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 〉
                               and the conditions (2.8b) at the split point 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                               on the edge 
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 〉
                              , the remaining Bézier ordinates on the rows 
                                 
                                    
                                       E
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       3
                                    
                                 
                                 )
                              , 
                                 r
                                 =
                                 0
                                 ,
                                 1
                               are also uniquely defined. The same argument holds for the Bézier ordinates on the rows related to the edges 
                                 
                                    
                                       ε
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 〉
                               and 
                                 
                                    
                                       ε
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 〉
                              . Finally, the 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smoothness at the split point Z specifies the remaining Bézier ordinates in the disk 
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Z
                                 )
                              .  □

From Theorem 1 it follows that the dimension of 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                         is equal to 
                           3
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                           +
                           2
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        .

In the next theorem we show that the CT3-spline space is a subspace of the PS3-spline space. We say that the partitions 
                           
                              
                                 Δ
                              
                              
                                 CT
                              
                           
                         and 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         of the same triangulation Δ are compatible if the triangle split points 
                           
                              
                                 Z
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 t
                              
                           
                         coincide in both partitions. 
                           Theorem 2
                           
                              If the partitions 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       CT
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                               
                              are compatible, then
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             CT
                                          
                                       
                                       )
                                       ⊂
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             3
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             PS
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

It is easy to see that 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                                 ⊂
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                              , where
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             3
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             PS
                                          
                                       
                                       )
                                       =
                                       
                                          {
                                          s
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                3
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                Δ
                                             
                                             
                                                PS
                                             
                                          
                                          )
                                          :
                                          
                                          s
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          Z
                                          )
                                          ,
                                          
                                          Z
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                PS
                                             
                                          
                                          ;
                                          
                                          s
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          ε
                                          )
                                          ,
                                          
                                          ε
                                          ∈
                                          
                                             
                                                E
                                             
                                             
                                                PS
                                             
                                          
                                          }
                                       
                                       .
                                    
                                 
                               We now show that 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       CT
                                    
                                 
                                 )
                               when the partitions 
                                 
                                    
                                       Δ
                                    
                                    
                                       CT
                                    
                                 
                               and 
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                               are compatible. As already mentioned before, the CT3-splines possess a 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               super-smoothness at the split points 
                                 Z
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       PS
                                    
                                 
                              . Moreover, when a cubic spline is 
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                               across an interior edge 
                                 ε
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       PS
                                    
                                 
                              , it is a single cubic polynomial over the two adjacent subtriangles. This completes the proof.  □

Since the CT3-spline space is a subspace of the PS3-spline space, the latter space also contains cubic polynomials, and consequently has an optimal approximation order.

Another cubic subspace of 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                         with local 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         super-smoothness has been considered by Chen and Liu (2008); Lamnii et al. (2014). However, that space is not so attractive as (2.7), because the corresponding Hermite interpolation scheme involves second order derivatives and the CT3-spline space is not a subspace. Many other spline spaces with a higher order of smoothness defined on a triangulation with PS-refinement or CT-refinement can be found in the literature (see, e.g., Alfeld and Schumaker, 2002a, 2002b; Laghchim-Lahlou and Sablonnière, 1994; Lai and Schumaker, 2001, 2003, 2007; Sablonnière, 1985; Speleers, 2013a).

In this section we look for a suitable B-spline representation of 
                        s
                        (
                        x
                        ,
                        y
                        )
                        ∈
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              3
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              PS
                           
                        
                        )
                     ,
                        
                           (3.1)
                           
                              s
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 3
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    v
                                 
                              
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    v
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              +
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       e
                                    
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 2
                              
                              
                                 
                                    c
                                 
                                 
                                    k
                                    ,
                                    j
                                 
                                 
                                    e
                                 
                              
                              
                              
                                 
                                    B
                                 
                                 
                                    k
                                    ,
                                    j
                                 
                                 
                                    e
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ,
                           
                        
                      in which the basis functions 
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                           
                              v
                           
                        
                        (
                        x
                        ,
                        y
                        )
                      and 
                        
                           
                              B
                           
                           
                              k
                              ,
                              j
                           
                           
                              e
                           
                        
                        (
                        x
                        ,
                        y
                        )
                      have a local support and form a convex partition of unity. We will refer to 
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                           
                              v
                           
                        
                        (
                        x
                        ,
                        y
                        )
                      and 
                        
                           
                              B
                           
                           
                              k
                              ,
                              j
                           
                           
                              e
                           
                        
                        (
                        x
                        ,
                        y
                        )
                      as a B-spline with respect to the vertex 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      and the edge 
                        
                           
                              ε
                           
                           
                              k
                           
                        
                     , respectively.

We define the B-spline 
                           
                              
                                 B
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         with respect to the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                         as the unique solution of the interpolation problem (2.8) with all 
                           (
                           
                              
                                 f
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 x
                                 ,
                                 l
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 y
                                 ,
                                 l
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           ,
                           0
                           )
                         and with all 
                           (
                           
                              
                                 g
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 ν
                                 ,
                                 m
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           )
                        , except for 
                           m
                           =
                           k
                        , where 
                           (
                           
                              
                                 g
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 ν
                                 ,
                                 k
                              
                           
                           )
                           ≠
                           (
                           0
                           ,
                           0
                           )
                        . It is easy to prove that such a spline vanishes outside the union of the two macro-triangles adjacent to the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        .

We now focus on the macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                        , as shown in Fig. 2(left), and we assume that the points indicated in the figure have the following barycentric coordinates:
                           
                              (3.2)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    (
                                    1
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                    ,
                                    
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    0
                                    ,
                                    1
                                    ,
                                    0
                                    )
                                    ,
                                    
                                    
                                       
                                          V
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    (
                                    0
                                    ,
                                    0
                                    ,
                                    1
                                    )
                                    ,
                                    
                                    Z
                                    =
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    (
                                    0
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          23
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          32
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                    
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          13
                                       
                                    
                                    ,
                                    0
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          31
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                    
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    ,
                                    0
                                    )
                                    .
                                 
                              
                           
                         In order to specify completely the B-spline 
                           
                              
                                 B
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         related to the edge 
                           
                              
                                 ε
                              
                              
                                 3
                              
                           
                           =
                           〈
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           〉
                         
                        
                           (
                           k
                           =
                           3
                           )
                        , i.e., determining the values 
                           (
                           
                              
                                 g
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 ν
                                 ,
                                 k
                              
                           
                           )
                        , we make use of the Bernstein–Bézier representation. The corresponding Bézier ordinates are schematically represented in Fig. 3
                        . From the definition of the B-spline it follows that many of these ordinates are zero, as can be seen in the figure. Because of the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -continuity across the edge 
                           〈
                           Z
                           ,
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           〉
                        , the Bézier ordinates 
                           
                              
                                 d
                              
                              
                                 1
                              
                              
                                 e
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 2
                              
                              
                                 e
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 3
                              
                              
                                 e
                              
                           
                         can be regarded as ordinates after subdivision of a single (univariate) quadratic polynomial 
                           
                              
                                 p
                              
                              
                                 2
                              
                              
                                 e
                              
                           
                         defined on the edge segment 
                           〈
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           〉
                         given by
                           
                              (3.3)
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                         This quadratic polynomial 
                           
                              
                                 p
                              
                              
                                 2
                              
                              
                                 e
                              
                           
                         can be chosen to have the values 
                           0
                           ,
                           
                              
                                 β
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                           ,
                           0
                         as its three Bézier ordinates, for some parameter 
                           
                              
                                 β
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                        . Then, we get
                           
                              (3.4)
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 .
                              
                           
                         In a similar way, we obtain
                           
                              (3.5)
                              
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       5
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       6
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                              
                           
                         for some parameter 
                           
                              
                                 γ
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                        . The remaining ordinates are determined by the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -smoothness at the split point Z, i.e.,
                           
                              (3.6)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          7
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          8
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    )
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          9
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          10
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          13
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          11
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          12
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          23
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

In order to ensure nonnegativity, it suffices to impose that all Bézier ordinates of the B-spline 
                           
                              
                                 B
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         are nonnegative. Looking at (3.4)–(3.6), this is the case when
                           
                              (3.7)
                              
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ≥
                                 0
                                 .
                              
                           
                         The conditions in (3.7) are also necessary conditions for nonnegativity, because 
                           
                              
                                 B
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           (
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           )
                           =
                           
                              
                                 d
                              
                              
                                 2
                              
                              
                                 e
                              
                           
                           =
                           2
                           
                              
                                 λ
                              
                              
                                 12
                              
                           
                           
                              
                                 λ
                              
                              
                                 21
                              
                           
                           
                              
                                 β
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           (
                           Z
                           )
                           =
                           
                              
                                 d
                              
                              
                                 11
                              
                              
                                 e
                              
                           
                           =
                           2
                           
                              
                                 z
                              
                              
                                 1
                              
                           
                           
                              
                                 z
                              
                              
                                 2
                              
                           
                           
                              
                                 γ
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                        . Hence, we need to choose two couples of parameters 
                           (
                           
                              
                                 β
                              
                              
                                 k
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 k
                                 ,
                                 1
                              
                           
                           )
                         and 
                           (
                           
                              
                                 β
                              
                              
                                 k
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 k
                                 ,
                                 2
                              
                           
                           )
                         satisfying (3.7) in order to define two nonnegative basis functions related to the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        . Depending on the type of the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        , we choose these parameters as follows.
                           
                              1.
                              If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                  is a boundary edge:
                                    
                                       (3.8a)
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          )
                                          =
                                          (
                                          0
                                          ,
                                          1
                                          )
                                          ,
                                          
                                          and
                                          
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                          
                                          )
                                          =
                                          (
                                          1
                                          ,
                                          0
                                          )
                                          .
                                       
                                    
                                 
                              

If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                  is an interior edge, so that there is another adjacent macro-triangle 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                  and the line through the split points Z and 
                                    
                                       
                                          Z
                                       
                                       
                                          ˜
                                       
                                    
                                  intersects the edge in 
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                 :
                                    
                                       (3.8b)
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                          
                                          )
                                          =
                                          (
                                          
                                             
                                                ‖
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                          
                                          ,
                                          1
                                          )
                                          ,
                                          
                                          and
                                          
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                          
                                          )
                                          =
                                          (
                                          
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ‖
                                             
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                          
                                          ,
                                          0
                                          )
                                          .
                                       
                                    
                                 
                              

The molecule (also called 1-ring) 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         of the vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         is defined as the union of all triangles in the triangulation that contain 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        . The B-spline 
                           
                              
                                 B
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         with respect to the vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         is defined as the unique solution of the interpolation problem (2.8) with all 
                           (
                           
                              
                                 f
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 x
                                 ,
                                 l
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 y
                                 ,
                                 l
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           ,
                           0
                           )
                        , except for 
                           l
                           =
                           i
                        , where 
                           (
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 x
                                 ,
                                 i
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 y
                                 ,
                                 i
                              
                           
                           )
                           =
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 y
                              
                           
                           )
                        , and with all 
                           (
                           
                              
                                 g
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 ν
                                 ,
                                 m
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           )
                        , except for any m such that 
                           
                              
                                 ε
                              
                              
                                 m
                              
                           
                         is an edge with 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         as endpoint, where 
                           (
                           
                              
                                 g
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 ν
                                 ,
                                 m
                              
                           
                           )
                           ≠
                           (
                           0
                           ,
                           0
                           )
                        . Such a spline is zero outside the molecule of 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        .

We consider again the macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                         depicted in Fig. 2(left); the barycentric coordinates of the points in the figure are given in (3.2). Without loss of generality, we look at the Bernstein–Bézier representation of the B-spline 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         related to the vertex 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                         
                        
                           (
                           i
                           =
                           1
                           )
                        , in order to specify the values 
                           (
                           
                              
                                 g
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 ν
                                 ,
                                 m
                              
                           
                           )
                         assuming the triplet 
                           (
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 j
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 y
                              
                           
                           )
                         is given. The corresponding Bézier ordinates are schematically represented in Fig. 4
                        . In view of the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        -smoothness at the vertex 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                        , the Bézier ordinates in the neighborhood of 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                         are found as
                           
                              (3.9a)
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                       ,
                                       j
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3.9b)
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    3
                                 
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3.9c)
                              
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    3
                                 
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    3
                                 
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3.9d)
                              
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          31
                                       
                                    
                                    3
                                 
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 .
                              
                           
                         In a similar way we can compute the Bézier ordinates in the neighborhood of the vertices 
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                        . In order to satisfy the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -continuity across the edge 
                           〈
                           Z
                           ,
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           〉
                        , we take
                           
                              (3.10)
                              
                                 
                                    
                                       d
                                    
                                    
                                       5
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       6
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       10
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             12
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       11
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             12
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 .
                              
                           
                         Note that the ordinates 
                           
                              
                                 d
                              
                              
                                 2
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 5
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 10
                              
                              
                                 v
                              
                           
                         can be regarded as ordinates after subdivision of a single (univariate) quadratic polynomial 
                           
                              
                                 p
                              
                              
                                 2
                              
                              
                                 v
                              
                           
                         defined on the edge segment 
                           〈
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           〉
                        , see (3.3). This quadratic polynomial 
                           
                              
                                 p
                              
                              
                                 2
                              
                              
                                 v
                              
                           
                         has the values 
                           
                              
                                 d
                              
                              
                                 2
                              
                              
                                 v
                              
                           
                           ,
                           0
                           ,
                           0
                         as its three Bézier ordinates. A similar reasoning holds for the ordinates 
                           
                              
                                 d
                              
                              
                                 3
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 6
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 11
                              
                              
                                 v
                              
                           
                        . In the same way, in order to satisfy the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -continuity across the edge 
                           〈
                           Z
                           ,
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           〉
                        , we take
                           
                              (3.11)
                              
                                 
                                    
                                       d
                                    
                                    
                                       9
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       13
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       8
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       13
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       16
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             13
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       15
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             13
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 .
                              
                           
                         The remaining Bézier ordinates are then specified by the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -smoothness at the split point Z, i.e.,
                           
                              (3.12)
                              
                                 
                                    
                                       d
                                    
                                    
                                       7
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       12
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       13
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       14
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       13
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 .
                              
                           
                         From the Bernstein–Bézier representation depicted in Fig. 4 we notice that the B-spline 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         is 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -continuous across the edge 
                           〈
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           〉
                        .

In order to ensure nonnegativity of 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , we impose that all its Bézier ordinates are nonnegative. It is clear from (3.9)–(3.12), that this is the case when
                           
                              (3.13)
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                    
                                       d
                                    
                                    
                                       4
                                    
                                    
                                       v
                                    
                                 
                                 ≥
                                 0
                                 .
                              
                           
                         This is not only a sufficient condition, but also a necessary condition for nonnegativity. Indeed, we have 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 d
                              
                              
                                 1
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           )
                           =
                           
                              
                                 d
                              
                              
                                 10
                              
                              
                                 v
                              
                           
                           =
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                              
                              
                                 2
                              
                           
                           
                              
                                 d
                              
                              
                                 2
                              
                              
                                 v
                              
                           
                        , 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           )
                           =
                           
                              
                                 d
                              
                              
                                 16
                              
                              
                                 v
                              
                           
                           =
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       13
                                    
                                 
                              
                              
                                 2
                              
                           
                           
                              
                                 d
                              
                              
                                 4
                              
                              
                                 v
                              
                           
                        , and 
                           
                              
                                 B
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           (
                           Z
                           )
                           =
                           
                              
                                 d
                              
                              
                                 13
                              
                              
                                 v
                              
                           
                           =
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 2
                              
                           
                           
                              
                                 d
                              
                              
                                 3
                              
                              
                                 v
                              
                           
                        . If the molecule of 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                         has more than one triangle, then we have to impose conditions similar to (3.13) for each of these triangles. These conditions are always feasible and there is an infinite number of solutions. This can be proved following the same geometric construction as developed by Dierckx (1997); the details are given in the next subsection.

In this subsection we investigate for which choices of the parameters 
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 y
                              
                           
                           )
                         the basis functions form a convex partition of unity. From the definition of the B-splines (related to both the vertices and the edges) it follows that only three basis functions have a nonzero function and derivative value at the vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        . Hence, we need to satisfy
                           
                              (3.14a)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                        
                        
                           
                              (3.14b)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (3.14c)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         for 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        . By taking into account the construction of the B-splines and the choices for the edge parameters in (3.8), we easily find that the conditions (3.14) are necessary and sufficient to form a partition of unity.

We now focus on the nonnegativity of the basis functions. For each vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         we define three points 
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           =
                           (
                           
                              
                                 X
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                           )
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , and for each edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                         we define two points 
                           
                              
                                 Q
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           =
                           (
                           
                              
                                 X
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                           )
                        , 
                           j
                           =
                           1
                           ,
                           2
                        , such that
                           
                              (3.15a)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    2
                                 
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 x
                                 ,
                              
                           
                        
                        
                           
                              (3.15b)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    2
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 y
                                 ,
                              
                           
                         for any 
                           (
                           x
                           ,
                           y
                           )
                           ∈
                           Ω
                        . Hence, the points 
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 Q
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                         are the Greville points for our B-spline representation. By using the interpolation problem (2.8) and the definition of the B-splines, the Cartesian coordinates of the points 
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         can be obtained as the solution of the systems
                           
                              (3.16a)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3.16b)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                        
                        
                           
                              (3.16c)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         and
                           
                              (3.17a)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3.17b)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (3.17c)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                         We can compactly write (3.14), (3.16) and (3.17) in the following matrix notation
                           
                              (3.18)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                                
                                                   v
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         The triangle 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 1
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 2
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 3
                              
                              
                                 v
                              
                           
                           )
                         will be called the PS3-triangle with respect to the vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        .

Following the same arguments as for quadratic Powell–Sabin B-splines (Dierckx, 1997), it can be easily shown that the constraints (3.13) related to the macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                         are equivalent to the request that the following set of points are inside the triangle 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                        :
                           
                              (3.19)
                              
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 Z
                                 ,
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                         These points are the Bézier domain points in the disk 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           )
                         in 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                        , and they will be called PS3-points with respect to the vertex 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                        . Summarizing, we can state the following theorem.


                        
                           Theorem 3
                           
                              The set of B-splines 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                               
                              and 
                              
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                               
                              are nonnegative and form a partition of unity, if the parameters 
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       y
                                    
                                 
                                 )
                               
                              and 
                              
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 )
                               
                              in their definitions are constructed as follows.
                              
                                 
                                    1.
                                    
                                       For each vertex 
                                       
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                        
                                       in Δ, the parameters 
                                       
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                y
                                             
                                          
                                          )
                                       
                                       , 
                                       
                                          j
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                       
                                       , are determined by the relation 
                                       
                                          (3.18)
                                       
                                       , given a PS3-triangle 
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                             
                                                v
                                             
                                          
                                          ,
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                             
                                                v
                                             
                                          
                                          ,
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                             
                                                v
                                             
                                          
                                          )
                                        
                                       that contains all the corresponding PS3-points, i.e., the Bézier domain points in the disk 
                                       
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          )
                                        
                                       in 
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                PS
                                             
                                          
                                       
                                       .
                                    


                                       For each edge 
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                k
                                             
                                          
                                        
                                       in Δ, the parameters 
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       , 
                                       
                                          j
                                          =
                                          1
                                          ,
                                          2
                                       
                                       , are given by 
                                       
                                          (3.8)
                                       
                                       .
                                    

There are many triangles that contain all PS3-points. An appropriate choice for such triangles, as suggested by Dierckx (1997) and Speleers (2010b), is to calculate triangles of minimal area, the so-called optimal triangles. In Fig. 5
                         we illustrate the PS3-points (black bullets) and a set of optimal PS3-triangles (red triangles) for a triangulation taken from Dierckx et al. (1992). Note that such PS3-triangles are much smaller than the ones needed for quadratic Powell–Sabin B-splines and for reduced Clough–Tocher B-splines; we refer to Speleers (2010b, Fig. 5 and Fig. 6) for a comparison on the same triangulation.

Given the position of the points 
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                        , the triplets 
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 y
                              
                           
                           )
                         can be computed as follows. Referring to (2.1) and (3.18), the values 
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 3
                              
                           
                           )
                         can be interpreted as the barycentric coordinates of the vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         with respect to 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 1
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 2
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 3
                              
                              
                                 v
                              
                           
                           )
                        . From (3.18) we obtain that
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             ,
                                             3
                                          
                                       
                                    
                                    F
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             ,
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                    
                                    F
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                       
                                    
                                    F
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                       
                                    
                                    F
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             3
                                          
                                       
                                    
                                    F
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                    
                                    F
                                 
                                 ,
                              
                           
                         with
                           
                              
                                 F
                                 =
                                 
                                    |
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    |
                                 
                                 .
                              
                           
                         The triplets 
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 1
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 2
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 3
                              
                              
                                 x
                              
                           
                           )
                         and 
                           (
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 1
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 2
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 i
                                 ,
                                 3
                              
                              
                                 y
                              
                           
                           )
                         can be seen as the barycentric coordinates of the x- and y-direction with respect to 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        .

Finally, we provide an expression for the points 
                           
                              
                                 Q
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           2
                        , related to the edges 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        , 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        . By exploiting the Bernstein–Bézier representation of the B-splines and the parameter choices in (3.8), we deduce that
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    (
                                    
                                       2
                                       3
                                    
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       1
                                       3
                                    
                                    Z
                                    )
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    (
                                    
                                       2
                                       3
                                    
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       1
                                       3
                                    
                                    Z
                                    )
                                 
                                 =
                                 
                                    1
                                    3
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 Z
                                 )
                                 ,
                              
                           
                         for an edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                           =
                           〈
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           〉
                         belonging to the macro-triangle 
                           T
                         which has the split point Z. A similar reasoning can be used for 
                           
                              
                                 Q
                              
                              
                                 k
                                 ,
                                 2
                              
                              
                                 e
                              
                           
                        , and we arrive at the following expressions.
                           
                              1.
                              If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    〈
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    〉
                                  is a boundary edge, having the split point 
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                  and belonging to the macro-triangle 
                                    T
                                  which has the split point Z:
                                    
                                       (3.20a)
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          
                                             1
                                             3
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          Z
                                          )
                                          ,
                                          
                                          and
                                          
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          
                                             1
                                             3
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              

If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    〈
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    〉
                                  is an interior edge, shared between the two macro-triangles 
                                    T
                                  and 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                  having the split points Z and 
                                    
                                       
                                          Z
                                       
                                       
                                          ˜
                                       
                                    
                                 , respectively:
                                    
                                       (3.20b)
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          
                                             1
                                             3
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          Z
                                          )
                                          ,
                                          
                                          and
                                          
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          
                                             1
                                             3
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                Z
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              

In this section we describe how to define control points and we provide a stable computation of the Bézier ordinates of a spline in the form (3.1). We assume that we are dealing with B-splines that are constructed as in Theorem 3.

Referring to the PS3-spline representation (3.1) and the definition of the points 
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 Q
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                         in (3.15), we may define control points as
                           
                              (4.1)
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 )
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                              
                           
                         for 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                         and 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        . We recall that the points 
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         form the vertices of the PS3-triangles, whereas the expressions of the points 
                           
                              
                                 Q
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                         are given in (3.20). Since the PS3-spline basis forms a convex partition of unity, it follows that the graph of a spline in the form (3.1) lies inside the convex hull of the control points (4.1). The first set of control points can be considered as vertices of the triangles 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 1
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 2
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 3
                              
                              
                                 v
                              
                           
                           )
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        , which are called control triangles; the second set as vertices of the line segments 
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 c
                              
                              
                                 k
                                 ,
                                 1
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 k
                                 ,
                                 2
                              
                              
                                 e
                              
                           
                           )
                        , 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        , which are called control lines.

From the definition of the B-splines we know that
                           
                              (4.2a)
                              
                                 s
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4.2b)
                              
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       x
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4.2c)
                              
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       y
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 .
                              
                           
                         Inverting the system (4.2), and using (3.18), we find after some elementary calculations that
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 s
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 s
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 s
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                         It follows that the three control points 
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , belong to the plane tangent to the spline surface 
                           z
                           =
                           s
                           (
                           x
                           ,
                           y
                           )
                         at vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        . Thus, the control triangle 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                         is tangent to the spline surface at 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        . There is no similar tangent property for the control lines.

The Bézier ordinates of a PS3-spline in the form (3.1) can be computed in a stable way from its B-spline coefficients 
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                        . We illustrate this procedure on the macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                         shown in Fig. 2(left), and the corresponding Bézier ordinates are depicted in Fig. 6
                        . The barycentric coordinates of the points in the macro-triangle are given in (3.2).

By combining the formulas (3.9) and (4.2), we derive that the Bézier ordinates in the disk 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           )
                         only depend on the three coefficients 
                           
                              
                                 c
                              
                              
                                 1
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         with 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        :
                           
                              (4.3)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                       
                                          v
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          3
                                          ,
                                          1
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          3
                                          ,
                                          2
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          3
                                          ,
                                          3
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                       
                                          v
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                       
                                          v
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       
                                          d
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                          ,
                                          1
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                          ,
                                          3
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          3
                                       
                                       
                                          v
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           (
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 1
                                 ,
                                 3
                              
                           
                           )
                        , 
                           (
                           
                              
                                 σ
                              
                              
                                 1
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 1
                                 ,
                                 3
                              
                           
                           )
                        , 
                           (
                           
                              
                                 σ
                              
                              
                                 2
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 2
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 2
                                 ,
                                 3
                              
                           
                           )
                         and 
                           (
                           
                              
                                 σ
                              
                              
                                 3
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 3
                                 ,
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 3
                                 ,
                                 3
                              
                           
                           )
                         are the barycentric coordinates of the PS3-points 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                        , respectively, with respect to the PS3-triangle 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Q
                              
                              
                                 1
                                 ,
                                 1
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 1
                                 ,
                                 2
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 1
                                 ,
                                 3
                              
                              
                                 v
                              
                           
                           )
                        , see (3.19). The expressions in (4.3) are convex combinations since the PS3-points are required to be inside the PS3-triangle. In a similar way we can compute 
                           (
                           
                              
                                 d
                              
                              
                                 5
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 6
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 7
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 8
                              
                           
                           )
                         and 
                           (
                           
                              
                                 d
                              
                              
                                 9
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 11
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 12
                              
                           
                           )
                         from the B-spline coefficients 
                           
                              
                                 c
                              
                              
                                 2
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 3
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                        , respectively.

The values of the Bézier ordinates 
                           
                              
                                 d
                              
                              
                                 13
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 14
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 15
                              
                           
                         are computed from the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -smoothness conditions of the PS3-spline across the edge 
                           〈
                           Z
                           ,
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           〉
                        . As we have already mentioned before, they can be regarded as ordinates after subdivision of a single (univariate) quadratic polynomial 
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                         defined on the edge segment 
                           〈
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           〉
                        , see (3.3). This quadratic polynomial 
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                         has the values 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           β
                           ,
                           
                              
                                 d
                              
                              
                                 8
                              
                           
                         as its three Bézier ordinates, where the value of β depends on the type of the edge 
                           
                              
                                 ε
                              
                              
                                 3
                              
                           
                        .
                           
                              1.
                              If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                  (
                                    k
                                    =
                                    3
                                 ) is a boundary edge, then
                                    
                                       (4.4a)
                                       
                                          β
                                          =
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                             
                                                e
                                             
                                          
                                          ,
                                       
                                    
                                  following the B-spline ordering as in (3.8a).

If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                  (
                                    k
                                    =
                                    3
                                 ) is an interior edge, then
                                    
                                       (4.4b)
                                       
                                          β
                                          =
                                          
                                             
                                                ‖
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                             
                                                e
                                             
                                          
                                          +
                                          
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ‖
                                             
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                             
                                                e
                                             
                                          
                                          ,
                                       
                                    
                                  following the same notation as in (3.8b).

Finally, the Bézier ordinates 
                           
                              
                                 d
                              
                              
                                 22
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 d
                              
                              
                                 37
                              
                           
                         can be computed by exploiting the 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -smoothness at the split point Z. They can be regarded as ordinates after subdivision of a single (bivariate) quadratic polynomial 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                         defined on the triangle spanned by the points
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 Z
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 Z
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    1
                                    3
                                 
                                 Z
                                 .
                              
                           
                         The Bézier ordinates of this quadratic polynomial 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                         are given by
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       200
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       020
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       002
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       11
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       110
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       3
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       011
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       101
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       2
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 .
                              
                           
                         This results in
                           
                              (4.6)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          31
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          33
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          7
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          35
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          11
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          37
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          31
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          33
                                       
                                    
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          35
                                       
                                    
                                    ,
                                 
                              
                           
                         and
                           
                              (4.7)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          22
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          24
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                          ,
                                          1
                                       
                                       
                                          e
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          23
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          22
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          24
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          d
                                       
                                       
                                          32
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          31
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          33
                                       
                                    
                                    ,
                                 
                              
                           
                         and similar expressions for the remaining ordinates.

Only convex combinations are needed in the above computation of all Bézier ordinates of the PS3-spline in the form (3.1) starting from its spline coefficients. Evaluation or differentiation of the PS3-spline within each of the six subtriangles can then further be performed using the de Casteljau algorithm (see, e.g., Farin, 1986; Lai and Schumaker, 2007). This gives us a stable procedure to manipulate PS3-splines in its normalized B-spline representation.

More generally, if we apply the convex combinations (4.3), (4.5), (4.6) and (4.7) to the control points defined in (4.1), then we get directly the Bézier control points of the PS3-spline surface.


                        Fig. 7
                        (left) shows a PS3-spline surface obtained as a discrete least-squares fit to the function 
                           f
                           (
                           x
                           ,
                           y
                           )
                           =
                           
                              
                                 (
                                 exp
                                 ⁡
                                 
                                    (
                                    
                                       
                                          (
                                          x
                                          −
                                          0.52
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          y
                                          −
                                          0.48
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 −
                                 0.95
                                 )
                              
                              
                                 −
                                 1
                              
                           
                         on the domain 
                           Ω
                           =
                           [
                           −
                           1
                           ,
                           1
                           ]
                           ×
                           [
                           −
                           1
                           ,
                           1
                           ]
                        . The spline has been defined on the triangulation given in Fig. 5, and its Bézier control net is depicted in Fig. 7(right).

In this section we provide some strategies to reduce the number of degrees of freedom in the PS3-spline space, i.e., 
                        3
                        
                           
                              n
                           
                           
                              v
                           
                        
                        +
                        2
                        
                           
                              n
                           
                           
                              e
                           
                        
                     . First, we describe the relation with the reduced Clough–Tocher (RCT3-) spline space considered by Speleers (2010b). Then, we provide a condensation strategy that maintains the full approximation order.

In Theorem 2 we have shown that the CT3-spline space is a subspace of the PS3-spline space. In particular, the RCT3-spline space considered by Speleers (2010b) is a subspace, so we can represent all its elements in terms of the PS3-spline basis. In this subsection we investigate how we can convert an RCT3-spline in its B-spline form into the PS3-spline form (3.1). We refer to Speleers (2010b) for more details on RCT3-splines and their properties.

Let 
                           
                              
                                 s
                              
                              
                                 RCT
                              
                           
                         be an RCT3-spline in its B-spline form defined on the mesh 
                           
                              
                                 Δ
                              
                              
                                 CT
                              
                           
                        , i.e.,
                           
                              (5.1)
                              
                                 
                                    
                                       s
                                    
                                    
                                       RCT
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       RCT
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       RCT
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 .
                              
                           
                         For the conversion into the corresponding PS3-spline form, we assume that the partitions 
                           
                              
                                 Δ
                              
                              
                                 CT
                              
                           
                         and 
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                         are compatible, so that 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 CT
                              
                           
                           )
                           ⊂
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 PS
                              
                           
                           )
                        .

First, we set the PS3-triangles identical to the RCT3-triangles (see Speleers, 2010b, for details). From their construction it is clear that RCT3-triangles are always valid PS3-triangles. Indeed, focusing on the macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                         in Δ, the RCT3-triangle related to the vertex 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                         contains the points 
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                        , 
                           (
                           2
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           )
                           /
                           3
                         and 
                           (
                           2
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                           /
                           3
                        . Since both spline representations satisfy the same relations like (3.18) and (4.2), it follows that
                           
                              (5.2)
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       RCT
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 .
                              
                           
                        
                     

Let us now concentrate on the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                           =
                           〈
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           〉
                         of the macro-triangle 
                           T
                           (
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           )
                        . The RCT3-spline 
                           
                              
                                 s
                              
                              
                                 RCT
                              
                           
                         is a (single) cubic polynomial along this edge. Moreover, the directional derivative of 
                           
                              
                                 s
                              
                              
                                 RCT
                              
                           
                         in a certain direction 
                           
                              
                                 ν
                              
                              
                                 k
                              
                           
                         (not parallel to 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        ) is constrained to be a linear polynomial along the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        , i.e.,
                           
                              (5.3)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             s
                                          
                                          
                                             RCT
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ν
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             s
                                          
                                          
                                             RCT
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ν
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             s
                                          
                                          
                                             RCT
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ν
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                         These two constraints will determine the values of the coefficients 
                           
                              
                                 c
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           2
                        .

A PS3-spline is a (single) cubic polynomial along the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                         when we impose an additional 
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                         super-smoothness across the edge 
                           〈
                           Z
                           ,
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           〉
                         with Z the split point of the macro-triangle 
                           T
                        . This is achieved when the parameter β, used in the construction of the Bernstein–Bézier representation of the PS3-spline (see (4.5)), satisfies
                           
                              
                                 β
                                 =
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          21
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          12
                                       
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       8
                                    
                                 
                                 −
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       5
                                    
                                 
                                 )
                                 ,
                              
                           
                         or, equivalently,
                           
                              (5.4)
                              
                                 β
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          RCT
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          ‖
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          ‖
                                       
                                       3
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                s
                                             
                                             
                                                RCT
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                ε
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          RCT
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          ‖
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          ‖
                                       
                                       3
                                    
                                    
                                       
                                          ∂
                                          
                                             
                                                s
                                             
                                             
                                                RCT
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                ε
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                 
                                 .
                              
                           
                         We now address the constraint (5.3). For the sake of simplicity of the presentation, we will focus on a particular case of interest (see Speleers, 2010b, Example 2.2), where
                           
                              
                                 
                                    
                                       ν
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                    
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                       ‖
                                    
                                 
                                 .
                              
                           
                         It has been explained by Speleers (2010b) that this choice is favorable because the B-spline construction involves a less restrictive geometric constraint on the CT-refined triangulation. With this choice, we have
                           
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             s
                                          
                                          
                                             RCT
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ν
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       3
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             14
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             23
                                          
                                       
                                       )
                                    
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                       ‖
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             s
                                          
                                          
                                             RCT
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ν
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       3
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                       ‖
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             s
                                          
                                          
                                             RCT
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             ν
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       3
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             8
                                          
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             7
                                          
                                       
                                       )
                                    
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                       ‖
                                    
                                 
                                 ,
                              
                           
                         using the same notation for the Bézier ordinates as in Section 4.2. The constraint (5.3) implies
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       14
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       23
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       8
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       7
                                    
                                 
                                 )
                                 .
                              
                           
                         On the other hand, by the smoothness of the PS3-spline and by the relations (4.5)–(4.7), we get
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       14
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       23
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       13
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       22
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       15
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       24
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          14
                                       
                                    
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          23
                                       
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 (
                                 β
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 β
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       8
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       7
                                    
                                 
                                 )
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          14
                                       
                                    
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          23
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             12
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 2
                                 
                                    
                                       λ
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       21
                                    
                                 
                                 (
                                 β
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             21
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       8
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       7
                                    
                                 
                                 )
                                 .
                              
                           
                         Taking into account that 
                           
                              
                                 λ
                              
                              
                                 21
                              
                           
                           =
                           1
                           −
                           
                              
                                 λ
                              
                              
                                 12
                              
                           
                        , we obtain
                           
                              
                                 β
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 (
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 +
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       8
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       7
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                       ‖
                                    
                                    6
                                 
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             
                                                s
                                             
                                             
                                                RCT
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                ν
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          ∂
                                          
                                             
                                                s
                                             
                                             
                                                RCT
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                ν
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                 
                                 .
                              
                           
                         Hence,
                           
                              (5.5)
                              
                                 
                                    
                                       c
                                    
                                    
                                       k
                                       ,
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 β
                                 −
                                 
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       −
                                       Z
                                       ‖
                                    
                                    3
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ν
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ν
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             
                                                s
                                             
                                             
                                                RCT
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                ν
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          ∂
                                          
                                             
                                                s
                                             
                                             
                                                RCT
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                ν
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                 
                                 .
                              
                           
                         From the definition of β in (4.4) we can compute the value of 
                           
                              
                                 c
                              
                              
                                 k
                                 ,
                                 2
                              
                              
                                 e
                              
                           
                        , which depends on the type of the edge 
                           
                              
                                 ε
                              
                              
                                 k
                              
                           
                        .
                           
                              1.
                              If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                  is a boundary edge, then
                                    
                                       (5.6a)
                                       
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          β
                                          .
                                       
                                    
                                 
                              

If 
                                    
                                       
                                          ε
                                       
                                       
                                          k
                                       
                                    
                                  is an interior edge, then
                                    
                                       (5.6b)
                                       
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                2
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                          β
                                          −
                                          
                                             
                                                ‖
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                             
                                                ‖
                                                Z
                                                −
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                          
                                             
                                                c
                                             
                                             
                                                k
                                                ,
                                                1
                                             
                                             
                                                e
                                             
                                          
                                          =
                                          β
                                          +
                                          
                                             
                                                ‖
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                                ‖
                                             
                                             3
                                          
                                          
                                             
                                                β
                                             
                                             
                                                ν
                                             
                                          
                                          .
                                       
                                    
                                 
                              

The coefficients in (5.2) and (5.5)–(5.6) with β given in (5.4) constitute the PS3-spline representation (3.1) of the RCT3-spline 
                           
                              
                                 s
                              
                              
                                 RCT
                              
                           
                         in (5.1).

In the previous subsection we have detailed a strategy to reduce the number of degrees of freedom to 
                           3
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        . Indeed, by choosing the edge coefficients 
                           
                              
                                 c
                              
                              
                                 k
                                 ,
                                 j
                              
                              
                                 e
                              
                           
                         as in (5.5)–(5.6) with β given in (5.4), we only keep the vertex coefficients 
                           
                              
                                 c
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 v
                              
                           
                         as degrees of freedom. Unfortunately, it is known that this choice has a negative impact on the approximation order (the order is decreased by one).

We now discuss how we can reduce the number of degrees of freedom, while maintaining the full approximation order. Instead of the RCT3-spline space, we could consider the (complete) CT3-spline space. We have seen in Theorem 2 that the CT3-spline space is also a subspace of the PS3-spline space. This subspace has optimal approximation order, while its dimension is smaller, namely 
                           3
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                           +
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        . A CT3-spline is obtained by imposing an additional 
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                         super-smoothness along each edge in Δ. From Section 5.1 we know that this is achieved by requiring the condition (5.4) for each edge 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                        , 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        .

Alternatively, inspired by Kashyap (1996) and Mann (1999), the edge coefficients could be determined from the vertex coefficients by means of the following local two-step strategy, in case 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         is an interior edge of Δ.
                           
                              1.
                              Use the Hermite data at the vertices (provided by the vertex coefficients 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          v
                                       
                                    
                                 , see (4.2)) of the two triangles sharing the edge 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                  to compute a cubic polynomial by least-squares fitting (or any other approximation method with cubic precision).

Compute the coefficients 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                       
                                          e
                                       
                                    
                                  related to the edge 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                  based on this cubic polynomial such that the resulting spline has cubic precision.

In this paper we have presented a new 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubic spline space defined over a triangulation endowed with a PS-refinement. Thanks to the locally imposed 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      super-smoothness, the proposed PS3-spline space has a simple dimension formula, namely 
                        3
                        
                           
                              n
                           
                           
                              v
                           
                        
                        +
                        2
                        
                           
                              n
                           
                           
                              e
                           
                        
                     , and the space is a close extension of the classical CT3-spline space. In addition, we have constructed a normalized B-spline basis for this space. The basis functions have a local support, they are nonnegative, and they form a partition of unity. We have also described how to compute from the control points of a PS3-spline its corresponding Bézier control net in a stable way.

In the literature one finds few other normalized B-spline representations for 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      cubic splines on triangulations with a macro-structure. For example, such a representation exists for RCT3-splines (Speleers, 2010b) and for cubic PS-splines with a different super-smoothness (Lamnii et al., 2014). For the sake of convenience, the latter splines will be referred to as PS3✠-splines in the following. The proposed new cubic B-spline representation has some favorable properties with respect to the other ones.
                        
                           •
                           The full space of cubic polynomials belongs to the PS3-spline space. This is also the case for the PS3✠-spline space, whereas the RCT3-spline space only contains the full space of quadratic polynomials. This implies that PS3-splines and PS3✠-splines possess full approximation power but RCT3-splines do not.

CT3-splines (and RCT3-splines) are in the PS3-spline space (on condition that the partitions are compatible, see Theorem 2), so they can be represented in the PS3-spline form (3.1). This is not the case for the PS3✠-spline space.

The PS3 Hermite interpolation problem (see Theorem 1) only involves first derivatives, and not second derivatives like in the PS3✠-spline case. The use of higher order derivatives is not so appealing in approximation. In addition, it might simplify the construction of quasi-interpolation schemes (see, e.g., Lamnii et al., 2014; Sbibih et al., 2014; Speleers, 2015).

The construction of the PS3-spline basis involves the use of PS3-triangles. These triangles are required to contain a specific set of PS3-points (see Theorem 3). Because this constraint is less restrictive, the PS3-triangles can be chosen smaller than the corresponding triangles for RCT3-splines and PS3✠-splines. This implies that the PS3 control points will be closer to the PS3-spline surface.

We now make a comparison with the spaces 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              CT
                           
                        
                        )
                      and 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              PS
                           
                        
                        )
                     , defined in (2.5) and (2.6), respectively, and we give an outlook on the construction of a normalized B-spline basis for them.
                        
                           •
                           The space 
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       PS
                                    
                                 
                                 )
                               is an extension of the PS3-spline space, so it shares the full approximation power but it has a larger dimension, namely 
                                 3
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 4
                                 
                                    
                                       n
                                    
                                    
                                       e
                                    
                                 
                              . A normalized B-spline basis can be constructed for this space by adopting the techniques from Dierckx (1997) and Speleers (2010a, 2013a).

The space 
                                 
                                    
                                       S
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       CT
                                    
                                 
                                 )
                               is contained in the PS3-spline space (see one of the previous items). It is known that it has full approximation power, but it is not clear whether a normalized B-spline basis can be constructed or not for this space in general. Since its dimension is 
                                 3
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       e
                                    
                                 
                              , it is natural to associate three basis functions with each vertex and one basis function with each edge. For the construction of the vertex basis functions, one could follow the approach from Speleers (2010b) for RCT3-splines. It seems impossible, however, to construct a nonnegative basis function related to an interior edge with support on two macro-triangles (the triangles adjacent to the edge). This would imply that possible edge basis functions must have larger support.

Finally, in Section 5, we have provided some strategies to reduce the number of degrees of freedom in the PS3-spline space. In particular, we have shown that we can easily convert an RCT3-spline in its B-spline form (5.1) into the PS3-spline form (3.1). Note that only the condition (5.4) is required to obtain a general CT3-spline in the PS3-spline form.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the MIUR ‘Futuro in Ricerca 2013’ Programme through the project DREAMS and by the ‘Uncovering Excellence’ Programme of the University of Rome ‘Tor Vergata’ through the project DEXTEROUS.

@&#REFERENCES@&#

