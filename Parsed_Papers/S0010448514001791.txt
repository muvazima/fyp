@&#MAIN-TITLE@&#Precise gouging-free tool orientations for 5-axis CNC machining

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present an algorithm for generating optimized gouging-free tool path for 5-Axis CNC machining.


                        
                        
                           
                           We employ analysis of hyper-osculating circles that provides third order approximation of the surface.


                        
                        
                           
                           Double tangential contact between the tool and the target surface is employed to connect feasible hyper-osculating tool paths.


                        
                        
                           
                           A robust collision and gouging detection algorithm is provided.


                        
                        
                           
                           We introduce a global optimization algorithm that maximizes the geometric matching between the tool and the target surface.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Free-form surfaces

Curvature matching

Hyper-osculating circles

Third order approximation

Collision and gouging detection

@&#ABSTRACT@&#


               
               
                  We present a precise approach to the generation of optimized collision-free and gouging-free tool paths for 5-axis CNC machining of freeform NURBS surfaces using flat-end and rounded-end (bull nose) tools having cylindrical shank. To achieve high approximation quality, we employ analysis of hyper-osculating circles (HOCs) (Wang et al., 1993a,b), that have third order contact with the target surface, and lead to a locally collision-free configuration between the tool and the target surface. At locations where an HOC is not possible, we aim at a double tangential contact among the tool and the target surface, and use it as a bridge between the feasible HOC tool paths. We formulate all such possible two-contact configurations as systems of algebraic constraints and solve them. For all feasible HOCs and two-contact configurations, we perform a global optimization to find the tool path that maximizes the approximation quality of the machining, while being gouge-free and possibly satisfying constraints on the tool tilt and the tool acceleration. We demonstrate the effectiveness of our approach via several experimental results.
               
            

@&#INTRODUCTION@&#

Free-form NURBS surfaces are the de facto industry standard representation for 3D modeling and have been widely used in a variety of applications. Consequently, CNC machining of NURBS surface has been studied extensively in the past few decades. 5-axis machining, which provides two additional degrees of freedom, compared to 3-axis machining, attracted much attention due to the flexibility of 5-axis tool path planning, in contrast with the difficulties that 5-axis tool path generation entails.

There are two major technical challenges in 5-axis machining. One is how to optimally orient the tool so that it can approximate the local target surface properly. The other challenge is how to avoid collisions and gouging into the target surface, 
                        S
                     , and other check surfaces, or other surfaces of the object. Collision and gouging
                        1
                     
                     
                        1
                        We distinguish two types of interferences between the cutting tool and the surface: the local one, denoted gouging, when the tool tip penetrates the surface in the local neighborhood of the contact point, and the global one, called collision, when the conflict occurs elsewhere on the tool.
                      avoidance in 5-axis machining is more challenging compared to other applications, because the tool tip is typically in a tangential contact with 
                        S
                      at the milling contact point, denoted 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     .

Consider 5-axis machining planning using a flat end cylindrical tool, 
                        T
                     , having a bottom circle, 
                        
                           
                              C
                           
                           
                              T
                           
                        
                     , as a cutting edge.
                        2
                     
                     
                        2
                        Path planning for a bull-nose or rounded tool having a cylindrical shank can be reduced to path planning for a flat end tool by offsetting the (target) surfaces by the rounding radius of the tool.
                      For each contact point 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , two orientation degrees of freedom must be determined for 
                        T
                     , while maintaining tangential contact between 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      and 
                        S
                      at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     . One natural approach to determine the orientation degrees of freedom uses a 2nd order approximation, to examine the osculating circle of a planar section of 
                        S
                      using the plane through 
                        
                           
                              C
                           
                           
                              T
                           
                        
                     . From Meusnier’s theorem  [1], and using the two orientation degrees of freedom, one can attempt to match the curvature of 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      and this planar section of 
                        S
                      at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , which is also known as curvature matched machining   [2–7]. Curvature matched machining provides a 2nd order approximation and is a simple way to define the tool orientation, and it has been widely adapted in tool path computation. However and as a side effect of curvature matched machining, 
                        T
                      is likely to locally gouge into 
                        S
                     , near 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , because the planar section curve of 
                        S
                      typically has an increasing or decreasing curvature at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , while 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      presents a constant curvature (see Fig. 1
                     (a)).

Hyper-osculating circles (HOCs)  [8,9] alleviate this difficulty and vastly reduce the possibility of 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      gouging into 
                        S
                     . Based on a 3rd order differential analysis, HOCs share the same position, tangent direction, curvature, and curvature derivative (which is zero for a circle), with 
                        S
                     ’s planar section at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     . In other words, an HOC is an osculating circle that is located at a curvature extreme point of the planar section of 
                        S
                      and thus it resolves the local potential gouging of 
                        T
                      into 
                        S
                      (see Figs. 1(b) and  5). However, this 3rd order approximation also has a limitation. Since the HOCs should satisfy both curvature and curvature derivative constraints, typically only a limited number of candidate configurations exist. As a consequence, a hyper-osculating configuration is not always feasible, and even less so when various constraints in practical situations are imposed, e.g., angular orientation limits on the CNC machine, global collisions, etc.

To help overcome this limitation of the HOCs, we also consider cases of two-tangential contacts between 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      and 
                        S
                      (see Fig. 1(c)). Henceforth and unless otherwise stated, ‘contact’ will denote a tangential contact. The key idea of our approach is based on the fact that there always exist two-contact configurations in the local neighborhood of hyper-osculating configurations.
                        3
                     
                     
                        3
                        In fact, HOC is a singular case of a two-contact circle when the two-contact locations coalesce, as will be discussed later.
                      From this observation, we can augment the HOCs and switch to nearby two-contact configurations whenever necessary, while providing good approximation quality in terms of the curvature difference between the bottom circle and the surface section at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      and being gouging-free.

The rest of this paper is organized as follows. In Section  2, we briefly review previous related work. Section  3 introduces HOCs and establishes the algebraic conditions for two-contact configurations between 
                        T
                      and 
                        S
                     . Then, we propose a global optimization algorithm for the tool path that maximizes the approximation quality of the HOCs and the two-contact configurations. Experimental results are reported in Section  4, and the paper is concluded in Section  5.

@&#RELATED WORK@&#

Related work on 5-axis milling mostly appeared in the CAD and mechanical engineering literature (see reference works  [10,11]). There are numerous papers contributing geometric methods to freeform surface CNC machining, including multi-axis (4- and 5-axis) machining. While this work focuses on contact analysis at the tip of the tool, in 5-axis machining, side or flank milling is one method that attracted much attention. See a recent survey in  [12] on flank milling.

Numerous efforts were made to optimize the position of the tip of the tool, in 5-axis tool path planning (see, e.g.,  [13–15]). However, state-of the-art results have not yet resolved the fundamental question satisfactorily; namely, how to select the best tool size and design an optimal tool motion so that a given freeform surface can be machined with given accuracy, without gouging and in a minimal amount of time. While the optimal tool orientation is the question that this work aims to resolve, the state-of-the-art of tool orientation is curvature matched machining  [2–7], which we already showed to be problematic as it is likely to cause small gouging of 
                        T
                      into 
                        S
                     , in the neighborhood of 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     . Multi point machining (MPM)  [16–18] provides an alternative approach to compute an optimized tool orientation by positioning the tool in a manner that maximizes the number of contact points. The MPM method produces a considerable reduction in scallop heights and a wide machining strip width compared to the other conventional approaches  [18]. However, the MPM tool path computation involves a non-linear optimization and finding a gouging-free solution is not always guaranteed.

Methods that aimed to select the best tool radius for the task are known. In  [19], the surface is divided into regions that are accessible to different tool radii, by globally examining the curvature properties of the surface. That said, the tool radii being examined are predetermined. Recently, a scheme that reduces the machining time by segmenting the input surface into smaller sub-patches, called zones, was introduced  [20]. Nevertheless, no explanation was given for where to segment the surface and an optimal size of the milling tool was not considered at all.

A general key question in planning of surface machining is the selection of a proper set of curves that form a covering for 
                        S
                     , the surface to be machined. That is, when the tool traverses these covering curves, all locations of 
                        S
                      are guaranteed to be visited to within some epsilon, by 
                        T
                     . Tool path generation methods include contouring 
                        S
                      by parallel planes, use of parallel (in the domain of 
                        S
                     ) iso-parametric curves which can be chosen adaptively  [21] and the use of space filling curves  [22,23]. See  [24] for a survey on tool path generation. This work is focused on the optimal contact analysis between 
                        T
                      and 
                        S
                      along some given tool path and hence any synthesis method for tool path curves can be employed here.

Collision detection also plays a major role in 5-axis tool path planning. See  [25,26] for recent surveys on collision avoidance and simulations. While previous work includes configuration (
                        C
                     -) space analysis methods, among others, in this work, we perform the 
                        C
                     -space analysis algebraically, gaining high precision.

Another optimality question that has recently been getting more attention is the aim for different tool shapes (beyond ball-end, flat-end and bull-nose tools). The reader is referred to  [27] as an example for barrel-type tools. Examining the problem in reverse, an algorithm that looks for semi-kinematic parts of freeform objects was recently introduced in  [28] in order to directly detect large segments that can be efficiently manufactured by a single sweep of a planar (tool) profile.

Consider a 
                        
                           
                              C
                           
                           
                              3
                           
                        
                      continuous target surface 
                        S
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      and let 
                        
                           
                              S
                           
                           
                              u
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                        ,
                        
                           
                              S
                           
                           
                              v
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      and 
                        N
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      be the partial derivatives and the normal field of 
                        S
                     . Now consider one tool path in 
                        S
                     , 
                        τ
                        
                           (
                           t
                           )
                        
                        =
                        S
                        
                           (
                           u
                           
                              (
                              t
                              )
                           
                           ,
                           v
                           
                              (
                              t
                              )
                           
                           )
                        
                     , of a flat end tool 
                        T
                      with a bottom circular edge 
                        
                           
                              C
                           
                           
                              T
                           
                        
                     , and let 
                        
                           
                              P
                           
                           
                              C
                           
                        
                        =
                        τ
                        
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           )
                        
                        =
                        S
                        
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           )
                        
                      be the current contact point. Further let, 
                        
                           
                              r
                           
                           
                              T
                           
                        
                      be the radius of 
                        T
                     , 
                        
                           
                              M
                           
                           
                              T
                           
                        
                      the center point of 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      and 
                        
                           
                              Γ
                           
                           
                              
                                 
                                    C
                                 
                                 
                                    T
                                 
                              
                           
                        
                      the plane containing 
                        
                           
                              C
                           
                           
                              T
                           
                        
                     . Finally, let 
                        
                           
                              C
                           
                           
                              S
                           
                        
                        =
                        S
                        
                           (
                           u
                           ,
                           v
                           )
                        
                        ∩
                        
                           
                              Γ
                           
                           
                              
                                 
                                    C
                                 
                                 
                                    T
                                 
                              
                           
                        
                      be the intersection curve between plane 
                        
                           
                              Γ
                           
                           
                              
                                 
                                    C
                                 
                                 
                                    T
                                 
                              
                           
                        
                      and 
                        S
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     ; see Fig. 3.

Recall that while we preserve the tangential contact between 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      and 
                        S
                      at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , we also have two degrees of freedom to best adapt 
                        T
                      to 
                        S
                      by rotating and tilting the tool’s position. We denote these two angular degrees of freedom by 
                        θ
                      and 
                        ϕ
                     , respectively. Consider an ortho-normal coordinate system 
                        
                           (
                           X
                           ,
                           Y
                           ,
                           Z
                           )
                        
                      (see Fig. 3(a)–(b)), of 
                        T
                     , where 
                        X
                      is the tangent direction of 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , 
                        Y
                        =
                        
                           
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              −
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                           
                           
                              
                                 ‖
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                                 ‖
                              
                           
                        
                     , and 
                        Z
                        =
                        X
                        ×
                        Y
                     , where 
                        ×
                      denotes the cross-product of two vectors. Based on this coordinate system of 
                        T
                     , 
                        θ
                      is now defined as the angle between 
                        X
                      and the tangent direction of the tool path, 
                        
                           
                              τ
                           
                           
                              ′
                           
                        
                        
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           )
                        
                     , and similarly, the tilting angle 
                        ϕ
                      is defined as the angle between 
                        Y
                      and the unit normal vector 
                        N
                      of 
                        S
                      at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      (see Fig. 3). We limit the range of these angles to be 
                        θ
                        ∈
                        
                           [
                           0
                           ,
                           π
                           ]
                        
                      and 
                        ϕ
                        ∈
                        
                           [
                           0
                           ,
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           ]
                        
                     .

The contact configurations between 
                        T
                      and 
                        S
                      form a 
                        C
                     -space obstacle boundary. Because the gouging of 
                        T
                      into 
                        S
                      always starts at a second event of contact, say at point 
                        
                           
                              P
                           
                           
                              2
                           
                        
                        =
                        S
                        
                           (
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           )
                        
                     , this second contact point together with 
                        
                           
                              P
                           
                           
                              C
                           
                        
                        =
                        S
                        
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           )
                        
                      defines a two-contact configuration. There can be several two-contact configurations 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           )
                        
                     , typically one of which is gouging-free. However, in exceptional cases one can have multiple collision-free two-contact configurations as is shown, for example, in Fig. 2
                     . In this work, we seek a collision-free two-contact configuration in the 
                        C
                     -space of 
                        T
                     , and hence stop after one is found. Fig. 4
                     (a) shows one example of a 
                        C
                     -space obstacle boundary consisting of two-contact configurations (black curve), which divide the 
                        
                           (
                           θ
                           ,
                           ϕ
                           )
                        
                      domain into two regions, a collision-free and a gouging region.

This 
                        C
                     -space obstacle boundary of 
                        T
                      plays an important role in our algorithm. Consider a tilting degree of freedom 
                        ϕ
                      of 
                        T
                      for a fixed rotation angle 
                        
                           
                              θ
                           
                           
                              ∗
                           
                        
                     . Following Meusnier’s theorem  [1] which states that the locus of osculating circles of a surface, passing through a given point 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      and sharing the same tangent line at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , form a sphere, the radius of curvature of 
                        
                           
                              C
                           
                           
                              S
                           
                        
                      (Fig. 3(b)–(c)) at 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      is given by: 
                        
                           (1)
                           
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 ϕ
                                 )
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              cos
                              ϕ
                              .
                           
                        
                      Here 
                        
                           
                              k
                           
                           
                              n
                           
                        
                      is the normal curvature of the surface for a fixed rotation angle 
                        
                           
                              θ
                           
                           
                              ∗
                           
                        
                      and it must hold that 
                        
                           
                              1
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                           
                        
                        >
                        
                           
                              r
                           
                           
                              T
                           
                        
                     , since otherwise there is no gouging-free configuration of 
                        T
                     , for any 
                        ϕ
                        ∈
                        
                           [
                           0
                           ,
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           ]
                        
                     . Let 
                        
                           
                              ϕ
                           
                           
                              ∗
                           
                        
                      be a tilting angle for which 
                        
                           
                              r
                           
                           
                              p
                           
                        
                        
                           (
                           
                              
                                 ϕ
                              
                              
                                 ∗
                              
                           
                           )
                        
                        =
                        
                           
                              r
                           
                           
                              T
                           
                        
                     . In general, curvature matched configurations (
                        ϕ
                        =
                        
                           
                              ϕ
                           
                           
                              ∗
                           
                        
                     ) lead to some penetrations of 
                        T
                      into 
                        S
                      and thus while tilting 
                        T
                      from 
                        ϕ
                        =
                        0
                      to 
                        
                           
                              π
                           
                           
                              2
                           
                        
                     , there exists a two-contact configuration on the 
                        C
                     -space obstacle boundary at 
                        ϕ
                        =
                        
                           
                              ϕ
                           
                           
                              t
                           
                        
                        <
                        
                           
                              ϕ
                           
                           
                              ∗
                           
                        
                     , before it reaches the curvature matched configuration (see the red and yellow dots in Fig. 4(a) and the circles in Fig. 4(b) for fixed 
                        θ
                        =
                        
                           
                              θ
                           
                           
                              ∗
                           
                        
                     , which shows a curvature matched 
                        
                           
                              C
                           
                           
                              T
                           
                        
                      and a two-contact 
                        
                           
                              C
                           
                           
                              T
                           
                        
                     , respectively). Since 
                        
                           
                              r
                           
                           
                              p
                           
                        
                        
                           (
                           ϕ
                           )
                        
                      is a monotonically decreasing function for 
                        ϕ
                        ∈
                        
                           [
                           0
                           ,
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           ]
                        
                     , the difference in the radius of curvature, 
                        
                           ‖
                           
                              
                                 r
                              
                              
                                 p
                              
                           
                           
                              (
                              ϕ
                              )
                           
                           −
                           
                              
                                 r
                              
                              
                                 T
                              
                           
                           ‖
                        
                     , is minimized while being gouging-free, when 
                        ϕ
                        =
                        
                           
                              ϕ
                           
                           
                              t
                           
                        
                     . Consequently, the best collision free approximation in terms of curvature difference is realized at a two-contact configuration. On the other hand, when an HOC is feasible for a fixed rotation angle 
                        
                           
                              θ
                           
                           
                              h
                           
                        
                     , the best collision free approximation, that is, a two-contact configuration on the 
                        C
                     -space obstacle boundary, and the curvature matched configuration for this rotation angle 
                        
                           
                              θ
                           
                           
                              h
                           
                        
                      coalesce, which leads us to the following lemma: 
                        Lemma 1
                        
                           If a hyper-osculating circle (HOC) at 
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                            
                           is a collision-free configuration, 
                           
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                            
                           is on the 
                           
                              C
                           
                           -space obstacle boundary of 
                           
                              T
                           
                           .
                        


                     
                        Proof
                        From the definition of HOC, 
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                            and 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                            is locally collision-free. Hence, for arbitrary small positive real value 
                              ϵ
                           , 
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                              <
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                           , by Meusnier’s theorem. If 
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                              <
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                           , 
                              T
                            penetrates into 
                              S
                           . Therefore, and due to the monotonicity of 
                              
                                 
                                    r
                                 
                                 
                                    p
                                 
                              
                              
                                 (
                                 ϕ
                                 )
                              
                           , 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                            is on the 
                              C
                           -space obstacle boundary of 
                              T
                           .■

As is shown in Fig. 4(a), the hyper-osculating configuration (blue dot) is realized on the tangential intersection between the two-contact configuration curve (black curve) and the curvature matched configuration curve (orange curve). This shows the known geometric fact that a hyper-osculating configuration is a special type of a two-contact configuration that has two coalescing contact points. Therefore, we can treat the HOCs as a special type of two-contact configurations and can perform a global optimization for the tool path on the combined set of configurations (done in Section  3.4).

Our algorithm consists of these two key contact analysis components, HOCs and two-contact configurations. In the rest of this section, we present details of our approach to compute these two-contact components, HOCs in Sections 3.1–3.2 and two-contact configurations in Section  3.3.

Recall that the HOC possesses 3rd order contact with 
                           S
                        , i.e., the contact point 
                           
                              
                                 P
                              
                              
                                 C
                              
                           
                         is a root of multiplicity four, considering the intersection of 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                         and 
                           S
                         as two algebraic manifolds. Whereas Meusnier’s theorem gives rise to a one-parameter family of osculating circles of given radius at a general point, the hyper-osculating configuration additionally requires extremal curvature and cannot be expected to be achievable everywhere on the surface. The natural relaxation is to split this one quadruple contact point into a pair of double (tangential contact) points. The expansion of the space of admissible circles, as will be seen in Section  4, gives us sufficient freedom to cover 
                           S
                        .

In this section, we perform 3rd order contact analysis to initialize the HOCs and again emphasize their benefit of not only having higher order contact but also of being locally “one sided” and hence locally gouging-free approximations (see Fig. 5). This makes them perfect candidates for CNC machining purposes.

Given a non-umbilical point 
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                            and a tangent vector 
                              X
                            of a surface 
                              S
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                           , let 
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                            be the principal directions of 
                              S
                            at 
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                            and 
                              α
                            be the angle spanned by 
                              X
                            and 
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                            as is shown in Fig. 6
                           . There exists a unique section plane 
                              Γ
                            such that the osculating circle of the intersection curve, 
                              
                                 
                                    C
                                 
                                 
                                    S
                                 
                              
                              =
                              S
                              ∩
                              Γ
                           , has a 3rd order contact with 
                              S
                           ; see Fig. 5 and  [29, pp. 118–124], or alternatively  [8].

Our computation follows  [30], where the 3rd order invariants of a surface are classified and, using them, the intrinsic quantities, e.g., the derivative of the curvature, are computed. In particular, we exploit Lemma 11 in  [30], where the derivative of the curvature with respect to the arc-length of the intersection curve 
                              
                                 
                                    C
                                 
                                 
                                    S
                                 
                              
                            is computed using the 3rd order invariants. We define 
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             l
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       
                                          〈
                                          2
                                          
                                             
                                                S
                                             
                                             
                                                u
                                                u
                                             
                                          
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          〉
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             l
                                          
                                          
                                             v
                                          
                                       
                                       +
                                       
                                          〈
                                          2
                                          
                                             
                                                S
                                             
                                             
                                                u
                                                v
                                             
                                          
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                u
                                             
                                          
                                          〉
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             n
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       
                                          〈
                                          2
                                          
                                             
                                                S
                                             
                                             
                                                u
                                                v
                                             
                                          
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                v
                                             
                                          
                                          〉
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       
                                          
                                             n
                                          
                                          
                                             v
                                          
                                       
                                       +
                                       
                                          〈
                                          2
                                          
                                             
                                                S
                                             
                                             
                                                v
                                                v
                                             
                                          
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                v
                                             
                                          
                                          〉
                                       
                                       ,
                                    
                                 
                              
                            where 
                              
                                 〈
                                 ⋅
                                 ,
                                 ⋅
                                 〉
                              
                            denotes the inner product, 
                              l
                              =
                              
                                 〈
                                 
                                    
                                       S
                                    
                                    
                                       u
                                       u
                                    
                                 
                                 ,
                                 N
                                 〉
                              
                              ,
                              n
                              =
                              
                                 〈
                                 
                                    
                                       S
                                    
                                    
                                       v
                                       v
                                    
                                 
                                 ,
                                 N
                                 〉
                              
                            and 
                              N
                            is the unit surface normal and subscripts represent the derivatives with respect to the corresponding parameter. Then, the curvature derivative with respect to arc-length 
                              s
                            is
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             d
                                          
                                          k
                                       
                                       
                                          
                                             d
                                          
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          cos
                                          α
                                       
                                    
                                    
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             cos
                                          
                                          
                                             3
                                          
                                       
                                       α
                                       +
                                       3
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       α
                                       sin
                                       α
                                       +
                                       3
                                       
                                          
                                             I
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       α
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       α
                                       +
                                       
                                          
                                             I
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             3
                                          
                                       
                                       α
                                       +
                                       3
                                       tan
                                       ϕ
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       cos
                                       α
                                       sin
                                       α
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                            are the principal curvatures at non-umbilical point 
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                           , (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ≠
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                           ), and 
                              ϕ
                            is the tilting (or Meusnier’s) angle between the surface normal 
                              N
                            and its orthogonal projection on plane 
                              Γ
                            (see Fig. 5).

The phenomenon of uniqueness of the plane 
                              Γ
                            containing the HOC can also be observed from Eq. (3), originally Eq. (36) in  [30], where for a fixed tangent direction 
                              X
                           , the constraint on the extremal curvature (
                              
                                 d
                              
                              k
                              /
                              
                                 d
                              
                              s
                              =
                              0
                           ) is linear in 
                              tan
                              ϕ
                            and gives a one-to-one mapping between the oriented Meusnier’s angle 
                              ϕ
                            and the value of 
                              
                                 d
                              
                              k
                              /
                              
                                 d
                              
                              s
                           . We are interested in the planes (angles 
                              ϕ
                           ) where 
                              
                                 d
                              
                              k
                              /
                              
                                 d
                              
                              s
                              =
                              0
                           , i.e., 
                              
                                 
                                    C
                                 
                                 
                                    S
                                 
                              
                            has the extremal curvature and the osculating circle becomes hyper-osculating.

At a given point 
                           
                              
                                 P
                              
                              
                                 C
                              
                           
                        , using Eq. (3), a univariate discrete radial function 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                              
                           
                           
                              (
                              ϕ
                              )
                           
                         is constructed, which assigns the value of the radius of the hyper-osculating circle (“hyper-osculating radius”) to the tangent direction 
                           X
                        , determined by the Euler angle 
                           α
                         (see Fig. 6). From Meusnier’s theorem, the radial function 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                              
                           
                           
                              (
                              α
                              )
                           
                         is 
                           
                              (4)
                              
                                 
                                    
                                       r
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 cos
                                 ϕ
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          )
                                       
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   tan
                                                
                                                
                                                   2
                                                
                                             
                                             ϕ
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Here, 
                           tan
                           ϕ
                         is a function of 
                           α
                        , computed from Eq. (3) by requiring 
                           
                              d
                           
                           k
                           /
                           
                              d
                           
                           s
                           =
                           0
                        . In this way, we obtain the final formula for 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                              
                           
                           
                              (
                              α
                              )
                           
                        , 
                           
                              (5)
                              
                                 
                                    
                                       r
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          )
                                       
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              (6)
                              
                                 F
                                 =
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             cos
                                          
                                          
                                             3
                                          
                                       
                                       α
                                       +
                                       3
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             cos
                                          
                                          
                                             2
                                          
                                       
                                       α
                                       sin
                                       α
                                       +
                                       3
                                       
                                          
                                             I
                                          
                                          
                                             3
                                          
                                       
                                       cos
                                       α
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       α
                                       +
                                       
                                          
                                             I
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             sin
                                          
                                          
                                             3
                                          
                                       
                                       α
                                    
                                    
                                       3
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                cos
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                sin
                                             
                                             
                                                2
                                             
                                          
                                          α
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       cos
                                       α
                                       sin
                                       α
                                    
                                 
                                 .
                              
                           
                        
                     

Assuming the tool radius 
                           
                              
                                 r
                              
                              
                                 T
                              
                           
                         is given, we would like to identify HOCs for this radius, i.e., we have to solve 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                              
                           
                           
                              (
                              α
                              )
                           
                           =
                           ±
                           
                              
                                 r
                              
                              
                                 T
                              
                           
                         for 
                           α
                        , and obtain the (possibly multiple) “hyper-osculating tangent directions” at point 
                           
                              
                                 P
                              
                              
                                 C
                              
                           
                         (see Fig. 7
                        ).

Let us first see how many solutions we have to expect: Rationalization of Eq. (5) by substituting 
                           sin
                           α
                           =
                           2
                           t
                           /
                           
                              (
                              1
                              +
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , 
                           cos
                           α
                           =
                           
                              (
                              1
                              −
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           /
                           
                              (
                              1
                              +
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         yields that 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              t
                              )
                           
                         is a rational function of degree 16 over 
                           R
                        , which implies the upper bound 8 on the number of hyper-osculating tangent directions. Note that two different real numbers 
                           t
                         correspond to the same angle 
                           α
                        . Since the degree of the problem is greater than 4, we numerically solve constraint 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       P
                                    
                                    
                                       C
                                    
                                 
                              
                           
                           
                              (
                              α
                              )
                           
                           =
                           ±
                           
                              
                                 r
                              
                              
                                 T
                              
                           
                        .

Two-contact configurations can be formulated as a system of algebraic constraints and be solved. The solutions of these algebraic equations may contain invalid solutions that cause gouging elsewhere into 
                           S
                         (recall Fig. 4(d)). Here, we present the algebraic constraints of the two-contact configurations and introduce an efficient and accurate collision detection algorithm that facilitates the robust elimination of these invalid solutions.

For a given target surface 
                              S
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            and a fixed contact point 
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                           , we need to find a second contact point 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              =
                              S
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            and a tool orientation which is determined by rotating and tilting angles 
                              θ
                            and 
                              ϕ
                           . Recall the ortho-normal coordinate system of 
                              T
                           , 
                              
                                 (
                                 X
                                 ,
                                 Y
                                 ,
                                 Z
                                 )
                              
                            that is shown in Fig. 3(a). The 
                              X
                              ,
                              Y
                              ,
                              Z
                            axes can be parameterized using 
                              θ
                            and 
                              ϕ
                           , as 
                              X
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                              ,
                              Y
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                              ,
                              Z
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                           . We also parameterize the center of 
                              T
                            as 
                              
                                 
                                    M
                                 
                                 
                                    T
                                 
                              
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              Y
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                              +
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                           . Depending on the location of 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            in the different regions of 
                              T
                            (the bottom disk of 
                              T
                           , the shank of 
                              T
                           , or the 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            discontinuity between them—along 
                              
                                 
                                    C
                                 
                                 
                                    T
                                 
                              
                           ), we have three different algebraic conditions to handle: 
                              
                                 1.
                                 A first condition, which is the most typical case, is realized when 
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                     is also located on 
                                       
                                          
                                             C
                                          
                                          
                                             T
                                          
                                       
                                     (Fig. 8
                                    (a)). We can formulate this condition using the following algebraic constraints: 
                                       
                                          
                                             (7)
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         S
                                                         
                                                            (
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            (
                                                            θ
                                                            ,
                                                            ϕ
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (8)
                                             
                                                
                                                   〈
                                                   
                                                      (
                                                      S
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (9)
                                             
                                                
                                                   〈
                                                   
                                                      (
                                                      S
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         (
                                                         θ
                                                         ,
                                                         ϕ
                                                         )
                                                      
                                                      )
                                                   
                                                   ×
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   ,
                                                   N
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                     with 
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       θ
                                       ,
                                       ϕ
                                     as unknowns.

Eqs. (7) and (8) prescribe the condition for 
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       S
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     to be on 
                                       
                                          
                                             C
                                          
                                          
                                             T
                                          
                                       
                                    . Then, 
                                       
                                          (
                                          S
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                          −
                                          
                                             
                                                M
                                             
                                             
                                                T
                                             
                                          
                                          
                                             (
                                             θ
                                             ,
                                             ϕ
                                             )
                                          
                                          )
                                       
                                       ×
                                       Z
                                       
                                          (
                                          θ
                                          ,
                                          ϕ
                                          )
                                       
                                     in Eq. (9) denotes the tangent direction of the circle at 
                                       S
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     and Eq. (9) makes sure that the tool tip is in contact with 
                                       S
                                     at 
                                       S
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     as well.

A second condition is realized when the second contact point 
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                     is located on the bottom disk of 
                                       T
                                    , as is shown in Fig. 8(b). The algebraic constraints for this condition are as follows: 
                                       
                                          
                                             (10)
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (11)
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (12)
                                             
                                                
                                                   〈
                                                   
                                                      (
                                                      S
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                     with 
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       θ
                                       ,
                                       ϕ
                                     as unknowns.

Eqs. (10) and (11) force the bottom disk of 
                                       T
                                     to be tangential to 
                                       S
                                    . Then, Eq. (12) locates 
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       S
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     on the plane containing the bottom disk of 
                                       T
                                    .


                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       S
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     can also be located on the shank of 
                                       T
                                     (Fig. 8(c)), which leads us to the last condition for the two-contact configuration. This last condition can be formulated as follows:
                                       
                                          
                                             (13)
                                             
                                                
                                                   〈
                                                   N
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (14)
                                             
                                                
                                                   〈
                                                   
                                                      (
                                                      S
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         (
                                                         θ
                                                         ,
                                                         ϕ
                                                         )
                                                      
                                                      )
                                                   
                                                   ×
                                                   N
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   Z
                                                   
                                                      (
                                                      θ
                                                      ,
                                                      ϕ
                                                      )
                                                   
                                                   〉
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (15)
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         S
                                                         
                                                            (
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            (
                                                            θ
                                                            ,
                                                            ϕ
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            〈
                                                            S
                                                            
                                                               (
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               (
                                                               θ
                                                               ,
                                                               ϕ
                                                               )
                                                            
                                                            ,
                                                            Z
                                                            
                                                               (
                                                               θ
                                                               ,
                                                               ϕ
                                                               )
                                                            
                                                            〉
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                     with 
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       θ
                                       ,
                                       ϕ
                                     as unknowns.

Eqs. (13) and (14) force a bi-normal condition, where the two normals of the two surfaces in hand, 
                                       T
                                     and 
                                       S
                                    , are collinear. Eq. (15) constrains the distance between 
                                       S
                                     and the axis of 
                                       T
                                     to be 
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                     so that 
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                     is on the shank of 
                                       T
                                    .

Not all the two-contact configurations computed in Section  3.3.1 are valid. There are invalid solutions that cause gouging of 
                              T
                            into 
                              S
                            elsewhere. Recall Fig. 4(d) that showed an example of such invalid two-contact configurations. To eliminate these invalid solutions, we perform some collision detection tests between 
                              T
                            and 
                              S
                           , a non-trivial task because 
                              
                                 
                                    C
                                 
                                 
                                    T
                                 
                              
                              ⊂
                              T
                            is already in contact with 
                              S
                           . Furthermore, these contact configurations might cause small gouging(s) of 
                              T
                            into 
                              S
                           , for which a simple point sampling approach to collision detection cannot guarantee a gouging-free answer. To address this issue, we precisely compute the maximum penetration depth of 
                              T
                            into 
                              S
                           . The conditions for the maximum penetration can also be formulated as a set of algebraic equations, which are presented in this section. By solving these algebraic constraints we can compute the precise penetration depth, enabling a robust and accurate detection of both global collision and local gouging.

Similar to the two-contact configurations analysis, there are three cases for the maximum penetration depth to be considered. We perform the collision detection test for a fixed configuration of 
                              T
                           , in the coordinate system of 
                              T
                            (Fig. 3), where 
                              X
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                           , 
                              Y
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                           , 
                              Z
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                            becomes our 
                              x
                              ,
                              y
                              ,
                              z
                            coordinate system and the origin is at 
                              
                                 
                                    P
                                 
                                 
                                    C
                                 
                              
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 )
                              
                           . The geometry in this (transformed) canonical space will be denoted by superscript 
                              c
                           . For example, 
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       y
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       z
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 )
                              
                            denote the coefficients of 
                              S
                            and 
                              N
                            in the canonical space, respectively.

For two smooth surface regions, the maximum penetration depth is realized at the bi-normal events. Herein, the two surfaces are 
                              T
                            and 
                              S
                            (see Fig. 9
                           ) and hence these bi-normal locations can be located as follows: 
                              
                                 1.
                                 If 
                                       
                                          
                                             S
                                          
                                          
                                             c
                                          
                                       
                                     has a bi-normal location with the bottom disk of 
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    , this event can be formulated as follows: 
                                       
                                          
                                             (16)
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (17)
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                     seeking vertical normals.

If the bi-normal event occurs on the shank of 
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    , this event can be formulated as follows: 
                                       
                                          
                                             (18)
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      z
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (19)
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                −
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 

Finally, the extrema can also occur at 
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                     discontinuities or herein along the intersection curve between 
                                       
                                          
                                             S
                                          
                                          
                                             c
                                          
                                       
                                     and the self-bisector of 
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                     that emanates from 
                                       
                                          
                                             C
                                          
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    . While the self-bisector of a general freeform surface can be quite difficult to compute, herein 
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                     is a flat end tool and has a simple self-bisector emanating from 
                                       
                                          
                                             C
                                          
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                     in the shape of a cone (see Fig. 9(c)). The constraints identifying this last case are as follows: 
                                       
                                          
                                             (20)
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         u
                                                         ,
                                                         v
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         u
                                                         ,
                                                         v
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               T
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               z
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            ,
                                                            v
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             (21)
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                −
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                     Eq. (20) prescribes the intersection condition between the target surface and the self-bisector of the tool, which can be represented by the implicit equation 
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      T
                                                   
                                                
                                                −
                                                z
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       0
                                    . Then, Eq. (21) forces the tangent direction of this intersection curve to be orthogonal to the (canonical) 
                                       z
                                    -axis so that the solution maximizes the penetration depth into 
                                       
                                          
                                             S
                                          
                                          
                                             c
                                          
                                       
                                    .

For a given tool path 
                           τ
                           
                              (
                              t
                              )
                           
                           =
                           S
                           
                              (
                              u
                              
                                 (
                                 t
                                 )
                              
                              ,
                              v
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                           ,
                           
                           0
                           ≤
                           t
                           ≤
                           1
                        , we discretely compute the optimized orientations 
                           O
                           
                              (
                              t
                              )
                           
                           =
                           
                              (
                              θ
                              
                                 (
                                 t
                                 )
                              
                              ,
                              ϕ
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         for 
                           τ
                           
                              (
                              t
                              )
                           
                        . As a pre-processing step of this discrete optimization, we compute collision-free two-contact configurations and HOCs using the algebraic constraints and the collision detection algorithms that were presented in the previous sections. We sample at 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                         along the tool path and similarly sample along rotation angle 
                           θ
                           =
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           m
                        . For each such 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         pair, we compute 
                           ϕ
                           =
                           
                              
                                 ϕ
                              
                              
                                 k
                              
                           
                         that are collision-free two-contact configurations. For each 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         we also find a finite number of HOCs at 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                                 
                                    h
                                 
                              
                              )
                           
                        . These collision-free two-contact and HOC configurations create (samples of) two/one-dimensional manifolds in the three dimensional space of 
                           
                              (
                              θ
                              ,
                              ϕ
                              ,
                              t
                              )
                           
                        . We accelerate this pre-computation, which is the main bottleneck of our algorithm, by taking advantage of the coherence of the solution set. Before solving the two-contact and HOC configurations, we numerically improve the previously computed adjacent solution, and then check if the numerically improved solution is collision free. If the solution is collision free we can use it as a solution, because we assume that there exist only one collision-free two-contact or HOC.

When there is neither a two-contact configuration nor an HOC for 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        , domain 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              ,
                              ϕ
                              )
                           
                           ,
                           
                           0
                           ≤
                           ϕ
                           ≤
                           π
                         is either entirely collision-free or completely gouging. We distinguish between the two cases simply by conducting a single collision detection test at one point in the domain, say at 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . If we detect a collision we void this configuration completely and if no collision is found, we set 
                           ϕ
                         so that 
                           T
                         and 
                           S
                         have the best geometric matching. If 
                           
                              
                                 P
                              
                              
                                 C
                              
                           
                         is an elliptic (convex) point, we set 
                           ϕ
                           =
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                        , aligning 
                           T
                         along 
                           S
                        ’s normal 
                           N
                        , which is the best curvature matching we can hope for, for a convex location.

We treat these two-contact configurations and HOCs as vertices in a directional graph in 
                           
                              (
                              θ
                              ,
                              ϕ
                              ,
                              t
                              )
                           
                         space. The directional edges for the graph are defined by only connecting from 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         to 
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                         if the angular distance is within some given tolerance. The weight of each edge reflects on the curvature matching quality, measuring the difference 
                           
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          S
                                       
                                    
                                 
                              
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 ,
                                 t
                                 )
                              
                              −
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              ‖
                           
                        , where 
                           
                              
                                 r
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       S
                                    
                                 
                              
                           
                         is a radius of curvature of 
                           
                              
                                 C
                              
                              
                                 S
                              
                           
                         at 
                           
                              
                                 P
                              
                              
                                 C
                              
                           
                        .

Given this graph structure, we perform a Dijkstra  [31] search to find the shortest path between some start (
                           t
                           =
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                        ) and terminal (
                           t
                           =
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                        ) vertices. By weighing the edges in the graph following 
                           
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          S
                                       
                                    
                                 
                              
                              
                                 (
                                 θ
                                 ,
                                 ϕ
                                 ,
                                 t
                                 )
                              
                              −
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              ‖
                           
                        , the shortest path globally minimizes the total curvature difference in the tool path. One can also easily embed various additional constraints into the optimization, by simply removing the vertices or edges from the graph that violate the constraint.

In this section, we present results of using the tool contact planning algorithms on several free-form surfaces. Fig. 10
                      illustrates the limitations when only HOCs are considered. In order to fairly evaluate the potential of HOCs, we computed optimized contact paths with a level set approach (see figure caption). Even then, the coverage of the surface by HOC strips is too low.

In the coming examples, the optimization algorithm computes 200 samples along the tool path and 200 samples along 
                        θ
                     , finding the best tilting angle, 
                        
                           
                              ϕ
                           
                           
                              k
                           
                        
                     , for each such 
                        
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           )
                        
                      pair and HOCs, 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 i
                              
                              
                                 h
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                              
                                 h
                              
                           
                           )
                        
                     , for each 
                        
                           
                              t
                           
                           
                              i
                           
                        
                     . All solutions for the HOCs and the two-contact configurations are computed with high numerical accuracy (10−8 in a unit-size parameter space), preventing possible tool axis oscillations due to numerical errors. Fig. 13(a) shows one example of this 
                        
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 j
                              
                           
                           )
                        
                      graph with 
                        
                           
                              ϕ
                           
                           
                              k
                           
                        
                      as the elevations. The admissible HOCs are also shown Fig. 13(a) in blue. In Fig. 13(b), the optimal path, computed using the Dijkstra search over this graph and taking into account collision detection and constraints etc., is presented in green.

The graph search example shown in Fig. 13 is for the cyan tool path shown in Fig. 11
                     (a) and (b). Fig. 11(a) shows the tool path used for this biquintic surface, where 99 isoparametric curves are used as the tool path. Fig. 11(b) shows several tool positions along the cyan curve in (a) where a blue 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      denotes an HOC contact and a green 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      depicts a two-contact case with 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      as the second contact location in magenta. Fig. 11(c) presents the resulting machined surface, simulated using Moduleworks’ (www.moduleworks.com) 5-axis machining simulator.

To gain some insight into the difference between the 3rd order tool contact orientation approach proposed here in comparison to curvature-matched machining, we provide Fig. 15. The color coding in this figure hints on gouging (in red) and on under cuts (in blue), while green hints on the precise surface location. As can be seen in Fig. 15, curvature matched machining gouges into the surface, whereas the 
                        
                           
                              C
                           
                           
                              3
                           
                        
                      approach presented in this work stays in the ‘green’. The flat-end tool used here is 5% of the maximum edge-length of the bounding box.


                     Fig. 16 presents two additional surfaces that were tested using the presented algorithms under similar conditions (number of tool path curves and samples in the curves). Then, Table 1
                      shows statistics for all three surfaces, results that are fairly consistent among all three surfaces.

A careful inspection of Figs. 11(c) and 15(a) reveals a small zone where the machining quality is not in the green level. We now discuss the reason for this and a possible remedy. Fig. 12
                     (a) shows a zoom-in on the problem. In Fig. 12(b), the reason is depicted. Since we allow 
                        θ
                      to vary from zero to 
                        π
                     , it can clearly happen that at two adjacent tool contact locations, on two adjacent tool paths, one 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      will present 
                        θ
                        =
                        0
                      and the other 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      will have 
                        θ
                        =
                        π
                     . As a direct result, the region between the two adjacent tool paths is not machined! To remedy this, one can limit 
                        θ
                      to a smaller domain, avoiding the problem as is shown in Fig. 12(c) and (d).

Because the HOCs computation, in Section  3.1.1, requires a third order analysis, we assume that the input surface has at least 
                        
                           
                              C
                           
                           
                              3
                           
                        
                      continuity. Working with NURBS surfaces, when the input surface is not 
                        
                           
                              C
                           
                           
                              3
                           
                        
                     , the algorithm is applied independently to each polynomial patch only to connect the paths via the optimization algorithm introduced in 3.4. Fig. 14
                     (a)
                      shows the discontinuous HOC paths for a bicubic 
                        B
                     -spline surface and Fig. 14(b) shows the result of the optimization algorithm which combines separated HOC paths and two-contact configurations.

The proposed optimization algorithm naturally combines HOCs and two-contact configurations by treating the hyper-osculating case as a special type of the two-contact configuration, and by simply minimizing the curvature difference between 
                        T
                      and 
                        S
                     . The tool path orientations generated by the global optimization procedure tend to maintain the hyper-osculating configurations when it is accessible, and smoothly switch to nearby two-contact configurations if there is no hyper-osculating position or it is not accessible due to some constraints. All this is done while precisely analyzing and avoiding any gouging.

The assumption was, while computing HOCs, that 
                        
                           
                              P
                           
                           
                              C
                           
                        
                      is not an umbilical point. While umbilical points are typically isolated, even if 
                        S
                      contains umbilical points, the two-contact solution can always be used in the neighborhood of the umbilical location(s) and hence, no real difficulty is posed by umbilical locations.

While this work assumed a cylindrical shank for 
                        T
                     , the extension of this work to handle conical tools is quite simple. For the most part, it amounts to handling two-contacts over conical shanks. One has to add support for possible two-contact with the conical shanks, extending Eqs. (13)–(15), and add support for collision detection for conical shanks, extending Eqs. (18) and (19).

The computation cost of the presented tool paths is high and can be in hours for a whole surface 
                        S
                     . Improvements of the performance of the presented algorithms must be explored as it will clearly ease their acceptance and use.

Even though we sample the tool path, we can easily interpolate the two adjacent solutions by representing them as unit quaternions  [32]. However, the advantage of using quaternions in this context is yet to be explored.

While we ensure gouging-free arrangements at the sampled points, we can guarantee very little in between samples. The continuous collision detection processing of tool path 
                        τ
                        
                           (
                           t
                           )
                        
                     , and the continuous collision detection/tests remain a challenging task, even though some work on this continuous processing has already been done, for example in  [33].

In the present work, we considered the tool paths as input. Computing these paths as part of an optimization algorithm is left as a topic for future research. Finally, being aware of the fast progress of engineering abilities, considering a machining tool that can adaptively modify its milling radius and shape introduces an interesting area for research.

@&#ACKNOWLEDGMENTS@&#

This work was supported in part by the People Programme (Marie Curie Actions) of the European Union’s Seventh Framework Programme FP7/2007–2013/ under REA grant agreement PIAP-GA-2011-286426, and was supported in part by the Israel Science Foundation (grant No. 278/13).

@&#REFERENCES@&#

