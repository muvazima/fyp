@&#MAIN-TITLE@&#Reversible watermarking for 2D CAD engineering graphics based on improved histogram shifting

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Difference histogram shifting is used for reversible watermarking of 2D CAD graphics.


                        
                        
                           
                           Difference histograms are constructed by coordinate values and phase values.


                        
                        
                           
                           Two reversible watermarking schemes are put forward for 2D CAD graphics.


                        
                        
                           
                           HS_C can obtain a good capacity, while HS_P can achieve a good robustness.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Reversible watermarking

2D CAD engineering graphics

Histogram shifting

Prediction error

@&#ABSTRACT@&#


               
               
                  According to the characteristics of the coordinates and phases in 2D CAD engineering graphics, difference histograms are constructed. Consequently, two reversible watermarking schemes based on difference histogram shifting are put forward. The first scheme HS_C implements the integer part of coordinate values to construct the adjacent difference histogram and hides messages in the peak and zero point pairs. The scheme can achieve high capacity and good invisibility in the graphics with high correlated coordinates. Instead of coordinates, the second scheme HS_P adopts the integer part of the phase value as the cover data, and the watermark is embedded by shifting and modifying the difference histogram of the phase. It is robust against translation, rotation and even scaling. Experimental results show that both schemes are strictly reversible. The proposed schemes have great potential to be applied for content authentication or secret communication of 2D CAD engineering graphics.
               
            

@&#INTRODUCTION@&#

With the rapid development of digital technology and multimedia network, much attention has been paid to the information security of the data transported over the network. Among these existing security mechanisms, watermarking technology has been widely used for copyright protection, content authentication and secret communication, etc. According to the application purpose, watermarking techniques can be classified into robust watermarking and fragile watermarking. Robust watermarking is usually focused on protecting ownership, which must robustly survive after attacks, while fragile watermarking intents to authenticate integrity. 2D CAD engineering graphics is a kind of vector graphics and has its own characteristics. Unlike highly correlated multimedia data whose relative positions are fixed, the entities of graphics are independent and their elements are different. In addition, geometric information and topology information are equally important. Furthermore, there is little redundancy in 2D CAD engineering graphics. Hence watermark embedding should be more difficult compared with raster images, audio, video, etc. Recently, some works have been done to the copyright protection and content authenticity of 2D vector graphics by using digital watermarking. However, since some traditional watermarking technologies brought permanent distortion to the host, they are not suitable for 2D CAD engineering graphics, which imposes strict requirements on data integrity and authenticity due to their applications in product manufacturing, medical diagnosis and judicial authentication. Fortunately, reversible watermarking is proposed to meet the needs of these applications. Reversible watermarking is also known as lossless data hiding, and it can completely recover the original data after the watermark extraction, which has no negative effect on the availability of the original carrier  [1].

Currently, reversible watermarking has been widely investigated. Generally speaking, the basic principle of reversible watermarking relies on reversible algebraic or geometric operations, such as difference expansion  [2], lossless compression  [3] and histogram shifting  [4–10]. However, the existing methods are mainly focused on raster images  [2–8]. Histogram shifting is a typical reversible technique, which was first proposed for raster images by Z. Ni et al.  [4]. It was carried out by shifting the zero and peak point pair of an image histogram and it obtained low computational complexity and high quality of watermarked image. Thereafter, G. Xuan et al.  [5] and X. Wu  [6] proposed reversible watermarking by using histogram shifting schemes based on integer wavelet transform, and both achieved high embedding capacity and good imperceptibility. After that, histogram shifting techniques based on prediction error are put forward in  [7–9], and a reversible watermark scheme combining pre-processing operation and histogram shifting is presented in  [10]. As a result, the capacity is considerably enhanced. Since the differences between raster images and vector graphics are varied from data element to data correlation, histogram shifting techniques cannot be directly used for 2D CAD engineering graphics. In this paper, an improvement is done to  [7], and consequently two reversible watermarking schemes for 2D CAD engineering graphics are proposed.

The rest of the paper is organized as follows: related works are introduced in Section  2; introduction of histogram shifting and its improvement are presented in Section  3; the proposed reversible watermarking schemes are described in detail in Section  4; experimental results and analysis are performed in Section  5; finally, some conclusions are drawn in Section  6.

@&#RELATED WORKS@&#

(1)  Reversible watermark for vector map
                  

To our best knowledge, the first reversible data hiding scheme for 2D vector map was proposed by M. Voigt et al. in 2004  [11]. The watermark is embedded by modifying the integer discrete cosine transform (DCT) coefficient of the map coordinates in each group. However, the capacity is low and the distortion is large. After that, two reversible watermarking schemes for 2D vector maps based on difference expansion were proposed by X.T. Wang et al.  [12]. It takes the adjacent coordinates or the Manhattan distance as the cover data to embed the watermark, but it needs extra space to store the location map and the actual payload is relatively low. Since then, some improvements are made to the method in  [12]. A difference histogram-based reversible data hiding algorithm for vector maps was proposed by Y.J. Hu et al.  [13]. Each information bit is embedded into the difference of two adjacent vertices. It obtains a good embedding rate and capacity control capability, however, the distortion is large. After that, a reversible watermark scheme based on difference expansion and shifting was proposed for scalable vector graphics (SVG) by D. Wu et al.  [14]. Neither lossless compression nor mark locations are used in the scheme. Thus, the payload is enhanced and the imperceptibility is improved. Based on a composite difference expansion integer transform, a reversible watermarking algorithm was proposed in  [15]. Multi-dimension vectors are constructed from the subsection monotonicity of coordinates of curves and polygons, and a composite difference expansion integer transform is proposed and used for the multi-dimension vectors. It obtains better transparency and payload than those of the method in  [12]. After that, an improved scheme was put forward by H. Zhao et al.  [16]. The watermark is embedded into the nearest pairs of vertices sequence in the 
                        x
                      or 
                        y
                      direction instead of the pairs of neighboring vertices, which are helpful for the improvement of the capacity and the reduction of distortion. A reversible watermark algorithm with good capacity was proposed by G. Chen et al.  [17]. The watermark is embedded into the difference between the original value and its approximate counterpart obtained from prediction. It can achieve a large capacity and less distortion. In addition, several reversible watermarking schemes for vector maps were proposed by C.G. Men et al.  [18–21]. A lossless watermarking based on the global characteristic of a vector map was investigated in  [18]. The Douglas–Peucker method is used to extract the feature points and non-feature points of every polyline, and the relation model of BP neural network and singular value decomposition (SVD) are implemented for the construction of watermark information, respectively. However, it is only suitable for vector graphics with sufficient polylines. A nonlinear scrambling-based reversible watermarking for 2D vector maps was proposed in  [19]. Under the premise that the relative positions of the feature points of vector maps are consistent, the relative positions of feature points are nonlinearly scrambled. The watermark is embedded into scrambled feature points. It is robust against simplified attacks and the capacity is improved, but the distortion is large and the implementation is complex. A perception-based reversible watermarking scheme was presented in  [20]. The vertex coordinates of the noise non-sensitive regions are chosen as cover data, and the watermark is embedded by selectively modifying alternating current (AC) coefficients after the integer DCT according to the predefined threshold. The scheme had good performance in imperceptibility and robustness, but it is only suitable for vector graphics with sufficient polylines and the capacity is small. Afterwards, a recursive embedding reversible algorithm for 2D vector maps was proposed in  [21]. Highly correlated data units are selected as the cover data and its mean vertex coordinates are recursively modified to embed the watermark. It enlarges the capacity to a certain extent, but the reversibility is decreased as the recursive iterations are increased.

(2)  Reversible watermark for 2D engineering graphics
                  

Nevertheless, few works have been done on reversible watermarking for 2D engineering graphics. A reversible watermarking scheme for 2D engineering graphics was proposed by L. Li et al.  [22]. A pre-processing is done to the coordinates of line vertex pairs to enhance the correlation of the vertices, and the watermark is embedded by adopting difference expansion transform. The capacity is directly related to the number of lines and the robustness is relatively poor. Besides, some contributions have been made by us on reversible watermarking for 2D engineering graphics  [23–25]. A reversible watermarking scheme based on improved quantization index modulation (IQIM) was proposed in  [23]. Based on the IQIM, the relative amplitudes and the phases of entity vertices are both used as hosts to carry the watermark. It strikes a good balance between capacity, imperceptibility, robustness, security, and complexity. Furthermore, a reversible watermarking algorithm based on wavelet transform was proposed in  [24], log-polar mapping (LPM) and discrete wavelet transform (DWT) are done on vertices to achieve the invariance of affine transform. The watermark is embedded into the detailed coefficients by using IQIM. It obtains large capacity and good reversibility. Based on improved difference expansion (IDE), a reversible scheme for 2D CAD engineering graphics was proposed in  [25]. The encrypted watermark is embedded into the scale factor of the relative coordinates by using IDE technology. The proposed scheme has a large capacity, good invisibility and robustness.

From the above analysis, although some achievements have been made in reversible watermarking for vector graphics, there still exist some limitations in capacity and invisibility, etc. Besides, the reversible transformations used in these schemes are mainly difference expansion and its improvement. In this paper, an improvement is done to the histogram shifting technique, and two reversible watermarking schemes for 2D CAD engineering graphics are proposed.

Histogram shifting is generally used in reversible watermarking technology for raster images with high quality. Utilizing the zero or the minimum point of the histogram, the watermark is embedded into images by slightly modifying the pixel values. As stated in  [4], the conventional histogram shifting technique is described as follows:

Given a grayscale image, its histogram can be generated by accounting its pixel values. After that, the watermark embedding is accomplished by the following four steps.


                        Step  1. In the histogram, find a peak point 
                           h
                           
                              (
                              a
                              )
                           
                        , 
                           a
                           ∈
                           
                           
                              [
                              0
                              ,
                              255
                              ]
                           
                         and a minimum point 
                           h
                           
                              (
                              b
                              )
                           
                        , 
                           b
                           ∈
                           
                              [
                              0
                              ,
                              255
                              ]
                           
                        , where the minimum point corresponds to the grayscale value which has minimum or no pixels in the given image, and the peak point corresponds to the grayscale value which has the maximum number of pixels. Generally speaking, the number of peak points represents the number of pixels for watermark embedding.


                        Step  2. If 
                           h
                           
                              (
                              b
                              )
                           
                           >
                           0
                        , the coordinate (
                           i
                        , 
                           j
                        ) of these pixels and the pixel grayscale value are recorded as tag information, then set 
                           h
                           
                              (
                              b
                              )
                           
                           =
                           0
                        .


                        Step  3. The whole image is scanned in a predefined order. According to the values of 
                           a
                         and 
                           b
                        , there are two situations to be considered. If 
                           a
                           <
                           b
                        , the pixels in (
                           a
                        , 
                           b
                        ) are all shifted to the right with 1 unit, otherwise all pixels in (
                           b
                        , 
                           a
                        ) are shifted to the left with 1 unit. This means the grayscale values of these pixels are incremented or decremented by 1. Thus, the number of the pixels with grayscale value 
                           a
                           +
                           1
                         (or 
                           a
                           −
                           1
                        ) is changed to zero.


                        Step  4. The whole image is scanned again in the same order as Step  3. Once a pixel with grayscale value 
                           a
                         is found, check the value of the watermark bits for embedding. If the corresponding watermark is “1”, the pixel value is changed to 
                           a
                           +
                           1
                         (or 
                           a
                           −
                           1
                        ), otherwise, the pixel value remains intact.

For 2D CAD engineering graphics, the value of the coordinates is varied, so the overflow problem that occurs in reversible watermarking for raster images does not exist, which means that no location map is needed. However, the correlation of the data of 2D CAD engineering graphics is generally much lower than that of raster images. If the histogram shifting technique is directly used, this may result in large distortion and small watermark capacity. Hence, an improvement is made to the histogram shifting technique to make it suitable for reversible watermarking for 2D CAD engineering graphics.

2D CAD engineering graphics is composed of a variety of entities (such as points, lines, and circles), and each entity has at least one two-dimensional vertex. Generally, parts of adjacent point pairs have the same abscissa, ordinate or the same difference. Based on this hypothesis, the difference histogram shifting is proposed as follows.

The construction of the difference histogram can be described as: 
                           
                              (1)
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             ∈
                                             
                                                [
                                                2
                                                ,
                                                m
                                                ]
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           H
                           =
                           
                              {
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    h
                                 
                                 
                                    m
                                 
                              
                              }
                           
                         represents the data sequence to be processed, and 
                           D
                           =
                           
                              {
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    m
                                 
                              
                              }
                           
                         is the difference sequence generated by 
                           H
                         according to Eq. (1).

After the analysis of difference sequence 
                           D
                        , it can be found that there exist peak point and zero point in the histogram statistics. As the peak and zero point pair of histogram play important roles in the proposed algorithm, they are defined as:


                        
                           Definition 1
                           In a difference histogram, given the difference 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                               and its frequency 
                                 f
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              . 
                                 
                                    (1)
                                    If 
                                          f
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          =
                                          0
                                       , 
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                        is named as a zero point;

If 
                                          f
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          =
                                          max
                                          
                                             {
                                             f
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             ,
                                             f
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             ,
                                             …
                                             ,
                                             f
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             }
                                          
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                        is named as a peak point.

Due to the prediction error the histogram usually follows an approximate Laplace distribution  [26], zero and peak points can be always found in it. Here, the left and right zero points are represented as 
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                        , respectively, and the left and right peak points are represented as 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        , respectively. Get the histogram of difference sequence 
                           D
                        , then find the maximum point and the second largest point, and mark them as 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                         according to their positions. After that, seek the differences smaller than 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         to find the nearest zero point 
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                        , and get the nearest zero point 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                         from the differences which are larger than 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        . The specific processes of histogram shifting is described as follows: [
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                           +
                           1
                           ,
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                           −
                           1
                        ] is changed to [
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                        , 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                           −
                           2
                        ] after a left shift, thus 
                           f
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    L
                                 
                              
                              −
                              1
                              )
                           
                           =
                           0
                        ; similarly, [
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           +
                           1
                        , 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                           −
                           1
                        ] is changed to [
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           +
                           2
                        , 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                        ] after a right shift, thus 
                           f
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    R
                                 
                              
                              +
                              1
                              )
                           
                           =
                           0
                        . In this way, some spaces are put aside for watermark embedding. The shifting results are shown in Fig. 1
                         (b).

In the watermark embedding process, one bit watermark is embedded to the positions whose differences are peak points. When the watermark is “0”, the difference remains the same, otherwise, the difference is changed into the adjacent zero point. i.e., if the peak point is 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        , then the difference is decremented by “1”; if the peak point is 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        , then the difference is incremented by “1”. The results are shown in Fig. 1(c).

The watermark embedding will change the difference in [
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                           +
                           1
                        , 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                           −
                           1
                        ], [
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                           +
                           1
                        , 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                           −
                           1
                        ], and the differences around 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        . Thus, the higher the frequency of the selected peak is, the larger the watermark capacity is. The quality of watermarked data is also related to the distance between the peak point and the zero point. Generally speaking, when distance is small, the volume of the data needed to be shifted is also small, which will result in a high quality of the watermarked data.

Here, the histogram shifting technique is performed on the difference of relative coordinates and the difference of relative phases of 2D CAD engineering graphics. For convenience, the reversible watermarking based on the difference of relative coordinates is named as HS_C, while the other is named as HS_P. The flowchart of the proposed schemes is shown in Fig. 2
                     . Both HS_C and HS_P are composed of three phases: data pre-processing, watermark embedding, watermark extraction and data recovery. HS_C and HS_P are described in detail in the following.


                        Vertex traversal order: firstly, assign a pointer for the block table, then traverse the block table to get every entity recorded. For each entity, its vertex coordinates and other properties can be obtained by the pointer belong to it.

According to the vertex traversal order, all vertices extracted from a 2D CAD engineering graphics 
                           G
                         form a vertex vector 
                           V
                        , where 
                           V
                           =
                           
                              {
                              
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       1
                                       y
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       2
                                       y
                                    
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       y
                                    
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       n
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       n
                                       y
                                    
                                 
                                 )
                              
                              }
                           
                        , and 
                           
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                    x
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    i
                                    y
                                 
                              
                              )
                           
                         represent the horizontal coordinate and the vertical coordinate of the 
                           i
                        th vertex, respectively, and 
                           n
                         represents the total number of vertices. For any vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        , it can be written as a complex signal 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 V
                              
                              
                                 i
                                 x
                              
                           
                           +
                           i
                           ×
                           
                              
                                 V
                              
                              
                                 i
                                 y
                              
                           
                        .


                        
                           Definition 2
                           For a reference vertex 
                                 p
                               and any other vertex 
                                 i
                               in 
                                 V
                              , a complex signal 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       p
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          i
                                          x
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          p
                                          x
                                       
                                    
                                    )
                                 
                                 +
                                 i
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          i
                                          y
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          p
                                          y
                                       
                                    
                                    )
                                 
                               can be obtained. Here, 
                                 
                                    
                                       Λ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      p
                                                      x
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      p
                                                      y
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               is defined as amplitude, and 
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 arctan
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             p
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             p
                                             x
                                          
                                       
                                    
                                 
                               is defined as phase of 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       p
                                    
                                 
                              , respectively. For any phase 
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 
                                    
                                       Θ
                                    
                                    
                                       j
                                    
                                 
                              , the difference 
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       Θ
                                    
                                    
                                       j
                                    
                                 
                               can be defined as relative phase for 
                                 i
                               with respect to 
                                 j
                              .

(1) Calculation of relative coordinates for HS_C


                        Step  1. Traverse all vertices of the entities in the 2D CAD engineering graphics, and select the abscissa and the ordinate with minimum values as the reference vertex 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 q
                              
                           
                        , respectively.


                        Step  2. Generally speaking, the storage precision for the vertices data of 2D CAD engineering graphics is about 6–8 digits after the decimal point. In order to adapt to the needs of the histogram shifting technique, all vertex coordinates should be converted to integers. Assuming that the maximum number of digits after the decimal point is 
                           
                              
                                 S
                              
                              
                                 max
                              
                           
                        , the integer coordinates 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    I
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    I
                                 
                              
                              )
                           
                         can be calculated as follows: 
                           
                              (2)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                                )
                                             
                                             =
                                             f
                                             l
                                             o
                                             o
                                             r
                                             
                                                (
                                                
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         p
                                                         x
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         q
                                                         y
                                                      
                                                   
                                                   )
                                                
                                                ×
                                                1
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      S
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      D
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      D
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      p
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      q
                                                      y
                                                   
                                                
                                                )
                                             
                                             ×
                                             1
                                             
                                                
                                                   0
                                                
                                                
                                                   S
                                                
                                             
                                             −
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      I
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 S
                                 ≤
                                 
                                    
                                       S
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 ≠
                                 p
                                 ,
                                 q
                              
                           
                         where 
                           S
                         represents the selected digit after the decimal point, floor(
                           ⋅
                        ) represents a floor operation.


                        Step  3. For all 
                           m
                         vertices, all integer parts and the decimal part of coordinates can be calculated from step  2. Thus, the set 
                           
                              
                                 X
                              
                              
                                 I
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 I
                              
                           
                           ,
                           
                              
                                 X
                              
                              
                                 D
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 D
                              
                           
                         for relative coordinates are obtained as: 
                           
                              (3)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      I
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   D
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      D
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      D
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      I
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   D
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      D
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      D
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           m
                           =
                           n
                           −
                           2
                         (if 
                           p
                           =
                           q
                         then 
                           m
                           =
                           n
                           −
                           1
                        ).

Here, 
                           
                              
                                 X
                              
                              
                                 I
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 I
                              
                           
                         can be regarded as the carrier of HS_C scheme to perform difference histogram statistics, then the watermark can be embedded through histogram shifting and modification.

(2) Calculation of relative phase for HS_P


                        Step  1. Traverse all vertices of the entities in 2D CAD engineering graphics, and select the abscissa with minimum value as the reference vertex 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                        . Based on a secret key 
                           K
                        , randomly select another vertex 
                           
                              
                                 V
                              
                              
                                 q
                              
                           
                         as the second reference point.


                        Step  2. Calculate the phase between two reference vertices and get 
                           
                              
                                 Θ
                              
                              
                                 q
                              
                           
                           =
                           arctan
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       q
                                       y
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       p
                                       y
                                    
                                 
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       q
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       p
                                       x
                                    
                                 
                              
                           
                        
                        
                           
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    q
                                 
                              
                              ∈
                              
                                 (
                                 −
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              )
                           
                        . For any vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              ≠
                              p
                              ,
                              q
                              )
                           
                         in 
                           V
                        , calculate the amplitude and phase between 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                        , then get 
                           
                              
                                 Λ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                i
                                                x
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                p
                                                x
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                i
                                                y
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                p
                                                y
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                           =
                           arctan
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       y
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       p
                                       y
                                    
                                 
                              
                              
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       p
                                       x
                                    
                                 
                              
                           
                        
                        
                           
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 (
                                 −
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              )
                           
                        . Thus, the relative phase between 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         to 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 q
                              
                           
                         can be obtained by Eq. (4).
                           
                              (4)
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       Θ
                                    
                                    
                                       q
                                    
                                 
                                 +
                                 π
                                 ,
                                 
                                 
                                    
                                       Θ
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    2
                                    π
                                    )
                                 
                                 .
                              
                           
                        
                     


                        Step  3. For 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        , obtain the integer part 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                              
                                 ′
                                 I
                              
                           
                         and the decimal part 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                              
                                 ′
                                 D
                              
                           
                         from Eq. (5). 
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                                I
                                             
                                          
                                          =
                                          f
                                          l
                                          o
                                          o
                                          r
                                          
                                             (
                                             
                                                
                                                   Θ
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             ×
                                             1
                                             
                                                
                                                   0
                                                
                                                
                                                   S
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                                D
                                             
                                          
                                          =
                                          
                                             
                                                Θ
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ×
                                          1
                                          
                                             
                                                0
                                             
                                             
                                                S
                                             
                                          
                                          −
                                          
                                             
                                                Θ
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                                I
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In a same way, a relative integer phase set 
                           
                              
                                 Θ
                              
                              
                                 ′
                                 I
                              
                           
                           =
                           
                              {
                              
                                 
                                    Θ
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                    I
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                    I
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    m
                                 
                                 
                                    ′
                                    I
                                 
                              
                              }
                           
                         can be obtained from the vertex vector 
                           V
                        , where 
                           m
                           =
                           n
                           −
                           2
                        . The integer phase set 
                           
                              
                                 Θ
                              
                              
                                 ′
                                 I
                              
                           
                         is the cover data of the HS_P scheme.

The corresponding inverse transform is 
                           
                              
                                 (6)
                                 
                                    
                                       
                                          Θ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             Θ
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                             I
                                          
                                       
                                       +
                                       
                                          
                                             Θ
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                             D
                                          
                                       
                                       )
                                    
                                    /
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          S
                                       
                                    
                                    +
                                    
                                       
                                          Θ
                                       
                                       
                                          q
                                       
                                    
                                    −
                                    π
                                    ,
                                 
                              
                              
                                 (7)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                      x
                                                   
                                                
                                                =
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ×
                                                cos
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      p
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                      y
                                                   
                                                
                                                =
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ×
                                                sin
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      p
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

For HS_P, assuming a 2D CAD engineering graphics is translated with a distance of 
                           
                              (
                              Δ
                              x
                              ,
                              Δ
                              y
                              )
                           
                        , then 
                           
                              
                                 Θ
                              
                              
                                 q
                              
                           
                           _
                           t
                           =
                           arctan
                           
                              
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          q
                                          y
                                       
                                    
                                    +
                                    Δ
                                    y
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          p
                                          y
                                       
                                    
                                    +
                                    Δ
                                    y
                                    )
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          q
                                          x
                                       
                                    
                                    +
                                    Δ
                                    x
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          p
                                          x
                                       
                                    
                                    +
                                    Δ
                                    x
                                    )
                                 
                              
                           
                        , which is equal to 
                           
                              
                                 Θ
                              
                              
                                 q
                              
                           
                        , and so does 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                        . Thus 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         remains unchanged. As for the rotated situation, both 
                           
                              
                                 Θ
                              
                              
                                 q
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                         are rotated with an angle of 
                           θ
                        , so the difference between them is constant and relative phase 
                           
                              
                                 Θ
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 Θ
                              
                              
                                 i
                              
                           
                           −
                           
                              
                                 Θ
                              
                              
                                 q
                              
                           
                           +
                           π
                         is unchanged. Assuming an even scaling operation with a scaling factor 
                           ρ
                         is done to the watermarked graphics, it only has effect on the amplitude 
                           
                              
                                 Λ
                              
                              
                                 i
                              
                           
                        , which has no effect on relative phase. Therefore, all watermark bits can be correctly extracted. In other words, HS_P scheme is robust against translation, rotation and even scaling.


                        Step  1. Obtain all vertices of the entities in the 2D CAD engineering graphics 
                           G
                         in order, and get a 2D vertex set 
                           V
                           =
                           
                              {
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              …
                              ,
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                              }
                           
                        . Traverse the abscissa and the ordinate of 
                           V
                        , and obtain reference vertices 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 q
                              
                           
                        . The indices of the reference points are kept as secret.


                        Step  2. Calculate the relative coordinates according to the method described in Section  4.1, and get the integer set 
                           
                              
                                 X
                              
                              
                                 I
                              
                           
                         and the decimal set 
                           
                              
                                 X
                              
                              
                                 D
                              
                           
                        .


                        Step  3. For each element in the relative coordinate set 
                           
                              
                                 X
                              
                              
                                 I
                              
                           
                        , adjacent difference prediction is first done to get the difference histogram, then find the maximum point and the second largest point, and mark them as 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        , respectively. After that, seek the differences smaller than 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         to find the nearest zero point 
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                        , and get the nearest zero point 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                         from the differences which are larger than 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        . 
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                        , 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        , 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                         and 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                         are all kept as a decryption key. Generally speaking, the maximum peak point occurs at 
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           =
                           0
                        . If the second largest point fulfills 
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           >
                           0
                        , then 
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           =
                           0
                         is represented as 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        , otherwise, it is presented as 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        . For any 
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                         in [
                           
                              
                                 Z
                              
                              
                                 L
                              
                           
                        , 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                        ] and [
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        , 
                           
                              
                                 Z
                              
                              
                                 R
                              
                           
                        ], they are shifted to the left and the right with one unit, respectively, which can be described as: 
                           
                              (8)
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             1
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      L
                                                   
                                                
                                                +
                                                1
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      L
                                                   
                                                
                                                −
                                                1
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             1
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      R
                                                   
                                                
                                                +
                                                1
                                                ,
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      R
                                                   
                                                
                                                −
                                                1
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                          
                                          
                                             e
                                             l
                                             s
                                             e
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Step  4. Watermark 
                           W
                         is embedded by modifying the difference as: 
                           
                              (9)
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                    
                                       ″
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             −
                                             W
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             W
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                          
                                          
                                             e
                                             l
                                             s
                                             e
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Step  5. Restore the integer part of the relative coordinates as 
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ″
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   ″
                                                
                                             
                                             +
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                                
                                                   I
                                                
                                             
                                             ,
                                          
                                          
                                             i
                                             ∈
                                             
                                                [
                                                2
                                                ,
                                                m
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Step  6. The watermarked coordinate 
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 w
                              
                           
                         can be calculated by using 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 ′
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 D
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 p
                                 x
                              
                           
                        , as seen in Eq. (11): 
                           
                              (11)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       w
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                I
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 /
                                 1
                                 
                                    
                                       0
                                    
                                    
                                       S
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       p
                                       x
                                    
                                 
                                 .
                              
                           
                        
                     


                        Step  7. If the length of the watermark 
                           L
                         satisfies 
                           L
                           >
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                           +
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        , then the same process is done for each element of 
                           
                              
                                 Y
                              
                              
                                 I
                              
                           
                        ; Otherwise, the ordinate remains unchanged. Update the vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                              
                                 w
                              
                           
                         to the 2D CAD engineering graphics, and obtain the watermarked 2D CAD engineering graphics 
                           
                              
                                 G
                              
                              
                                 w
                              
                           
                        .

Thus, the watermark embedding process is finished. In a same way, the watermark can be embedded into the relative phase of 2D CAD engineering graphics.


                        Step  1. According to the indices of the reference points, obtain the reference vertices 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 q
                              
                           
                        , and calculate the integer set 
                           
                              
                                 X
                              
                              
                                 I
                                 ′
                              
                           
                         and the decimal set 
                           
                              
                                 X
                              
                              
                                 D
                                 ′
                              
                           
                         for all vertices.


                        Step  2. Adjacent difference prediction is performed to 
                           
                              
                                 X
                              
                              
                                 I
                                 ′
                              
                           
                        , the watermark 
                           
                              
                                 W
                              
                              
                                 ′
                              
                           
                         can be extracted and the data can be recovered as: 
                           
                              (12)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             1
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      L
                                                   
                                                
                                                ,
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      L
                                                   
                                                
                                                −
                                                2
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   L
                                                
                                             
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             +
                                             
                                                
                                                   W
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   L
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   L
                                                
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             −
                                             1
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      R
                                                   
                                                
                                                +
                                                2
                                                ,
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      R
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   R
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             −
                                             
                                                
                                                   W
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   R
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                                
                                                   w
                                                
                                             
                                             =
                                             
                                                
                                                   P
                                                
                                                
                                                   R
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   I
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                          
                                          
                                             O
                                             t
                                             h
                                             e
                                             r
                                             w
                                             i
                                             s
                                             e
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 d
                              
                              
                                 i
                              
                              
                                 w
                              
                           
                           =
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 ′
                              
                           
                           −
                           
                              
                                 x
                              
                              
                                 i
                                 −
                                 1
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 1
                              
                              
                                 I
                              
                           
                           =
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 ′
                              
                           
                        .


                        Step  3. For 
                           
                              
                                 Y
                              
                              
                                 I
                                 ′
                              
                           
                        , a same method can be used to extract the watermark and recover data. Correlation coefficients NC between the original watermark 
                           W
                         and the extracted watermark 
                           
                              
                                 W
                              
                              
                                 ′
                              
                           
                         can be calculated as: 
                           
                              (13)
                              
                                 N
                                 C
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Step  4. If 
                           N
                           C
                           =
                           1.0
                        , it means that the integrity of the 2D CAD engineering graphics is authenticated. The original vertex set 
                           V
                         can be calculated according to Eq. (11) with 
                           
                              
                                 X
                              
                              
                                 I
                              
                           
                        , 
                           
                              
                                 X
                              
                              
                                 D
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 I
                              
                           
                        , 
                           
                              
                                 Y
                              
                              
                                 D
                              
                           
                        . Update the coordinates of the vertices and recover the original 2D CAD engineering graphics 
                           G
                        . If 
                           N
                           C
                           ≠
                           1.0
                        , it indicates that the 2D CAD engineering graphics has been modified.

Thus, the watermark extraction and data recovery are finished. In a same way, the watermark can be extracted from the relative phase of 2D CAD engineering graphics.

The experiments are performed on 50 2D CAD engineering graphics in a PC with a configuration of CPU 3.0 GHz, RAM 2.0 GB, Windows XP, Visual C++6.0, DWGdirect 4.0, AutoCAD 2008 and Matlab R2010a. Here, the parameters are selected as 
                        S
                        =
                        1
                      in HS_C, and 
                        S
                        =
                        4
                      in HS_P.

Since the operating efficiency is considered as an important part of the algorithm, the timer is set at the beginning part and the end part of the program to obtain the running time. Experimental results show that the average embedding time and extracting time of 50 graphics are about 425.8 ms and 303.6 ms in HS_C, and 362.2 ms and 322.9 ms in HS_P, respectively. Most of the execution time is consumed in the extraction and update of the vertex coordinates.

Here, RMSE (Root Mean Square Error) is used to measure the distortion between the watermarked 2D CAD engineering graphics and the original engineering graphics, and it is defined as: 
                        
                           (14)
                           
                              R
                              M
                              S
                              E
                              =
                              
                                 
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 ‖
                                 V
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       w
                                    
                                 
                                 ‖
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       [
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      w
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        N
                      represents the total number of vertices, 
                        V
                      and 
                        
                           
                              V
                           
                           
                              w
                           
                        
                      are the corresponding vertices in the original 2D CAD graphics and the watermarked 2D CAD graphics.

In order to evaluate the performance of the proposed schemes HS_C and HS_P, experiments are done to analyze the quality of 2D CAD graphics and the distribution of difference histograms. The results are shown in Figs. 3 and 4
                     
                     , respectively.

As seen from Figs. 3(d) and 4(d), the distribution of prediction error histograms of G1 and G2 both can be fitted approximately to follow a Laplace distribution, and have peak points. Thus, it can provide a certain amount of space for watermark embedding. Figs. 3(e) and 4(e) are the difference histograms after shifting and modification. It can be found that the shape of the difference histogram is basically kept, but the peak values are decreased. This is mainly due to the difference of peak point transfer to adjacent ones during the watermark embedding process. Figs. 3(f) and 4(f) are the prediction error histograms of the recovered 2D CAD graphics, and they have the same shape of the difference histograms in Figs. 3(e) and 4(e), respectively, which indicate that G1 and G2 are lossless recovery.

Generally, a 2D CAD engineering graphics can be regarded as lossless recovery when 
                           
                              
                                 S
                              
                              
                                 max
                              
                           
                         (the value of 
                           
                              
                                 S
                              
                              
                                 max
                              
                           
                         is the acquired value from 6 to 8) digits after the decimal point of the recovered 2D CAD engineering graphics are the same as those of the original 2D CAD engineering graphics. The basic information of some sample 2D CAD engineering graphics and the RMSEs between the recovered 2D CAD engineering graphics and the original 2D CAD engineering graphics are listed in Table 1
                        .

It can be seen that the RMSEs of 50 recovered 2D CAD engineering graphics are varied in the range of 10−16–10−13, which can meet the needs of high data precision requirement for the vertices of 2D CAD engineering graphics. Besides, from Figs. 3 and 4, it can be seen that the watermarked 2D CAD engineering graphics have a good invisibility, and the recovered 2D CAD engineering graphics have a same visual effect as the original ones. The above analyses indicate the good reversibility of the proposed scheme.

According to the principle of the proposed schemes, the watermark is only embedded when the difference equals the peak 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         or 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        . Thus, the watermark capacity can be precisely calculated from 
                           
                              
                                 P
                              
                              
                                 L
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 R
                              
                           
                        . Here, bpv (bit per vertex) is used to measure the capacity.
                           
                              (15)
                              
                                 C
                                 a
                                 p
                                 a
                                 c
                                 i
                                 t
                                 y
                                 =
                                 
                                    (
                                    f
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             L
                                          
                                       
                                       )
                                    
                                    +
                                    f
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             R
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 /
                                 N
                                 
                                 b
                                 p
                                 v
                                 ,
                              
                           
                         where bpv represents the average number of bits that can be embedded in each vertex.

Experiments are done on 50 CAD engineering graphics. Analysis results show that the average capacity of HS_C is about 
                           0.555
                           b
                           p
                           v
                         and 
                           0.4946
                           b
                           p
                           v
                         when 
                           P
                         equals 1 and 2, respectively, and the average capacity of HS_P is about 
                           0.1762
                           b
                           p
                           v
                         when 
                           P
                         equals 4.

At the same time, experiments are done on the methods in [14,21,22] to evaluate their watermark capacity, and the results are listed in Table 2
                        .

As seen from Table 2, it can be found that the proposed reversible watermarking scheme HS_C has a larger watermark capacity than those of methods proposed by D. Wu  [14], L.J. Cao [21] and L. Li  [22], but the capacity of HS_P is relative small.

Besides, experiments are also done to analyze the relation between capacity and embedding position. As seen in Fig. 5
                        , the watermark capacity is decreased when the embedding position is backward, but it is relatively stable when 
                           S
                           >
                           3
                        . Taking graphics G1 as an example, difference histograms of horizontal ordinates under the condition of different embedding positions are shown in Fig. 6
                        . When the embedding position is shifted backward, almost all differences are just enlarged. Only the peak position except 
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           =
                           0
                         is changed, but the number of peak points remains nearly the same. From Fig. 6, it can be found that all three difference histograms’ peak values are almost the same when 
                           S
                           =
                           4
                           ,
                           5
                           ,
                           6
                        , which indicates its stability.

Experiments are done on methods in  [14,21,22] and the proposed methods to compare their invisibility, the results are listed in Table 3
                        .

As seen from Table 3, the invisibility of HS_C is better than that of methods in  [14,21,22], while the invisibility of HS_P is relatively poor. Since the HS_C algorithm deals with the abscissa value and the ordinate value directly, the variation of coordinates to one vertex is at most 
                           
                              
                                 
                                    
                                       
                                          (
                                          Δ
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          Δ
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 2
                              
                           
                           ×
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 S
                              
                           
                           
                              
                                 2
                              
                           
                        . As the phase value changes 
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 S
                              
                           
                         times by using HS_P scheme, the corresponding changed coordinates of a vertex are
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                Δ
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                Δ
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   cos
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                   −
                                                   cos
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   sin
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                   −
                                                   sin
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Λ
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    
                                       2
                                       −
                                       2
                                       cos
                                       
                                          
                                             Θ
                                          
                                          
                                             i
                                          
                                          
                                             w
                                          
                                       
                                       cos
                                       
                                          
                                             Θ
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       2
                                       sin
                                       
                                          
                                             Θ
                                          
                                          
                                             i
                                          
                                          
                                             w
                                          
                                       
                                       sin
                                       
                                          
                                             Θ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Λ
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    
                                       1
                                       −
                                       cos
                                       
                                          (
                                          1
                                          
                                             
                                                0
                                             
                                             
                                                −
                                                S
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       Λ
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    |
                                    sin
                                    
                                       (
                                       1
                                       
                                          
                                             0
                                          
                                          
                                             −
                                             S
                                          
                                       
                                       /
                                       2
                                       )
                                    
                                    |
                                 
                                 ≈
                                 
                                    
                                       Λ
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 1
                                 
                                    
                                       0
                                    
                                    
                                       −
                                       S
                                    
                                 
                              
                           
                         where 
                           
                              
                                 Λ
                              
                              
                                 i
                              
                           
                         represents the amplitude defined in Section  4.1, and it is usually much greater than 2. Thus, the distortion caused by HS_P is larger than that of HS_C after the watermark embedding.

Besides, the relation between the embedding position and RMSEs is also analyzed. As seen in Fig. 7
                        , the RMSE value is significantly reduced when the embedding position is backward. In order to guarantee a better invisibility and capacity of the proposed scheme HS_C, it is recommended to set the embedding position between 1–3.

As known to us, reversible watermarking is generally regarded as fragile watermarking and it is used for integrity authentication. Ideally, a reversible watermarking scheme should be robust against those operations which do not destroy the integrity of the graphics, such as entity rearrangement/vertex reversing, translation/rotation/even scaling. Here, the performance of integrity authentication is discussed, and some situations including entity rearrangement/vertex reversing, vertex modification/addition/deletion, format conversion and graphics translation/rotation/even scaling are considered.

For most 2D CAD engineering graphics, each entity has been allocated an individual record number during its generation. The record number can be easily changed by redrawing it without degrading the vector data’s precision. Similarly, each vertex has its own index within an entity. The order of the vertices can be reversed without introducing any distortion to the entity. According to the principle of the proposed schemes, both HS_C and HS_P can detect these kinds of operations, i.e., entity rearrangement/vertex reversing in the watermarked 2D CAD engineering graphics cannot pass the integrity authentication, because they heavily rely on the original vertex order.

Since modifications of entities will eventually impose an impact on the vertices, only vertex modification is considered. If the reference vertex is modified/deleted, the entire histogram will be significantly changed, thus the 2D CAD engineering graphics will be regarded as tampered. For other vertices, modification/addition/deletion also changes the structure of histogram, and it will lead to a failure of watermark authentication.

File format conversion is often implemented in 2D CAD engineering graphics and it has no side effect on the integrity. As for the proposed schemes, file formats such as DWG, DXF and DWS are considered. Experiments results show that file format conversion among these three types have no influence on the watermark extraction and data recovery. Thus, the format conversion between DWG, DXF and DWS can pass the integrity authentication.

For 2D CAD engineering graphics, translation/rotation/even scaling are general operations which do not destroy the integrity of them.

Experiments are also done on the samples of watermarked 2D CAD engineering graphics after translation, rotation and even scaling to evaluate the vulnerability of the proposed schemes. The NCs between the watermark extracted from 2D CAD engineering graphics after geometric operations and the original watermark are listed in Table 4
                           .

As seen from Table 4, HS_C scheme is robust against translation as normal operation, but it is very sensitive to rotation and even scaling. While for HS_P, the NCs are all 1.0, which indicates that it is robust against translation, rotation and even scaling.

In order to summarize the performance of integrity authentication, a comparison is performed between the proposed scheme and the existing methods. The results are listed in Table 5
                           .

@&#CONCLUSION@&#

In this paper, two reversible watermarking schemes for 2D CAD engineering graphics based on histogram shifting are proposed, one is HS_C and the other is HS_P. Both schemes exploit the correlation of adjacent coordinates or relative phases, and can be applied for the content authentication and secret communication. Compared to other reversible schemes which utilized the correlation of vector data, the proposed scheme HS_C exhibits some advantages such as capacity and invisibility, and HS_P can get better performance of integrity authentication on RST operations. Experimental results and analysis indicate that the proposed schemes have strict reversibility, and the watermarked 2D CAD engineering graphics can be recovered with a very high precision when it is not tampered. However, there still exist some limitations such as the sensitivity of HS_C scheme to even scaling and rotation, and the small capacity of the HS_P scheme. Our future work will be concentrated on the enhancement of the performance of authentication and capacity with multi-level embedding based on the histogram shifting technique.

@&#ACKNOWLEDGMENTS@&#

This work was supported in part by the project supported by National Natural Science Foundation of China (Grant Nos. 61370225, 61070195, 61001004), project supported by Hunan Provincial Natural Science Foundation of China (Grant No. 12JJA006), project supported by Youth Growth Plan of Hunan University (53107040055), and project supported by the Education Department Foundation of Hunan Province (Grant No. 11B002).

@&#REFERENCES@&#

