@&#MAIN-TITLE@&#Quantifying subtle locomotion phenotypes of Drosophila larvae using internal structures based on FIM images

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We extend the range of applications of the recently published FIM imaging technique.


                        
                        
                           
                           We demonstrate how to integrate internal organs into locomotion phenotyping.


                        
                        
                           
                           Rolling behavior is automatically quantified based on the trachea (located dorsal).


                        
                        
                           
                           Maximal muscle contractions are detected based on gaps between muscle fibers.


                        
                        
                           
                           Proof-of-principle: internal structures visible in FIM images can be utilized.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Neuroscience

Frustrated Total Internal Reflection (FTIR)

FTIR-based Imaging Method (FIM)

Internal organs




                     Drosophila larva

Trachea

Peristalsis

Rolling behavior

Histogram analysis

Clustering

@&#ABSTRACT@&#


               
               
                  Quantitative analysis of behavioral traits requires precise image acquisition and sophisticated image analysis to detect subtle locomotion phenotypes. In the past, we have established Frustrated Total Internal Reflection (FTIR) to improve the measurability of small animals like insects. This FTIR-based Imaging Method (FIM) results in an excellent foreground/background contrast and even internal organs and other structures are visible without any complicated imaging or labeling techniques. For example, the trachea and muscle organizations are detectable in FIM images. Here these morphological details are incorporated into phenotyping by performing cluster analysis using histogram-based statistics for the first time. We demonstrate that FIM enables the precise quantification of locomotion features namely rolling behavior or muscle contractions. Both were impossible to quantify automatically before. This approach extends the range of FIM applications by enabling advanced automatic phenotyping for particular locomotion patterns.
               
            

@&#INTRODUCTION@&#

Quantitative behavioral studies have become an integral subject of biological research [1]. Examples for crawling animals like worms, larvae, beetles or flies are Drosophila melanogaster larvae [2–5], adult flies [6–8], the nematode Caenorhabditis elegans 
                     [9–11] and planarian [12]. The possibility of automated computer-based image acquisition and motion analysis facilitates high-throughput experiments [13,14] and complex experimental constructions [15–17]. The range of extractable locomotion features and the precision of the quantitative readout depend on the image acquisition technique (i.e. the overall hardware setup) and the subsequent locomotion feature extraction (i.e. the tracking software).

@&#RELATED WORK@&#


                        Image acquisition techniques: In general, imaging of small animals can be roughly separated into three categories: camera-based setups, lens-less optical imaging methods and image-sensor-less on-chip acquisition techniques. Camera-based setups are most popular and require a sufficient illumination [18]. Thus incident or transmitted light is employed in behavioral experiments [19,20]. Recently, dark field illumination was introduced as an alternative strategy to enhance the overall contrast [21]. The on-chip optical imaging techniques utilize a complementary metal oxide semiconductor (CMOS) or charge couple device (CCD) sensor chip to measure the shadow of the animals on the image sensor (optofluidic microscope) [22,23]. Instead of using image sensors, orthogonally arranged micro-electrodes are used to measure the resistance change that indicates the presence of the animals body [24].


                        Tracking algorithms: Different tracking programs are available for different purposes. First attempts were made 15years ago by adapting a tracking program initially programmed to track cells (DIAS) [25]. Since DIAS facilitates contour based feature extraction for a single animal, even peristalsis related features could be determined based on the perimeter and length of the animal. To achieve an even more precise quantification a movable tracking stage was used to image a single animal by a microscope [26]. Others stimulate the animals using a sensory landscape [27]. Again, only a single animal is tracked at a time. For high-throughput tracking the Multi-Worm-Tracker (MWT [13]), Multianimal Gait and Track (MAGAT [21]) or the commercially available EthoVision [28] have been introduced. Collisions are not addressed by these programs leading to fragmented tracks and multiple new identities. In an alternative approach, 12 spatially separated animals are tracked in a multi-well setup [29], preventing the animals from collisions.


                        Locomotion on the level of organs: All of the above mentioned acquisition techniques and tracking algorithms utilized to describe the locomotion are based on the outer silhouette of the animals. To analyze locomotion on the level of inner organs like muscles, animals with directed green fluorescent protein (GFP) expression imaged by microscope setups must be used for visualization. For example, confocal microscopy was utilized to visualize the segmental muscles of Drosophila larvae [2] or the peristaltic contraction wave progression [30]. However, several specific locomotion features are difficult to quantify without additional information. For example, rolling behavior of Drosophila larvae cannot be quantified automatically. This stereotypic nociception response is characterized by lateral rolling in a corkscrew-like motion [31]. Currently, the absolute number of rolls needs to be counted manually [32]. Currently, quantification is done manually by roughly classifying into no rolling response (rotation angle 
                           ϕ
                           <
                           180
                           °
                        ), slight rolling (
                           180
                           °
                           ≤
                           ϕ
                           <
                           360
                           °
                        ) and corkscrew-like rolling (
                           ϕ
                           ≥
                           360
                           °
                        ) [33]. In addition, the absolute number of rolls needs to be counted by experts [32].


                        FTIR-based Imaging Method (FIM): We recently introduced FIM which utilizes Frustrated Total Internal Reflection (FTIR) to measure the contact surface of the animals on the substrate resulting in an unrivaled foreground/background contrast [34]. Because of the high contrast, even subtle differences in reflected light intensities can be measured, so that internal structures are visible without the use of microscope setups. FIM images are used in a tracking program called FIMTrack, which can be used for both high-throughput and high-resolution analyses [34].

If specific locomotion types need to be analyzed, manual quantification is still used in many studies. Especially, nearly unmeasurable locomotion types characterized by subtle structures or internal organs are often evaluated by experts.

In [34], we demonstrated the usability of FIM to quantify the locomotion in general and illustrated the visibility of inner organs by several images. However, a precise quantification of these structures has not been done.

The contribution of this paper is to demonstrate how to quantify advanced locomotion types based on internal structures visible in FIM images. Consequently, our aim is both to present a new tool for advanced locomotion phenotyping and to give a straightforward proof-of-principle that FIM recordings are sufficient for these kinds of applications. In particular, we make use of the main dorsal trachea to quantify rolling behavior (Fig. 1
                        ). We use local histograms and statistical features to classify time points in which the trachea is visible. These time points can be used to count the number of rolls, in which the animal is oriented in ventral/dorsal side up, or the overall rolling velocity.

To further emphasize the range of applications, we quantified the time points of maximal muscle contraction in a second experiment. During elongation, the gaps between muscle fibers become visible in FIM images, resulting in dark spots close to the animals contour (Fig. 2
                        ). Again, local histograms in combination with statistics are used to classify time points of maximal muscle contraction.

Since FIM is used to visualize internal organs we will give a short overview of this setup in Section 2. In Section 3, a detailed explanation is given about how to calculate rolling behavior and muscle contractions from FIM images. We have tested our algorithm using multiple videos for both applications. Results are given in Section 4 and a final conclusion is used to summarize and discuss our approach (Section 5).

A detailed explanation of FIM, as well as its applicability for small animals like larvae has been described before [34]. Here we will only give a very brief overview.

In the FIM setup, the light sources (light emitting diodes; LEDs) are mounted on the edges of the acrylic glass stage (i.e. the measuring surface). Because of the different refractive indices of acrylic glass (n
                     1) and air (n
                     
                        A
                     ), light enters the glass and is completely reflected at the glass/air boundaries as long as the reflection angle 
                        Θ
                      is above the critical angle (Fig. 3
                     ). This effect is known as total internal reflection.

Due to the different refractive indices (
                        
                           
                              n
                           
                           
                              3
                           
                        
                        >
                        
                           
                              n
                           
                           
                              2
                           
                        
                        >
                        
                           
                              n
                           
                           
                              1
                           
                        
                        >
                        
                           
                              n
                           
                           
                              A
                           
                        
                     ) light passes from the acrylic glass into the animals. Given a semi-translucent Drosophila larva, the rays of light are reflected or absorbed because of the different densities of the internal organs. Reflected rays of light with an angle below the critical angle can pass through the acrylic glass and are captured by a camera from below (i.e. Frustrated Total Internal Reflection). To prevent crawling animals from dehydration, a moist surface (generally agar) is used for behavioral experiments. Since the refractive indices of air (n
                     
                        A
                     ), acrylic glass (n
                     1), agar (n
                     2) and larvae (n
                     3) fulfill the inequality 
                        
                           
                              n
                           
                           
                              A
                           
                        
                        <
                        
                           
                              n
                           
                           
                              1
                           
                        
                        <
                        
                           
                              n
                           
                           
                              2
                           
                        
                        <
                        
                           
                              n
                           
                           
                              3
                           
                        
                     , an agar layer even enhances the sensitivity of FIM [34].

As a consequence, FIM images have an overall black background. The only bright objects are the objects of interest. Because of this high contrast sensitivity, inner structures like the gut, the proventriculus, gaps between the muscle fibers or the trachea can be seen, as long as these organs are close to the measurement surface. For example, the trachea can only be seen if the animal is in a dorsal orientation (Fig. 3, t=1,2).

@&#METHODS@&#

We have shown in [34], the visibility of internal organs in FIM recordings was demonstrated by exemplary images. A precise quantification based on these structures has not been done. Here, we demonstrate how to extend the range of readouts and applications by integrating measurements of internal organs into computer aided phenotyping. As a result, new features are available, describing the animals’ locomotion in more detail. The new features can be seen as a binary state, indicating if a specific assumption for an animal at time t is true or false. To be more concrete, we determine two motion related states:
                        
                           1.
                           The animal is located ventral side up on the tracking stage (in the case of rolling events; see Fig. 1).

The lateral muscles are contracted maximally (in the case of forward movement; see Fig. 2).

The involved image processing and computer vision can be divided into four parts: the segmentation of the region of interest, the calculation of histogram-based statistics, filtering and smoothing of these statistics, and finally, a classification step to distinguish if one of the above mentioned states is true.

Given FIM images, the segmentation is straightforward, since the animals appear as bright objects in front of an overall black background. Thus thresholding is sufficient to determine the foreground pixels, which can be done automatically using Otsu׳s thresholding [35,36]. However, given the high foreground/background contrast, a wide range of thresholds can be applied to segment the animals [34]. The animal׳s contour is calculated from the thresholded images. This contour is used to calculate a mask for the trachea and another mask to segment the gaps between the muscles.

As illustrated in Fig. 4
                        , only the inner area of the larval׳s silhouette is used as a mask to detect the trachea (named inner segmentation). The complementary outer segmentation mask is utilized to measure the gaps between lateral body muscles. This outer segmentation is additionally reduced by subtracting two circles, covering the head and the tail of the larvae (named halves in Fig. 4).

In general, segmentation is done using intersections of binary masks. Let 
                           
                              
                                 M
                              
                              
                                 f
                              
                           
                         be the mask containing the filled contour of the animal. Then, a mask 
                           
                              
                                 M
                              
                              
                                 b
                              
                           
                         containing the outer border with thickness r
                        1 is used to segment the inner region of the animals by
                           
                              (1)
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       f
                                    
                                 
                                 ∩
                                 ¬
                                 
                                    
                                       M
                                    
                                    
                                       b
                                    
                                 
                              
                           
                        where 
                           ¬
                           
                              
                                 M
                              
                              
                                 b
                              
                           
                         is the inverted outer border mask (
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         corresponds to the inner segmentation and 
                           
                              
                                 M
                              
                              
                                 b
                              
                           
                         corresponds to the outer segmentation in Fig. 4).

The head and the tail is removed by calculating the two points with maximal curvature and drawing circles with radius r
                        2 at these points in mask 
                           
                              
                                 M
                              
                              
                                 c
                              
                           
                        . The outer segmentation is then given by
                           
                              (2)
                              
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       b
                                    
                                 
                                 ∩
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 ∩
                                 ¬
                                 
                                    
                                       M
                                    
                                    
                                       c
                                    
                                 
                              
                           
                        (compare to the halves given in Fig. 4).

The parameters r
                        1 and r
                        2 have strong impact on the statistics calculated subsequently. Thus we choose both according to the per animal resolution in the test movies (see below).

In a next step, we calculate histograms of all pixels inside the masks to determine the standard deviation σ and the quantile length q
                        
                           p
                         (covering 
                           p
                           %
                         of the histogram). Since the trachea appears very bright in FIM images, we used the upper 
                           p
                           %
                         to quantify the quantile length for the trachea (called 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 +
                              
                           
                        ). The quantile length for the “muscle gaps” is defined analogously, but including only 
                           p
                           %
                         of the dark pixels (called 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 −
                              
                           
                        ) since the gaps between the muscles appear as dark blobs in FIM images. Consequently, the quantile length 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 +
                              
                           
                         is comparatively small in the case of a visible trachea. In the same way, 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 −
                              
                           
                         is small if “muscle gaps” are visible. Given frames with no visible trachea or “muscle gaps”, 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 +
                              
                           
                         or 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 −
                              
                           
                         are comparatively big (see Fig. 5
                        , upper plot).

The standard deviation is very sensitive, so that it increases with the visibility of the inner organ, leading to high standard deviation measurements. However, it is very susceptible to noise, which causes unspecific measurements (Fig. 5, blue line). In contrast, the quantile length is more specific: inner organs lead to stable valleys over time (Fig. 5, green line).

Thus, we use a combination of σ and q
                        
                           p
                         to detect inner organs, where the standard deviation is weighted by the quantile length. We normalized the quantile length using
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       t
                                       )
                                       −
                                       
                                          
                                             min
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                    
                                    
                                       
                                          
                                             max
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       −
                                       
                                          
                                             min
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                    
                                 
                              
                           
                        Thus we have a measurement 
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                         for each time point t with 
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                           =
                           1
                         indicating the maximal probability for a visibility of an organ.

To get a continuous but almost binary weight, we filtered 
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                         using the sigmoid Gompertz function [37]:
                           
                              (4)
                              
                                 y
                                 (
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 =
                                 a
                                 ·
                                 
                                    
                                       e
                                    
                                    
                                       −
                                       b
                                       ·
                                       
                                          
                                             e
                                          
                                          
                                             −
                                             c
                                             ·
                                             
                                                
                                                   m
                                                
                                                
                                                   ω
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where a is the upper asymptote, b corresponds to the displacement along the x-axis and c is used to set the y-axes scaling. For smoothing over time, we use a 1D median filter 
                           
                              
                                 m
                              
                              
                                 ω
                              
                           
                           (
                           ·
                           )
                         with kernel size ω.

Since we use 
                           y
                           (
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                           )
                         to weight σ, a is a constant factor and can be neglected (we set a=1). In contrast b and c have a strong impact on the normalized quantile length. We have plotted several combinations of b and c in Fig. 6
                        .

To get strong signals in the case of very high normalized quantile lengths (i.e. close to 1), but almost no signal for 
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                           <
                           0.6
                        , we use both small values for b (
                           =
                           −
                           100
                        ) and c (
                           =
                           −
                           7
                        ) (compare to Fig. 6, red line). We used this filtered 
                           y
                           (
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                           )
                         to smooth the standard deviation:
                           
                              (5)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 σ
                                 ·
                                 y
                                 (
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 )
                              
                           
                        As a consequence 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         is both sensitive and specific for internal organs (Fig. 5, red line).

The filtered and smoothed standard deviation 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         is used in a cluster analysis. We used k-means clustering to find two clusters (k=2) for each application [38]: to determine time points, in which the animal is in a dorsal orientation, we cluster for state C
                        0 where the trachea is not visible and C
                        1 where the trachea is visible. In the same way we determine time points, where the muscles are contracted (C
                        1; “muscle gaps” are visible) and time points where no gaps can be acquired (C
                        0).

If not otherwise noted, we chose k=2 for two reasons: firstly, we want to have a binary decision whether the event C
                        0 or C
                        1 holds true. Secondly, stable plateaus could be determined for both the trachea and the “muscle gap” detection given the above described (and almost binary) signal 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         (compare to Fig. 4 and Supplementary videos).

The overall procedure is given in Fig. 5: σ and 
                           
                              
                                 q
                              
                              
                                 p
                              
                              
                                 −
                              
                           
                         as well as characteristic time points from the movie are given in the top. The filtered and smoothed results of Eq. (5), which are used as an input for the k-means clustering are given in the lower plot. Clustering results for gaps between the lateral muscle fibers are given by C
                        0 and C
                        1. Time points with detected gaps are additionally highlighted by cyan boxes.

@&#RESULTS@&#

We used the above-mentioned approach to analyze rolling behavior and time points with maximal muscle contraction. In the Gompertz equation (4), we set 
                        b
                        =
                        −
                        100
                     , 
                        c
                        =
                        −
                        7
                      and 
                        ω
                        =
                        5
                      for the trachea and 
                        b
                        =
                        −
                        100
                     , 
                        c
                        =
                        −
                        7
                      and 
                        ω
                        =
                        3
                      for the “muscle gaps” as standard parameters for all below mentioned results (compare to Fig. 6, red line). The relatively small b ensures a suppressed signal for all 
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              p
                           
                        
                      below 50%. 
                        c
                        =
                        −
                        7
                      ensures that a signal 
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              p
                           
                        
                        ≥
                        0.7
                      leads to a probability 
                        y
                        (
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              p
                           
                        
                        )
                        ≥
                        0.5
                     . As illustrated in Fig. 6, 
                        b
                        =
                        −
                        100
                      and 
                        c
                        =
                        −
                        7
                      guarantee a relatively strong increase for all 
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              p
                           
                        
                      above 50% leading to sharp values for 
                        
                           
                              σ
                           
                           
                              ⁎
                           
                        
                      with both sensitive and specific peaks and valleys (Fig. 5).

To quantify the precision of our rolling behavior clustering, we used 6 movies containing 24 rolls recorded with different camera and illumination settings. In addition, we altered the distance between the camera and the tracking stage so that the resolution of a single larva ranges from 110 to 270 pixel larval length. We manually labeled all frames (1034) whether the trachea is visible or not. Thus, we have ground truth with 314 frames showing the trachea and 720 frames with no trachea in recordings with different resolutions and different brightnesses.

An exemplary rolling event and the calculated 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         is given in Fig. 7
                        . Frames in which the trachea is detected are highlighted in cyan (several stills at the bottom indicate different states of the animal).

The positive and negative predictive values for all movies are given in Table 1
                        . In general, 92.75% of all frames were classified correctly. The overall sensitivity (
                           
                              
                                 r
                              
                              
                                 p
                              
                           
                           /
                           (
                           
                              
                                 r
                              
                              
                                 p
                              
                           
                           +
                           
                              
                                 f
                              
                              
                                 n
                              
                           
                           )
                        ) is 85.03% and the specificity (
                           
                              
                                 f
                              
                              
                                 n
                              
                           
                           /
                           (
                           
                              
                                 r
                              
                              
                                 p
                              
                           
                           +
                           
                              
                                 f
                              
                              
                                 n
                              
                           
                           )
                        ) is 96.11% (see Table 1). Since almost all dorsal and ventral orientations can be detected, the number of rolls, rolling velocities or rolling frequencies can be calculated. For example, 23 of 24 rolls were identified correctly. Thus, only one rolling event in the ground truth was not classified correctly in our data, mostly due to non-optimal recordings. In contrast, three wrong rolling events were determined by the classifier. However, the longest of these wrong rolling events was less than 10 frames.

In the FIM setup, imaging conditions can be reproduced easily [34]. Thus, all above mentioned parameters only need to be adjusted once and can then be used for all movies recorded. To demonstrate the robustness of our approach, the imaging conditions were altered between different recordings, but with fixed filtering and smoothing parameters. However, if we adjust the parameters of Eq. (4) properly for each imaging condition, we get almost 100% accuracy with only one missed rolling event. Furthermore no false positive rolling events were detected at all.

To evaluate the precision of the muscle contraction quantification, we analyzed 8 movies captured with different camera and illumination settings. The resolution was altered between 170 and 270 pixel per larval length.

In contrast to larvae in ventral side up, exact moments of maximal muscle contraction cannot be recognized manually. Thus, the number of contractions was identified in the movies, but without labeling each time point. The results are given in Table 2
                        . With standard parameters 75.61% of all contractions were identified correctly. Ten manually assigned events were missed (false negative), whereas no false positives were measured at all. If the parameters of Eq. (4) were adjusted to the given conditions of each movie, the number of false positive events decreases to 3 leading to an overall accuracy of 92.68%.

As reported in [25], the perimeter and length of the animals serve as an indirect readout for peristaltic movement. In a similar fashion, the area of the animals can be used to quantify the peristalsis over time [34]. We compared the latter indirect readout with the described clustering results, but using k=3 clusters instead of two: C
                        0 and C
                        1 indicate no or maximal muscle contraction as before. The third cluster C
                        2 was used to find medium contractions between C
                        0 and C
                        1. The clustering results as well as the area are given in Fig. 8
                        .

Obviously both the area and 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         serve as indicators for the contraction frequency. However, 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         is not an indirect indicator: contractions are detected on the level of the muscles. In addition, 
                           
                              
                                 σ
                              
                              
                                 ⁎
                              
                           
                         is very sensitive so that even slight differences in muscle contraction intensities are detectable, leading to correct clustering results of three clusters. It should be noted that correct clustering in more than two clusters depends strongly on the given parameters 
                           b
                           ,
                           c
                         and ω, but given an appropriate compromise in the slope and y-axes scaling, the same parameters could have been used for both applications and all tested resolutions.

Another important remark concerns the parameters that need to be set for this histogram-based quantification. For segmentation (Section 3.1) r
                        1 and r
                        2 need to be adjusted based on the resolution of the animals to correctly segment the regions of interest. On one hand both parameters are crucial to calculate sufficient results. On the other hand no parameters need to be set to segment the overall foreground due to Otsu׳s thresholding. For statistics (Section 3.2) only the percentage p of the quantile length needs to be set, which was not a critical parameter in our experiments. The parameters affecting the filtering procedure (b and c of the Gompertz function and the kernel size ω) are examined in detail in Section 3.3, Fig. 6 and Table 2. Furthermore, due to the use of k-means clustering no threshold needs to be set for locomotion state clustering (k is implicitly given due to the binary selection; see Section 3.4).

Several movies of all above mentioned locomotion states (rolling behavior and two/three cluster muscle contractions) are given as Supplementary material, including color coded clustering results.

@&#CONCLUSION@&#

To quantify subtle locomotion phenotypes, we have extended the range of FIM applications by means of integrating rolling behavior and muscle contraction analysis. Both quantifications rely on internal structures, namely the trachea and the gaps between muscle fibers visible in FIM images. Only standard statistics calculated from local histograms are used for successful locomotion state clustering. Using this algorithm, we precisely quantify rolling events of Drosophila larvae. In addition, time points of maximal muscle contraction could have been determined automatically.

It should be noted that we only used movies containing rolls for rolling behavior classification. In the same manner, only images of crawling animals were used for muscle contraction analysis. All frames with other locomotion types like coiled animals (Fig. 9
                     (a)) or animals doing head sweeps (Fig. 9(b)) were neglected. Since these states can be determined automatically (compare to [34,21]), these restrictions do not affect the generalizability of this procedure.

In summary, the incorporation of internal structures given as bright or dark textures in FIM images can be used for advanced locomotion analysis. Thus our intention was both to demonstrate a valid method to analyze the mentioned locomotion states and to give a proof-of-principle that FIM images serve as an ideal readout for automatic quantifications of even subtle phenotypes.

In the future, we will make further use of the potential of FIM imaging: stereotypic larval locomotion is characterized by muscle contractions and a peristaltic progression [2,5]. Both result in contrast changes along the larval body in FIM images. We will analyze these changes to quantify this peristalsis in more detail.

None declared.

Supplementary data associated with this article can be found in the online version at doi:10.1016/j.compbiomed.2014.08.026.


                     
                        
                           Video 1-6
                           
                              In the first row of each movie, the frame, segmentation and segmentation mask is given. The number of rolls or muscle contractions can be found in the top left. The second row contains the histogram. The standard deviation 
                                    σ
                                  and the quantile length 
                                    
                                       
                                          q
                                       
                                       
                                          p
                                       
                                    
                                  is given in the third and fourth row. Finally, the filtered and smoothed 
                                    
                                       
                                          σ
                                       
                                       
                                          ⁎
                                       
                                    
                                  is plotted in the last row.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

