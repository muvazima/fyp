@&#MAIN-TITLE@&#Fast local image inpainting based on the Allen–Cahn model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a fast and efficient algorithm for image inpainting.


                        
                        
                           
                           The proposed model is based on the local Allen–Cahn equation.


                        
                        
                           
                           The proposed scheme is unconditionally stable with respect to time step size.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image inpainting

Energy minimization

Allen–Cahn equation

Operator splitting

Unconditionally stable scheme

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a fast local image inpainting algorithm based on the Allen–Cahn model. The proposed algorithm is applied only on the inpainting domain and has two features. The first feature is that the pixel values in the inpainting domain are obtained by curvature-driven diffusions and utilizing the image information from the outside of the inpainting region. The second feature is that the pixel values outside of the inpainting region are the same as those in the original input image since we do not compute the outside of the inpainting region. Thus the proposed method is computationally efficient. We split the governing equation into one linear equation and one nonlinear equation by using an operator splitting technique. The linear equation is discretized by using a fully implicit scheme and the nonlinear equation is solved analytically. We prove the unconditional stability of the proposed scheme. To demonstrate the robustness and accuracy of the proposed method, various numerical results on real and synthetic images are presented.
               
            

@&#INTRODUCTION@&#

Image inpainting is the process of filling in missing or damaged parts of images based on information from surrounding areas [1]. Up to now, a large number of algorithms have been proposed to solve the image inpainting problem. For the recent survey of the theoretical foundations, the different categories of methods, and illustrations of the main applications about the image inpainting, see the review paper [2] and references therein. Qin et al. [3] proposed an efficient image inpainting approach, which progressively propagates neighboring information into damaged region and can restore sharp edge successfully. In [4], the authors proposed a compact and fast PDE-based inpainting method using anisotropic heat transfer model, which can propagate both the structure and texture information from surrounding region into damaged region simultaneously. Liu and Caselles [5] presented a novel formulation of exemplar-based inpainting [6–8] as a global energy optimization problem, written in terms of the offset map. They also proposed a multiscale graph cuts algorithm to efficiently solve the energy minimization problem. Recently, Ramamurthy et al. [9] regularized the sparse models with manifold projection for image inpainting and Turek et al. [10] used the signal generation model for image inpainting.

Many inpainting algorithms are based on partial differential equations, in which the missing region is filled by diffusing the image information from the known region into the missing region at the pixel level [11–13]. Among them, one of widely applied methods is proposed by Chan and Shen [12]. They proposed a variational framework based on total variation to recover the missing information, which minimizes the following energy functional:
                        
                           (1)
                           
                              
                                 
                                    E
                                 
                                 
                                    TV
                                 
                              
                              (
                              c
                              )
                              =
                              
                                 ∫
                                 Ω
                              
                              |
                              ∇
                              c
                              |
                              d
                              x
                              +
                              
                                 ∫
                                 Ω
                              
                              
                                 
                                    λ
                                    (
                                    x
                                    )
                                 
                                 2
                              
                              
                                 
                                    (
                                    f
                                    (
                                    x
                                    )
                                    −
                                    c
                                    )
                                 
                                 
                                    2
                                 
                              
                              d
                              x
                              ,
                           
                        
                      where 
                        x
                        =
                        (
                        x
                        ,
                        y
                        )
                     , 
                        f
                        (
                        x
                        )
                      is a given image, and c is the gray scale image in a domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              2
                           
                        
                     . 
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                        ⊂
                        Ω
                      is the inpainting domain, 
                        ∂
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                      is the boundary of inpainting domain, and 
                        Ω
                        \
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                      is the complement of 
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                      in Ω (see Fig. 1
                     ). The fidelity term 
                        λ
                        (
                        x
                        )
                        
                           
                              (
                              f
                              (
                              x
                              )
                              −
                              c
                              )
                           
                           
                              2
                           
                        
                      was used to keep the solutions close to the given image in 
                        Ω
                        \
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                     . For this purpose, 
                        λ
                        (
                        x
                        )
                        =
                        0
                         if 
                        x
                        ∈
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                     ; otherwise 
                        λ
                        (
                        x
                        )
                        =
                        
                           
                              λ
                           
                           
                              0
                           
                        
                     .

The steepest descent equation for the energy functional (1) is given by
                        
                           (2)
                           
                              
                                 
                                    ∂
                                    c
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              ∇
                              ⋅
                              
                                 (
                                 
                                    
                                       ∇
                                       c
                                    
                                    
                                       |
                                       ∇
                                       c
                                       |
                                    
                                 
                                 )
                              
                              +
                              λ
                              (
                              x
                              )
                              
                                 (
                                 f
                                 (
                                 x
                                 )
                                 −
                                 c
                                 )
                              
                              .
                           
                        
                     
                  

Hence,
                        
                           (3)
                           
                              
                                 
                                    ∂
                                    c
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          ∇
                                          ⋅
                                          (
                                          
                                             
                                                ∇
                                                c
                                             
                                             
                                                |
                                                ∇
                                                c
                                                |
                                             
                                          
                                          )
                                       
                                       
                                          if
                                          
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          ∇
                                          ⋅
                                          (
                                          
                                             
                                                ∇
                                                c
                                             
                                             
                                                |
                                                ∇
                                                c
                                                |
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                λ
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          f
                                          (
                                          x
                                          )
                                          −
                                          c
                                          )
                                       
                                       
                                          if
                                          
                                          x
                                          ∈
                                          Ω
                                          \
                                          
                                             
                                                Ω
                                             
                                             
                                                D
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                      As can be observed, the pixel values in the solution are the same as the values in 
                        Ω
                        \
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                     , i.e., 
                        c
                        ≈
                        f
                        (
                        x
                        )
                     . And in the inpainting domain, the pixel values are obtained by curvature-driven diffusions. In [14], Chan and Shen proposed a new inpainting model based on the curvature-driven diffusions to realize the connectivity principle.
                        
                           (4)
                           
                              
                                 
                                    ∂
                                    c
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              ∇
                              ⋅
                              
                                 (
                                 G
                                 
                                    (
                                    x
                                    ,
                                    |
                                    κ
                                    |
                                    )
                                 
                                 
                                    
                                       ∇
                                       c
                                    
                                    
                                       |
                                       ∇
                                       c
                                       |
                                    
                                 
                                 )
                              
                              +
                              λ
                              
                                 (
                                 f
                                 (
                                 x
                                 )
                                 −
                                 c
                                 )
                              
                              .
                           
                        
                      Here,
                        
                           (5)
                           
                              G
                              
                                 (
                                 x
                                 ,
                                 |
                                 κ
                                 |
                                 )
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                |
                                                κ
                                                |
                                             
                                             
                                                p
                                             
                                          
                                       
                                       
                                          if
                                          
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          if
                                          
                                          x
                                          ∈
                                          Ω
                                          \
                                          
                                             
                                                Ω
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                      where 
                        p
                        ≥
                        1
                      and κ is the curvature, which is given by 
                        ∇
                        ⋅
                        (
                        ∇
                        c
                        /
                        |
                        ∇
                        c
                        |
                        )
                     . In [13], Esedoḡlu and Shen introduced the Mumford–Shah–Euler model, which is based on the Mumford–Shah image segmentation model [15], to solve the image inpainting problems. Ballester et al. [16] adapted a joint interpolation of vector fields and gray-levels to incorporate the principle of continuity in a variational framework. Li et al. [17] proposed a fast scheme to solve the Chan and Shen's inpainting model [12] with an operator splitting method. Another well-known method was introduced by Bertozzi et al. [18,19], where they proposed an inpainting model which is the modified Cahn–Hilliard (CH) equation
                        
                           (6)
                           
                              
                                 
                                    E
                                 
                                 
                                    B
                                 
                              
                              (
                              c
                              )
                              =
                              
                                 
                                    E
                                 
                                 
                                    B
                                    1
                                 
                              
                              (
                              c
                              )
                              +
                              
                                 
                                    E
                                 
                                 
                                    B
                                    2
                                 
                              
                              (
                              c
                              )
                              =
                              
                                 ∫
                                 Ω
                              
                              
                                 (
                                 
                                    
                                       F
                                       (
                                       c
                                       )
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          |
                                          ∇
                                          c
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    2
                                 
                                 )
                              
                              d
                              x
                              +
                              
                                 ∫
                                 Ω
                              
                              
                                 λ
                                 2
                              
                              
                                 
                                    (
                                    f
                                    (
                                    x
                                    )
                                    −
                                    c
                                    )
                                 
                                 
                                    2
                                 
                              
                              d
                              x
                              ,
                           
                        
                      where 
                        F
                        (
                        c
                        )
                        =
                        0.25
                        
                           
                              c
                           
                           
                              2
                           
                        
                        
                           
                              (
                              1
                              −
                              c
                              )
                           
                           
                              2
                           
                        
                      is the Helmholtz free energy density (see Fig. 2
                     ). The term 
                        F
                        (
                        c
                        )
                      is a force that makes c to be approximately 0 or 1. 
                        
                           
                              |
                              ∇
                              c
                              |
                           
                           
                              2
                           
                        
                      is a gradient energy, ϵ is the gradient energy coefficient related to the interfacial energy.

By a superposition of gradient descent with respect to 
                        
                           
                              H
                           
                           
                              −
                              1
                           
                        
                      inner product for the energy 
                        
                           
                              E
                           
                           
                              B
                              1
                           
                        
                      and gradient descent with respect to 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      inner product for the energy 
                        
                           
                              E
                           
                           
                              B
                              2
                           
                        
                     , the authors in [18,19] proposed the following model:
                        
                           (7)
                           
                              
                                 
                                    ∂
                                    c
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              Δ
                              
                                 (
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       c
                                       )
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 −
                                 Δ
                                 c
                                 )
                              
                              +
                              λ
                              
                                 (
                                 f
                                 (
                                 x
                                 )
                                 −
                                 c
                                 )
                              
                              .
                           
                        
                     
                  

We note that if 
                        λ
                        =
                        0
                      in Eq. (7), then the equation becomes the classical CH equation [20], which has been used as a mathematical model to investigate the phase separation of binary mixture under quenching below a critical temperature. For physical, mathematical, and numerical derivations of the CH equation, see the recent review paper [21].

In this paper, we propose a new effective and accurate image inpainting method which is based on the local Allen–Cahn equation [22]. The equation has been used in solving problems in image processing [23–27]. By using the Allen–Cahn equation, we can perform fast image inpaintings, because its fast and accurate hybrid numerical solver is available [28]. It should be pointed that our model is the extension of Chan and Shen's model [12], since Allen–Cahn equation describes the motion of mean curvature flow. Compared to Cahn–Hilliard equation [18,19], we choose to use the Allen–Cahn equation, since its numerical treatment is simpler than that of the Cahn–Hilliard type, which involves fourth-order differential operators. The outline of this paper is the following. In Section 2, the governing equations for the image inpainting are presented. In Section 3, we describe the proposed operator splitting algorithm and give a detailed proof for its unconditional stability. In Section 4, we present computational examples to demonstrate the efficiency and robustness of our proposed method. Finally, conclusions are drawn in Section 5.

The inpainting algorithms can be summarized as: First, the missing region is filled by diffusing the image information from the known region into the missing region at the pixel level. Second, the image information in the known region should be close to the given image. To reduce the computational cost and keep the accuracy of the inpainting algorithm, we propose the following equations:
                        
                           (8)
                           
                              
                                 
                                    ∂
                                    c
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              (
                              x
                              ,
                              t
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          −
                                          
                                             
                                                F
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          c
                                          (
                                          x
                                          ,
                                          t
                                          )
                                          )
                                          /
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          Δ
                                          c
                                          (
                                          x
                                          ,
                                          t
                                          )
                                       
                                       
                                          if
                                          
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              c
                              (
                              x
                              ,
                              0
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          0.5
                                       
                                       
                                          if
                                          
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      max
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                          
                                       
                                       
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              n
                              ⋅
                              ∇
                              c
                              (
                              x
                              ,
                              t
                              )
                              =
                              0
                              ,
                              
                              x
                              ∈
                              ∂
                              Ω
                              ,
                           
                        
                      where 
                        
                           
                              f
                           
                           
                              max
                           
                        
                      and 
                        
                           
                              f
                           
                           
                              min
                           
                        
                      are the maximum and the minimum values of the given image, respectively, and n is the unit normal vector to ∂Ω. Thus, we have the normalized image data 
                        c
                        (
                        x
                        ,
                        0
                        )
                        ∈
                        [
                        0
                        ,
                        1
                        ]
                     . Eq. (8) is also called as the Allen–Cahn equation [22], which is widely applied in image processing due to the motion by mean curvature. We choose the AC equation because it has intrinsic smoothing effect on interfacial transition layers and its fast and accurate hybrid numerical solver is available [28].

For the initial condition, we can choose different initial guesses for the inpainting domain 
                        
                           
                              Ω
                           
                           
                              D
                           
                        
                      because the solution of missing regions will be defined by the information of the known region at the equilibrium solution. In this work, to reduce the numerical iterations, we set 
                        c
                        (
                        x
                        ,
                        0
                        )
                        =
                        0.5
                      in the inpainting domain.

In this section, we propose an operator splitting method to get an unconditionally stable numerical method for solving the proposed algorithm. Let the computational domain Ω be 
                           [
                           1
                           ,
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ]
                           ×
                           [
                           1
                           ,
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                           ]
                        , h be the uniform grid size, and 
                           
                              
                                 Ω
                              
                              
                                 h
                              
                           
                           =
                           {
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           )
                           |
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           =
                           (
                           i
                           −
                           0.5
                           )
                           h
                           ,
                            
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           =
                           (
                           j
                           −
                           0.5
                           )
                           h
                           ,
                            
                           1
                           ≤
                           i
                           ≤
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ,
                            
                           1
                           ≤
                           j
                           ≤
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                           }
                        . Let 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                              
                              
                                 n
                              
                           
                         be approximations of 
                           c
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           ,
                           n
                           Δ
                           t
                           )
                        , where 
                           Δ
                           t
                           =
                           T
                           /
                           
                              
                                 N
                              
                              
                                 t
                              
                           
                         is the time step, T is the final time, and 
                           
                              
                                 N
                              
                              
                                 t
                              
                           
                         is the total number of time steps. Here, the superscript n denotes an evaluation at time level n. We split the original problem (8) into a sequence of simpler problems as
                           
                              (11)
                              
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 Δ
                                 c
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       c
                                       )
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 .
                              
                           
                         As the first step, we solve Eq. (11) by applying the fully implicit method with an initial condition 
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                        , that is,
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       Δ
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 Δ
                              
                              
                                 d
                              
                           
                         is the 9-point discrete Laplacian operator, i.e.,
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                             +
                                             1
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                             −
                                             1
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             −
                                             1
                                             ,
                                             j
                                             +
                                             1
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             −
                                             1
                                             ,
                                             j
                                             −
                                             1
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                    
                                    
                                       6
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       2
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             j
                                             −
                                             1
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             −
                                             1
                                             ,
                                             j
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       )
                                       −
                                       10
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                    
                                    
                                       3
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         The resulting implicit discrete Eq. (13) can be solved by the Gauss–Seidel method. Next, Eq. (12) is solved by the method of separation of variables [28–31] as
                           
                              (14)
                              
                                 
                                    
                                       c
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             n
                                             +
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       −
                                       0.5
                                    
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   
                                                      −
                                                      Δ
                                                      t
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                2
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      n
                                                      +
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          1
                                          −
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   
                                                      −
                                                      Δ
                                                      t
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         For more details, we refer to [28] and note that in the previous numerical solution of Eq. (11), the authors used the Crank–Nicolson scheme, which is prone to oscillations when a large time step is used. However, in this paper, we do not have oscillations because we use the fully implicit scheme.

To solve Eqs. (11) and (12) in 
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                        , we introduce a control function g, which is defined as
                           
                              (15)
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   D
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         The schematic diagram is shown in Fig. 3
                        . 
                           
                              
                                 c
                              
                              
                                 n
                                 +
                                 1
                              
                           
                         is updated from 
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                         by solving Eqs. (13) and (14) only when 
                           
                              
                                 g
                              
                              
                                 i
                                 j
                              
                           
                           =
                           1
                        . We note that the closest neighboring exterior cells to the boundary of 
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                         play a role as the Dirichlet boundary condition. Therefore, 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                              
                              
                                 n
                              
                           
                         can have values between zero and one depending on the neighboring image values.

In summary, our discrete solution algorithm is described as following:


                        Step 1. Find the inpainting domain 
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                         using various methods: for example, either by inspection or by image segmentation methods [29,32].


                        Step 2. Define the control function g and initialize 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                         as
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   D
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0.5
                                          
                                          
                                             if
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   D
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Step 3. Update 
                           
                              
                                 c
                              
                              
                                 n
                                 +
                                 1
                              
                           
                         from 
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                         by solving Eqs. (13) and (14).

An efficient preconditioned conjugate gradient (PCG) scheme is used to solve imaging problems [33].

Our proposed hybrid splitting method, Eqs. (13) and (14), is an unconditionally stable scheme. To confirm the unconditional stability of Eq. (13), we apply the von Neumann analysis. Let 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                              
                              
                                 n
                                 +
                                 1
                                 /
                                 2
                              
                           
                         be decomposed into Fourier series as
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       α
                                       =
                                       −
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       β
                                       =
                                       −
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       α
                                       β
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       k
                                       (
                                       α
                                       i
                                       +
                                       β
                                       j
                                       )
                                       π
                                       h
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       n
                                       +
                                       1
                                       /
                                       2
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       α
                                       =
                                       −
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       β
                                       =
                                       −
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       α
                                       β
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       k
                                       (
                                       α
                                       i
                                       +
                                       β
                                       j
                                       )
                                       π
                                       h
                                    
                                 
                                 ,
                              
                           
                         respectively. Here, we denote n on γ as a power and k as the imaginary unit, i.e., 
                           k
                           =
                           
                              
                                 −
                                 1
                              
                           
                        . Let 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 γ
                              
                              
                                 n
                              
                           
                           
                              
                                 e
                              
                              
                                 k
                                 (
                                 α
                                 i
                                 +
                                 β
                                 j
                                 )
                                 π
                                 h
                              
                           
                         and 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 n
                                 +
                                 1
                                 /
                                 2
                              
                           
                           =
                           
                              
                                 γ
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           
                              
                                 e
                              
                              
                                 k
                                 (
                                 α
                                 i
                                 +
                                 β
                                 j
                                 )
                                 π
                                 h
                              
                           
                         denote one summand of the series, respectively, where we drop the summand index in 
                           
                              
                                 γ
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 γ
                              
                              
                                 n
                                 +
                                 1
                              
                           
                        . These formulas are now substituted into Eq. (13) and we obtain
                           
                              
                                 γ
                                 =
                                 
                                    
                                       3
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       3
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       Δ
                                       t
                                       (
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       ⁡
                                       
                                          
                                             (
                                             α
                                             +
                                             β
                                             )
                                             π
                                             h
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       ⁡
                                       
                                          
                                             (
                                             α
                                             −
                                             β
                                             )
                                             π
                                             h
                                          
                                          2
                                       
                                       +
                                       4
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       ⁡
                                       
                                          
                                             α
                                             π
                                             h
                                          
                                          2
                                       
                                       +
                                       4
                                       
                                          
                                             sin
                                          
                                          
                                             2
                                          
                                       
                                       ⁡
                                       
                                          
                                             β
                                             π
                                             h
                                          
                                          2
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

We can see that the above γ satisfies the property 
                           |
                           γ
                           |
                           ≤
                           1
                         for any α and β. Hence, the numerical scheme Eq. (13) is unconditionally stable. Furthermore, the inequality 
                           inf
                           ⁡
                           (
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                           )
                           ≤
                           
                              
                                 c
                              
                              
                                 n
                                 +
                                 
                                    1
                                    2
                                 
                              
                           
                           ≤
                           sup
                           ⁡
                           (
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                           )
                         is satisfied by the discrete minimum and maximum principles for the heat equation [34]. Thus from Eq. (13), we get 
                           0
                           ≤
                           
                              
                                 c
                              
                              
                                 n
                                 +
                                 
                                    1
                                    2
                                 
                              
                           
                           ≤
                           1
                         and this result induces 
                           0
                           ≤
                           
                              
                                 c
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           ≤
                           1
                         from Eq. (14). Therefore our proposed scheme, Eqs. (13) and (14), is unconditionally stable for any time step.

In this section, we present numerical results which are obtained by using the proposed numerical algorithm on various synthetic and real images. Unless otherwise specified, we use uniform grid size 
                        h
                        =
                        1
                      and time step 
                        Δ
                        t
                        =
                        2
                     . The ϵ value is given as 
                        
                           
                              ϵ
                           
                           
                              m
                           
                        
                        =
                        h
                        m
                        /
                        [
                        4
                        
                           2
                        
                        
                           
                              tanh
                           
                           
                              −
                              1
                           
                        
                        ⁡
                        (
                        0.9
                        )
                        ]
                      
                     [35], where hm is approximately the transition length of c from 0.05 to 0.95. We also will present the CPU times in seconds of our calculations which are performed in 
                        C
                        ++
                      on a 3 GHz with 3 G RAM.

We stop the numerical computations when the difference between the 
                        (
                        n
                        +
                        1
                        )
                     th and nth time step energies becomes less than a given tolerance, tol. In this paper, we set 
                        
                           tol
                        
                        =
                        0.1
                     . The termination criterion algorithm is listed as follows:
                        
                           
                              
                                 
                                    
                                       
                                          Set a maximum iteration number N, a tolerance tol, and 
                                                k
                                                =
                                                1
                                             .

While 
                                                (
                                                k
                                                ≤
                                                N
                                                )
                                              do Steps 1–2
                                             
                                                
                                                   
                                                      Step 1 Compute 
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                       from 
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                       by solving Eqs. (13) and (14).


                                                      Step 2 If 
                                                         |
                                                         
                                                            
                                                               E
                                                            
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                         −
                                                         
                                                            
                                                               E
                                                            
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                         |
                                                         <
                                                         
                                                            tol
                                                         
                                                      , then stop the calculation.
                                                         
                                                            Else 
                                                                  k
                                                                  =
                                                                  k
                                                                  +
                                                                  1
                                                               .

We start with an example which illustrates the basic mechanism of the algorithm, Eqs. (8)–(10). Let us consider a synthetic image as shown in Fig. 4
                        (a) on the computational domain 
                           Ω
                           =
                           [
                           1
                           ,
                           128
                           ]
                           ×
                           [
                           1
                           ,
                           128
                           ]
                        . Here, white regions are close to 1 and black regions are close to 0. Gray region is an inpainting domain and is close to 0.5. Interfacial energy coefficient 
                           
                              
                                 ϵ
                              
                              
                                 3
                              
                           
                         is used. The top and bottom rows in Fig. 4 show the evolution of the gray region and mesh plots of the numerical solutions, respectively. The evolution times are shown below each figure. The inpainting region evolves according to neighboring values, i.e., either 0 or 1.

We perform a parameter ϵ sensitivity analysis for the model. The role of ϵ is interface thickness of a transition layer of the separated region which represents two different states. We take the same initial condition except for different interface parameter values 
                           
                              
                                 ϵ
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 ϵ
                              
                              
                                 3
                              
                           
                        , and 
                           
                              
                                 ϵ
                              
                              
                                 6
                              
                           
                        . From the results shown in Fig. 5
                        , we can observe that when ϵ is too small, interfacial transition is too sharp. On the other hand, if ϵ is too large, the inpainting result is blurry in appearance.

To show the relation of the parameter ϵ and the time step Δt, we perform the same test as the above with different time steps, 
                           Δ
                           t
                           =
                           0.1
                           
                              
                                 ϵ
                              
                              
                                 2
                              
                           
                        , 
                           2
                           
                              
                                 ϵ
                              
                              
                                 2
                              
                           
                        , and 
                            
                           10
                           
                              
                                 ϵ
                              
                              
                                 2
                              
                           
                        . Here, 
                           ϵ
                           =
                           
                              
                                 ϵ
                              
                              
                                 3
                              
                           
                         is used. From Fig. 6
                        , we can see that when the time step is larger, the interfacial transition is getting sharper. Therefore, too large time step is not good for getting smooth results.


                        Fig. 7
                         shows the evolution of inpainting an image with respect to three different initial conditions on 
                           Ω
                           =
                           [
                           1
                           ,
                           128
                           ]
                           ×
                           [
                           1
                           ,
                           128
                           ]
                        . Here, 
                           
                              
                                 ϵ
                              
                              
                                 3
                              
                           
                         is employed. As shown in Fig. 7(a), we set 
                           c
                           (
                           x
                           ,
                           y
                           ,
                           0
                           )
                           =
                           1
                         for 
                           (
                           x
                           ,
                           y
                           )
                           ∈
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                        . Even though 
                           F
                           (
                           c
                           )
                           =
                           0
                         and 
                           
                              
                                 |
                                 ∇
                                 c
                                 |
                              
                              
                                 2
                              
                           
                           /
                           2
                           =
                           0
                         for 
                           (
                           x
                           ,
                           y
                           )
                           ∈
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                        , our method also works well because of 
                           n
                           ⋅
                           ∇
                           c
                           ≠
                           0
                           
                           on
                           
                           ∂
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                        . The inpainting result is obtained after 340 iterations. Another initial condition is with random perturbations on 
                           
                              
                                 Ω
                              
                              
                                 D
                              
                           
                        , i.e., 
                           c
                           (
                           x
                           ,
                           y
                           ,
                           0
                           )
                           =
                           rand
                           (
                           x
                           ,
                           y
                           )
                        , where 
                           
                              rand
                           
                           (
                           x
                           ,
                           y
                           )
                         is a random number between 0 and 1. The numerical solutions obtained from 200 iterations are shown in Fig. 7(b). In the last test, we consider our proposed initialization algorithm, i.e., 
                           c
                           (
                           x
                           ,
                           y
                           ,
                           0
                           )
                           =
                           0.5
                        . It takes only 11 iterations to solve the image inpainting problem. Note that, with the three different initial conditions, image inpaintings are successfully done as shown in the last column of Fig. 7.

In this section, we show our proposed method can inpaint various synthetic images such as double stripes, crosses, and disks. In this simulation, 
                           
                              
                                 ϵ
                              
                              
                                 4
                              
                           
                         is used. The initial configurations are shown in the first two columns of Fig. 8
                        . The gray region in the initial configuration denotes the inpainting region. The inpainted results are shown in the last two columns. As shown in Fig. 8, our proposed method works well. Note that Bertozzi et al. [18] have taken similar numerical tests for double stripes and crosses by using the Cahn–Hilliard equation with an adaptive ϵ. The comparisons with the results in [18] for iterations and CPU time are listed in Table 1
                        . From the results, we can see that our proposed method is more efficient than theirs.


                        Figs. 9
                        (a), (b), (c), (d), and (e) show an initial image, the inpainting domain, and the recovered images by using the Chan and Shen's method [12], the Li et al.'s method [17], and the proposed method, respectively. Interface parameter 
                           
                              
                                 ϵ
                              
                              
                                 15
                              
                           
                         and time step 
                           Δ
                           t
                           =
                           5
                         are used. It took only 4 iterations, which is much faster than Li et al.'s method with 200 iterations and Chan and Shen's method with 5000 iterations for inpainting with Fig. 9(a).

Also, we conduct the inpainting of a zebra and a QR code images, which are considered by Bosch et al. [1]. In Ref. [1], the authors developed a fast solver using the Moreau–Yosida regularization technique for the Cahn–Hilliard inpainting. The results by Bosch et al. [1] are presented in second column of Fig. 10
                        . And we represent the our results in third column for comparison. As shown in Fig. 10, we obtain more clear recovered images of a zebra and QR code with only 8 and 10 iterations than Bosch et al. [1], respectively. These facts imply that our numerical method is also performed well in gray valued inpainting images.


                        Figs. 11
                        (a) and (b) show two removal of texts. Here, 
                           
                              
                                 ϵ
                              
                              
                                 15
                              
                           
                         and 
                           Δ
                           t
                           =
                           5
                         are used. As shown in Fig. 11, image inpaintings are successfully done. We refer to [36] for an automatic image inpainting algorithm based on a fuzzy C-mean (FCM).

In this section, we perform an image inpainting in three-dimensional space with our numerical method. It should be noted that in order to use more information from the original image, we use the 27-point discrete Laplacian operator in three-dimensional space [37], i.e.,
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    [
                                    14
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                    +
                                    3
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          k
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          −
                                          1
                                          ,
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    128
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ]
                                 
                                 /
                                 
                                    (
                                    30
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     


                        Figs. 12
                        (a) and (b) show two 3D examples. From left to right, they are original, damaged, and recovered surfaces, respectively. Here, 
                           
                              
                                 ϵ
                              
                              
                                 4
                              
                           
                         and 
                           Δ
                           t
                           =
                           2
                         are used. As can be seen, our proposed method performs well for inpainting in three-dimensional space.

Now, we show the performance of all test problems which were done in previous sections. Table 2
                         shows the image size (N), the inpainting domain size (
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                        ), the number of iterations, and the CPU time in each test. The result indicates that our proposed method is robust and efficient. It should be noted that since our proposed model is defined in the inpainting domain, the computational cost is not 
                           O
                           (
                           N
                           log
                           ⁡
                           N
                           )
                         but 
                           O
                           (
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                           log
                           ⁡
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                           )
                        . To demonstrate it, in Fig. 13
                        , we plot the average CPU time (total CPU time over total iterations) and 
                           O
                           (
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                           log
                           ⁡
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                           )
                        , which are summarized in Table 2. Here, the linear fitting is done using the MATLAB function “polyfit”. We define the error as the difference between the average CPU time and the linear fit result. In this test, the 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                         error is 0.89%. Therefore the results suggest that the convergence rate of the computational cost is linear with respect to 
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                           log
                           ⁡
                           
                              
                                 N
                              
                              
                                 i
                                 s
                              
                           
                        . To show the effect and accuracy of our proposed method, we will compute PSNR (Peak Signal to Noise Ratio) [38–41], which is commonly used to measure the quality of reconstruction of image inpainting. Here, PSNR is defined as
                           
                              
                                 PSNR
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    (
                                    
                                       1
                                       
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       
                                          [
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                n
                                             
                                          
                                          −
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                min
                                             
                                          
                                          )
                                          /
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                min
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Since the pixel values in the inpainting domain are obtained by curvature-driven diffusions and the pixel values outside the inpainting region are the same as those in the original input image, we can expect the higher PSNR obtained by our proposed method.

In this section, we test a disconnected stripe image with large inpainting region as the benchmark example [42]. First, we recover the example (see Fig. 14
                        (a)) by using the modified Cahn–Hilliard equation. For this test, we use 
                           λ
                           =
                           1
                        , 
                           Δ
                           t
                           =
                           1
                        , and 
                           h
                           =
                           1
                        . Numerical results with 
                           ϵ
                           =
                           10
                         and 100 are shown in Figs. 14(b) and (c), respectively.

From these results, we know that the inpainting problem with large gap is difficult to recover with the modified CH equation. In order to resolve this problem which is arising in Cahn–Hilliard model, authors in [18,19,42] proposed the two-step method. This method is first performed with a large ϵ, then used with small ϵ to regulate the diffuse-interface motion. For more details about the two-step method, see the reference [18,19,42].

Also, we conduct the test with new method proposed in this paper. In this test, we use 
                           Δ
                           t
                           =
                           0.01
                         and 
                           h
                           =
                           1
                        . And we do test with three different values of ϵ. Figs. 14(d)–(f) show the numerical results with 
                           ϵ
                           =
                           0.01
                           ,
                           0.1
                        , and 1 at steady states, respectively. Here, we define the steady state as 
                           ‖
                           
                              
                                 E
                              
                              
                                 B
                                 1
                              
                           
                           (
                           
                              
                                 ϕ
                              
                              
                                 n
                                 +
                                 1
                              
                           
                           )
                           −
                           
                              
                                 E
                              
                              
                                 B
                                 1
                              
                           
                           (
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                           )
                           ‖
                           <
                           
                              
                                 10
                              
                              
                                 −
                                 5
                              
                           
                        . When we use 
                           ϵ
                           =
                           0.1
                        , we get the good numerical result as the one in [42].

@&#CONCLUSION@&#

In this paper, we proposed a new unconditionally stable hybrid numerical method for image inpainting. The model is based on the local Allen–Cahn equation and an operator splitting technique was used to solve the model numerically. We proved the unconditional stability of the proposed scheme. Various numerical results on real and synthetic images were presented to demonstrate the efficiency and robustness of the proposed method. Since our proposed model is defined in the inpainting domain, the computational cost is not 
                        O
                        (
                        N
                        log
                        ⁡
                        N
                        )
                      but 
                        O
                        (
                        
                           
                              N
                           
                           
                              i
                              s
                           
                        
                        log
                        ⁡
                        
                           
                              N
                           
                           
                              i
                              s
                           
                        
                        )
                     . This indicates that our proposed method is very fast for image inpainting process. Through the computational cost comparisons with three models in [12,17,18], we confirmed that our proposed model is much faster than the other existing models.

The authors declare that there is no conflict of interests regarding the publication of this article.

@&#ACKNOWLEDGEMENTS@&#

The second author (D. Jeong) was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education, Science and Technology (2014R1A6A3A01009812). The corresponding author (J.S. Kim) was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science, ICT and future Planning (NRF-2014R1A2A2A01003683). The authors are grateful to the reviewers whose valuable suggestions and comments significantly improved the quality of this paper.

@&#REFERENCES@&#

