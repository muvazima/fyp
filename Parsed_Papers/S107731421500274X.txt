@&#MAIN-TITLE@&#Stepwise calibration of focused plenoptic cameras

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel method for the calibration of focused plenoptic monocular cameras is proposed.


                        
                        
                           
                           In this way, the camera will deliver metric depth information instead of disparities.


                        
                        
                           
                           We detach the intrinsic camera parameters related to either brightness or depth data.


                        
                        
                           
                           We present novel initialization methods for all parameters.


                        
                        
                           
                           The accuracy is demonstrated on independent ground-truth validation data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Focused plenoptic camera

Light-field

Plenoptic 2.0

Metric calibration

@&#ABSTRACT@&#


               
               
                  Monocular plenoptic cameras are slightly modified, off-the-shelf cameras that have novel capabilities as they allow for truly passive, high-resolution range sensing through a single camera lens. Commercial plenoptic cameras, however, are presently delivering range data in non-metric units, which is a barrier to novel applications e.g. in the realm of robotics. In this work we revisit the calibration of focused plenoptic cameras and bring forward a novel approach that leverages traditional methods for camera calibration in order to deskill the calibration procedure and to increase accuracy. First, we detach the estimation of parameters related to either brightness images or depth data. Second, we present novel initialization methods for the parameters of the thin lens camera model—the only information required for calibration is now the size of the pixel element and the geometry of the calibration plate. The accuracy of the calibration results corroborates our belief that monocular plenoptic imaging is a disruptive technology that is capable of conquering new markets as well as traditional imaging domains.
               
            

@&#INTRODUCTION@&#

A considerable number of machine vision users think that multi-view triangulation is required in order to retrieve accurate 3-D information using cameras without a priori information about the scene. This is predominantly accomplished either by passively taking images from different vantage points (stereo vision) or by actively projecting a known pattern from a separate location (Kinect). In other words, the notion that 3-D information is lost when light rays traverse the front lens of the camera is widespread. Experts know, however, that this is not the case as light rays are differently diffracted by a lens depending on the distance to the emitting object [1]. In fact, one of the potential outputs of monocular plenoptic cameras is range sensing.

Plenoptic (also light-field) imaging is about measuring light in a higher dimensionality than in standard 2-D imaging. In fact, light transmission can be contemplated in a higher-dimensional space, the so-called plenoptic function [2]. Current plenoptic imaging samples the plenoptic function in 4-D , viz. 2-D projection position on the chip together with the direction of incoming light rays. The quest for this extra information is anything but new, but advances in parallel computation and modern workmanship of microlens arrays (MLAs) have recently made commercial products possible [3–5]. In a nutshell, monocular plenoptic cameras capture the 3-D image produced by the main lens within the camera by using an MLA in front of the sensor chip. By capturing the whole 3-D image, classical habits when using planar sensors like keeping the aperture size small in order to increase depth of field are lifted and more light can be gathered from the scene. Different camera designs open up new possibilities to trade off lateral precision against angular resolution of the reprojected ray directions. The original monocular plenoptic cameras focus the image on the MLA, achieving a limited spatial resolution at that particular depth equal to the number of valid microlenses. These microlenses produce defocused images that sample the ray direction at the position of the microlens. In 2009 Lumsdaine and Georgiev introduced the focused plenoptic camera (or plenoptic camera 2.0), which makes it possible to adapt this rather rigid trade-off between angular and spatial resolutions towards more spatial resolution [6]. This is performed by a modification of the focus distance to the main lens with the result that microlenses produce focused images that, on the other hand, more loosely sample ray direction.
                     

Many characteristics of plenoptic cameras are in conformity with the standard reference on disruptive technologies in Ref. [7]. For instance, plenoptic cameras initially produce a deficient standard output (fair images) at a higher cost, which makes them of no interest to the average consumer. They, however, clearly have the potential to improve and open up new markets while sharply reducing costs. Their current applications are offline refocusing and total focusing (i.e., increased depth of field) of 2-D images. More relevant potential applications are passive, 3-D video recording, 3-D modeling, range-based segmentation and tracking, industrial inspection (e.g. in narrow cavities), and imaging in challenging, low-light environments (e.g. underwater or in space). Most of these applications rely on the capability of plenoptic cameras to provide metric information of the scene in the form of 2.5-D depth images. This is, however, not yet commercially available as depth is currently being delivered in internal units related to image processing (disparities). We address the metric calibration of focused, monocular plenoptic cameras in order to transform their depth output into metric space.

@&#RELATED WORK@&#

There is less research on the metric calibration of focused plenoptic cameras and the works on the calibration of the original, unfocused ones are only of partial use [8]. Next we review the only available approaches in Refs. [9–12]. They all have in common that they start out from synthetic images generated by the RxLive software of Raytrix GmbH (viz. the total focus image and the depth image), not from the raw images of the camera. The conformity of the generated synthetic images with the camera models used for calibration is of course critical. It is a judicious decision to rely on the manufacturers, however, since (i) they are most qualified to do that job, (ii) they still keep individual design details in secret, and (iii) in order to avoid mismatching between our potential reconstruction attempts and the eventual operation on GPGPUs. In addition, the calibration process is simplified by using the synthetic images because we leverage established methods for pinhole camera calibration [13,14]. It is worth noting that the geometry of the MLA is not included in the calibration process as it can be estimated in a separate procedure using the Raytrix software. The best-known work in Ref. [9] details the modeling and calibration of the focused plenoptic camera, failing to obtain absolute range accuracy. Further the automatic initialization of calibration parameters is not addressed; the authors make use of privileged information from the manufacturer. The recent Master’s thesis in Ref. [12], however, does achieve superior results by largely implementing the above approach. Still, considerations on the initialization of calibration parameters are not being addressed. The author makes strong use of filtering approaches to wipe out peripheral artifacts in depth estimation, which might constrain the general applicability of the approach. Zeller et al. in Ref. [11] perform calibration by minimizing the reprojection residuals with respect to (w.r.t.) a set of measured calibration points for which the object distance is known—at least for the initialization of their method. In addition, the method requires assumed intrinsic values. In the same spirit, Luhmann et al. in Ref. [10] opt for measuring ranges of a planar calibration object, which is error-prone and inconvenient [15,16]. Incidentally, the current internal approach for metric calibration at Raytrix GmbH also relies on a linear actuator in order to produce a polynomial that directly converts virtual depths into metric distances [12]. This type of empirical models, however, is only applicable within the scope of the calibration data.

In this work we revisit the type of calibration approaches that are based on the standard camera calibration method described in Refs. [13,14]. We suggest modifications to particular modeling details and present justifications. Special care has been taken to keep the approach in the spirit of the standard method, i.e., to take images of a known planar calibration pattern in unknown pose and to facilitate automatic bootstrapping of the parameters prior to nonlinear optimization. This keeps the amount of required prior knowledge (e.g. specifications by the manufacturer) to a minimum, making the whole calibration process more generic and easier. More importantly, we introduce a novel approach for stepwise calibration by alternate use of total focus and depth (synthetic) images. Our motivation is to avoid the impact of higher levels of noise in the depth images on a large part of the intrinsic parameters like the focal length and the radial lens distortion. These parameters can be estimated in advance by exclusively using total focus images, as in traditional camera calibration. After that, the optimization of the remaining parameters using the depth images and the results of the first optimization takes place, see Fig. 1. By doing so, calibration accuracy is increased and the optimization robustness is promoted as the formulations of both optimizations become better conditioned compared with joint optimization methods [9]. In addition, the optimization of the lens distortion model will not get entangled with the optimization of the (potentially very similar) depth distortion model.

Overall, we produce an easy-to-use, automatic method for metric plenoptic camera calibration. The only required data are synthetic total focus and virtual depth images of a planar calibration plate of known geometry and the metric size of their virtual sensor elements.

@&#PROPOSED METHOD@&#

The pinhole camera model is a valid approximation for most cameras and applications. It relates projection directions in the camera reference frame S
                        C with projection positions in the sensor reference frame S
                        S. This projection is independent of the actual range to the scene, which makes it unsuitable for modeling plenoptic cameras aimed at inferring the depth of the scene out of inner camera projections. The pinhole camera model is derived from the thin lens camera model in the case of smaller aperture sizes. The thin lens camera model embraces the thin lens approximation of light rays passing through a thin lens, which states that ray directions are still projected following the pinhole camera model and that projections are only focused at particular depths d that depend both, on the focal length f of the lens and on the object ranges r in the direction of the principal axis of the camera as follows:

                           
                              (1)
                              
                                 
                                    
                                       1
                                       f
                                    
                                    =
                                    
                                       1
                                       d
                                    
                                    +
                                    
                                       1
                                       r
                                    
                                    .
                                 
                              
                           
                        
                     

The thin lens camera model does consider ranges to the scene and therefore serves as a starting point for the camera model of a plenoptic camera. The use of the pinhole camera model has been convenient because of its linear projective formulation in homogeneous coordinates (
                           
                              
                              
                                 
                                 ¯
                              
                              
                           
                        ). Similarly, the thin lens camera model allows for such a formulation as follows:

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                          C
                                       
                                       
                                          
                                             p
                                             ¯
                                          
                                          f
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   
                                                      x
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   
                                                      y
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   
                                                      z
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      S
                                                   
                                                   x
                                                   ·
                                                   p
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                         S
                                                      
                                                      y
                                                   
                                                   ·
                                                   p
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   
                                                      z
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                    ∝
                                    
                                       [
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                   −
                                                   
                                                      1
                                                      f
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                    ·
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   z
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        introducing the focused projection C
                        
                           p
                        
                        f of the point in space C
                        
                           p
                        , both vectors represented in 3-D in S
                        C. The metric 2-D orthogonal projection of C
                        
                           p
                        
                        f {C
                        x
                        f, C
                        y
                        f} can be transformed to a virtual S
                        S using the length p of the virtual sensor element. The virtual sensor corresponds to the sensor that would produce the synthetic images delivered e.g. by the RxLive software out of raw sensor images. Note that we choose to shift pixel values to the center of projection at the principal axis of the camera since camera calibration is less sensitive to the actual position of the principal point (at the cost of a slightly different pose of S
                        C, see Refs. [17,18]) and because lens distortion will feature its own 2-D origin {C
                        x
                        r, C
                        y
                        r} in the first place.

The internal depth d of projections C
                        z
                        f is the central value of this model. It depends on the actual range r to the scene C
                        z and on the focal length f of the main lens. In the case of the focused plenoptic camera it is possible to estimate C
                        z
                        f using raw camera projections, see Fig. 2. In fact, the depth estimation algorithm of Raytrix cameras delivers the distance a between the MLA and the internal depth C
                        z
                        f in multiples of the distance b between the MLA and the sensor chip, which is an unknown value related with camera production [19]. That relative distance is called virtual depth 
                           
                              v
                              =
                           
                         
                        a/b. In detail, virtual depths are provided as normalized values P coded in 16 bits that are to be converted to real values and divided by their potential maximum 65535, resulting in values in the range of [0.5, 1.0). This normalized internal depth value is transformed to actual, relative virtual depths 
                           
                              v
                              =
                              
                                 
                                    (
                                    1
                                    −
                                    P
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              ,
                           
                         which are in turn related to the internal depth projections using b and the distance h between the MLA and S
                        C as follows:

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                          C
                                       
                                       
                                          z
                                          f
                                       
                                    
                                    =
                                    v
                                    ·
                                    b
                                    +
                                    h
                                    .
                                 
                              
                           
                        Virtual depths are, however, of limited use to final applications because they are not metric and because they involve a nonlinear relationship with the actual depths in the scene C
                        z. In order to be able to transform virtual depths into actual metric depths it is necessary to estimate b and h with high accuracy. It is worth noting that it is the knowledge of virtual depths v that enables plenoptic cameras to deliver synthetic, total focus 2-D brightness images composed of projections at their respective focused depths C
                        z
                        f.

Our method is based on the two types of synthetic images explained above: first, depth images featuring virtual depths v at their virtual sensor projections {S
                        x, S
                        y}, and second, total focus images featuring actual, focused brightness values captured at the same virtual sensor projections {S
                        x, S
                        y}. Traditional pinhole camera calibration approaches only use the latter brightness images, minimizing reprojection residuals in S
                        S for optimal estimation of intrinsic parameters following the maximum likelihood criterion, which holds because checkerboard corner detection by image processing is prone to errors that can be modeled by 2-D independent and identically distributed zero-mean Gaussian distributions [13,14]. In the case of the thin lens camera model, the information conveyed by brightness images, together with the model of the calibration target, does allow to parameterize Eq. (2) including C
                        z
                        f. In order to estimate the unknown intrinsic parameters b and h in Eq. (3), however, the information v conveyed by the virtual depth images is also needed. The previous calibration approaches for focused plenoptic cameras included both types of data into the thin lens camera model in Eqs. (2) and (3) in order to obtain all intrinsic and extrinsic parameters by global minimization of Euclidean 3-D residual distances [9]. It is difficult to justify the optimality of that approach in the face of multi-modal data and an aleatory choice of residuals. Virtual depth images feature a much higher level of noise than brightness images after all. It is clear that by using multi-modal data for joint optimization, the accuracy of all results will be compromised by both noise sources—especially by the strongest source, i.e., the virtual depth images. Even though information theory says that even the noisiest bit of information is able to increase the overall information budget, in reality this is here not the case as the stochastic error distribution of virtual depths has not yet been properly modeled.

In this work we note that most intrinsic parameters of the thin lens camera model can be estimated without having to make recourse to noisy virtual depth images. Virtual depths are a new type of information that is not yet accurately understood and modeled. We propose to recur to this type of data only when strictly necessary by the following procedure (cf. Fig. 2):

                           
                              1.
                              First, the focal length f and, in the case of radial lens distortion, the parameters (C
                                 x
                                 r, C
                                 y
                                 r, k
                                 1 and perhaps k
                                 2) are automatically estimated using brightness images. As a by-product, we obtain the optimal extrinsic parameters of the camera (i.e., the camera motion) with highest accuracy as well as the optimal internal depths of projections C
                                 z
                                 f. The intrinsic parameters are then fixed for future estimations. Camera calibration from brightness images is a trusted science after all.

Second, virtual depths images are used to estimate the inner lengths b and h in Eq. (3)—perhaps together with the parameters of a depth distortion model.

In addition, the detachment of these two types of information during the calibration process proves to be useful whenever it is required to robustify the calibration process against data outliers. For example, the whole set of brightness features can be used to perform lateral calibration (Stage #1) whereas the most noisy depth values can be readily removed during the estimation of the depth-related parameters (Stage #2). This is not possible when using the state-of-the-art calibration algorithms that mix both data types during calibration. An additional advantage is that the lens distortion model and the depth distortion model will not become entangled within a sole optimization, which otherwise would be a problem since both models are potentially similar. Lastly, the unwanted correlations between the focal length f and the inner camera lengths b and h are suppressed.

Without loss of generality in this work we suggest checkerboard calibration patterns [20]. In Ref. [12] the author chooses circular features because Raytrix, historically, did so. They calculate their projected centroids and average over the depth values of the whole ellipse. It is worth noting, however, that in the case of circular features, the center of the ellipse is generally not the same as the projected circle center [21]. Similarly, averaging over depth values of the ellipse to find the depth of its centroid is also prone to errors. Both of these aspects are better managed when using checkerboard patterns. The correspondence problem is easily solved e.g. by using the calibration software DLR CalDe [22].

Lastly, we introduce automatic, sequential initialization schemes for all parameters involved in the staged calibration.

By removing the third, depth-related row in Eq. (2) we obtain:

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                            S
                                                         
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                            S
                                                         
                                                         y
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          
                                             
                                             
                                             ∝
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            1
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                            −
                                                            
                                                               1
                                                               f
                                                            
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                             ·
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            x
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            y
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            z
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             =
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            1
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                            −
                                                            
                                                               1
                                                               f
                                                            
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                             ·
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               O
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            
                                                               
                                                                  t
                                                               
                                                               O
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                             ·
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               O
                                                            
                                                            x
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               O
                                                            
                                                            y
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                               O
                                                            
                                                            z
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which represents a projection model from 3-D coordinates in S
                        C or the object reference frame S
                        O to 2-D projections in S
                        S. This formulation is fully in the spirit of the thin lens camera model. Since the calibration object is planar, i.e., O
                        z≜0, this formulation allows for rapid initialization of the focal length f and the rigid body transformation 
                           
                              {
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       R
                                    
                                    O
                                 
                              
                              =
                              
                                 [
                                 
                                    r
                                    1
                                 
                                 
                                    r
                                    2
                                 
                                 
                                    r
                                    3
                                 
                                 ]
                              
                              ,
                              
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       t
                                    
                                    O
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                          C
                                       
                                       
                                          x
                                          O
                                       
                                    
                                    
                                       
                                          
                                          C
                                       
                                       
                                          y
                                          O
                                       
                                    
                                    
                                       
                                          
                                          C
                                       
                                       
                                          z
                                          O
                                       
                                    
                                    ]
                                 
                                 T
                              
                              }
                           
                         using planar homographies 
                           H
                        
                        (3×3) similar to the traditional pinhole approach in Refs. [13,14]. Homographies 
                           H
                         can be easily estimated for every calibration image as the linear least squares solution of the homogeneous formulation including two equations for every measured (
                           
                              
                              
                                 
                                 ˜
                              
                              
                           
                        ) feature 
                           
                              
                                 
                                 S
                              
                              
                                 p
                                 ˜
                              
                           
                         
                        [23]. The importance of normalizing data cannot be overestimated at this point.

First, a novel correspondence between the homography and the unknown transformations is established:

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                                
                                                   (
                                                   3
                                                   ×
                                                   3
                                                   )
                                                
                                             
                                             =
                                             
                                                [
                                                
                                                   h
                                                   1
                                                
                                                
                                                
                                                   h
                                                   2
                                                
                                                
                                                
                                                   h
                                                   3
                                                
                                                ]
                                             
                                             ∝
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            1
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            
                                                            −
                                                            
                                                               1
                                                               f
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                             ·
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            
                                                               
                                                                  t
                                                               
                                                               O
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                          ≈
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  1
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                  −
                                                                  
                                                                     1
                                                                     f
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   ︸
                                                
                                                
                                                   A
                                                   
                                                      (
                                                      3
                                                      ×
                                                      3
                                                      )
                                                   
                                                
                                             
                                             ·
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            r
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            r
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                               C
                                                            
                                                            
                                                               
                                                                  t
                                                               
                                                               O
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                             ⇔
                                             
                                             f
                                             ≪
                                             
                                                
                                                   
                                                   C
                                                
                                                z
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The correspondence has been simplified because the focal length is generally much shorter than the range to the feature in front of the main lens C
                        z, when represented in the same distance units. Now using the orthonormality constraints 
                           
                              
                                 r
                                 1
                              
                              ·
                              
                                 r
                                 2
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              
                                 r
                                 1
                              
                              ·
                              
                                 r
                                 1
                              
                              =
                              1
                              ,
                           
                         and 
                           
                              
                                 r
                                 2
                              
                              ·
                              
                                 r
                                 2
                              
                              =
                              1
                              ,
                           
                         
                        i.e., C
                        
                           R
                        
                        
                           O
                         ∈ SO(3), we obtain:

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                               
                                                                  h
                                                                  1
                                                               
                                                               )
                                                            
                                                            T
                                                         
                                                         ·
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                            
                                                               h
                                                               2
                                                            
                                                            )
                                                         
                                                         =
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                               
                                                                  h
                                                                  1
                                                               
                                                               )
                                                            
                                                            T
                                                         
                                                         ·
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                            
                                                               h
                                                               1
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               
                                                               
                                                                  h
                                                                  2
                                                               
                                                               )
                                                            
                                                            T
                                                         
                                                         ·
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                            
                                                               h
                                                               2
                                                            
                                                            )
                                                         
                                                         =
                                                         0
                                                      
                                                   
                                                
                                             
                                             }
                                          
                                       
                                       
                                       
                                          
                                       
                                    
                                    
                                       
                                          
                                             ⇔
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                               1
                                                               T
                                                            
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               ∞
                                                            
                                                            
                                                            
                                                               h
                                                               2
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                               1
                                                               T
                                                            
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               ∞
                                                            
                                                            
                                                            
                                                               h
                                                               1
                                                            
                                                            =
                                                            
                                                               h
                                                               2
                                                               T
                                                            
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               ∞
                                                            
                                                            
                                                            
                                                               h
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                       
                                          
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        with the so-called absolute conic

                           
                              (7)
                              
                                 
                                    
                                       
                                          ω
                                       
                                       ∞
                                    
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          −
                                          T
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   p
                                                   2
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   p
                                                   2
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   f
                                                   2
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                        Eq. (6) enable the direct estimation (
                           
                              
                              
                                 
                                 ^
                              
                              
                           
                        ) of the focal length f either using the orthogonality constraint (
                           
                              
                                 f
                                 ^
                              
                              1
                           
                        ) or using the normalization constraint (
                           
                              
                                 f
                                 ^
                              
                              2
                           
                        ):

                           
                              (8)
                              
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       1
                                    
                                    =
                                    ±
                                    p
                                    ·
                                    
                                       
                                          
                                             −
                                             
                                                h
                                                11
                                             
                                             
                                                h
                                                12
                                             
                                             +
                                             
                                                h
                                                21
                                             
                                             
                                                h
                                                22
                                             
                                          
                                          
                                             
                                                h
                                                31
                                             
                                             
                                                h
                                                32
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          f
                                          ^
                                       
                                       2
                                    
                                    =
                                    ±
                                    p
                                    ·
                                    
                                       
                                          
                                             
                                                h
                                                
                                                   12
                                                
                                                2
                                             
                                             +
                                             
                                                h
                                                
                                                   22
                                                
                                                2
                                             
                                             −
                                             
                                                h
                                                
                                                   11
                                                
                                                2
                                             
                                             −
                                             
                                                h
                                                
                                                   21
                                                
                                                2
                                             
                                          
                                          
                                             
                                                h
                                                
                                                   31
                                                
                                                2
                                             
                                             −
                                             
                                                h
                                                
                                                   32
                                                
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        for every single calibration image of the checkerboard plate. Note that 
                           
                              
                                 h
                                 1
                              
                              =
                              
                                 
                                    [
                                    
                                    
                                       h
                                       11
                                    
                                    
                                    
                                       h
                                       21
                                    
                                    
                                    
                                       h
                                       31
                                    
                                    ]
                                 
                                 T
                              
                           
                         and 
                           
                              
                                 h
                                 2
                              
                              =
                              
                                 
                                    [
                                    
                                    
                                       h
                                       12
                                    
                                    
                                    
                                       h
                                       22
                                    
                                    
                                    
                                       h
                                       32
                                    
                                    ]
                                 
                                 T
                              
                           
                        . The only required data for the metric initialization of f are the side length p of the virtual sensor pixel featuring total focus and virtual depth images together with the geometry of the checkerboard calibration plate, i.e., the N coordinates of its corners 
                           
                              
                                 
                                    
                                    O
                                 
                                 
                                    p
                                    i
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                          O
                                       
                                       
                                          x
                                          i
                                       
                                    
                                    
                                    
                                       
                                          
                                          O
                                       
                                       
                                          y
                                          i
                                       
                                    
                                    
                                    
                                       
                                          
                                          O
                                       
                                       
                                          z
                                          i
                                       
                                    
                                    ]
                                 
                                 T
                              
                              ,
                              
                              ∀
                              i
                              ∈
                              
                                 {
                                 1
                                 ,
                                 
                                 …
                                 ,
                                 N
                                 }
                              
                           
                        . The requirement on the knowledge of the latter geometry could, however, be partially lifted [16]. Experiments show that the estimation 
                           
                              
                                 f
                                 ^
                              
                              2
                           
                         is slightly better conditioned with regard to the amount of perspective distortion included in the calibration images (orthogonal plate projections are widely discouraged for camera calibration [24]). We choose the median of all the 
                           
                              
                                 f
                                 ^
                              
                              2
                           
                         estimations for every C calibration images, arriving at a value 
                           
                              
                                 f
                                 ^
                              
                              =
                              median
                              
                                 (
                                 
                                    
                                       f
                                       ^
                                    
                                    
                                       2
                                       c
                                    
                                 
                                 )
                              
                              ,
                              
                              ∀
                              c
                              ∈
                              
                                 {
                                 1
                                 ,
                                 
                                 …
                                 ,
                                 C
                                 }
                              
                              ,
                           
                         that closely matches the nominal focal length of the lens unit.

The absolute extrinsic camera parameters {C
                        
                           R
                        
                        
                           O
                        , C
                        
                           t
                        
                        
                           O
                        } can then be estimated for every calibration image c using both, the C homographies 
                           H
                        
                        
                           c
                         and the approximated intrinsic matrix 
                           A
                         including the virtual pixel size p and the newly estimated focal length 
                           
                              f
                              ^
                           
                         as follows: 
                           
                              
                                 
                                    
                                       r
                                       ^
                                    
                                    1
                                 
                                 =
                                 1
                                 /
                                 s
                                 
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    h
                                    1
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    
                                       r
                                       ^
                                    
                                    2
                                 
                                 =
                                 1
                                 /
                                 s
                                 
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    h
                                    2
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    
                                       r
                                       ^
                                    
                                    3
                                 
                                 =
                                 
                                    
                                       r
                                       ^
                                    
                                    1
                                 
                                 ×
                                 
                                    
                                       r
                                       ^
                                    
                                    2
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    t
                                    ^
                                 
                                 =
                                 1
                                 /
                                 s
                                 
                                 
                                    
                                       A
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    h
                                    3
                                 
                              
                              ,
                           
                         and 
                           
                              
                                 s
                                 =
                                 ∥
                              
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 h
                                 1
                              
                              
                                 ∥
                                 =
                                 ∥
                              
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 h
                                 2
                              
                              
                                 ∥
                              
                           
                        . These can also be used for a potential hand-eye calibration of the plenoptic camera [25].

At this point all parameters have been estimated with reasonable accuracy. It is known that the radial lens distortion parameters can be initialized at zero value for subsequent nonlinear optimization. If necessary, they can also be estimated in advance, perhaps stand-alone [26,27].

Last, the optimal (⋆) parameters 
                           
                              
                                 
                                    Ω
                                 
                                 ^
                              
                              ☆
                           
                         including 
                           
                              
                                 
                                    f
                                    ^
                                 
                                 ☆
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       x
                                       ^
                                    
                                    
                                       r
                                       ☆
                                    
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       y
                                       ^
                                    
                                    
                                       r
                                       ☆
                                    
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    k
                                    ^
                                 
                                 
                                    1
                                    ☆
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 k
                                 ^
                              
                              
                                 2
                                 ☆
                              
                           
                         as well as the C extrinsic transformations 
                           
                              {
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       R
                                       ^
                                    
                                    
                                       c
                                       ☆
                                    
                                    O
                                 
                              
                              ,
                              
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       t
                                       ^
                                    
                                    
                                       c
                                       ☆
                                    
                                    O
                                 
                              
                              }
                           
                         can be estimated on the basis of the maximum likelihood criterion, i.e., by sensibly minimizing the discrepancies between the erroneous measurements 
                           
                              p
                              ˜
                           
                         and the expected, distorted projections 
                           
                              
                                 
                                 S
                              
                              
                                 
                                    p
                                    ^
                                 
                                 d
                              
                           
                         of the actual corners of the calibration plate O
                        
                           p
                         as follows:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          ^
                                       
                                       ☆
                                    
                                    =
                                    arg
                                    
                                       min
                                       
                                          
                                             Ω
                                          
                                          ^
                                       
                                    
                                    
                                       ∑
                                       
                                          c
                                          =
                                          1
                                       
                                       C
                                    
                                    
                                       ∑
                                       i
                                    
                                    
                                       
                                          ∥
                                          
                                             
                                                
                                                S
                                             
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                
                                                   {
                                                   c
                                                   ,
                                                   
                                                   i
                                                   }
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                S
                                             
                                             
                                                
                                                   p
                                                   ^
                                                
                                                d
                                                
                                                   {
                                                   c
                                                   ,
                                                   
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   Ω
                                                
                                                ^
                                             
                                             ,
                                             
                                             p
                                             ,
                                             
                                             
                                                
                                                   
                                                   O
                                                
                                                
                                                   p
                                                   i
                                                
                                             
                                             )
                                          
                                          ∥
                                       
                                       2
                                    
                                    .
                                 
                              
                           
                        The expected projections 
                           
                              
                                 
                                 S
                              
                              
                                 
                                    p
                                    ^
                                 
                                 d
                              
                           
                         depend on the calibration parameters 
                           Ω
                         to be optimized, on the side length p, and on the known geometry of the corners of the calibration plate O
                        
                           p
                        . The calibration parameters 
                           Ω
                         are initialized as explained above.

A word of caution regarding the formulation of the lens distortion model as in Ref. [28]: First, the only formulation that is correct on a physical ground, viz. based on Snell’s refraction law, applies to virtual, undistorted projections derived from the actual scene (u→d formulation). Many authors apply the formulation the other way around (d→u formulation), which is wrong on a strict, physical ground and can be potentially misinterpreted when it comes to using the parameterized model. Experiments show, however, that the d→u formulation does come very close by the physically-conform u→d formulation [23]. Second, it is necessary to state the dimensions of the lens distortion model along with delivering the calibration results, i.e., whether it has been estimated on normalized directional coordinates or on projected pixels or millimeters. Third, it is a good idea to use C
                        x
                        r and C
                        y
                        r to detach the camera’s principal point from the origin of lens distortion, which is equivalent to releasing the first degree of freedom of lens decentering distortion [18].

Metric calculation of depths in front of a plenoptic camera demands metric knowledge about its inner lengths b and h. These parameters connect virtual depths with actual ranges in S
                        C, cf. Eq. (3). It is by the relationship between virtual and actual depths that we will be able to estimate these parameters in a novel way.

In Section 2.3 we removed the third row of the system of equations in Eq. (2)
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                          C
                                       
                                       
                                          z
                                          f
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                             C
                                          
                                          z
                                       
                                       
                                          −
                                          
                                             
                                                
                                                C
                                             
                                             z
                                          
                                          /
                                          f
                                          +
                                          1
                                       
                                    
                                    /
                                    
                                       
                                          
                                          C
                                       
                                       z
                                    
                                    =
                                    
                                       r
                                       31
                                    
                                    
                                    
                                       
                                          
                                          O
                                       
                                       x
                                    
                                    +
                                    
                                       r
                                       32
                                    
                                    
                                    
                                       
                                          
                                          O
                                       
                                       y
                                    
                                    +
                                    
                                       r
                                       33
                                    
                                    
                                    
                                       
                                          
                                          O
                                       
                                       z
                                    
                                    +
                                    
                                       
                                          
                                          C
                                       
                                       
                                          z
                                          O
                                       
                                    
                                    ,
                                 
                              
                           
                        obtaining Eq. (4). Eq. (10), however, can readily be executed after optimal estimation of the other intrinsic parameters in Eq. (9), obtaining optimal depth values 
                           
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       z
                                       ^
                                    
                                    f
                                 
                              
                              ☆
                              
                                 {
                                 c
                                 ,
                                 
                                 i
                                 }
                              
                           
                         for all features and C calibration images. These values, together with the virtual depths 
                           
                              
                                 v
                                 ˜
                              
                              
                                 {
                                 c
                                 ,
                                 
                                 i
                                 }
                              
                           
                         acquired during calibration, can be used to estimate the inner lengths h and b by using Eq. (3). First, we initialize these values by ordinary least squares on all available data:

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                            ˜
                                                         
                                                         
                                                            {
                                                            1
                                                            ,
                                                            
                                                            1
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            v
                                                            ˜
                                                         
                                                         
                                                            {
                                                            1
                                                            ,
                                                            
                                                            2
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             ]
                                          
                                          ︸
                                       
                                       
                                          
                                             C
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             
                                                h
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                            C
                                                         
                                                         
                                                            
                                                               z
                                                               ^
                                                            
                                                            
                                                               f
                                                               ☆
                                                            
                                                            
                                                               {
                                                               1
                                                               ,
                                                               
                                                               1
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                            C
                                                         
                                                         
                                                            
                                                               z
                                                               ^
                                                            
                                                            
                                                               f
                                                               ☆
                                                            
                                                            
                                                               {
                                                               1
                                                               ,
                                                               
                                                               2
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                
                                             
                                             ]
                                          
                                          ︸
                                       
                                       
                                          
                                             d
                                          
                                       
                                    
                                    ⇒
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   b
                                                   ^
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                   ^
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    inv
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          T
                                       
                                       C
                                       )
                                    
                                    
                                       
                                          C
                                       
                                       T
                                    
                                    d
                                    .
                                 
                              
                           
                        Note that these parameters can be estimated using a sole calibration image but using more data is beneficial. Earlier approaches initialized these parameters using privileged information from the manufacturer, together with the focus distance that can be gauged from the lens unit, which is both inconvenient and error-prone.

After that, the whole thin lens camera model can be used to optimize only these two parameters 
                           
                              
                                 
                                    Φ
                                 
                                 ^
                              
                              =
                              
                                 {
                                 
                                    b
                                    ^
                                 
                                 ,
                                 
                                    h
                                    ^
                                 
                                 }
                              
                           
                         as follows:

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          ^
                                       
                                       ☆
                                    
                                    =
                                    arg
                                    
                                       min
                                       
                                          
                                             Φ
                                          
                                          ^
                                       
                                    
                                    
                                       ∑
                                       
                                          c
                                          =
                                          1
                                       
                                       C
                                    
                                    
                                       ∑
                                       i
                                    
                                    
                                       
                                          ∥
                                          
                                             
                                                
                                                C
                                             
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                f
                                                
                                                   {
                                                   c
                                                   ,
                                                   
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   Φ
                                                
                                                ^
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                C
                                             
                                             
                                                
                                                   p
                                                   ^
                                                
                                                
                                                   f
                                                   ,
                                                   d
                                                
                                                
                                                   {
                                                   c
                                                   ,
                                                   
                                                   i
                                                   }
                                                
                                             
                                          
                                          
                                             (
                                             p
                                             ,
                                             
                                             
                                                
                                                   
                                                   O
                                                
                                                
                                                   p
                                                   i
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   ^
                                                
                                                ☆
                                             
                                             )
                                          
                                          ∥
                                       
                                       2
                                    
                                    ,
                                 
                              
                           
                        making use of the optimal parameters 
                           
                              
                                 
                                    Ω
                                 
                                 ^
                              
                              ☆
                           
                         obtained in Eq. (9). This optimization is well conditioned and converges in a few steps. Note that we opt for minimizing 3-D Euclidean distances in S
                        C between focused depths within the camera because these distances feature Gaussian noise, refer to Fig. 5. Gaussian noise is certainly not expected from reconstructed actual depths in front of the camera as the relationship in Eq. (10) is highly nonlinear. It is conceivable, however, that a minimization of reprojection errors on raw plenoptic images delivers even more accurate results.

Depth images from plenoptic cameras are also affected by systematic depth errors. The authors in Ref. [9] suggest that these are in part consequence of the Petzval field curvature aberration, which describes a slight change of focal distance for oblique projections. The authors model this distortion in a similar way to the radial lens distortion, affecting projection depth C
                        z
                        f instead of its lateral position {C
                        x, C
                        y}. Further, the authors introduce a linear dependency of this model w.r.t. the magnitude of the virtual depth. Since this type of distortion is in accordance with the nature of the lens used, we propose a more general depth distortion model:

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                C
                                             
                                             
                                                
                                                   z
                                                   ˜
                                                
                                                
                                                   f
                                                   ,
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                   C
                                                
                                                
                                                   
                                                      z
                                                      ˜
                                                   
                                                   
                                                      f
                                                      ,
                                                      u
                                                   
                                                
                                             
                                             +
                                             α
                                             ·
                                             
                                                (
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   C
                                                
                                                /
                                                
                                                   
                                                      z
                                                      ^
                                                   
                                                   C
                                                
                                                )
                                             
                                             +
                                             β
                                             ·
                                             
                                                (
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   C
                                                
                                                /
                                                
                                                   
                                                      z
                                                      ^
                                                   
                                                   C
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                ∞
                                             
                                             
                                                (
                                                
                                                   γ
                                                   i
                                                
                                                +
                                                
                                                   δ
                                                   i
                                                
                                                
                                                
                                                   
                                                      
                                                      C
                                                   
                                                   
                                                      
                                                         z
                                                         ˜
                                                      
                                                      
                                                         f
                                                         ,
                                                         u
                                                      
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     x
                                                                     ^
                                                                  
                                                                  C
                                                               
                                                               /
                                                               
                                                                  
                                                                     z
                                                                     ^
                                                                  
                                                                  C
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                         +
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     y
                                                                     ^
                                                                  
                                                                  C
                                                               
                                                               /
                                                               
                                                                  
                                                                     z
                                                                     ^
                                                                  
                                                                  C
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                   )
                                                
                                                i
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        Eq. (13) models a skewed paraboloid with factors α and β that parameterize a linear bias dependent on the lateral projection position (i.e., a planar slope, which could be consequence of inner skewness of the camera components), and γi
                         and δi
                         parameterize the linear dependency of the depth distortion w.r.t. the undistorted, focused projection depth 
                           
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       z
                                       ˜
                                    
                                    
                                       f
                                       ,
                                       u
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    v
                                    ˜
                                 
                                 ·
                                 
                                    b
                                    ^
                                 
                                 +
                                 
                                    h
                                    ^
                                 
                                 )
                              
                           
                         and the absolute lateral distance. These parameters can be added to the set of unknown parameters 
                           
                              
                                 Φ
                              
                              ^
                           
                        . As explained in the next Section 3.1, our experiments using a short focal length lens of 12.5 mm feature a stronger planar distortion w.r.t. the lateral projection position, an underlying parabolic depth distortion component, and a steep higher-degree paraboloid in 
                           
                              7
                              th
                              
                           
                         degree to cope with the strong peripheral distortion. It is known that multi-focus plenoptic cameras work best using long focal lengths and short focus distances [19]. Further research is required in this concern.

@&#RESULTS@&#

Next, the implementation of the calibration procedure is described. The parameters are then validated using a commercial range measuring table.

We use a Raytrix R5-C-K color camera featuring 4.2 Megarays and a 12.5 mm Canon lens that yields total focus and depth images with 1 MP each. We choose a low post-processing level for depth images in order not to hallucinate information by using regularization terms. Note that 
                           
                              p
                              =
                              2
                              ·
                              5.5
                              
                              μ
                              m
                           
                         is twice the side length of the actual Baumer camera pixels because we are using 1 MP virtual images instead of the raw 4 MP images.

First, eight tilted calibration images including feature ranges between 11 and 55 cm have been taken, see Fig. 3
                        . The total focus images in the top row are processed with either DLR CalDe or DLR CalDe++ [22], which flawlessly detect all 2023 visible corners and assigns them to their known coordinates in S
                        O. All of these corners will be used for calibration, i.e., data filtering is not applied. After that, the feature projections are represented around the central point of the image instead of the upper-left corner.

The initialization of the parameters requires the computation of homographies, which is performed on normalized pixel and Euclidean coordinates. In detail, C linear equation systems (one for every image 
                           
                              c
                              ,
                              
                              ∀
                              c
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              C
                              }
                           
                        ) are solved in a least-square sense using the single value decomposition. The homographies are then transformed back to their original dimensions by matrix multiplication [23]. The 2-D reprojection root mean square (RMS) error using homographies amounts to 3.3 pixels. Next, we estimate the focal length of the lens using Eq. (8) with the result of 
                           
                              
                                 f
                                 ^
                              
                              =
                              12.01
                              
                              mm
                           
                        . It is clear that, in the absence of radial distortion correction, the estimated focal length diverges from reality as the apparent scaling factor is compromised. This initial value is, however, valid for subsequent nonlinear optimization of the whole model. Next, the C absolute extrinsics of the camera w.r.t. the calibration plate 
                           
                              {
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       R
                                    
                                    c
                                    O
                                 
                              
                              ,
                              
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       t
                                    
                                    c
                                    O
                                 
                              
                              }
                           
                         are estimated as explained in Section 2.3. A pinhole camera model featuring 
                           
                              f
                              ^
                           
                         and 
                           
                              {
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       R
                                       ^
                                    
                                    c
                                    O
                                 
                              
                              ,
                              
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       t
                                       ^
                                    
                                    c
                                    O
                                 
                              
                              }
                           
                         shows a reprojection RMS error of 3.6 pixels.

At this point the thin lens camera model optimization described in Eq. (9) takes place. The optimization is performed using the 
                           lsqnonlin
                         method in MATLAB®, a Levenberg–Marquardt implementation. After 14 iterations and 8 s it successfully optimizes the model’s parameters yielding a reprojection RMS error of 0.39 pixels. Such a low reprojection residual indicates a highly accurate parametrization and pose estimation—in consideration of the megapixel size of the images and the fact that images are filled with features to the brim. The optimal focal length 
                           
                              
                                 f
                                 ^
                              
                              ☆
                           
                         amounts to 12.76 mm and the lens distortion parameters are detailed in Fig. 4 (a).
                     

By way of contrast, we also implemented a plain (non-iterative) joint optimization of all intrinsic parameters (including b and h) using all virtual images. The optimization delivers erroneous radial distortion parameters because they compensate for noisy virtual depth values and a potential depth distortion model featuring radial components, see Fig. 4 (b). This effect can be mathematically interpreted as bad conditioning and/or local minima because a constrained optimization featuring fixed optimal intrinsic values as obtained by our method does yield a lower residual cost. In fact, the authors in Ref. [9] encountered the same difficulties. Therefore, they proposed an empirical optimization approach using iterative, constrained optimization steps within the framework of sequential quadratic programming.

Second, the calibration of the inner lengths of the camera between the MLA and the image plane (b) and between the main lens and the MLA (h) is conducted as in Section 2.4. The initialization of these parameters by solving the system of equations in Eq. (11) uses the optimal depth values 
                           
                              
                                 
                                    
                                    C
                                 
                                 
                                    z
                                    ^
                                 
                              
                              
                                 f
                                 ☆
                              
                              
                                 {
                                 c
                                 ,
                                 
                                 i
                                 }
                              
                           
                         for all features and C calibration images together with the virtual depths 
                           
                              
                                 v
                                 ˜
                              
                              
                                 {
                                 c
                                 ,
                                 
                                 i
                                 }
                              
                           
                         in the bottom row of Fig. 3. It is convenient to filter the depth values in case of missing pixels or noise artifacts. The author in Ref. [12] averages the virtual depth values of a whole image blob. Instead, we opt for using the median value within a radius of 5 pixels around the measured projections 
                           
                              
                                 
                                 S
                              
                              
                                 
                                    p
                                    ˜
                                 
                                 
                                    {
                                    c
                                    ,
                                    
                                    i
                                    }
                                 
                              
                           
                        . The values estimated by the linear least-squares method for the distances 
                           
                              b
                              ^
                           
                         and 
                           
                              h
                              ^
                           
                         are 0.397 and 11.969 mm, respectively.

Next comes the second nonlinear optimization in Eq. (12). This optimization is well conditioned, taking 2 iterations and 1 s. The final values for the inner lengths are 
                           
                              
                                 
                                    b
                                    ^
                                 
                                 ☆
                              
                              =
                              0.432
                              
                              mm
                           
                         and 
                           
                              
                                 
                                    h
                                    ^
                                 
                                 ☆
                              
                              =
                              11.850
                              
                              mm
                           
                         (both are actually negative, owing to the formulation choice). The nonzero parameters of the depth distortion model are also estimated: 
                           
                              α
                              =
                              −
                              0.080
                              ,
                           
                        
                        
                           
                              β
                              =
                              −
                              0.044
                              ,
                           
                        
                        
                           
                              
                                 γ
                                 2
                              
                              =
                              −
                              0.127
                              ,
                           
                        
                        
                           
                              
                                 γ
                                 7
                              
                              =
                              −
                              190.03
                              ,
                           
                         and 
                           
                              
                                 δ
                                 7
                              
                              =
                              14.82
                           
                        . Note that we minimize 3-D Euclidean distances between focused projections in S
                        C within the camera, refer to Fig. 5
                        . The optimization engine used is, again, MATLAB®’s 
                           lsqnonlin
                        .

We collect independent range data in order to validate the last section’s results. To this end we use a commercial range measuring table and a known planar calibration pattern, see Fig. 6
                        
                        . The camera is mounted on the vertical axis and is shifted in range from 10 to 90 cm in 80 steps of 1 cm.

Note that it is also possible to estimate range accuracy without an external measuring system. On the one hand, 3-D reprojections are computed from both, virtual depth images (e.g. of the calibration pattern) and the optimal intrinsic parameters, using Eqs. (2) and (3). On the other hand, 3-D estimations of the same features’ structure can be computed using total focus brightness images, the local model of the calibration pattern, and the intrinsic parameters estimated in Section 2.3. The latter method is preferably in the form of a nonlinear optimization similar to Eq. (9), now with fixed, optimal intrinsic parameters. The method is known as model-based structure estimation and is highly accurate when using regular pinhole cameras with an adequate angular field of view [24]. Unfortunately, high accuracy is yet to be verified in the context of plenoptic cameras. In this section we also consider the accuracy of model-based structure estimation using total focus brightness images.


                        Fig. 7 (a) shows the absolute range accuracy w.r.t. registered ground truth of model-based structure estimation using the total focus brightness images of the Raytrix camera, the known model of the calibration plate O
                        
                           p
                        
                        
                           i
                        , and the thin lens camera model parameterized using Section 3.1 including 
                           
                              
                                 
                                    f
                                    ^
                                 
                                 ☆
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    k
                                    ^
                                 
                                 
                                    1
                                    ☆
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    k
                                    ^
                                 
                                 
                                    2
                                    ☆
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    
                                    C
                                 
                                 
                                    
                                       x
                                       ^
                                    
                                    
                                       r
                                       ☆
                                    
                                 
                              
                              ,
                           
                         and 
                           
                              
                                 
                                 C
                              
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    r
                                    ☆
                                 
                              
                           
                        . Range data shows highest accuracy with a standard deviation of 0.18 mm in the range between 10 and 90 cm—irrespective of the actual depth, which matches the precision of the measuring system. Note that this validation range is larger than the distances used for camera calibration. Therefore, model-based structure estimation using the thin lens camera model that has been parameterized using the method presented in Section 2.3 does indeed yield highly accurate range estimations.


                        Fig. 7 (b) in turn shows the same absolute range accuracy plot, now using the light-field range measurements reprojected from virtual depths. All corner measurements within an angular field of view of 30° have been used (between 9 and 450 depending on the camera height, cf. Fig. 6). In this way we include the problematic depth distortion model in the validation results. We obtain highly accurate measurements in short range between 10 and 25 cm with an accuracy of 1 mm. From that point through to 90 cm an unsteady bias appears within the range of ± 2 cm. Note that due to the overall unbiased results, these range measurements do not require any bias correction factor, cf. Ref. [9] with a correction factor of 25 cm. These are good accuracy values considering the extended measurement range beyond calibration data and the highly noisy nature of virtual depths.

@&#CONCLUSION@&#

In this work we introduce a novel method for the calibration of focused plenoptic monocular cameras that leverages long-established practice for the calibration of standard monocular cameras [13,14]. We decouple the calibration of the traditional capabilities of plenoptic cameras from the calibration of their novel features related with depth estimation. In this way, the higher noise levels of the latter novel features will not affect the estimation of traditional parameters like the focal length and the radial lens distortion. Further advantages are: First, different robustification methods can be applied to the input data (either total focus or depth images) in accordance to their specific propensity toward outliers. Second, both subtasks are simpler, enabling novel, rapid initialization schemes for all parameters where the only required physical data are the metric size of the sensor elements (pixels) and the local geometry of the calibration pattern. Third, neither the correlated lens and depth distortion models nor the inner lengths f, b and h will get entangled during optimization. In addition, we address particular details on the modeling of this sort of cameras and suggest modifications in the choice of the minimization space of the depth distortion model.

Experiments show the rapid convergence of the approach along with its accuracy on independent ground-truth validation data.

Future work comprises the study of the depth distortion model and the skewness of single camera components with regard to the lens unit used. The inclusion of the geometry of the MLA in the calibration algorithm should be addressed as well as the consideration of the three different types of microlenses used in the MLAs of Raytrix cameras [12]. In addition, a calibration approach based on raw plenoptic images would generalize this formulation to jointly calibrate unfocused and focused plenoptic cameras [29].

@&#REFERENCES@&#

