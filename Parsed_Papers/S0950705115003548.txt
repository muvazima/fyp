@&#MAIN-TITLE@&#Gravitational fixed radius nearest neighbor for imbalanced problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We use the gravitational scenario into the fixed radius nearest neighbor rule.


                        
                        
                           
                           The proposed GFRNN deals with imbalanced classification problem.


                        
                        
                           
                           GFRNN does not need any manual parameter setting or coordination.


                        
                        
                           
                           Comparison experiments on 40 datasets validate its effectiveness and efficiency.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fixed radius search

Nearest neighbor rule

Imbalanced data

Pattern classification

@&#ABSTRACT@&#


               
               
                  This paper proposes a novel learning model that introduces the calculation of the pairwise gravitation of the selected patterns into the classical fixed radius nearest neighbor method, in order to overcome the drawback of the original nearest neighbor rule when dealing with imbalanced data. The traditional k nearest neighbor rule is considered to lose power on imbalanced datasets because the final decision might be dominated by the patterns from negative classes in spite of the distance measurements. Differently from the existing modified nearest neighbor learning model, the proposed method named GFRNN has a simple structure and thus becomes easy to work. Moreover, all parameters of GFRNN do not need initializing or coordinating during the whole learning procedure. In practice, GFRNN first selects patterns as candidates out of the training set under the fixed radius nearest neighbor rule, and then introduces the metric based on the modified law of gravitation in the physical world to measure the distance between the query pattern and each candidate. Finally, GFRNN makes the decision based on the sum of all the corresponding gravitational forces from the candidates on the query pattern. The experimental comparison validates both the effectiveness and the efficiency of GFRNN on forty imbalanced datasets, comparing to nine typical methods. As a conclusion, the contribution of this paper is constructing a new simple nearest neighbor architecture to deal with imbalanced classification effectively without any manually parameter coordination, and further expanding the family of the nearest neighbor based rules.
               
            

@&#INTRODUCTION@&#

Class distribution is defined as the proportion of patterns belonging to different classes in a dataset and plays a pivotal role in pattern recognition [11,12,38]. As a special case of class distribution, the imbalanced dataset is the case that the number of patterns from one class is far less than those belonging to the other classes [3,5,12,15]. Further in real-world classification tasks, the class with less patterns generally attracts more interests than the others and then is defined as the positive class [2,11,24]. Correspondingly, the other classes with more patterns are defined as the negative classes. To be convenient, this paper abbreviates the positive class (i.e., the minority class) to POS and the negative classes (i.e., the majority classes) to NEG. Generally in binary-class imbalanced problems, one indicator named the Imbalance Ratio (IR) [26] is defined in Eq. (1) to measure the imbalance degree of one dataset:

                        
                           (1)
                           
                              
                                 I
                                 R
                                 =
                                 
                                    
                                       N
                                       
                                          N
                                          E
                                          G
                                       
                                    
                                    
                                       N
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     where N
                        NEG
                      and N
                        POS
                      mean the number of patterns from NEG and POS, respectively.

The previous research studies [2,3,11,15] have revealed that the traditional classification methods deteriorate more or less when dealing with the imbalanced datasets. The classical k Nearest Neighbor search algorithm (kNN) has no exception [19,20,23,33]. kNN used to be evaluated as one of the top 10 algorithms in data mining [37] because of its simple but powerful principle, which recognizes a query pattern only based on the most frequent class distribution of its k nearest neighbors in testing steps [8]. However, kNN might be misled in imbalanced problems because that 1) the decision of kNN might be dominated by the NEG patterns around the query pattern [23] and 2) the selection of k is data-dependent and difficult to tune [33]. For instance, a kNN with 
                        
                           k
                           =
                           7
                        
                      is prone to classify a query pattern into NEG in a binary-case, in spite of the fact that the two nearest neighbors belong to POS and the other five farside patterns belong to NEG.

The existing solutions for imbalanced problems can be categorized into three parts: firstly, the data-oriented methods use sampling techniques to achieve the equilibrium of the class distribution, such as the typical over-sampling method named SMOTE [7] that increases the size of POS with the synthetic patterns. Secondly, the cost-sensitive methods consider the penalties associated with misclassifying patterns [34]. Finally, the ensemble methods improve the performance of each used classifier [11]. Nevertheless, research studies on kNN with imbalanced datasets are far from enough [20]. In general, the corresponding interests of kNN for imbalanced problem can be divided into two branches: the pattern-oriented methods aiming to amplify the effect of each POS pattern [20,39] and the distribution-oriented methods trying to acquire more informative prior knowledge of global distribution [10,19,23]. For the first branch, one typical pattern-oriented method is the k Exemplar-based Nearest Neighbor (ENN) [20] that first selects the pivot POS patterns and then expands the boundary of them into Gaussian balls. In detail, ENN uses a newly-defined distance between the query pattern and the surface of the ball of one pivot POS pattern instead of the original distance between them, leading to a nearer connection between the query one and the pivot one. Afterwards, the Positive-biased Nearest Neighbor (PNN) [39] is proposed to boost ENN by dynamically comparing the distance between the kth nearest local neighbor and the query to the distance between the rth nearest POS pattern and the query. According to the rule of PNN, one of the two parameters k and r is finally selected to balance the local distribution of the binary-class patterns. That is, the search area of the query pattern is dependent on the value of the two parameters. Differently from ENN, PNN has no training steps [39]. As a result, PNN can deal with test patterns faster. Another idea is to learn the relationship between the query and its neighbors to correct the substantial bias to major class iteratively [13]. In detail, the coordination of each iteration considers the infection from patterns of both intra-classes and inter-classes as the weight and adopts the Geometric Means metric (GM) as the measurement [13].

As for the second branch of kNN-related methods for imbalanced problems, the typical distribution-oriented strategies are listed as follows. First, the Class Confidence Weighted kNN algorithm (CCW-kNN) [23] obtains the different weights by calculating the mixture models or Bayesian networks and then imposes the weights on various neighbors as the confidence. Besides, the Class Based Weighted k Nearest Neighbor [10] generates weights for each pattern by calculating the rate of misclassification of each class by the original kNN. In addition, the Class Conditional Nearest Neighbor Distribution (CCNND) [19] compares the query pattern to patterns of each class in turn, and thus finds the most eligible class, in which the query pattern defeats the most intra-class patterns in terms of the pointwise comparison of distances to their k neighbors. Moreover, the Informative k Nearest Neighbor (IkNN) containing the localized version (LI-kNN) and the globalized version (GI-kNN) introduces a new metric that measures the informativeness between patterns first, and then finds the top I nearest patterns as the final candidates from the basic k nearest neighbors [33]. Finally, there are methods combining both of the pattern and the distribution-oriented idea, e.g., the Fuzzy-Rough k Nearest Neighbor Algorithm [14] constructs relation between the query patterns and its neighbors based on the fuzzy membership function, while some related approaches [21,22] are proposed based on the fuzzy knowledge.

It can be concluded that most of the mentioned nearest neighbor algorithms, to a certain extent, intend to learn and utilize global information to make a progress, but there is still possibility for overcoming the existing drawbacks and improving the previous work: firstly, the learning models usually seem too complex and not easy to be approached without adopting special data structures; secondly, some of the classifiers have to tune many parameters and the process for finding optimal parameters costs extra time; thirdly, the influence of the global information might be weakened during the training process. In this paper, we intend to find a simpler but more robust way to make a progress. Differently from the existing methods, we first consider to separate rather than combine the processes to acquire both global and local knowledge. In detail, we first try to eliminate ineligible patterns globally and then deal with the surviving ones that are called as candidates in this paper. To fulfill the global search task, we prefer to adopt the Fixed Radius Nearest Neighbor search strategy (FRNN) [4,25] instead of the traditional kNN. Further inspired and modified by the typical gravitation-based methods including the Data Gravitation based Classification (GDC) [27,28] strategy and the Gravitational Search Algorithm (GSA) [29,30], we aim to design and introduce a new local decision criterion based on the gravitational rule into the FRNN. Furthermore, all steps are not expected to require any parameter input manually. To our best knowledge, it is the first time to propose the gravitation-inspired FRNN without any manually-coordinated parameters. To be convenient, the novel method is called GFRNN in short.

The major contribution of this paper lies in the following aspects:

                        
                           •
                           Motivation: This paper tries to propose a new easy-to-approach nearest neighbor learning model by introducing the calculation of universal gravitation into the traditional FRNN, in order to overcome the drawback of the original nearest neighbor rule on imbalanced classification problems.

Novelty: The proposed method is expected to eliminate unnecessary patterns through the FRNN strategy and makes the final decision according to the sum of the gravitational forces between the query and the surviving patterns. Moreover, none of parameters are manually set or coordinated in the whole learning procedure.

Experiments: The experiments are designed to compare GFRNN to some typical algorithms. Specially, nine classifiers including CCNND [19], ENN [20], LI-kNN [33], PNN [39], kNN [8], FRkNN [25], C4.5 [6], Logistic Regression (LR) [16], and the Support Vector Machine (SVM) [35] are considered. Finally, the results demonstrate the effectiveness and the efficiency of the proposed method.

The rest of this paper is organized as follows. Section 2 presents the architecture of the proposed method and demonstrates relevant analyses on it. Section 3 reports on all the experimental results. Finally, conclusions are given in Section 4.

In this paper, we focus on the binary-class recognition for imbalanced datasets even though GFRNN can be generalized into the multi-class problems. At first, we suppose that there is an binary-class imbalanced dataset. The training set of the dataset is XAll
                      that includes the set of POS: 
                        
                           
                              X
                              
                                 P
                                 O
                                 S
                              
                           
                           =
                           
                              {
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    φ
                                    1
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    x
                                    2
                                 
                                 ,
                                 
                                    φ
                                    1
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    x
                                    
                                       n
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                 
                                 ,
                                 
                                    φ
                                    1
                                 
                                 )
                              
                              }
                           
                           ,
                        
                      and the set of NEG: 
                        
                           
                              X
                              
                                 N
                                 E
                                 G
                              
                           
                           =
                           
                              {
                              
                                 (
                                 
                                    x
                                    
                                       
                                          n
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    φ
                                    2
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    x
                                    
                                       
                                          n
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 ,
                                 
                                    φ
                                    2
                                 
                                 )
                              
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    x
                                    
                                       
                                          n
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                       +
                                       
                                          n
                                          
                                             N
                                             E
                                             G
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    φ
                                    2
                                 
                                 )
                              
                              }
                           
                           ,
                        
                      where 
                        
                           
                              φ
                              i
                           
                           ∈
                           
                              {
                              1
                              ,
                              −
                              1
                              }
                           
                        
                      is the label, 
                        
                           i
                           =
                           1
                        
                      for POS and 
                        
                           i
                           =
                           2
                        
                      for NEG. nPOS
                      and nNEG
                      are the number of training patterns belonging to POS and NEG, respectively. Therefore, the number of the total training patterns can be written as:

                        
                           (2)
                           
                              
                                 
                                    n
                                    
                                       A
                                       L
                                       L
                                    
                                 
                                 =
                                 
                                    n
                                    
                                       P
                                       O
                                       S
                                    
                                 
                                 +
                                 
                                    n
                                    
                                       N
                                       E
                                       G
                                    
                                 
                                 .
                              
                           
                        
                     Moreover, we define the query pattern 
                        y
                      and formulate the function d( · ) in Eq. (3) to measure the distance between two patterns. To be simple, we adopt Euclidean distance here though any appropriate measurements could be used.

                        
                           (3)
                           
                              
                                 
                                    d
                                 
                                 
                                    (
                                    
                                       x
                                       p
                                    
                                    ,
                                    
                                       x
                                       q
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∥
                                       
                                          x
                                          p
                                       
                                       −
                                       
                                          x
                                          q
                                       
                                       ∥
                                    
                                    2
                                 
                                 .
                              
                           
                        
                     In addition, the training pattern that survives from the FRNN is named candidate in sequent parts. Finally, it can be summarized that the formulation of GFRNN includes three main steps: first selecting candidates around 
                        y
                      through FRNN, then calculating the distance between 
                        y
                      and each candidate based on the simplified law of gravitation, and making the decision according to the sum of the gravitational forces of all 
                        y
                     -candidate pairs at last.

According to the literature [25], there are three most popular nearest neighbor search methods: kNN, FRNN, and the combination of kNN and FRNN (i.e., FRkNN). At first, kNN can be defined as [25]:

                           
                              (4)
                              
                                 
                                    k
                                    
                                       NN
                                    
                                    (
                                    y
                                    ,
                                    
                                       X
                                       
                                          A
                                          l
                                          l
                                       
                                    
                                    ,
                                    k
                                    )
                                    =
                                    A
                                    ,
                                 
                              
                           
                        here A is the set that satisfies the following conditions, in which |A| means the number of patterns in the set A:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                |
                                                A
                                                |
                                             
                                             =
                                             k
                                             ,
                                             
                                             A
                                             ⊆
                                             
                                                X
                                                
                                                   A
                                                   l
                                                   l
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ∀
                                             
                                                x
                                                p
                                             
                                             ∈
                                             A
                                             ,
                                             
                                             
                                                x
                                                q
                                             
                                             ∈
                                             
                                                X
                                                
                                                   A
                                                   l
                                                   l
                                                
                                             
                                             −
                                             A
                                             ,
                                             
                                             d
                                             
                                                (
                                                y
                                                ,
                                                
                                                   x
                                                   p
                                                
                                                )
                                             
                                             ≤
                                             d
                                             
                                                (
                                                y
                                                ,
                                                
                                                   x
                                                   q
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Secondly, FRNN is defined as follows [25]:

                           
                              (5)
                              
                                 
                                    
                                       FRNN
                                    
                                    
                                       (
                                       y
                                       ,
                                       
                                          X
                                          
                                             A
                                             l
                                             l
                                          
                                       
                                       ,
                                       R
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                          p
                                       
                                       ∈
                                       
                                          X
                                          
                                             A
                                             l
                                             l
                                          
                                       
                                       ,
                                       
                                       d
                                       
                                          (
                                          y
                                          ,
                                          
                                          
                                             x
                                             p
                                          
                                          )
                                       
                                       <
                                       R
                                       }
                                    
                                    ,
                                 
                              
                           
                        where R is generally a constant obtained either from the user or some preliminary calculation. Moreover according to the definition mentioned at the beginning of this section, the patterns selected through FRNN are called candidates in this paper. Finally, the combination of both kNN and FRNN is given as the Fixed Radius k Nearest Neighbor (FRkNN) that can be formulated as follows [25]:

                           
                              (6)
                              
                                 
                                    
                                       FR
                                    
                                    k
                                    
                                       NN
                                    
                                    (
                                    y
                                    ,
                                    
                                       X
                                       
                                          A
                                          l
                                          l
                                       
                                    
                                    ,
                                    k
                                    ,
                                    R
                                    )
                                    =
                                    A
                                    ,
                                 
                              
                           
                        with respect to:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                |
                                                A
                                                |
                                             
                                             ≤
                                             k
                                             ,
                                             
                                             A
                                             ⊆
                                             
                                                X
                                                
                                                   A
                                                   l
                                                   l
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ∀
                                             
                                                x
                                                p
                                             
                                             ∈
                                             A
                                             ,
                                             
                                             
                                                x
                                                q
                                             
                                             ∈
                                             
                                                X
                                                
                                                   A
                                                   l
                                                   l
                                                
                                             
                                             −
                                             A
                                             ,
                                             
                                             d
                                             
                                                (
                                                y
                                                ,
                                                
                                                   x
                                                   p
                                                
                                                )
                                             
                                             ≤
                                             d
                                             
                                                (
                                                y
                                                ,
                                                
                                                   x
                                                   q
                                                
                                                )
                                             
                                             
                                             a
                                             n
                                             d
                                             
                                             d
                                             
                                                (
                                                y
                                                ,
                                                
                                                   x
                                                   p
                                                
                                                )
                                             
                                             <
                                             R
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since the candidates are obtained through FRNN, the key is to find the suitable radius R. Here we are inspired by the literature [32] to regard the mean squared mutual Euclidean distance between training pattern pairs as the value of R. The correlated calculation is as follows:

                           
                              (7)
                              
                                 
                                    R
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       n
                                       
                                          A
                                          L
                                          L
                                       
                                    
                                    
                                       (
                                       
                                          n
                                          
                                             A
                                             L
                                             L
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       ∑
                                       
                                          
                                             x
                                             p
                                          
                                          ,
                                          
                                             x
                                             q
                                          
                                          ∈
                                          
                                             X
                                             
                                                A
                                                l
                                                l
                                             
                                          
                                       
                                    
                                    
                                       d
                                    
                                    
                                       (
                                       
                                          x
                                          p
                                       
                                       ,
                                       
                                          x
                                          q
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        In the literature [32], R is called the cutoff distance and treated as the threshold to present the local density of the query pattern 
                           y
                        . We utilize this method because it is one of the simplest and non-manual-parameter-required methods to obtain a suitable R without any inclination to either class but considering the global distribution. Once R is determined, we can use FRNN to select the candidates out to form the new localized set XCandi
                        . It should be noted that any FRNN data structure could be adopted here [25]. To be convenient, we simply use the linear search structure for FRNN.

After obtaining the set of candidates, we regard each pattern of XAll
                         as an entity with its corresponding mass. Based on the gravitation-based methods [27–29,36], the present pattern 
                           y
                         would be apt to move towards the direction of the composition of the gravitational forces generated from all the 
                           y
                        -candidate pairs. Differently from DGC or GSA, we do not consider the direction of the gravitation here, i.e., we simply do the calculation as if all candidates are located in a straight line and regard the weight for each feature of the pattern as one. Finally, the composition of the gravitational forces acting on the query pattern 
                           y
                         is obtained through the function F( · ) as follows:
                        
                           
                              (8)
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          .
                                          
                                             x
                                             i
                                          
                                          ∈
                                          
                                             X
                                             
                                                C
                                                a
                                                n
                                                d
                                                i
                                             
                                          
                                       
                                    
                                    
                                       φ
                                       i
                                    
                                    
                                       D
                                    
                                    
                                       (
                                       y
                                       ,
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        where the function D( · ) is developed from the formula of gravitation and designed for calculating the gravitation between the query pattern 
                           y
                         and each candidate
                        
                           x
                        
                        
                           i
                         ∈ XCandi
                        :

                           
                              (9)
                              
                                 
                                    
                                       D
                                    
                                    
                                       (
                                       y
                                       ,
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    =
                                    G
                                    
                                       
                                          
                                             m
                                             y
                                          
                                          
                                             m
                                             
                                                x
                                                i
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                (
                                                y
                                                ,
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        To simplify Eq. (9), both the mass of the query m
                        
                           
                              y
                           
                         and the gravitational constant G are set to one. The next step is to acquire the value of 
                           
                              m
                              
                                 x
                                 i
                              
                           
                         based on the density. In fact, it is not rare to find the application of the localized density conception in solving classification problems [17]. Accordingly, we consider to utilize IR of XAll
                         to achieve the balance among candidates on condition that the following equation holds:

                           
                              (10)
                              
                                 
                                    
                                       n
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                    
                                       m
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                    =
                                    
                                       n
                                       
                                          N
                                          E
                                          G
                                       
                                    
                                    
                                       m
                                       
                                          N
                                          E
                                          G
                                       
                                    
                                    ,
                                 
                              
                           
                        where mPOS
                         is the mass of candidates belonging to POS and mNEG
                         is the mass for candidates from NEG. From Eq. (10), we can find that 
                           
                              
                                 m
                                 
                                    P
                                    O
                                    S
                                 
                              
                              =
                              
                                 
                                    n
                                    
                                       N
                                       E
                                       G
                                    
                                 
                                 
                                    n
                                    
                                       P
                                       O
                                       S
                                    
                                 
                              
                              
                                 m
                                 
                                    N
                                    E
                                    G
                                 
                              
                              =
                              I
                              R
                              ·
                              
                                 m
                                 
                                    N
                                    E
                                    G
                                 
                              
                           
                         based on the premise that the distribution of the training patterns is consistent with or at least similar to the distribution of the whole dataset. Now we can formulate the piecewise-defined function to get the 
                           
                              m
                              
                                 x
                                 i
                              
                           
                         as follows:

                           
                              (11)
                              
                                 
                                    
                                       m
                                       
                                          x
                                          i
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                         
                                                            N
                                                            E
                                                            G
                                                         
                                                      
                                                      
                                                         n
                                                         
                                                            P
                                                            O
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                   
                                                      (
                                                      i
                                                      .
                                                      e
                                                      .
                                                      ,
                                                      
                                                      IR
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      i
                                                   
                                                   
                                                   ∈
                                                   
                                                      X
                                                      
                                                         P
                                                         O
                                                         S
                                                      
                                                   
                                                   ∩
                                                   
                                                      X
                                                      
                                                         C
                                                         a
                                                         n
                                                         d
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      i
                                                   
                                                   
                                                   ∈
                                                   
                                                      X
                                                      
                                                         N
                                                         E
                                                         G
                                                      
                                                   
                                                   ∩
                                                   
                                                      X
                                                      
                                                         C
                                                         a
                                                         n
                                                         d
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        Afterwards, the decision criterion is that the query pattern 
                           y
                         is classified into NEG if F(
                           y
                        ) < 0, while 
                           y
                         is classified into POS if F(
                           y
                        ) > 0. Finally, the completed procedure of GFRNN summarized in pseudo-code is given in Table 1.

In this part, we discuss some specialties of GFRNN. We first explain why FRNN rather than kNN is chosen as the preprocessing strategy for GFRNN , and then demonstrate the effectiveness of GFRNN, i.e., why this model works. In detail, we choose FRNN instead of kNN for two main reasons. As mentioned in Section 1, the first reason is that the selection of parameter k in kNN is too crucial for the manual setting to achieve the optimal value. Accordingly, some unpredictable trouble might be caused in imbalanced learning situation when k is initialized in wrong interval. An example is given in Fig. 1. In this example, the k of kNN is set to 7 and the radius R of FRNN is obtained in the same way as that in GFRNN, i.e., R is the mean squared mutual Euclidean distance between pattern pairs. From Fig. 1, three extra patterns of NEG are included in the seven neighbors of the query pattern according to kNN rule, which might lead the classifier to make a wrong decision. Further, it could be naturally imagined that kNN might lose its power if the distribution of patterns is both sparse and imbalanced. However, it cannot be asserted that FRNN absolutely outperforms kNN in all cases, e.g., kNN might make the correct decision if k is set to 1, 3, or 5 in Example 1 (Fig. 1). But we are immediately trapped in the first problem mentioned above, i.e., the selection of the optimal k is in fact a difficult task because the right choice is usually dataset-dependent in most real-world situation [33]. On the other hand, FRNN might be more robust and adaptive since we find a way to make the radius R be correlated with the dataset.

Furthermore, we focus on analyzing the main formula of GFRNN in order to make it easier to be understood. We first define that there are 
                              
                                 
                                    n
                                    ˜
                                 
                                 
                                    P
                                    O
                                    S
                                 
                              
                            
                           candidates of XPOS
                            and 
                              
                                 
                                    n
                                    ˜
                                 
                                 
                                    N
                                    E
                                    G
                                 
                              
                            
                           candidates of XNEG
                            after FRNN. According to Eq. (11), we can expand Eq. (8) as follows:

                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                (
                                                y
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                      ∈
                                                      
                                                         X
                                                         
                                                            P
                                                            O
                                                            S
                                                         
                                                      
                                                      ∩
                                                      
                                                         X
                                                         
                                                            C
                                                            a
                                                            n
                                                            d
                                                            i
                                                         
                                                      
                                                   
                                                
                                                G
                                                
                                                   
                                                      
                                                         m
                                                         y
                                                      
                                                      
                                                         m
                                                         
                                                            x
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            (
                                                            y
                                                            ,
                                                            
                                                               x
                                                               i
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                      ∈
                                                      
                                                         X
                                                         
                                                            N
                                                            E
                                                            G
                                                         
                                                      
                                                      ∩
                                                      
                                                         X
                                                         
                                                            C
                                                            a
                                                            n
                                                            d
                                                            i
                                                         
                                                      
                                                   
                                                
                                                G
                                                
                                                   
                                                      
                                                         m
                                                         y
                                                      
                                                      
                                                         m
                                                         
                                                            x
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            (
                                                            y
                                                            ,
                                                            
                                                               x
                                                               j
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         i
                                                      
                                                      ∈
                                                      
                                                         X
                                                         
                                                            P
                                                            O
                                                            S
                                                         
                                                      
                                                      ∩
                                                      
                                                         X
                                                         
                                                            C
                                                            a
                                                            n
                                                            d
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      I
                                                      R
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            (
                                                            y
                                                            ,
                                                            
                                                               x
                                                               i
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      
                                                         x
                                                         j
                                                      
                                                      ∈
                                                      
                                                         X
                                                         
                                                            N
                                                            E
                                                            G
                                                         
                                                      
                                                      ∩
                                                      
                                                         X
                                                         
                                                            C
                                                            a
                                                            n
                                                            d
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            (
                                                            y
                                                            ,
                                                            
                                                               x
                                                               j
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           To simplify the problem, we suppose that 
                              
                                 
                                    d
                                 
                                 
                                    
                                       (
                                       y
                                       ,
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    2
                                 
                                 =
                                 
                                    d
                                 
                                 
                                    
                                       (
                                       y
                                       ,
                                       
                                          x
                                          j
                                       
                                       )
                                    
                                    2
                                 
                                 =
                                 
                                    d
                                    ˜
                                 
                                 ,
                              
                            i.e., all the candidates have the same distance from the query pattern. Then Eq. (12) is rewritten as:

                              
                                 (13)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       =
                                       
                                          
                                             (
                                             I
                                             R
                                             
                                                
                                                   n
                                                   ˜
                                                
                                                
                                                   P
                                                   O
                                                   S
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                   ˜
                                                
                                                
                                                   N
                                                   E
                                                   G
                                                
                                             
                                             )
                                          
                                          
                                             d
                                             ˜
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      n
                                                      
                                                         N
                                                         E
                                                         G
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                         ˜
                                                      
                                                      
                                                         P
                                                         O
                                                         S
                                                      
                                                   
                                                
                                                
                                                   n
                                                   
                                                      P
                                                      O
                                                      S
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                   ˜
                                                
                                                
                                                   N
                                                   E
                                                   G
                                                
                                             
                                             )
                                          
                                          
                                             d
                                             ˜
                                          
                                       
                                       .
                                    
                                 
                              
                           Besides, we know that the query is classified to POS when F(
                              y
                           ) > 0. So we further consider that on what condition the result of Eq. (13) is greater than 0. Since the sum of distances is always non-negative, the following inequation holds:

                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                n
                                                
                                                   N
                                                   E
                                                   G
                                                
                                             
                                             
                                                
                                                   n
                                                   ˜
                                                
                                                
                                                   P
                                                   O
                                                   S
                                                
                                             
                                          
                                          
                                             n
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       >
                                       
                                          
                                             n
                                             ˜
                                          
                                          
                                             N
                                             E
                                             G
                                          
                                       
                                       .
                                    
                                 
                              
                           In most situation, 
                              
                                 
                                    
                                       n
                                       ˜
                                    
                                    
                                       P
                                       O
                                       S
                                    
                                 
                                 >
                                 0
                              
                           . Hence we can obtain the following inequation:

                              
                                 (15)
                                 
                                    
                                       I
                                       R
                                       =
                                       
                                          
                                             n
                                             
                                                N
                                                E
                                                G
                                             
                                          
                                          
                                             n
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       >
                                       
                                          
                                             
                                                n
                                                ˜
                                             
                                             
                                                N
                                                E
                                                G
                                             
                                          
                                          
                                             
                                                n
                                                ˜
                                             
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       =
                                       i
                                       r
                                       .
                                    
                                 
                              
                           Now it can be clearly seen that the query would be determined to belong to POS if IR > ir. Furthermore, it is obvious that IR is indeed greater than ir except two cases. The first case is that 
                              
                                 
                                    
                                       n
                                       ˜
                                    
                                    
                                       P
                                       O
                                       S
                                    
                                 
                                 ≥
                                 
                                    
                                       n
                                       ˜
                                    
                                    
                                       N
                                       E
                                       G
                                    
                                 
                              
                            when the query appears near the clustering center of POS. The second case is that 
                              
                                 
                                    
                                       n
                                       ˜
                                    
                                    
                                       P
                                       O
                                       S
                                    
                                 
                                 =
                                 0
                              
                            when the query locates among patterns of NEG and is far away from patterns of POS. In fact, the second case never happens in our experiments, but we can imagine that 
                              
                                 
                                    n
                                    ˜
                                 
                                 
                                    P
                                    O
                                    S
                                 
                              
                            is small enough to approach to zero. Further, it should be noted that here the distance 
                              
                                 d
                                 ˜
                              
                            is fixed while in fact both of these two special cases are easy to be dealt with because in first case the query obviously belongs to POS and in second case it can be easily classified in NEG in terms of the sum of distances. As a conclusion, Eq. (15)
implies that if the local density is just the same to the training density, i.e., 
                              
                                 
                                    
                                       n
                                       ˜
                                    
                                    
                                       P
                                       O
                                       S
                                    
                                 
                                 =
                                 
                                    n
                                    
                                       P
                                       O
                                       S
                                    
                                 
                              
                            while 
                              
                                 
                                    
                                       n
                                       ˜
                                    
                                    
                                       N
                                       E
                                       G
                                    
                                 
                                 =
                                 
                                    n
                                    
                                       N
                                       E
                                       G
                                    
                                 
                                 ,
                              
                            and all the candidates have the same distance from the query pattern, making 
                              
                                 
                                    F
                                 
                                 (
                                 y
                                 )
                                 =
                                 0
                              
                            means that the query shares the same possibility to be classified into POS or NEG. Further, the key is that at the preprocessing step, the number of patterns from NEG is far more sharply reduced than those form POS, so as to achieve 
                              
                                 
                                    
                                       n
                                       
                                          N
                                          E
                                          G
                                       
                                    
                                    
                                       n
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                 
                                 >
                                 
                                    
                                       
                                          n
                                          ˜
                                       
                                       
                                          N
                                          E
                                          G
                                       
                                    
                                    
                                       
                                          n
                                          ˜
                                       
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                 
                              
                            when the query locates between POS and NEG. It implies that the query that first locates between POS and NEG is usually apt to “move” to the boundary of POS. Example 2 in Fig. 2
                            illustrates that after FRNN, the number of patterns from NEG is nearly reduced to half while the number of patterns from POS barely changes. Therefore, GFRNN could be in fact treated as some kind of under-sampling idea combined with modified voting strategy. The speciality of GFRNN is that the whole procedure does not need any parameter-setting manually.

In this part, we discuss the differences between GFRNN and the other previous gravitation-based methods. At first, it is obvious to find two main differences between GFRNN and GSA. The first one is about the motivation. Even though it is used as a preprocessing to select more useful patterns for the subsequent classifier in the later literature [31], GSA is not specially designed for the classification tasks. Instead, it is one of the heuristic optimization methods inspired by swarm behaviors in nature [29]. On the other hand, GFRNN is designed mainly to solve the recognition problems. Secondly, GSA dynamically searches for the optimal solution and considers more parameters than GFRNN that is analytic and does not need to change any parameters during the calculation. As for GSA, the acceleration is an important coefficient while the gravitational constant G might change after each iteration. Both of the two factors are unnecessary and omitted in GFRNN. Further in GSA, three definitions of mass are defined as: the inertial mass, the active gravitational mass, and the passive gravitational mass, while in GFRNN the definition of mass is simpler [29].

It seems that GFRNN is more similar to DGC than to GSA because both GFRNN and DGC are designed for classification and based on the similarity between patterns. In addition, the final decision of both two methods depends on the distance and the mass instead of G or other coefficients. However, GFRNN is substantially different from DGC. Before the analysis, we briefly introduce DGC at first. As for DGC, all the operations are done between the basic entities named the “particle”. One particle is a subset (or cluster) of the original dataset. The mass of the particle is defined as the number of patterns included in it and the feature (or location) of the particle is the centroid of those included patterns. The special case is that one pattern could be treated as one particle. DGC first constructs a gravitational field by calculating all gravitational forces between each particle-pair and then classifies the query pattern to the class, whose particles impose the strongest force to the query and dominate the final direction of the composition of forces. It should be noted that each class could contain more than one particle and the division strategy for particles is crucial. In literature [28], one novel DGC for imbalanced problem named IDGC has been proposed. To modify the original DGC, IDGC adds one new parameter named the Amplified Gravitation Coefficient (AGC) γi, i ∈ {POS, NEG}, which in binary-class imbalanced case is defined as follows. To make the subsequent analysis convenient, we here treat each pattern as one particle in IDGC:

                              
                                 (16)
                                 
                                    
                                       
                                          γ
                                          i
                                       
                                       =
                                       
                                          
                                             
                                                n
                                                
                                                   N
                                                   E
                                                   G
                                                
                                             
                                             +
                                             
                                                n
                                                
                                                   P
                                                   O
                                                   S
                                                
                                             
                                          
                                          
                                             n
                                             i
                                          
                                       
                                       ,
                                       
                                       i
                                       ∈
                                       
                                          {
                                          P
                                          O
                                          S
                                          ,
                                          N
                                          E
                                          G
                                          }
                                       
                                    
                                 
                              
                           First, we consider the training patterns of POS. The function for the composition of the gravitational forces of POS pattern in IDGC, which is denoted as 
                              
                                 
                                    
                                       APTARANORMAL
                                       
                                          F
                                          ˜
                                       
                                    
                                    
                                       P
                                       O
                                       S
                                    
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                                 ,
                              
                            is given as follows:

                              
                                 (17)
                                 
                                    
                                       
                                          
                                             APTARANORMAL
                                             
                                                F
                                                ˜
                                             
                                          
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             n
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       
                                          
                                             
                                                γ
                                                
                                                   P
                                                   O
                                                   S
                                                
                                             
                                             
                                                m
                                                k
                                             
                                          
                                          
                                             
                                                APTARANORMAL
                                                
                                                   d
                                                   ˜
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   ,
                                                   
                                                      x
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           In Eq. (17), the denominator could be further expanded as follows, because in DGC each feature shares different weight and d is the number of features in one pattern:

                              
                                 (18)
                                 
                                    
                                       
                                          APTARANORMAL
                                          
                                             d
                                             ˜
                                          
                                       
                                       
                                          
                                             (
                                             y
                                             ,
                                             
                                                x
                                                k
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          ∑
                                          
                                             l
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          w
                                          l
                                       
                                       
                                          
                                             (
                                             
                                                y
                                                l
                                             
                                             −
                                             
                                                x
                                                
                                                   k
                                                   ,
                                                   l
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       .
                                    
                                 
                              
                           Moreover, mk
                            in Eq. (17) is set to 1 because each particle now has only one pattern. So if we further suppose that all features share the same weight, i.e., 
                              
                                 w
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       d
                                       ×
                                       1
                                    
                                 
                                 ,
                              
                            
                           Eq. (17)
could be simplified to:

                              
                                 (19)
                                 
                                    
                                       
                                          
                                             APTARANORMAL
                                             
                                                F
                                                ˜
                                             
                                          
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             n
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       
                                          
                                             γ
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   (
                                                   y
                                                   ,
                                                   
                                                      x
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                           Eq. (19) means the composition of the gravitational forces from all POS patterns for the query pattern. Now we inspect the composition forces of POS in GFRNN, which can be calculated as:

                              
                                 (20)
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                ˜
                                             
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       
                                          
                                             m
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   (
                                                   y
                                                   ,
                                                   
                                                      x
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                ˜
                                             
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                                
                                                   N
                                                   E
                                                   G
                                                
                                             
                                             
                                                n
                                                
                                                   P
                                                   O
                                                   S
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   (
                                                   y
                                                   ,
                                                   
                                                      x
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       =
                                       I
                                       R
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                ˜
                                             
                                             
                                                P
                                                O
                                                S
                                             
                                          
                                       
                                       
                                          1
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   (
                                                   y
                                                   ,
                                                   
                                                      x
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           Obviously, Eq. (19) does not equal to Eq. (20)
mainly because the sum of the mass from them is different. For the further investigation, we bring 
                              
                                 γ
                                 =
                                 
                                    
                                       
                                          n
                                          
                                             N
                                             E
                                             G
                                          
                                       
                                       +
                                       
                                          n
                                          
                                             P
                                             O
                                             S
                                          
                                       
                                    
                                    
                                       n
                                       
                                          P
                                          O
                                          S
                                       
                                    
                                 
                              
                            into Eq. (19) and obtain:

                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      APTARANORMAL
                                                      
                                                         F
                                                         ˜
                                                      
                                                   
                                                   
                                                      P
                                                      O
                                                      S
                                                   
                                                
                                                
                                                   (
                                                   y
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            n
                                                            
                                                               N
                                                               E
                                                               G
                                                            
                                                         
                                                         +
                                                         
                                                            n
                                                            
                                                               P
                                                               O
                                                               S
                                                            
                                                         
                                                      
                                                      
                                                         n
                                                         
                                                            P
                                                            O
                                                            S
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      
                                                         P
                                                         O
                                                         S
                                                      
                                                   
                                                
                                                
                                                   1
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            (
                                                            y
                                                            ,
                                                            
                                                               x
                                                               k
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   I
                                                   R
                                                   +
                                                   1
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      
                                                         P
                                                         O
                                                         S
                                                      
                                                   
                                                
                                                
                                                   1
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            (
                                                            y
                                                            ,
                                                            
                                                               x
                                                               k
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           The difference between GFRNN and IDGC still remains. Same conclusion could be achieved from the NEG situation. Therefore, GFRNN and DGC are totally two different methods.

@&#EXPERIMENTS@&#

In this section, we compare GFRNN to some representative algorithms on forty selected binary-class imbalanced datasets in order to validate both the effectiveness and the efficiency of it (Table 3). The corresponding setting is given in the first part and the detailed reports on experiments are presented in the rest parts.

Three indicators used to measure the results in the experiments are: the Geometric Means metric (GM), the Average Accuracy metric (AA) [15] and the average processing time. Here we adopt the definition from the literature [11] to describe GM and AA. Table 2
                         presents four relationships between the prediction by a learning machine and the true class label in imbalanced problems. Based on the confusion matrix, AA is calculated as:

                           
                              (22)
                              
                                 
                                    
                                       A
                                    
                                    
                                       A
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       (
                                       T
                                       P
                                       /
                                       (
                                       T
                                       P
                                       +
                                       F
                                       N
                                       )
                                       +
                                       T
                                       N
                                       /
                                       (
                                       F
                                       P
                                       +
                                       T
                                       N
                                       )
                                       )
                                    
                                    ·
                                    100
                                    %
                                    .
                                 
                              
                           
                        Moreover, GM is obtained from:

                           
                              (23)
                              
                                 
                                    
                                       G
                                    
                                    
                                       M
                                    
                                    =
                                    
                                       
                                          (
                                          T
                                          P
                                          /
                                          (
                                          T
                                          P
                                          +
                                          F
                                          N
                                          )
                                          )
                                          ·
                                          (
                                          T
                                          N
                                          /
                                          (
                                          T
                                          N
                                          +
                                          F
                                          P
                                          )
                                          )
                                       
                                    
                                    ·
                                    100
                                    %
                                    .
                                 
                              
                           
                        
                     

In the
                        
                         first and the second parts of the experiments, 40 binary-class real-world imbalanced problems from the KEEL dataset repository [1] (http://www.keel.es/dataset.php) are taken into consideration by both the proposed GFRNN and the comparison group. The detailed description on the used datasets is presented in Table 3 including the IR, dimension, and size of each dataset. Five-Fold Cross Validation (5FCV) [18] is adopted during the whole experiments and the Grid Search strategy is used to find the optimal parameters for the comparison algorithms. Finally, all the computations are performed on AMD Turion Core 2 processors with 2.10 GHz, 4G RAM DDR2, Microsoft Windows 7, MATLAB environment.

In this part, four existing well-performing kNN-related algorithms, including CCNND [19], ENN [20], LI-kNN [33], and PNN [39], are selected to take comparison with the proposed GFRNN. According to the introduction part of this paper, ENN and PNN are the typical pattern-based methods while CCNND and LI-kNN are the distribution-oriented ones. In the experiment, the parameters of each comparison algorithm are set according to the optimal choices given in the original literatures. In detail, the number k of nearest neighbors for ENN, PNN, and CCNND are selected from the set {1, 3}, while k for LI-kNN is chosen from the set {7, 9, 11, 13, 15, 17, 19}. Moreover, the number I of the selected informative points for LI-kNN is chosen from {1, 3} [33]. In addition, the default confidence levels for ENN and PNN are set to 10% and 20%, respectively [20,39]. That is, the parameter z for ENN and PNN are set to 1.28 and 0.84, respectively. The results of both AA and GM of all five algorithms are recorded, but only the best result from the optimal parameter settings for each algorithm on each dataset is listed in this paper.


                        Table 4 lists the results of AA from all algorithms on all used datasets, while Table 5 reports all GM results. To make it easy-to-check, the detailed information about each used dataset is given under the dataset name, including the dimensionality (Dim), IR, and the whole size of that dataset in Tables 7
                        
                        
                        
                        
                           −
                        
                        10
                        . Furthermore, Tables 4
                        
                           −
                        
                        5 record the standard deviation and the score of each result for each algorithm on all datasets. The value of the score ranges from 1 to 5. The lower the score is, the better the algorithm performs, i.e., score 1 means the best. Further on the bottom of the tables, there are average rank (the mean value of scores from each algorithm on all datasets) and final rank for each algorithm recorded. It could be found that in both tables, GFRNN performs better than the other algorithms in terms of both average rank and final rank. Besides, the statistic results for Win/Tie/Loss are recorded on the bottom of the four tables. Accordingly, GFRNN outperforms CCNND and LI-kNN and keeps competitive with ENN and PNN.

Furthermore, two non-parametric statistical tests, named the Friedmen test (FR) and the Bonferroni-Dunn test (BD) [9], are used to measure the similarity between the used algorithms (Table 6). According to Friedmen test [9], 
                           
                              r
                              i
                              j
                           
                         is defined as the rank of the jth of kalg
                         algorithms on the ith of NData
                         datasets. The H
                        0-hypothesis in the test is that there is no significant difference among all algorithms. If the value of FF
                         is larger than the critical value qβ
                         obtained from the F-distribution with 
                           
                              
                                 k
                                 
                                    A
                                    l
                                    g
                                 
                              
                              −
                              1
                           
                         and 
                           
                              
                                 (
                                 
                                    k
                                    
                                       A
                                       l
                                       g
                                    
                                 
                                 −
                                 1
                                 )
                              
                              
                                 (
                                 
                                    N
                                    
                                       D
                                       a
                                       t
                                       a
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                         degrees of freedom while 
                           
                              α
                              =
                              0.05
                              ,
                           
                         the H
                        0-hypothesis is rejected, i.e., there exists significant difference among the algorithms. The equations to calculate FF
                         are given as follows:

                           
                              (24)
                              
                                 
                                    
                                       χ
                                       F
                                       2
                                    
                                    =
                                    
                                       
                                          12
                                          
                                             N
                                             
                                                D
                                                a
                                                t
                                                a
                                             
                                          
                                       
                                       
                                          
                                             k
                                             
                                                A
                                                l
                                                g
                                             
                                          
                                          
                                             (
                                             
                                                k
                                                
                                                   A
                                                   l
                                                   g
                                                
                                             
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       [
                                       
                                          ∑
                                          j
                                       
                                       
                                          R
                                          j
                                          2
                                       
                                       −
                                       
                                          
                                             
                                                k
                                                
                                                   A
                                                   l
                                                   g
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      k
                                                      
                                                         A
                                                         l
                                                         g
                                                      
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                2
                                             
                                          
                                          4
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        then

                           
                              (25)
                              
                                 
                                    
                                       F
                                       F
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                N
                                                
                                                   D
                                                   a
                                                   t
                                                   a
                                                
                                             
                                             −
                                             1
                                             )
                                          
                                          
                                             χ
                                             F
                                             2
                                          
                                       
                                       
                                          
                                             N
                                             
                                                D
                                                a
                                                t
                                                a
                                             
                                          
                                          
                                             (
                                             
                                                k
                                                
                                                   A
                                                   l
                                                   g
                                                
                                             
                                             −
                                             1
                                             )
                                          
                                          −
                                          
                                             χ
                                             F
                                             2
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where the average ranks of algorithms can be denoted as 
                           
                              
                                 R
                                 j
                              
                              =
                              
                                 1
                                 
                                    N
                                    
                                       D
                                       a
                                       t
                                       a
                                    
                                 
                              
                              
                                 ∑
                                 i
                              
                              
                                 r
                                 i
                                 j
                              
                           
                        . Moreover, the critical value qβ
                         is calculated as 
                           
                              
                                 q
                                 β
                              
                              =
                              F
                              
                                 (
                                 α
                                 ,
                                 
                                    k
                                    
                                       A
                                       l
                                       g
                                    
                                 
                                 −
                                 1
                                 ,
                                 
                                    (
                                    
                                       k
                                       
                                          A
                                          l
                                          g
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       N
                                       
                                          D
                                          a
                                          t
                                          a
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 )
                              
                           
                        . As mentioned above, if FF
                         > qβ
                        , the H
                        0-hypothesis is rejected in terms of the Friedmen test. In addition, the Bonferroni-Dunn test is used to compare GFRNN to the other algorithm in turn. Accordingly, the critical value qγ
                         for the two-tailed Bonferroni-Dunn test with 5 algorithms when 
                           
                              α
                              =
                              0.05
                           
                         is 2.498 [9]. Correspondingly, the performance of two algorithms is significantly different if the corresponding average ranks differ by at least the Critical Difference (CD) [9]:

                           
                              (26)
                              
                                 
                                    
                                       C
                                    
                                    
                                       D
                                    
                                    =
                                    
                                       q
                                       γ
                                    
                                    
                                       
                                          
                                             
                                                k
                                                
                                                   A
                                                   l
                                                   g
                                                
                                             
                                             
                                                (
                                                
                                                   k
                                                   
                                                      A
                                                      l
                                                      g
                                                   
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             6
                                             
                                                N
                                                
                                                   D
                                                   a
                                                   t
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        That is, if the difference between two algorithms is greater than CD, the two algorithms are significantly different. In the experiments, we can obtain the corresponding qβ
                         and CD at first:

                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       D
                                    
                                    =
                                    2.498
                                    
                                       
                                          
                                             5
                                             ×
                                             6
                                          
                                          
                                             6
                                             ×
                                             40
                                          
                                       
                                    
                                    =
                                    0.8832
                                    .
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       q
                                       β
                                    
                                    =
                                    F
                                    
                                       (
                                       0.05
                                       ,
                                       4
                                       ,
                                       4
                                       ×
                                       39
                                       )
                                    
                                    =
                                    2.4296
                                    .
                                 
                              
                           
                        Then, all the corresponding results are recorded in Table 6
                        
                        . The first column of Table 6 records the name of the tables in this paper. Moreover, the second, the third and the last column present the correlated results of 
                           
                              
                                 χ
                                 F
                                 2
                              
                              ,
                           
                         
                        FF
                         and the comparison between FF
                         and qβ
                         for each table. In Table 6, it is shown that the corresponding FF
                         > qβ
                         in two tables, which implies that there are indeed significant differences existing among all algorithms in terms of the Friedman test (FR). Besides, the 4th
                           −
                        7th columns reveal the difference between GFRNN and the corresponding algorithm. The comparison between the difference and the CD is given afterwards. It could be found that GFRNN keeps the significant differences from CCNND and LI-kNN. As for PNN, the difference exists for the distribution of the GM values. Further, GFRNN and ENN seems similar according to the distribution of both AA and GM values. However, we have obviously known that the structure of GFRNN is totally different from ENN. GFRNN reduces unnecessary patterns by using searching strategy while ENN first selects the most important patterns from POS and then expands their radiuses in order to reduce the distance between the query and these selected patterns. Generally, ENN is pattern-based while GFRNN is more like the distribution-oriented methods.

In this part, we compare GFRNN to the other five baseline algorithms including kNN [8], FRkNN [25], C4.5 [6], LR [16], and the SVM [35]. In the comparison group, kNN and FRkNN are the basic models of the proposed algorithm and the other three algorithms are typical when SVMs could even perform better on imbalanced datasets because they focus mainly on the boundary [33]. In detail, the parameter k for both kNN and FRkNN ranges from the set {1, 3, 5, 7, 9}. However, since we find that kNN and FRkNN with 
                           
                              k
                              =
                              5
                           
                         usually perform the best on most datasets, we only record the results of kNN and FRkNN when k is set to one or five in this paper. The corresponding nearest neighbor algorithms in the experiment are written as 1NN, FR1NN, 5NN, and FR5NN. Futhermore, the radius R for both GFRNN and FRkNN is obtained from Eq. (7). Moreover for SVM, three kinds of kernels including the linear kernel (Linear), the polynomial kernel (POLY), and the Radial Basis Function (RBF) are considered. The coefficient C of SVM is selected from the set 
                           
                              {
                              
                                 10
                                 
                                    −
                                    2
                                 
                              
                              ,
                              
                                 10
                                 
                                    −
                                    1
                                 
                              
                              ,
                              
                                 10
                                 0
                              
                              ,
                              
                                 10
                                 1
                              
                              ,
                              
                                 10
                                 2
                              
                              }
                           
                        . d for SVM(POLY) is set to 2 and σ for SVM(RBF) is chosen from the set 
                           
                              {
                              
                                 10
                                 
                                    −
                                    3
                                 
                              
                              ,
                              
                                 10
                                 
                                    −
                                    2
                                 
                              
                              ,
                              
                                 10
                                 
                                    −
                                    1
                                 
                              
                              ,
                              
                                 10
                                 0
                              
                              ,
                              
                                 10
                                 1
                              
                              ,
                              
                                 10
                                 2
                              
                              ,
                              
                                 10
                                 3
                              
                              }
                           
                        .

The comparison results include AA (Table 7) and GM (Table 8) on all 40 imbalanced datasets. Further in order to take a more comprehensive comparison, we compare GFRNN to all the six algorithms with the SMOTE [7] preprocessing step based on AA (Table 9) and GM (Table 10) on all used datasets. Here, we manually coordinate the parameters for SMOTE to keep the IR of each dataset stay less than 2. All these four tables keep the same format as those of Tables 4 and 5, only the score ranges 
                           
                              1
                              −
                              10
                           
                        . It is found that in all four tables the proposed GFRNN outperforms the other algorithms in terms of both average rank and final rank. In detail, GFRNN usually ranks top 3 of all algorithms on each dataset even though it is not the best one all the time, which demonstrates the stableness of GFRNN. Moreover, it is witnessed that after the SMOTE preprocessing, the similarity-based comparison algorithms such as 5NN and FR5NN become more competitive while the boundary-sensitive algorithm, such as SVM, experiences less change. On the other hand, GFRNN coordinates the number of candidates all by itself and performs well without the SMOTE preprocessing. According to the statistic results for Win/Tie/Loss, we can find that GFRNN obviously outperforms nearest-neighbor-rule-based algorithms such as kNN and FRkNN and seems to be competitive with SVMs.

The two non-parametric statistical tests FR and BD are also adopted in this part. Accordingly, the critical value qγ
                         for the two-tailed Bonferroni–Dunn test with 10 algorithms when 
                           
                              α
                              =
                              0.05
                           
                         is 2.773 [9]. Hence in this part, CD
                           
                              =
                              1.8773
                              ,
                           
                        
                        
                           
                              
                                 q
                                 β
                              
                              =
                              F
                              
                                 (
                                 0.05
                                 ,
                                 9
                                 ,
                                 9
                                 ×
                                 39
                                 )
                              
                              =
                              1.9066
                           
                        . Table 11 shows that GFRNN is significantly different from its related clan-algorithms such as kNN and FRkNN. On the other hand, GFRNN might perform more like the boundary-sensitive method such as SVM in terms of the Bonferroni-Dunn test. However, we know that the principle of GFRNN is totally different from that of SVM.

The effectiveness of GFRNN has been investigated in the first and second part of this section. Here we design the experiment to validate the efficiency of GFRNN. All the kNN-related algorithms including CCNND, ENN, LI-kNN, and PNN, and the typical baseline algorithm SVM in both linear and non-linear models are included in the comparison group. Furthermore, we select six datasets with the largest size of the forty ones in this part. During the experiment, the parameter for SVMs are fixed, i.e., 
                           
                              C
                              =
                              1
                              ,
                           
                        
                        
                           
                              σ
                              =
                              1
                           
                         for SVM with RBF and 
                           
                              C
                              =
                              1
                           
                         for linear SVM. On the other hand, the number k of nearest neighbors for ENN, LI-kNN and PNN are selected from the set {3, 9, 27, 81, 243} in order to observe the influence of the training size on these algorithms. Since CCNND spends more time on calculating the cumulative distribution of each query, the k of CCNND is fixed to 1 [19]. It should be noted that since the algorithm such as PNN does not need the training process, here we record the total consumption of time including both training and testing steps of each algorithm in each iteration of 5FCV and then take the average value of them.

Three main conclusions could be derived from Table 12. Firstly, GFRNN spends more time when the size of the dataset becomes larger because the computation complexity of the basic FRNN is dataset-dependent. Secondly, it could be found that the time to run the kNN-related methods rises with the growth of k. Even though it is rare to set k more than 20 in practice, it presents one drawback of the kNN-based methods. Furthermore, a set of values for k has to be checked in turn before the optimal one is found. Hence the total time cost on one algorithm is not the highest time that is caused by one choice of k, but the sum of the time caused by all choices of k in the set. The same situation might happen in SVMs since we use the grid search to find the optimal values in the experiments. If we suppose the linear SVM would spend the same time regardless of the value of C, the total time cost by the grid search to obtain the optimal parameters of SVM would be n times higher than the time recorded in Table 12, where n is the number of choices of C, e.g., 
                           
                              n
                              =
                              5
                           
                         when C is selected from the set 
                           
                              {
                              
                                 10
                                 
                                    −
                                    2
                                 
                              
                              ,
                              
                                 10
                                 
                                    −
                                    1
                                 
                              
                              ,
                              
                                 10
                                 0
                              
                              ,
                              
                                 10
                                 1
                              
                              ,
                              
                                 10
                                 2
                              
                              }
                           
                        . It is indispensable because we do not know the optimal value of C at first. On the other hand, the time cost of GFRNN is only correlated to the size of the dataset, because GFRNN does not need any settings or coordinations of parameters. As a result, GFRNN becomes more controllable and does not need to change any parameters when facing a new dataset. Thirdly, GFRNN seems faster than the half of the comparison methods even when the other methods do not consider each choice of parameters. It could be seen from the first row of each dataset from Table 12 that GFRNN still requires less time than ENN, LI-kNN, and CCNND, and keeps competitive with PNN and SVMs. Therefore, it could be concluded that GFRNN is efficient.

@&#CONCLUSIONS@&#

In this paper, we propose a novel learning model named GFRNN to operate the classification problems on imbalanced datasets. The proposal of the new model is based on the classical fixed radius nearest neighbor search strategy and inspired by the gravitation-based methods. Specially, GFRNN does not need any manually-set parameters in the whole process. In the process, GFRNN first selects the appropriate patterns out as the candidate through the FRNN rule, and then calculates the gravitational force between the query pattern and each candidate. As a result, the composition of those gravitational forces is obtained to be the criterion of the final decision. Experiments are designed to compare GFRNN to nine representative algorithms such as CCNND, ENN, LI-kNN, PNN, kNN, FRkNN, SVM, C4.5, and LR on forty selected binary-class imbalanced datasets and validate the effectiveness of the proposed method. Furthermore, the time comparison on large size datasets between GFRNN and six selected typical algorithms demonstrates the efficiency of it. Finally, the main contribution of this paper can be concluded as designing an effective and structurally-simple nearest neighbor learning model to deal with the imbalanced recognition tasks more effectively and efficiently.

@&#ACKNOWLEDGMENT@&#

This work was partially supported by Natural Science Foundations of China under Grant Nos.61272198 and 21176077, Innovation Program of Shanghai Municipal Education Commission under Grant No.14ZZ054, the Fundamental Research Funds for the Central Universities, Shanghai Key Laboratory of Intelligent Information Processing of China under Grant No.IIPL-2012-003, and Provincial Key Laboratory for Computer Information Processing Technology of Soochow University.

@&#REFERENCES@&#

