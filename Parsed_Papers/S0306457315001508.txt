@&#MAIN-TITLE@&#Probabilistic latent variable models for unsupervised many-to-many object matching

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a probabilistic model for matching clusters in different domains without correspondence information.


                        
                        
                           
                           The proposed method can handle data with more than two domains, and the number of objects in each domain can be different.


                        
                        
                           
                           We extend the proposed method for a semi-supervised setting.


                        
                        
                           
                           We demonstrate that the proposed method achieve better matching performance than existing methods using synthetic and real-world data sets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Latent variable model

Mixture model

Object matching

@&#ABSTRACT@&#


               
               
                  Object matching is an important task for finding the correspondence between objects in different domains, such as documents in different languages and users in different databases. In this paper, we propose probabilistic latent variable models that offer many-to-many matching without correspondence information or similarity measures between different domains. The proposed model assumes that there is an infinite number of latent vectors that are shared by all domains, and that each object is generated from one of the latent vectors and a domain-specific projection. By inferring the latent vector used for generating each object, objects in different domains are clustered according to the vectors that they share. Thus, we can realize matching between groups of objects in different domains in an unsupervised manner. We give learning procedures of the proposed model based on a stochastic EM algorithm. We also derive learning procedures in a semi-supervised setting, where correspondence information for some objects are given. The effectiveness of the proposed models is demonstrated by experiments on synthetic and real data sets.
               
            

@&#INTRODUCTION@&#

Object matching is an important task for finding the correspondence between objects in different domains. Examples of object matching include matching an image with an annotation (Socher & Fei-Fei, 2010), an English word with a French word (Tripathi, Klami, & Virpioja, 2010), and user identification in different databases for recommendation (Li, Yang, & Xue, 2009). Most object matching methods require similarity measures between objects in the different domains, or paired data that contain correspondence information. When a similarity measure is given, we can match objects by finding pairs of objects that maximize the sum of the similarities. When correspondence information is given, we can obtain a mapping function from one domain to another by using supervised learning methods, and then we can calculate the similarities between objects in different domains.

However, similarity measures and correspondences might not be available. Defining similarities and generating correspondences incur considerable cost and time, and they are sometimes unobtainable because of the need to preserve privacy. For example, dictionaries between some languages might not exist, and different online stores cannot share user identification. For these situations, unsupervised object matching methods have been proposed; they include kernelized sorting (Quadrianto, Smola, Song, & Tuytelaars, 2010), least squares object matching (Yamada & Sugiyama, 2011), matching canonical correlation analysis (Haghighi, Liang, Berg-Kirkpatrick, & Klein, 2008), and its Bayesian extension (Klami, 2012; 2013). These methods find one-to-one matches. However, matching is not necessarily one-to-one in some applications. For example, when matching English and German documents, multiple English documents with the similar topic could correspond to multiple German documents. In image annotation, related annotations ‘tree’, ‘wood’ and ‘forest’ can be attached to multiple images that look similar to each other. Other limitations of these methods are that the number of domains is limited to two, and the numbers of objects in the different domains must be the same. There can be more than two domains in some applications, for example matching multilingual documents such as English, French and German, and the number of documents for each language can be different.

In this paper, we propose a probabilistic latent variable model for finding correspondence between object clusters in multiple domains without correspondence information. We assume that objects in different domains share a hidden structure, which is represented by an infinite number of latent vectors that are shared by all domains. Each object is generated from one of the latent vectors and a domain-specific linear projection. The latent vectors used for generating objects are unknown. By assigning a latent vector to each object, we can allocate objects in different domains to common clusters, and find many-to-many matches. The number of clusters is automatically inferred from the given data by using a Dirichlet process prior. The proposed model can handle more than two domains with different numbers of objects. We infer the proposed model using a stochastic EM algorithm. The proposed model can ignore arbitrary linear transformations for different domains by inferring the domain-specific linear projection, and can find cluster matching in different domains, where similarity cannot be calculated directly.

The proposed model assumes a Gaussian distribution for each observed variable, and its mean is determined by a latent vector and a linear projection matrix. It is an extension of probabilistic principle component analysis (PCA) (Tipping & Bishop, 1999b) and factor analysis (FA) (Everitt, 1984), which are representative probabilistic latent variable models. With probabilistic PCA and FA, each object is associated with a latent vector. On the other hand, with the proposed model, the latent vector that is assigned to each object is hidden. When the number of domains is one, and every object is assigned to a cluster that is different from those of other objects, the proposed model corresponds to probabilistic principle component analysis.

The proposed model can be also used in a semi-supervised setting, where correspondence information for some objects is given (Jagarlamudi, Juarez, & Daumé III, 2010; Quadrianto et al., 2010). The information assists matching by incorporating a condition stating that the cluster assignments of the corresponding objects must be the same. We derive learning procedures for the semi-supervised setting by modifying the learning procedures for unsupervised setting.

This paper is an extended version of Iwata, Hirao, and Ueda (2013). We newly proposed the inference procedure for a semi-supervised setting, and added derivations and experiments. The remainder of this paper is organized as follows. In Section 2, we review related work. In Section 3, we formulate the proposed model and describe its efficient learning procedures. We also present the learning procedures for a semi-supervised setting and for missing data. In Section 4, we demonstrate the effectiveness of the proposed models with experiments on synthetic and real data sets. Finally, we present concluding remarks and a discussion of future work in Section 5.

@&#RELATED WORK@&#

Unsupervised object matching is a task that involves finding the correspondence between objects in different domains without correspondence information. For example, kernelized sorting (Quadrianto et al., 2010) finds the correspondence by permuting a set to maximize the dependence between two domains where the Hilbert Schmidt Independence Criterion (HSIC) is used as the dependence measure. Kernelized sorting requires the two domains have the same number of objects. Convex kernelized sorting (Djuric, Grbovic, & Vucetic, 2012) is a convex formulation of kernelized sorting. Matching canonical correlation analysis (MCCA) (Haghighi et al., 2008) is another unsupervised object matching method based on a probabilistic model, where bilingual translation lexicons are learned from two monolingual corpora. MCCA simultaneously finds latent variables that represent correspondences and latent vectors so that the latent vectors of corresponding objects exhibit the maximum correlation. Tripathi, Klami, Orešič, and Kaski (2011) also proposed a method for unsupervised object matching that is related to MCCA. These methods assume one-to-one matching of objects. On the other hand, the proposed model can find many-to-many matching, and is applicable to objects in more than two domains. Bayesian solution for MCCA (BMCCA) has been proposed (Klami, 2012; 2013). BMCCA assumes that latent vectors are generated from a Gaussian distribution, and finds one-to-one matching by inferring a permutation matrix. In contrast, the proposed model assumes that latent vectors are generated from an infinite Gaussian mixture model (Rasmussen, 2000), and finds many-to-many matching by inferring cluster assignments.

Manifold alignment is related to the proposed model because they both find latent vectors of multiple sets in a joint latent space. The unsupervised manifold alignment method (Wang & Mahadevan, 2009) finds latent vectors of different domains in a joint latent space in an unsupervised manner. The method first identifies all possible matches for each example by leveraging its local geometry, and then finds an embedding in the latent space. The method requires permutations of the order of the factorial of the size of neighborhoods to match the local geometry. Note that the method does not explicitly find correspondences.

There has been some work on improving the learning performance of the classification task by using labeled objects in different domains without correspondence information. For example, multiple outlook mapping (MOMAP) (Harel & Mannor, 2011) improves the performance by matching the moments of the empirical distributions for each class of two domains. Shi, Liu, Fan, Yu, and Zhu (2010) proposed a transfer learning method that improves the learning performance by embedding both source and target domains in a joint latent space when a limited number of target objects are labeled. These methods require labeled objects. On the other hand, the proposed method does not require any labeled objects.

Consensus clustering (Strehl & Ghosh, 2003) tries to find a single clustering from a number of different clusterings. In the case that a clustering is obtained using data in each domain, consensus clustering can find many-to-many matching. However, consensus clustering requires that objects are aligned across domains.

The proposed model, as well as MCCA (Haghighi et al., 2008), can be considered as an unsupervised version of probabilistic canonical correlation analysis (CCA) (Bach & Jordan, 2005). Probabilistic CCA finds dependences between objects in two domains by projecting objects into a latent space. It requires correspondence information between different domains since it takes a set of paired objects as input. On the other hand, the proposed model can find dependences in an unsupervised manner without correspondence information by taking a set of objects for each domain as input. CCA is being successfully used for a wide variety of applications, such as multi-label prediction (Rai & Daumé III, 2009; Sun, Ji, & Ye, 2011), information retrieval (Hardoon, Szedmak, & Shawe-Taylor, 2004), and image annotation (Kimura et al., 2010). The proposed model can be used for these applications when supervised data are unavailable.

Mixtures of latent variable models have been also proposed, such as mixtures of probabilistic principal component analyzers (Tipping & Bishop, 1999a) and mixtures of factor analyzer (Ghahramani, Hinton et al., 1996). These mixture models assume that each object has its own latent vector, and different objects can be generated from different projection matrices, where the data are obtained from a domain. On the other hand, the proposed model assumes that different objects can share a latent vector, and all objects from a domain are generated from a domain-specific projection matrix. Thus, the proposed model can find many-to-many matching by assigning the same latent vectors to different objects from multiple domain data.

The proposed model can be seen as a generalization of the infinite Gaussian mixture model (Rasmussen, 2000). When the dimensionality of the latent space is the same as that of the observed space and the projection matrix is the identity matrix for all domains, the proposed model corresponds to the infinite Gaussian mixture model.

Recently, there have been proposed a number of deep learning methods for obtaining latent representations of multimodal data, such as multimodal deep learning (Ngiam et al., 2011), multimodal deep Boltzmann machine (Srivastava & Salakhutdinov, 2012) and deep canonical correlation analysis (Andrew, Arora, Bilmes, & Livescu, 2013). These methods utilize deep architectures to model complex nonlinear transformations between latent representations and multimodal observations. However, these methods require correspondence information to learn the transformations, and is unapplicable in an unsupervised setting. We can use deep learning to obtain latent representations for each domain in preprocessing, and apply the proposed method to the latent representations for unsupervised object matching.

@&#PROPOSED METHOD@&#

Suppose that we are given objects in D domains 
                           
                              X
                              =
                              
                                 
                                    {
                                    
                                       X
                                       d
                                    
                                    }
                                 
                                 
                                    d
                                    =
                                    1
                                 
                                 D
                              
                              ,
                           
                         where 
                           
                              
                                 X
                                 d
                              
                              =
                              
                                 
                                    {
                                    
                                       x
                                       
                                          d
                                          n
                                       
                                    
                                    }
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    N
                                    d
                                 
                              
                           
                         is a set of objects in the dth domain, and 
                           
                              
                                 x
                                 
                                    d
                                    n
                                 
                              
                              ∈
                              
                                 R
                                 
                                    M
                                    d
                                 
                              
                           
                         is the feature vector of the nth object in the dth domain. Our notation is summarized in Table 1
                        . Note that we are unaware of any correspondence between objects in different domains. The number of objects Nd
                         and the dimensionality Md
                         for each domain can be different from those of other domains. The task is to match groups of objects across multiple domains in an unsupervised manner. Fig. 1
                         shows an example of the input (top) and output (bottom) for the proposed model with two domains, where the numbers of objects in the first and second domains are 50 and 60, and the numbers of observation features are 70 and 50, respectively. The color shows the value of the observation feature. In this case, the proposed model found five clusters, and the object indices are permutated so that matched objects are aligned.

The model proposed for this task is a probabilistic latent variable model. The proposed model assumes that (1) there is a potentially infinite number of clusters, and (2) each cluster j has a latent vector 
                           
                              
                                 z
                                 j
                              
                              ∈
                              
                                 R
                                 K
                              
                           
                         in a K-dimensional latent space. Each object 
                           x
                        
                        
                           dn
                         in the dth domain is generated depending on domain-specific projection matrix 
                           
                              
                                 W
                                 d
                              
                              ∈
                              
                                 R
                                 
                                    
                                       M
                                       d
                                    
                                    ×
                                    K
                                 
                              
                           
                         and latent vector 
                           
                              z
                              
                                 s
                                 
                                    d
                                    n
                                 
                              
                           
                         that is selected from a set of latent vectors 
                           
                              Z
                              =
                              
                                 
                                    {
                                    
                                       z
                                       j
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 ∞
                              
                           
                        . Here, 
                           
                              
                                 s
                                 
                                    d
                                    n
                                 
                              
                              ∈
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 ∞
                                 }
                              
                           
                         is the latent cluster assignment of object 
                           x
                        
                        
                           dn
                        . Objects that use the same latent vector, or that have the same cluster assignment, are considered to match. Fig. 2
                         shows the relationship between latent vectors and objects in two domains, where arrows that indicate the corresponding latent vectors for each object are hidden.

To be precise, the proposed model is an infinite mixture model, where the probability of object 
                           x
                        
                        
                           dn
                         is given by

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                Z
                                                ,
                                                W
                                                ,
                                                
                                                   θ
                                                
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                ∞
                                             
                                             
                                                θ
                                                j
                                             
                                             N
                                             
                                                (
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                
                                                   W
                                                   d
                                                
                                                
                                                   z
                                                   j
                                                
                                                ,
                                                
                                                   α
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                I
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              W
                              =
                              
                                 
                                    {
                                    
                                       W
                                       d
                                    
                                    }
                                 
                                 
                                    d
                                    =
                                    1
                                 
                                 D
                              
                           
                         is a set of projection matrices, 
                           
                              
                                 θ
                              
                              =
                              
                                 
                                    {
                                    
                                       θ
                                       j
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 ∞
                              
                           
                         is a set of mixture weights, θj
                         represents the probability that the jth cluster is chosen, α is a precision parameter, and 
                           
                              N
                              (
                              
                                 μ
                              
                              ,
                              
                                 Σ
                              
                              )
                           
                         denotes a multivariate normal distribution with mean 
                           μ
                         and covariance matrix 
                           Σ
                        . In the proposed model, a set of latent vectors 
                           Z
                         is shared among multiple domains, but projection matrix 
                           W
                        
                        
                           d
                         depends on the domain. The benefit of the proposed model is as follows:

                           
                              •
                              By sharing the latent vectors, we can assign objects in different domains to common clusters, and find matchings between clusters.

By employing domain-specific projection matrices, we can handle multiple domains with different dimensionalities by adjusting the size of the matrices, and different statistical properties, such as means and covariances, by inferring the values of the matrices from the given data.

Given latent vectors, an arbitrary number of objects can be generated for each domain independently. Therefore, we can handle domains with different numbers of objects.

Specifically, the proposed model generates objects in multiple domains 
                           X
                         according to the following process,

                           
                              1.
                              Draw mixture weights 
                                    θ
                                  ∼ Stick(γ)

Draw a precision parameter 
                                    
                                       α
                                       ∼
                                       G
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              

For each cluster: 
                                    
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       ∞
                                    
                                 
                                 
                                    
                                       (a)
                                       Draw a latent vector 
                                             
                                                
                                                   z
                                                   j
                                                
                                                ∼
                                                N
                                                
                                                   (
                                                   
                                                      0
                                                   
                                                   ,
                                                   
                                                      
                                                         (
                                                         α
                                                         r
                                                         )
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   I
                                                   )
                                                
                                             
                                          
                                       

For each domain: 
                                    
                                       d
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       D
                                    
                                 
                                 
                                    
                                       (a)
                                       For each object: 
                                             
                                                n
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                
                                                   N
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                i.
                                                Draw a cluster assignment sdn
                                                    ∼ Categorical(
                                                      θ
                                                   )

Draw an observation vector 
                                                      
                                                         
                                                            x
                                                            
                                                               d
                                                               n
                                                            
                                                         
                                                         ∼
                                                         N
                                                         
                                                            (
                                                            
                                                               W
                                                               d
                                                            
                                                            
                                                               z
                                                               
                                                                  s
                                                                  
                                                                     d
                                                                     n
                                                                  
                                                               
                                                            
                                                            ,
                                                            
                                                               α
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            I
                                                            )
                                                         
                                                      
                                                   
                                                

The joint probability of data 
                           X
                         and cluster assignments 
                           
                              S
                              =
                              
                                 
                                    {
                                    
                                       
                                          {
                                          
                                             s
                                             
                                                d
                                                n
                                             
                                          
                                          }
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                          d
                                       
                                    
                                    }
                                 
                                 
                                    d
                                    =
                                    1
                                 
                                 D
                              
                           
                         is given by

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             p
                                             (
                                             X
                                             ,
                                             S
                                             |
                                             W
                                             ,
                                             a
                                             ,
                                             b
                                             ,
                                             r
                                             ,
                                             γ
                                             )
                                             =
                                             p
                                             (
                                             S
                                             |
                                             γ
                                             )
                                             p
                                             (
                                             X
                                             |
                                             S
                                             ,
                                             W
                                             ,
                                             a
                                             ,
                                             b
                                             ,
                                             r
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By marginalizing out mixture weights 
                           θ
                        , the first factor is calculated by

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                S
                                                |
                                                γ
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      γ
                                                      J
                                                   
                                                   
                                                      ∏
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      J
                                                   
                                                   
                                                      (
                                                      
                                                         N
                                                         
                                                            ·
                                                            j
                                                         
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   !
                                                
                                                
                                                   γ
                                                   (
                                                   γ
                                                   +
                                                   1
                                                   )
                                                   …
                                                   (
                                                   γ
                                                   +
                                                   N
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              N
                              =
                              
                                 ∑
                                 
                                    d
                                    =
                                    1
                                 
                                 D
                              
                              
                                 N
                                 d
                              
                           
                         is the total number of objects, N
                        · j
                         represents the number of objects assigned to cluster j, and J is the number of clusters for which N
                        · j
                         > 0. By marginalizing out latent vectors 
                           Z
                         and precision parameter α, the second factor of (2) is calculated by

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                X
                                                |
                                                S
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                )
                                             
                                             =
                                             
                                                
                                                   (
                                                   2
                                                   π
                                                   )
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            ∑
                                                            d
                                                         
                                                         
                                                            M
                                                            d
                                                         
                                                         
                                                            N
                                                            d
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                r
                                                
                                                   
                                                      K
                                                      J
                                                   
                                                   2
                                                
                                             
                                             
                                                
                                                   b
                                                   a
                                                
                                                
                                                   b
                                                   
                                                      ′
                                                      
                                                         a
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Γ
                                                   (
                                                   
                                                      a
                                                      ′
                                                   
                                                   )
                                                
                                                
                                                   Γ
                                                   (
                                                   a
                                                   )
                                                
                                             
                                             
                                                ∏
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                
                                                   |
                                                   
                                                      C
                                                      j
                                                   
                                                   |
                                                
                                                
                                                   1
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here,

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                ′
                                             
                                             =
                                             a
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         d
                                                         =
                                                         1
                                                      
                                                      D
                                                   
                                                   
                                                      M
                                                      d
                                                   
                                                   
                                                      N
                                                      d
                                                   
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                b
                                                ′
                                             
                                             =
                                             b
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   d
                                                
                                             
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                                ⊤
                                             
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                
                                                ⊤
                                             
                                             
                                                C
                                                
                                                   j
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                j
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                j
                                             
                                             =
                                             
                                                C
                                                j
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                                W
                                                
                                                   d
                                                
                                                ⊤
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   :
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   j
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                                N
                                                
                                                   d
                                                   j
                                                
                                             
                                             
                                                W
                                                
                                                   d
                                                
                                                ⊤
                                             
                                             
                                                W
                                                d
                                             
                                             +
                                             r
                                             I
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where Ndj
                         is the number of objects assigned to cluster j in domain d. The posterior for the precision parameter α is given by

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                α
                                                |
                                                X
                                                ,
                                                S
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                )
                                             
                                             =
                                             G
                                             
                                                (
                                                
                                                   a
                                                   ′
                                                
                                                ,
                                                
                                                   b
                                                   ′
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        and the posterior for the latent vector 
                           z
                        
                        
                           j
                         is given by

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   z
                                                   j
                                                
                                                |
                                                α
                                                ,
                                                X
                                                ,
                                                S
                                                ,
                                                W
                                                ,
                                                r
                                                )
                                             
                                             =
                                             N
                                             
                                                (
                                                
                                                   
                                                      μ
                                                   
                                                   j
                                                
                                                ,
                                                
                                                   α
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   C
                                                   j
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        See Appendix B for the derivation.

We describe the learning procedures for the proposed model based on a stochastic EM algorithm, in which collapsed Gibbs sampling of cluster assignments 
                           S
                         and the maximum joint likelihood estimation of projection matrices 
                           W
                         are alternately iterated while marginalizing out latent vectors 
                           Z
                        , precision parameter α, and cluster proportions 
                           θ
                        . By collapsing, or marginalizing out, the variables, the time-consuming step of drawing the variables is skipped, and the sample autocorrelations are usually reduced (Liu, 1994).

In the E-step, given the current state of all but one latent cluster assignments, sdn
                        , a new value for sdn
                         is sampled from the following probability,

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                =
                                                j
                                                |
                                                X
                                                ,
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                ,
                                                γ
                                                )
                                             
                                             ∝
                                             
                                                
                                                   p
                                                   (
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                             
                                             ·
                                             
                                                
                                                   p
                                                   (
                                                   X
                                                   |
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      X
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   |
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ∖dn represents a value or set excluding the nth object in the dth domain, and we use the fact that 
                           
                              p
                              (
                              
                                 s
                                 
                                    d
                                    n
                                 
                              
                              =
                              j
                              |
                              X
                              ,
                              
                                 S
                                 
                                    ∖
                                    d
                                    n
                                 
                              
                              ,
                              W
                              ,
                              a
                              ,
                              b
                              ,
                              r
                              ,
                              γ
                              )
                           
                         does not depend on p(
                           x
                        
                        
                           dn
                        |
                           W
                        , a, b, r). See Appendix C for the derivation. The first factor is given by

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               N
                                                               
                                                                  ·
                                                                  j
                                                                  ∖
                                                                  d
                                                                  n
                                                               
                                                            
                                                            
                                                               N
                                                               −
                                                               1
                                                               +
                                                               γ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            for
                                                            
                                                            an
                                                            
                                                            existing
                                                            
                                                            cluster,
                                                            
                                                            
                                                               j
                                                               ∈
                                                               {
                                                               1
                                                               ,
                                                               …
                                                               ,
                                                               J
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                            
                                                               N
                                                               −
                                                               1
                                                               +
                                                               γ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            for
                                                            
                                                            a
                                                            
                                                            new
                                                            
                                                            cluster,
                                                            
                                                            
                                                               j
                                                               =
                                                               J
                                                               +
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        using (3). By using (4), the second factor is given by

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   X
                                                   |
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      X
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   |
                                                   
                                                      S
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   2
                                                   π
                                                   )
                                                
                                                
                                                   −
                                                   
                                                      
                                                         M
                                                         d
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                r
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   I
                                                   
                                                      (
                                                      j
                                                      >
                                                      
                                                         J
                                                         
                                                            ∖
                                                            d
                                                            n
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                   
                                                      ′
                                                      
                                                         a
                                                         
                                                            ∖
                                                            d
                                                            n
                                                         
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   b
                                                   
                                                      
                                                         s
                                                         
                                                            d
                                                            n
                                                         
                                                      
                                                      =
                                                      j
                                                   
                                                   
                                                      ′
                                                      
                                                         a
                                                         
                                                            
                                                               s
                                                               
                                                                  d
                                                                  n
                                                               
                                                            
                                                            =
                                                            j
                                                         
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Γ
                                                   (
                                                   
                                                      a
                                                      
                                                         
                                                            s
                                                            
                                                               d
                                                               n
                                                            
                                                         
                                                         =
                                                         j
                                                      
                                                      ′
                                                   
                                                   )
                                                
                                                
                                                   Γ
                                                   (
                                                   
                                                      a
                                                      
                                                         ∖
                                                         d
                                                         n
                                                      
                                                      ′
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      C
                                                      
                                                         j
                                                         ,
                                                         
                                                            s
                                                            
                                                               d
                                                               n
                                                            
                                                         
                                                         =
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      C
                                                      
                                                         j
                                                         ∖
                                                         d
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where subscript 
                           
                              
                                 s
                                 
                                    d
                                    n
                                 
                              
                              =
                              j
                           
                         indicates the value when object 
                           x
                        
                        
                           dn
                         is assigned to cluster j as follows,

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                                ′
                                             
                                             =
                                             
                                                a
                                                ′
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                b
                                                
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                                ′
                                             
                                             =
                                             
                                                b
                                                
                                                   ∖
                                                   d
                                                   n
                                                
                                                ′
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                                ⊤
                                             
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   ∖
                                                   d
                                                   n
                                                
                                                ⊤
                                             
                                             
                                                C
                                                
                                                   j
                                                   ∖
                                                   d
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   ∖
                                                   d
                                                   n
                                                
                                             
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   ,
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                                ⊤
                                             
                                             
                                                C
                                                
                                                   j
                                                   ,
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   ,
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                   ,
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                             
                                             =
                                             
                                                C
                                                
                                                   j
                                                   ,
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   W
                                                   
                                                      d
                                                   
                                                   ⊤
                                                
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                +
                                                
                                                   C
                                                   
                                                      j
                                                      ∖
                                                      d
                                                      n
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   j
                                                   ,
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             =
                                             
                                                W
                                                
                                                   d
                                                
                                                ⊤
                                             
                                             
                                                W
                                                d
                                             
                                             +
                                             
                                                C
                                                
                                                   j
                                                   ∖
                                                   d
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        and I(·) is used to denote the indicator function, i.e. 
                           
                              I
                              (
                              A
                              )
                              =
                              1
                           
                         if A is true, 
                           
                              I
                              (
                              A
                              )
                              =
                              0
                           
                         otherwise.

In the M-step, the projection matrices 
                           W
                         are estimated by maximizing the logarithm of the joint likelihood (2). We maximize it by using a gradient-based numerical optimization method such as the quasi-Newton method (Nocedal, 1980). The gradient of the joint log likelihood is calculated by

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   log
                                                   p
                                                   (
                                                   X
                                                   ,
                                                   S
                                                   |
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   ,
                                                   γ
                                                   )
                                                
                                                
                                                   ∂
                                                   
                                                      W
                                                      d
                                                   
                                                
                                             
                                             =
                                             −
                                             
                                                W
                                                d
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                N
                                                
                                                   d
                                                   j
                                                
                                             
                                             
                                                C
                                                j
                                             
                                             −
                                             
                                                
                                                   a
                                                   ′
                                                
                                                
                                                   b
                                                   ′
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                (
                                                
                                                   N
                                                   
                                                      d
                                                      j
                                                   
                                                
                                                
                                                   W
                                                   d
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   j
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                   ⊤
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      :
                                                      
                                                         s
                                                         
                                                            d
                                                            n
                                                         
                                                      
                                                      =
                                                      j
                                                   
                                                
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                   ⊤
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        We can obtain the projection matrices that maximize the joint likelihood analytically as follows,

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             W
                                             =
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      J
                                                   
                                                   
                                                      N
                                                      
                                                         d
                                                         j
                                                      
                                                   
                                                   
                                                      C
                                                      j
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                         ′
                                                      
                                                      
                                                         b
                                                         ′
                                                      
                                                   
                                                   
                                                      N
                                                      
                                                         d
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      j
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      j
                                                      ⊤
                                                   
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   a
                                                   ′
                                                
                                                
                                                   b
                                                   ′
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   :
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                
                                                ⊤
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        In our experiments, we used gradient-based updates since it found better local optimum solutions by updating parameters gradually.


                        Algorithm 1
                         shows the procedures for inferring the proposed model based on the stochastic EM algorithm. Here, T is the number of iterations for the stochastic EM algorithm. For the input, we give the initial number of clusters J. The cluster assignments 
                           S
                         are initialized by randomly selecting an integer from 
                           
                              {
                              1
                              ,
                              …
                              ,
                              J
                              }
                           
                        . The projection matrices 
                           W
                         can be initialized by Gaussian with zero mean and small variance. By iterating the E- and M-steps, we can obtain an estimate of the cluster assignments and projection matrices. In all of the experiments, we used the following hyperparameters: 
                           
                              a
                              =
                              b
                              =
                              r
                              =
                              γ
                              =
                              1
                           
                        .

We can use cross-validation to select an appropriate dimensionality for latent space K. H-fold cross-validation is as follows,

                           
                              1.
                              The elements of observation matrices 
                                    X
                                  are partitioned into H subsets.

For each of H experiments, 
                                    
                                       H
                                       −
                                       1
                                    
                                  subsets are used for inferring the model while the remaining one is assumed missing. The test likelihood of the missing part is calculated by using the inferred model.

We select the K value that performed the best in terms of the average test likelihood over H experiments.

The learning procedure for missing data is described in Section 3.4.

When we use a regular EM algorithm instead of the stochastic EM algorithm, latent vectors are not integrated out, and therefore need to be estimated. We can use Gibbs sampling for inferring projection matrices. However, we learned them by maximizing the likelihood since priors, which require additional hyperparameters, are not necessary.

In some applications, correspondence information on a few pairs of objects might be available. This correspondence information helps to improve matching performance. Here, we describe learning procedures for the semi-supervised setting, where correspondence information between some objects in different domains is given, based on a stochastic EM algorithm. The task of finding correspondence in a semi-supervised setting is also called informed sorting (Quadrianto et al., 2010) or seed alignment (Jagarlamudi et al., 2010). Let 
                           
                              i
                              =
                              (
                              d
                              ,
                              n
                              )
                           
                         and 
                           
                              
                                 i
                                 ′
                              
                              =
                              
                                 (
                                 
                                    d
                                    ′
                                 
                                 ,
                                 
                                    n
                                    ′
                                 
                                 )
                              
                           
                         be a pair of objects for which one-to-one correspondence is given. Their latent cluster assignments must be the same because we know that they match. Thus, in the E-step, we sample the cluster assignments for both of them, i and i′, simultaneously so that they have the same cluster assignments. New values for the cluster assignments, si
                         and 
                           
                              
                                 s
                                 
                                    i
                                    ′
                                 
                              
                              ,
                           
                         are sampled from the following probability,

                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                
                                                   s
                                                   i
                                                
                                                =
                                                
                                                   s
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                =
                                                j
                                                |
                                                X
                                                ,
                                                
                                                   S
                                                   
                                                      ∖
                                                      i
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                ,
                                                γ
                                                )
                                             
                                             =
                                             
                                                
                                                   p
                                                   (
                                                   
                                                      s
                                                      i
                                                   
                                                   =
                                                   
                                                      s
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                             
                                             ·
                                             
                                                
                                                   p
                                                   (
                                                   X
                                                   |
                                                   
                                                      s
                                                      i
                                                   
                                                   =
                                                   
                                                      s
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      X
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   |
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ∖ii′ represents a value or set excluding objects i and i′. The first factor of the left-hand side is calculated by

                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   
                                                      s
                                                      i
                                                   
                                                   =
                                                   
                                                      s
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   |
                                                   γ
                                                   )
                                                
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  N
                                                                  
                                                                     ·
                                                                     j
                                                                     ∖
                                                                     i
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                               
                                                               
                                                                  (
                                                                  
                                                                     N
                                                                     
                                                                        ·
                                                                        j
                                                                        ∖
                                                                        i
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            
                                                               (
                                                               N
                                                               −
                                                               2
                                                               +
                                                               γ
                                                               )
                                                               (
                                                               N
                                                               −
                                                               1
                                                               +
                                                               γ
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            for
                                                            
                                                            an
                                                            
                                                            existing
                                                            
                                                            cluster,
                                                            
                                                            
                                                               j
                                                               ∈
                                                               {
                                                               1
                                                               ,
                                                               …
                                                               ,
                                                               J
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                            
                                                               (
                                                               N
                                                               −
                                                               2
                                                               +
                                                               γ
                                                               )
                                                               (
                                                               N
                                                               −
                                                               1
                                                               +
                                                               γ
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            for
                                                            
                                                            a
                                                            
                                                            new
                                                            
                                                            cluster,
                                                            
                                                            
                                                               j
                                                               =
                                                               J
                                                               +
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        using (3), and the second factor is given by

                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   X
                                                   |
                                                   
                                                      s
                                                      i
                                                   
                                                   =
                                                   
                                                      s
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   =
                                                   j
                                                   ,
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      X
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   |
                                                   
                                                      S
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   ,
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   2
                                                   π
                                                   )
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            M
                                                            d
                                                         
                                                         +
                                                         
                                                            M
                                                            
                                                               d
                                                               ′
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                r
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   I
                                                   
                                                      (
                                                      j
                                                      >
                                                      
                                                         J
                                                         
                                                            ∖
                                                            i
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                   
                                                      ∖
                                                      i
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   
                                                      ′
                                                      
                                                         a
                                                         
                                                            ∖
                                                            i
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   b
                                                   
                                                      
                                                         s
                                                         
                                                            i
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                      
                                                      =
                                                      j
                                                   
                                                   
                                                      ′
                                                      
                                                         a
                                                         
                                                            
                                                               s
                                                               
                                                                  i
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                            
                                                            =
                                                            j
                                                         
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Γ
                                                   (
                                                   
                                                      a
                                                      
                                                         
                                                            s
                                                            
                                                               i
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                         
                                                         =
                                                         j
                                                      
                                                      ′
                                                   
                                                   )
                                                
                                                
                                                   Γ
                                                   (
                                                   
                                                      a
                                                      
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      ′
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      C
                                                      
                                                         j
                                                         ,
                                                         
                                                            s
                                                            
                                                               i
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                         
                                                         =
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      C
                                                      
                                                         j
                                                         ∖
                                                         i
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        using (3) and (4). When we are given correspondence information for more than two objects, we can derive a sampling probability with the same manner using (4). For objects without correspondence information, the sampling probability of the latent cluster assignment is the same as in the unsupervised setting (11). The M-step is the same as that in the unsupervised setting, and we can update projection matrices using gradient-based optimization with (18).

Since the proposed model is a probabilistic generative model, it can handle missing data, where some observation features are missing. Let 
                           
                              
                                 h
                                 
                                    d
                                    n
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       h
                                       
                                          d
                                          n
                                          m
                                       
                                    
                                    )
                                 
                                 
                                    m
                                    =
                                    1
                                 
                                 
                                    M
                                    d
                                 
                              
                           
                         be a vector indicating observed indices, where 
                           
                              
                                 h
                                 
                                    d
                                    n
                                    m
                                 
                              
                              =
                              1
                           
                         if xdnm
                         is observed, 
                           
                              
                                 h
                                 
                                    d
                                    n
                                    m
                                 
                              
                              =
                              0
                           
                         otherwise, and Mdn
                         is the number of observed values for object 
                           x
                        
                        
                           dn
                        . The posterior parameters are calculated as follows,

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                ′
                                             
                                             =
                                             a
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         d
                                                         =
                                                         1
                                                      
                                                      D
                                                   
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                         d
                                                      
                                                   
                                                   
                                                      M
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                b
                                                ′
                                             
                                             =
                                             b
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   d
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   ∘
                                                   
                                                      x
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                             
                                                (
                                                
                                                   h
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                ∘
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   j
                                                
                                                ⊤
                                             
                                             
                                                C
                                                
                                                   j
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                j
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                j
                                             
                                             =
                                             
                                                C
                                                j
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                                W
                                                
                                                   d
                                                
                                                ⊤
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   :
                                                   
                                                      s
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   =
                                                   j
                                                
                                             
                                             
                                                h
                                                
                                                   d
                                                   n
                                                
                                             
                                             ∘
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   j
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                                W
                                                
                                                   d
                                                
                                                ⊤
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      n
                                                      :
                                                      
                                                         s
                                                         
                                                            d
                                                            n
                                                         
                                                      
                                                      =
                                                      j
                                                   
                                                
                                                diag
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                                W
                                                d
                                             
                                             +
                                             r
                                             I
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where ○ represents the Hadamard product, or element-wise product, and diag(
                           h
                        
                        
                           dn
                        ) returns a diagonal matrix whose diagonal elements are 
                           
                              
                                 h
                                 
                                    d
                                    n
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 h
                                 
                                    d
                                    n
                                    
                                       M
                                       d
                                    
                                 
                              
                           
                        . For learning with missing data, we use (23)–(26) instead of (5)–(8) for calculating the sampling probability (11) in the E-step. In the M-step, the following gradient is used for optimizing projection matrices,

                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   log
                                                   p
                                                   (
                                                   X
                                                   ,
                                                   S
                                                   |
                                                   W
                                                   ,
                                                   a
                                                   ,
                                                   b
                                                   ,
                                                   r
                                                   ,
                                                   γ
                                                   )
                                                
                                                
                                                   ∂
                                                   
                                                      W
                                                      d
                                                   
                                                
                                             
                                             =
                                             −
                                             
                                                W
                                                d
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                N
                                                
                                                   d
                                                   j
                                                
                                             
                                             
                                                C
                                                j
                                             
                                             −
                                             
                                                
                                                   a
                                                   ′
                                                
                                                
                                                   b
                                                   ′
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                (
                                                
                                                   N
                                                   
                                                      d
                                                      j
                                                   
                                                
                                                
                                                   W
                                                   d
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   j
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                   ⊤
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      :
                                                      
                                                         s
                                                         
                                                            d
                                                            n
                                                         
                                                      
                                                      =
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      h
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   ∘
                                                   
                                                      x
                                                      
                                                         d
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                   ⊤
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        instead of (18).

@&#EXPERIMENTS@&#

First, we demonstrate the proposed model described in Section 3 using a toy data set with three domains, which is created using handwritten digits from the MNIST database (LeCun, Bottou, Bengio, & Haffner, 1998). The first domain contains original handwritten digits, where each image is downsampled to 16 × 16 pixels. We synthesize objects for the second and third domains by rotating handwritten digits by 90 and 180 degrees, clockwise, respectively. Thus, we obtain three-domain objects that share a latent space. The number of objects in each domain is 200 for all domains. We would like to match the rotated digits in different domains without information about rotation or correspondence.


                        Fig. 4
                         shows some examples of the clusters discovered by the proposed model with 
                           
                              K
                              =
                              5
                           
                        . The proposed model successfully clustered objects, the same digit with rotation. In each domain, similar objects are clustered. Across different domains, dissimilar objects can be clustered. For example, objects in cluster ‘6’ in the first domain are more dissimilar to those in the third domain than objects in cluster ‘9’ in the first domain. By using domain-dependent projection matrices, the proposed model finds clusters of objects across different domains that have similar latent features and that might have different observation features. When we use standard clustering methods such as k-means and Gaussian mixtures for the data that are constructed by combining data in all domains, ‘6’ is never clustered with ‘6’ with 180 degree rotation.

We can map the observation features to different domains through the latent space by using the inferred projection matrices. Observation feature vector 
                           x
                         in domain d can be mapped into the latent space by 
                           
                              
                                 z
                                 ^
                              
                              =
                              
                                 
                                    (
                                    
                                       W
                                       
                                          d
                                       
                                       ⊤
                                    
                                    
                                       W
                                       d
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 W
                                 
                                    d
                                 
                                 ⊤
                              
                              x
                              ,
                           
                         where we used the pseudo-inverse of projection matrix 
                           W
                        
                        
                           d
                        . The latent vector 
                           z
                         can be mapped into domain d′ by 
                           
                              
                                 
                                    x
                                    ^
                                 
                                 
                                    d
                                    ′
                                 
                              
                              =
                              
                                 W
                                 
                                    d
                                    ′
                                 
                              
                              
                                 z
                                 ^
                              
                           
                        . Thus, the projection matrix that maps from domain d to domain d′ is 
                           
                              
                                 W
                                 
                                    d
                                    ′
                                 
                              
                              
                                 
                                    (
                                    
                                       W
                                       
                                          d
                                       
                                       ⊤
                                    
                                    
                                       W
                                       d
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 W
                                 
                                    d
                                 
                                 ⊤
                              
                           
                        . Fig. 5
                         shows the images mapped to the three domains by the projection matrices. The original image comes from the first domain. The mapped images to second and third domains are rotated images of the first domain by 90 and 180 degrees clockwise, respectively, which are consistent with the procedure used to synthesize the data set. This result indicates that we can infer the projection matrices properly, and that the proposed model can map to different domains in an unsupervised fashion by using the shared latent space.

Next, we evaluated the proposed model quantitatively by using three synthetic and five real-world data sets. The statistics of the seven data sets are shown in Table 2
                        . There are two domains for all data sets. Synth3, Synth5, and Synth10 are synthetic data sets with different true dimensionalities of the latent space 
                           
                              
                                 K
                                 *
                              
                              =
                              3
                              ,
                              5
                           
                         and 10, respectively. We generated the synthetic data sets using the following procedure. First, we sampled latent vectors 
                           z
                        
                        
                           j
                         for 
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 J
                                 *
                              
                           
                         from a K
                        *-dimensional normal distribution with mean 
                           0
                         and covariance 
                           I
                        . Next, we generated projection matrices 
                           W
                        
                        
                           d
                         for 
                           
                              d
                              =
                              1
                              ,
                              2
                              ,
                           
                         where each element is drawn from a normal distribution with mean 0 and variance 1. Finally, we generated N/J
                        * objects for each cluster j using a normal distribution with mean 
                           W
                        
                        
                           d
                        
                        
                           z
                        
                        
                           j
                         and covariance 
                           
                              
                                 α
                                 
                                    −
                                    1
                                 
                              
                              I
                              ,
                           
                         and obtained N objects in total for each domain 
                           
                              d
                              =
                              1
                              ,
                              2
                           
                        .

Iris, Glass, Wine and MNIST, the real-world data sets, were obtained from LIBSVM multi-class data sets (Chang & Lin, 2011), and generated objects in two domains by randomly splitting the features into two parts for each data set as Djuric et al. (2012); Quadrianto et al. (2010) did for their experiments. Because there is no overlapping feature, we cannot calculate similarities between objects in different domains. Iris, Glass, Wine and MNIST were artificially splitted into two domains. On the other hand, Wiki data was a real-world two domain data set, which consisted of Wikipedia documents written in English and German. For each language, we sampled 150 documents that were categorized in ‘Nobel laureates in Physics’, ‘Nobel laureates in Chemistry’, ‘American basketball players’, ‘American composers’, and ‘English footballers’. We selected these categories since since they contained enough number of documents, they were related to each other (‘Nobel laureates in Physics’ and ‘Nobel laureates in Chemistry’, ‘American basketball players’ and ‘American composers’, ‘American basketball players’ and ‘English footballers’), and their topics seemed to be interpretable. We used 1000 most frequently occurring words as features for each language to reduce computational time, where the frequencies were computed by all documents that were categorized in the five categories. With the real-world data sets, we used class labels as true clusters.

For the proposed method, we used the dimensionality of the latent space, 
                           
                              K
                              =
                              5
                              ,
                           
                         for all data sets. To alleviate the local optimum problem, we ran the learning procedure five times with different initial conditions, and selected the result that achieved the highest likelihood. The number of iterations was 100. For comparison, we used k-means (KM), convex kernelized sorting (CKS) (Djuric et al., 2012), and their combinations (KM-CKS and CKS-KM) as described below. The KM method is widely used for clustering. Although KM is not a many-to-many matching method, we included KM as a baseline method to evaluate the case when only objects in the same domain are clustered. The CKS method is an unsupervised object matching method. It directly finds correspondence between objects, and does not cluster objects in the same domain. We used the CKS code provided by the authors
                           1
                        
                        
                           1
                           
                              http://astro.temple.edu/~tua95067/CKS_code.zip
                           
                        , where we used their default setting and the maximum number of iterations was 10,000. With KM-CKS, first we discovered clusters by applying KM to each domain individually, and then found the correspondence between clusters in two domains by using CKS. We used the mean vector of each cluster as the input for cluster matching by CKS. With CKS-KM, after matching objects using CKS, we combined matched objects in two domains into a vector, and estimated clusters using KM. We employed CKS for comparison since it achieves higher performance than kernelized sorting and matching canonical correlation analysis (Djuric et al., 2012; Jagarlamudi et al., 2010). With KM, KM-CKS and CKS-KM, we used the number of clusters estimated by the proposed model. For comparison with object matching based methods (CKS, CKS-KM), we used data sets that had the same numbers of objects in the two domains 
                           
                              
                                 N
                                 1
                              
                              =
                              
                                 N
                                 2
                              
                           
                         for each data set.

For the evaluation measurement, we used the adjusted Rand index (Hubert & Arabie, 1985), which quantifies the similarity between inferred clusters and true clusters. It takes a value from 
                           
                              −
                              1
                           
                         to 1; 0 represents random clustering. A higher value indicates better clustering performance. The adjusted Rand index becomes high when object pairs that belong to one true cluster are assigned to one inferred cluster simultaneously, and when object pairs that belong to different true clusters are assigned to different inferred clusters. Here, we use object pairs across all domains including the same domain. Even if no objects are correctly matched across different domains, the adjusted Rand index can be positive if clusters are correctly found within each domain. If objects are matched, they are considered assigned to the same cluster. Therefore, we can calculate the adjusted Rand index of CKS although it is likely to be low because all objects in the same domain are assigned to different clusters. The adjusted Rand index for KM is calculated by assuming that any clusters across different domains do not match. The adjusted Rand index measures how well objects with the same label in different domains are assigned to the same cluster as well as measuring the clustering performance within each domain. For the real data sets, we assume that the category label of each object is its true cluster assignment.

@&#RESULTS@&#


                        Table 3
                         shows the adjusted Rand index for the seven data sets, which were averaged over ten experiments for each data set. For all data sets, the proposed model achieved the highest adjusted Rand index. This result indicates that the proposed model can infer matching clusters by assuming a shared latent space. KM-CKS achieved higher performance than KM by matching clusters in a post-processing step. With KM-CKS, since clusters are inferred individually for each domain, the estimated clusters might be different in different domains. On the other hand, since the proposed model infers clusters in all domains simultaneously, it more successfully found shared clusters than KM-CKS as shown by its higher adjusted Rand index. The adjusted Rand index obtained with the CKS method was low, because it does not cluster objects. By clustering the result of CKS, CKS-KM improved the cluster matching performance. However, it did not outperform the proposed model, because errors that accumulate in the object matching process by CKS cannot be corrected in the clustering process with k-means. The better performance of the proposed model with fixed hyperparameters 
                           
                              a
                              =
                              b
                              =
                              r
                              =
                              γ
                              =
                              1
                           
                         for all data sets indicates that the performance is not sensitive to hyperparameter setting.

The performance with the synthetic data by the proposed model was better than that with the real-world data since the synthetic data are generated by the generative process of the proposed model. Because the generative process, where observations are generated by linear projections of latent vectors, is simple compared with the real-world data, the performance with the synthetic data by the baselines was also better than the performance with the real-world data. With the Wiki data, although the proposed method achieved the best adjusted Rand index, it was not significantly better than KM-CKS and CKS-KM. This might be because the word frequency feature does not match with Gaussian noise which is the assumption of the proposed method. Another reason would be that linear projections is not appropriate for the Wiki data.


                        Fig. 6
                         shows the adjusted Rand index for the Synth5 data set achieved by the proposed model with different latent dimensionalities. The value was highest when the latent dimensionality of the model was the same as the true latent dimensionality 
                           
                              K
                              =
                              
                                 K
                                 *
                              
                              =
                              5
                           
                        . The proposed model with K ≠ K
                        * also performed better than the other methods. This result indicates that the proposed model is robust to the latent dimensionality setting.


                        Fig. 7
                         shows the adjusted Rand index for the Synth5 data set with different numbers of domains, D. The proposed model can handle data with more than two domains. For kernelized sorting based methods (KM-CKS, CKS-KM and CKS), we used one of the domains as a pivot for handling more than two domains. In particular, with these methods, we found matching across multiple domains by matching clusters/objects between the Dth domain and each of the other 
                           
                              D
                              −
                              1
                           
                         domains, and then combined the results. In general, the adjusted Rand index decreases as the number of domains increases, since the number of possible combinations of cluster matching increases. However, the proposed method consistently achieved the highest performance regardless of domain number.

The proposed model assumes that cluster proportions are shared by different domains. We evaluated the performance of the proposed model with synthetic data, in which cluster proportions were different across two domains. Each clusters contains 50 objects except for cluster1 of domain1, where we changed the number of objects from 10 to 100. The number of true clusters was 
                           
                              
                                 J
                                 *
                              
                              =
                              5
                              ,
                           
                         the latent dimensionality was 
                           
                              
                                 K
                                 *
                              
                              =
                              5
                              ,
                           
                         and the dimensionality of the objects was 
                           
                              
                                 M
                                 1
                              
                              =
                              
                                 M
                                 2
                              
                              =
                              50
                           
                        . Fig. 8
                        
                        
                         shows the adjusted Rand index. Note that CKS and CKS-KM are unapplicable since they require that different domains contain the same number of objects. The proposed model achieved the best performance even with data with different cluster proportions. When the number of objects in cluster1 of domain1 was 50, the adjusted Rand index of the proposed model was highest, since the common cluster proportions were the same across different domains with this data set.

The computational time of the proposed model for learning the Synth5 data set was 22 s with 100 learning iterations when using a computer with 3.20 GHz CPU. The computational complexity of each E-step is O(NJK
                        3), where N is the total number of objects, J is the number of clusters, and K is the latent dimensionality. It increases linearly with the number of objects N because we need to perform sampling for each object. Cluster assignment is sampled from 
                           
                              J
                              +
                              1
                           
                         clusters, in which we calculate the probability for each of the 
                           
                              J
                              +
                              1
                           
                         clusters. Therefore, the complexity increases linearly with the number of clusters J. The complexity of calculating each sampling probability is dominated by the O(K
                        3) computation of inverse 
                           
                              C
                              
                                 j
                              
                              
                                 −
                                 1
                              
                           
                        . Fig. 9 shows the experimental computation time of the proposed model including E- and M-steps. The computation time linearly increases with the number of objects as shown in Fig. 9(a). The dimensionality of the observation and latent spaces, and the true number of clusters do not strongly impact the computation time (Fig. 9(b)–(d)). Because this experiment used small latent dimensionality, it might not alter the total computation time. The computation time increases superlinearly with the number of domains (Fig. 9(e)). The time increases because the number of parameters in the projection matrices increases linearly with the number of domains, and the total number of objects is also increased.


                        Fig. 10 shows the average adjusted Rand index achieved by the proposed model with semi-supervised setting over ten experiments, where different objects were labeled for each experiment. Here, we used the seven data sets shown in Table 2. For each data set, we randomly selected pairs of objects to be labeled according to the labeled object rate, which is the horizontal axis of Fig. 10, and correspondence information to the different domain for the selected objects were attached. The performance increases as the rate of labeled objects increases. With some data sets (e.g. Synth5, Synth10 and Wine), the addition of just a few labeled objects drastically increases the adjusted Rand index. This result indicates that these data sets can be appropriately modeled by the linear projection of latent vectors, and the proposed model can utilize correspondence information for a small number of objects for finding many-to-many matching. Because the true latent dimensionality of the Synth5 data was the same with the model used in this experiment, the adjusted Rand index became one with additional labeled data. With the Synth3 data, the performance was not improved well since the proposed model overfit to the data due to its high latent dimensionality.

@&#CONCLUSION@&#

We proposed a generative model approach for finding many-to-many matching based on probabilistic latent variable models. In experiments, we confirmed that the proposed model can perform much better than conventional methods based on object matching, clustering and their combinations. Advantages of the proposed model over the existing methods are that it can find many-to-many matching, and can handle multiple domains with different numbers of objects with no prior knowledge. Because the proposed approach uses probabilistic generative models, we can extend it in a probabilistically principled manner, and use it, for example, to handle missing data, integration with other probabilistic models, and generalization to exponential family distributions.

Although our results have been encouraging as a first step towards unsupervised many-to-many object matching, we must extend our approach in a number of directions. First, we would like to extend the proposed model to other types of data, such as time series and graph data. Second, we can relax the assumption that the observations are linear with respect to their latent vectors by using nonlinear matrix factorization techniques (Lawrence & Urtasun, 2009). Third, we need some techniques for automatically inferring the latent dimensionality, such as automatic relevance determination (MacKay, 1992). Finally, we would like to use the proposed method for other applications, which include image annotation (Socher & Fei-Fei, 2010), cross domain recommendation (Li et al., 2009), multi-lingual corpus analysis (Boyd-Graber & Blei, 2009; Iwata, Mochihashi, & Sawada, 2010), machine translation (Haghighi et al., 2008), and bioinformatics (Wang & Mahadevan, 2008).

We give the derivation of the likelihood (4), in which latent vectors 
                        Z
                      and precision parameter α are analytically integrated out.

                        
                           (A.1)
                           
                              
                                 
                                    
                                       
                                          p
                                          (
                                          X
                                          |
                                          S
                                          ,
                                          W
                                          ,
                                          a
                                          ,
                                          b
                                          ,
                                          r
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          ∫
                                          ∫
                                          
                                             ∏
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                                d
                                             
                                          
                                          N
                                          
                                             (
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             |
                                             
                                                W
                                                d
                                             
                                             
                                                z
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                             
                                             ,
                                             
                                                α
                                                
                                                   −
                                                   1
                                                
                                             
                                             I
                                             )
                                          
                                          G
                                          
                                             (
                                             α
                                             |
                                             a
                                             ,
                                             b
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          N
                                          
                                             (
                                             
                                                z
                                                j
                                             
                                             |
                                             
                                                0
                                             
                                             ,
                                             
                                                
                                                   (
                                                   a
                                                   r
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             I
                                             )
                                          
                                          d
                                          Z
                                          d
                                          α
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          ∫
                                          ∫
                                          
                                             ∏
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                                d
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   α
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   M
                                                   d
                                                
                                                /
                                                2
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                α
                                                2
                                             
                                             ∥
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             −
                                             
                                                W
                                                d
                                             
                                             
                                                z
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                             
                                             
                                                ∥
                                                2
                                             
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      α
                                                      r
                                                   
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                )
                                             
                                             
                                                K
                                                /
                                                2
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                
                                                   α
                                                   r
                                                
                                                2
                                             
                                             ∥
                                             
                                                z
                                                j
                                             
                                             
                                                ∥
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                             1
                                             
                                                Γ
                                                (
                                                a
                                                )
                                             
                                          
                                          
                                             b
                                             a
                                          
                                          
                                             α
                                             
                                                a
                                                −
                                                1
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             b
                                             α
                                             )
                                          
                                          d
                                          Z
                                          d
                                          α
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                b
                                                a
                                             
                                             
                                                Γ
                                                (
                                                a
                                                )
                                             
                                          
                                          ∫
                                          ∫
                                          
                                             
                                                (
                                                
                                                   α
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   ∑
                                                   d
                                                
                                                
                                                   M
                                                   d
                                                
                                                
                                                   N
                                                   d
                                                
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      α
                                                      r
                                                   
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                )
                                             
                                             
                                                K
                                                J
                                                /
                                                2
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                α
                                                2
                                             
                                             
                                                [
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   J
                                                
                                                
                                                   
                                                      (
                                                      
                                                         z
                                                         j
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   ⊤
                                                
                                                
                                                   C
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      z
                                                      j
                                                   
                                                   −
                                                   
                                                      
                                                         μ
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                ]
                                             
                                             )
                                          
                                          d
                                          Z
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          exp
                                          
                                             (
                                             −
                                             α
                                             
                                                [
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ∑
                                                   
                                                      d
                                                      =
                                                      1
                                                   
                                                   D
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                      d
                                                   
                                                
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                   ⊤
                                                
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                −
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   J
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                   ⊤
                                                
                                                
                                                   C
                                                   j
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   j
                                                
                                                +
                                                b
                                                ]
                                             
                                             )
                                          
                                          
                                             α
                                             
                                                a
                                                −
                                                1
                                             
                                          
                                          d
                                          α
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                −
                                                
                                                   
                                                      
                                                         ∑
                                                         d
                                                      
                                                      
                                                         M
                                                         d
                                                      
                                                      
                                                         N
                                                         d
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             r
                                             
                                                
                                                   K
                                                   J
                                                
                                                2
                                             
                                          
                                          
                                             
                                                b
                                                a
                                             
                                             
                                                Γ
                                                (
                                                a
                                                )
                                             
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          
                                             
                                                |
                                                
                                                   C
                                                   j
                                                
                                                |
                                             
                                             
                                                1
                                                2
                                             
                                          
                                          ∫
                                          exp
                                          
                                             (
                                             −
                                             
                                                b
                                                ′
                                             
                                             α
                                             )
                                          
                                          
                                             α
                                             
                                                
                                                   a
                                                   ′
                                                
                                                −
                                                1
                                             
                                          
                                          d
                                          α
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                −
                                                
                                                   
                                                      
                                                         ∑
                                                         d
                                                      
                                                      
                                                         M
                                                         d
                                                      
                                                      
                                                         N
                                                         d
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             r
                                             
                                                
                                                   K
                                                   J
                                                
                                                2
                                             
                                          
                                          
                                             
                                                b
                                                a
                                             
                                             
                                                b
                                                
                                                   ′
                                                   
                                                      a
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Γ
                                                (
                                                
                                                   a
                                                   ′
                                                
                                                )
                                             
                                             
                                                Γ
                                                (
                                                a
                                                )
                                             
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          
                                             
                                                |
                                                
                                                   C
                                                   j
                                                
                                                |
                                             
                                             
                                                1
                                                2
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     In the third equation, factors related to 
                        Z
                      are grouped together. In the fourth equation, we integrated out 
                        Z
                      using

                        
                           (A.2)
                           
                              
                                 
                                    
                                       
                                          ∫
                                          exp
                                          
                                             (
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      μ
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                             C
                                             
                                                (
                                                x
                                                −
                                                
                                                   μ
                                                
                                                )
                                             
                                             )
                                          
                                          d
                                          x
                                          =
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                M
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                |
                                                C
                                                |
                                             
                                             
                                                1
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     which is the normalization constant of M-dimensional Gaussian distribution. Similarly, α is integrated out by using the following the normalization constant of Gamma distribution in the sixth equation

                        
                           (A.3)
                           
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             α
                                             
                                                a
                                                −
                                                1
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             b
                                             α
                                             )
                                          
                                          d
                                          α
                                          =
                                          
                                             
                                                Γ
                                                (
                                                a
                                                )
                                             
                                             
                                                b
                                                a
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

We give here the derivation of posteriors of α 
                     (9) and 
                        z
                     
                     
                        j
                      
                     (10).

                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          p
                                          
                                             (
                                             α
                                             |
                                             X
                                             ,
                                             S
                                             ,
                                             W
                                             ,
                                             a
                                             ,
                                             b
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          p
                                          
                                             (
                                             
                                                z
                                                j
                                             
                                             |
                                             α
                                             ,
                                             X
                                             ,
                                             S
                                             ,
                                             W
                                             ,
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       ∝
                                    
                                    
                                       
                                          p
                                          
                                             (
                                             X
                                             |
                                             α
                                             ,
                                             Z
                                             ,
                                             S
                                             ,
                                             W
                                             ,
                                             a
                                             ,
                                             b
                                             ,
                                             r
                                             )
                                          
                                          p
                                          
                                             (
                                             α
                                             |
                                             a
                                             ,
                                             b
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          p
                                          
                                             (
                                             
                                                z
                                                j
                                             
                                             |
                                             α
                                             ,
                                             r
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∏
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                                d
                                             
                                          
                                          N
                                          
                                             (
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             |
                                             
                                                W
                                                d
                                             
                                             
                                                z
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                             
                                             ,
                                             
                                                α
                                                
                                                   −
                                                   1
                                                
                                             
                                             I
                                             )
                                          
                                          G
                                          
                                             (
                                             α
                                             |
                                             a
                                             ,
                                             b
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          N
                                          
                                             (
                                             
                                                z
                                                j
                                             
                                             |
                                             
                                                0
                                             
                                             ,
                                             
                                                
                                                   (
                                                   a
                                                   r
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             I
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∏
                                             
                                                d
                                                =
                                                1
                                             
                                             D
                                          
                                          
                                             ∏
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                                d
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   α
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   M
                                                   d
                                                
                                                /
                                                2
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                α
                                                2
                                             
                                             ∥
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             −
                                             
                                                W
                                                d
                                             
                                             
                                                z
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                             
                                             
                                                ∥
                                                2
                                             
                                             )
                                          
                                          
                                             1
                                             
                                                Γ
                                                (
                                                a
                                                )
                                             
                                          
                                          
                                             b
                                             a
                                          
                                          
                                             α
                                             
                                                a
                                                −
                                                1
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             b
                                             α
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      α
                                                      r
                                                   
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                )
                                             
                                             
                                                K
                                                /
                                                2
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                
                                                   α
                                                   r
                                                
                                                2
                                             
                                             ∥
                                             
                                                z
                                                j
                                             
                                             
                                                ∥
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ∝
                                    
                                    
                                       
                                          
                                             α
                                             
                                                
                                                   a
                                                   ′
                                                
                                                −
                                                1
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                b
                                                ′
                                             
                                             α
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          
                                             
                                                |
                                                
                                                   C
                                                   j
                                                
                                                |
                                             
                                             
                                                −
                                                
                                                   1
                                                   2
                                                
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                α
                                                2
                                             
                                             
                                                
                                                   (
                                                   
                                                      z
                                                      j
                                                   
                                                   −
                                                   
                                                      
                                                         μ
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                             
                                                C
                                                j
                                             
                                             
                                                (
                                                
                                                   z
                                                   j
                                                
                                                −
                                                
                                                   
                                                      μ
                                                   
                                                   j
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ∝
                                    
                                    
                                       
                                          G
                                          
                                             (
                                             
                                                a
                                                ′
                                             
                                             ,
                                             
                                                b
                                                ′
                                             
                                             )
                                          
                                          
                                             ∏
                                             
                                                j
                                                =
                                                1
                                             
                                             J
                                          
                                          N
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                j
                                             
                                             ,
                                             
                                                α
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                C
                                                j
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where we used Bayes’ rule.

We give here the derivation of the E-step (11) for learning based on a stochastic EM algorithm.

                        
                           (C.1)
                           
                              
                                 
                                    
                                       
                                          p
                                          (
                                          
                                             s
                                             
                                                d
                                                n
                                             
                                          
                                          =
                                          j
                                          |
                                          X
                                          ,
                                          
                                             S
                                             
                                                ∖
                                                d
                                                n
                                             
                                          
                                          ,
                                          W
                                          ,
                                          a
                                          ,
                                          b
                                          ,
                                          r
                                          ,
                                          γ
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             p
                                             (
                                             
                                                s
                                                
                                                   d
                                                   n
                                                
                                             
                                             =
                                             j
                                             ,
                                             
                                                S
                                                
                                                   ∖
                                                   d
                                                   n
                                                
                                             
                                             ,
                                             X
                                             |
                                             W
                                             ,
                                             a
                                             ,
                                             b
                                             ,
                                             r
                                             ,
                                             γ
                                             )
                                          
                                          
                                             p
                                             (
                                             
                                                S
                                                
                                                   ∖
                                                   d
                                                   n
                                                
                                             
                                             ,
                                             
                                                x
                                                
                                                   d
                                                   n
                                                
                                             
                                             ,
                                             
                                                X
                                                
                                                   ∖
                                                   d
                                                   n
                                                
                                             
                                             |
                                             W
                                             ,
                                             a
                                             ,
                                             b
                                             ,
                                             r
                                             ,
                                             γ
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                =
                                                j
                                                ,
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                γ
                                                )
                                             
                                             p
                                             
                                                (
                                                X
                                                |
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                =
                                                j
                                                ,
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                ,
                                                γ
                                                )
                                             
                                          
                                          
                                             p
                                             
                                                (
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                γ
                                                )
                                             
                                             p
                                             
                                                (
                                                
                                                   X
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                ,
                                                γ
                                                )
                                             
                                             p
                                             
                                                (
                                                
                                                   x
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ∝
                                    
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                =
                                                j
                                                ,
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                γ
                                                )
                                             
                                             
                                                p
                                                (
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                γ
                                                )
                                             
                                          
                                          ·
                                          
                                             
                                                p
                                                (
                                                X
                                                |
                                                
                                                   s
                                                   
                                                      d
                                                      n
                                                   
                                                
                                                =
                                                j
                                                ,
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                )
                                             
                                             
                                                p
                                                (
                                                
                                                   X
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                |
                                                
                                                   S
                                                   
                                                      ∖
                                                      d
                                                      n
                                                   
                                                
                                                ,
                                                W
                                                ,
                                                a
                                                ,
                                                b
                                                ,
                                                r
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where p(
                        x
                     
                     
                        dn
                     |
                        W
                     , a, b, r) does not depend on 
                        
                           p
                           (
                           
                              s
                              
                                 d
                                 n
                              
                           
                           =
                           j
                           |
                           X
                           ,
                           
                              S
                              
                                 ∖
                                 d
                                 n
                              
                           
                           ,
                           W
                           ,
                           a
                           ,
                           b
                           ,
                           r
                           ,
                           γ
                           )
                        
                     .

@&#REFERENCES@&#

