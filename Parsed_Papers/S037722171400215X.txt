@&#MAIN-TITLE@&#The Quintile Share Ratio in location analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The European Union is using the “Quintile Share Ratio” (QSR) as a measure of equity.


                        
                        
                           
                           We find the location of one facility that minimizes the QSR of service distances.


                        
                        
                           
                           The solutions to the QSR objective are similar to those of the Gini index objective.


                        
                        
                           
                           Problems with 100,000 demand points were optimally solved in about half a minute.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quintile Share Ratio

Facility location

Equity

Global optimization

@&#ABSTRACT@&#


               
               
                  The inequality measure “Quintile Share Ratio” (QSR or sometimes S80/S20) is the primary income inequality measure in the European Union’s set of indicators on social cohesion. An important reason for its adoption as a leading indicator is its simplicity. The Quintile Share Ratio is “The ratio of total income received by the 20% of the population with the highest income (top quintile) to that received by the 20% of the population with the lowest income (lowest quintile)”. The QSR concept is used in this paper in the context of obnoxious facility location where the inequality is in distances to the obnoxious facility. The single facility location problem minimizing the QSR is investigated. The problem is investigated for continuous uniform demand in an area such as a disk, a rectangle, and a line; when demand is generated at a finite set of demand points; and when the facility can be located anywhere on a network. Optimal solution algorithms are devised for demand originating at a finite set of demand points and at nodes of the network. Computational experiments demonstrate the effectiveness of the algorithms.
               
            

@&#INTRODUCTION@&#

Typical location objectives are concerned with minimizing cost or maximizing efficiency of service. For example, the p-median objective minimizes the average service distance; the p-center objective minimizes the maximum service distance; the p-max-cover objective maximizes the number of customers served within a given distance. For a review of these problems see Current, Daskin, and Schilling (2002) and Daskin (1995). The objective of obnoxious facilities location models (Church & Garfinkel, 1978; Hansen, Peeters, & Thisse, 1981) is to locate a facility far from demand points. Facilities such as airports, prisons, nuclear power plants, dump sites, polluting plants and others are “obnoxious” and thus should be located away from population centers but should be close enough to provide the service or accommodate workers and visitors.

Many location models employ equity objectives (Berman, 1990; Berman & Kaplan, 1990; Hay, 1995; Lopez-De-Los-Mozos, Mesa, & Puerto, 2008; Mandell, 1991; Ogryczak, 2009; Ogryczak & Zawadzki, 2002). Equitable distance to service providers, equitable burden or nuisance imposed, etc. In the context of facility location the objective is to equalize as much as possible the distance between demand points and a facility that serves them. Maimon (1986) considered the minimization of the variance of the distances in a network environment. Drezner, Thisse, and Wesolowsky (1986) analyzed the minimization of the range of distances that customers travel in the plane. This is equivalent to locating a line that minimizes the maximum vertical distance to demand points (Schöbel, 1999). Drezner and Drezner (2007) analyzed minimizing both objectives – the variance of the distances and the range of distances in the plane. A commonly used measure of income inequity is the Gini index (Gini, 1921) of the Lorenz curve (Lorenz, 1905). In the location literature minimizing the Gini Coefficient is investigated in Maimon (1988), Drezner (2004) and Drezner, Drezner, and Guyse (2009). Eiselt and Laporte (1995) list 19 equity measures used in location models. Note that all these objectives attain their minimum value when all distances are equal. For a review of equity models in location see Drezner and Drezner (2007), Eiselt and Laporte (1995), Erkut (1993), Marsh and Schilling (1994) and Mulligan (1991).

Models which assign equitable loads to facilities were investigated for discrete planar problems (Drezner & Drezner, 2006), continuous planar demand (Baron, Berman, Krass, & Wang, 2007; Suzuki & Drezner, 2009), and the network environment (Berman, Drezner, Tamir, & Wesolowsky, 2009).

In the present paper we investigate the equity objective “Quintile Share Ratio” (QSR or sometimes S80/S20) which is the primary income inequality measure in the European Union’s set of indicators on social cohesion (European Commission, 2003). An important reason for its adoption as a leading indicator is its simplicity. The Quintile Share Ratio is “The ratio of total income received by the 20% of the population with the highest income (top quintile) to that received by the 20% of the population with the lowest income (lowest quintile)” (Eurostat, 2012). Thus the definition is clear, short and readily understandable unlike the definition of other inequality measures like the Gini-Index (Drezner et al., 2009; Gini, 1921). In 2010 the QSR ranged from 3.4 for Norway and Slovenia to 7.3 for Lithuania (Eurostat, 2012).

Formally QSR is defined as follows: let 
                        
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Y
                              
                              
                                 n
                              
                           
                        
                      be independent identically distributed observations of a univariate variable on a sample of size n. In this article we assume that the sampling process is ignorable but in the context of the application of QSR as an inequality measure the sample usually is a complex survey sample and therefore special care for weighting and variance estimation must be observed (Langel & Tillé, 2011; Osier, 2009). Here we also assume that the 
                        
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                        
                      are positive. Denote by 
                        
                           
                              
                                 Y
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           ⩽
                           
                              
                                 Y
                              
                              
                                 (
                                 2
                                 )
                              
                           
                           ⩽
                           ,
                           …
                           ,
                           
                              
                                 Y
                              
                              
                                 (
                                 n
                                 )
                              
                           
                        
                      the order statistics. For any pair of probabilities p with 
                        
                           0
                           ⩽
                           p
                           <
                           0.5
                        
                      and r with 
                        
                           0
                           ⩽
                           r
                           <
                           0.5
                        
                      the quantile share ratio for p and r is defined as
                        
                           (1)
                           
                              Q
                              (
                              p
                              ,
                              r
                              )
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ⌈
                                          nr
                                          ⌉
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          n
                                          +
                                          1
                                          -
                                          ⌈
                                          nr
                                          ⌉
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ⌈
                                          np
                                          ⌉
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          ⌈
                                          np
                                          ⌉
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           ⌈
                           np
                           ⌉
                        
                      is the smallest integer majorising np and similar for 
                        
                           ⌈
                           nr
                           ⌉
                        
                     . The probabilities p and r are named for the proportion of poor and rich, respectively. The Quintile Share Ratio is 
                        
                           Q
                           (
                           p
                           ,
                           r
                           )
                        
                      for 
                        
                           p
                           =
                           r
                           =
                           0.2
                        
                     . Obviously, the division by 
                        
                           ⌈
                           np
                           ⌉
                        
                      and 
                        
                           ⌈
                           nr
                           ⌉
                        
                      cancels out if 
                        
                           p
                           =
                           r
                        
                     . Thus quantiles other than 20% and also differing quantiles for the numerator and denominator may be considered. However, for the purpose of this article we mainly use 
                        
                           p
                           =
                           r
                           =
                           0.2
                        
                     . In addition, to avoid undue influence of outliers the top quintile share may be trimmed above. No trimming is considered in this paper but the suggested methods can be extended to trimmed values. Outlier-robustness of quantile shares has been considered in Cowell and Victoria-Feser (1996) and of the Quintile Share Ratio in Hulliger and Schoch (2009).

QSR is looking at the extremes of the distribution and is not sensitive to the middle part, as for example is the Gini-Index. The dependence on the involved quantiles, which must be estimated in a first step, and the ratio form make the QSR a non-linear estimator and its statistical properties must be investigated carefully (Langel & Tillé, 2011). However, the QSR and other inequality measures have a monotonic relationship for important income distribution functions (Graf, Nedyalkova, Münnich, Seger, & Zins, 2011) and are capable of transmitting similar messages. In this paper we treat service distance the same way income is treated in wealth distribution.

In the location context the formulation is based on n demand points located at given locations in a plane, or on nodes of a network. For a given facility location X the distances vector between the demand points and the facility is 
                        
                           {
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           (
                           X
                           )
                           }
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . The sorted vector of distances is defined as 
                        
                           
                              
                                 d
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           (
                           X
                           )
                           ⩽
                           ⋯
                           ⩽
                           
                              
                                 d
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           (
                           X
                           )
                        
                     . For simplicity of presentation we develop the formulas for equal weights for all demand points. The general weight case requires a small modification of the un-weighted case and is described in Section 4.3.

In the context of obnoxious facility location a farther location is better. Therefore, demand points at large distances are “rich” and demand points close to the facility are disadvantaged and thus can be considered “poor”. Our objective is equity of nuisance to customers. Equity is usually achieved when distances are very large (see, for example the discussion in Erkut (1993) and Drezner (2004)). At far away points all the distances are about the same and the limit of the QSR ratio, as the location of the facility moves to “infinity” is one. We should therefore restrict the location of the facility to a finite set such as the convex hull of demand points or a square that encloses all demand points. The average of the top 
                        
                           r
                           %
                        
                      distances is 
                        
                           
                              
                                 1
                              
                              
                                 [
                                 nr
                                 ]
                              
                           
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 n
                                 +
                                 1
                                 -
                                 [
                                 nr
                                 ]
                              
                              
                                 n
                              
                           
                           
                              
                                 d
                              
                              
                                 (
                                 i
                                 )
                              
                           
                           (
                           X
                           )
                        
                      where 
                        
                           [
                           x
                           ]
                        
                      is the rounded integer of x. One can use the ceiling of x for the same purpose but if n is large it does not matter much. In all our experiments we selected n such that both nr and np are integer. A similar expression is formulated for the bottom 
                        
                           p
                           %
                        
                      of distances. The ratio to be minimized is:
                        
                           (2)
                           
                              Q
                              (
                              p
                              ,
                              r
                              ,
                              X
                              )
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          [
                                          nr
                                          ]
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          n
                                          +
                                          1
                                          -
                                          [
                                          nr
                                          ]
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    (
                                    X
                                    )
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          [
                                          np
                                          ]
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          [
                                          np
                                          ]
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           QSR
                           (
                           X
                           )
                        
                      is defined as 
                        
                           Q
                           (
                           0.2
                           ,
                           0.2
                           ,
                           X
                           )
                        
                     .

We investigate the location of an obnoxious facility when demand is uniformly distributed in a finite area of the plane. We analyze location in a disk, a rectangle, and a segment. The results are sensitive to the uniformity of demand. If the distribution of the demand is not uniform, different conclusions may be reached.

Consider an infinite number of demand points uniformly distributed in a disk (a circle and its interior). First suppose that a facility is located at the center of the circle. Consider a ring based on concentric circles of inner radius 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                           
                         and outer radius 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                        . By integration, the average distance from the center of the concentric circles to all demand points in the ring is
                           
                              (3)
                              
                                 
                                    
                                       2
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       3
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        The circle containing the closest 
                           
                              p
                              %
                           
                         of distances has a a radius 
                           
                              
                                 
                                    p
                                 
                              
                           
                         and thus 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                              ,
                              
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    p
                                 
                              
                           
                         leading to an average distance by (3) of 
                           
                              
                                 
                                    2
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    p
                                 
                              
                           
                        . The farthest 
                           
                              r
                              %
                           
                         demand points are in a ring with 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    1
                                    -
                                    r
                                 
                              
                              ,
                              
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           
                         leading by (3) to an average distance of
                           
                              (4)
                              
                                 
                                    
                                       2
                                       (
                                       1
                                       +
                                       
                                          
                                             1
                                             -
                                             r
                                          
                                       
                                       +
                                       1
                                       -
                                       r
                                       )
                                    
                                    
                                       3
                                       (
                                       1
                                       +
                                       
                                          
                                             1
                                             -
                                             r
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       (
                                       1
                                       -
                                       (
                                       1
                                       -
                                       r
                                       )
                                       
                                          
                                             1
                                             -
                                             r
                                          
                                       
                                       )
                                    
                                    
                                       3
                                       r
                                    
                                 
                              
                           
                        and the ratio is
                           
                              (5)
                              
                                 
                                    
                                       1
                                       -
                                       (
                                       1
                                       -
                                       r
                                       )
                                       
                                          
                                             1
                                             -
                                             r
                                          
                                       
                                    
                                    
                                       r
                                       
                                          
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        When the location X of the facility diverges to infinity, 
                           
                              
                                 
                                    lim
                                 
                                 
                                    X
                                    →
                                    ∞
                                 
                              
                              Q
                              (
                              p
                              ,
                              r
                              ,
                              X
                              )
                              =
                              1
                           
                        .

In the rest of this section we analyze 
                           
                              p
                              =
                              r
                              =
                              20
                              %
                           
                        . At the center of the circle, by (5), 
                           
                              QSR
                              (
                              0
                              )
                              =
                              5
                              
                                 
                                    5
                                 
                              
                              -
                              8
                              ≈
                              3.18
                           
                        . We calculated and plotted the graph of 
                           
                              QSR
                              (
                              X
                              )
                           
                         for X on the positive x-axis, and a demand circle of radius 1 centered at the origin. The graph is depicted in Fig. 1
                        . It is clear from the graph that the minimum QSR inside the circle is achieved at the center of the circle. It increases up to about 71% of the radius reaching a high of 4.78, dropping to 3.94 at the periphery of the circle. A ratio below 3.18 is obtained outside the circle for a distance greater than 1.21. If the location of the facility is allowed anywhere in the square bounding the circle, the optimal location is at the vertex of the square because its distance from the center of the disk is 
                           
                              
                                 
                                    2
                                 
                              
                              >
                              1.21
                           
                        .

It is interesting that QSR has a very similar shape as the Gini coefficient reported in Drezner et al. (2009). They found that when the facility is located at the center of a disk, the Gini coefficient is equal to 0.2. It increases up to about 65% of the radius of the disk and then decreases. On the periphery of the disk, the Gini coefficient is 0.2376.


                        Drezner et al. (2009) proved that when demand is uniformly distributed in a rectangle, the Gini coefficient at the center of the rectangle is the same as the Gini coefficient at its four corners. We prove the same property for 
                           
                              Q
                              (
                              p
                              ,
                              r
                              ,
                              X
                              )
                           
                        , and in particular 
                           
                              QSR
                              (
                              X
                              )
                           
                        , along the same lines of the proof in Drezner et al. (2009).
                           Theorem 1
                           
                              When demand is uniformly distributed in a rectangle, the value of 
                              
                                 
                                    Q
                                    (
                                    p
                                    ,
                                    r
                                    ,
                                    X
                                    )
                                 
                              
                              , and in particular 
                              
                                 
                                    QSR
                                    (
                                    X
                                    )
                                 
                              
                              , at the center of a rectangle is the same as at its four vertices.
                           

Consider any rectangle as the one in Fig. 2
                              . Suppose that the facility is located at the upper right corner of the rectangle and demand is uniformly distributed in the upper right quarter of the rectangle. For the moment ignore the other three small rectangles. There is a radius 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                 
                               such that a circle centered at the facility covers 
                                 
                                    p
                                    %
                                 
                               of the area of the small rectangle. This is the “poor” area. Similarly, the “rich” area is defined by a radius 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                               such that a circle centered at the facility covers 
                                 
                                    100
                                    %
                                    -
                                    r
                                    %
                                 
                               of the area, or in other words, is not covering 
                                 
                                    r
                                    %
                                 
                               of the area. The average distances to all the demand points in the “poor” area and the “rich” area is well defined. 
                                 
                                    Q
                                    (
                                    p
                                    ,
                                    r
                                    ,
                                    X
                                    )
                                 
                               for demand in the small rectangle when the facility is located at one of its corners is the ratio between the average distance to the rich and poor areas.

Suppose that all four sides of the rectangle are doubled. The ratio remains the same because all averages are doubled. This is 
                                 
                                    Q
                                    (
                                    p
                                    ,
                                    r
                                    ,
                                    X
                                    )
                                 
                               for a facility located at a corner of the large rectangle. When a facility is located at the center of the rectangle, it is located at a vertex of a small rectangle and 
                                 
                                    Q
                                    (
                                    p
                                    ,
                                    r
                                    ,
                                    X
                                    )
                                 
                               for each of the four small rectangles is the same. Since the areas covering 
                                 
                                    p
                                    %
                                 
                               and 
                                 
                                    100
                                    %
                                    -
                                    r
                                    %
                                 
                               are the same for the four small rectangles with the same shape, the ratio is exactly the same when the facility is located at the center of the rectangle.□

The surface of 
                           
                              QSR
                              (
                              X
                              )
                           
                         as a function of the facility’s location is depicted in Fig. 3
                        . It is clear from the figure (and Theorem 1) that the center of the square and the four vertices are all optimal.

This common ratio can be numerically calculated for any rectangle and in particular a square. For a unit square with a facility located at one of its corners, the radius 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                           
                         of the circle covering 20% of the area fulfils 
                           
                              π
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              /
                              4
                              =
                              0.2
                           
                         yielding 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              =
                              0.504627
                           
                        . The radius 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         covering 80% of the area satisfies
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                4
                                             
                                          
                                          -
                                          ϕ
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0.8
                              
                           
                        where 
                           
                              ϕ
                           
                         satisfies 
                           
                              cos
                              ϕ
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        . The solution to (6) is 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              =
                              1.010545
                           
                        .

The average distance which is less than 
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                           
                         is 
                           
                              
                                 
                                    2
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                           
                        . The average distance which is greater than 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         is
                           
                              (7)
                              
                                 10
                                 
                                    ∫
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    ∫
                                    
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             cos
                                             θ
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 dxd
                                 θ
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       3
                                    
                                 
                                 
                                    ∫
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      cos
                                                   
                                                   
                                                      3
                                                   
                                                
                                                θ
                                             
                                          
                                          -
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 d
                                 θ
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            sin
                                                            θ
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  cos
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            θ
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ln
                                                      
                                                         
                                                            1
                                                            +
                                                            sin
                                                            θ
                                                         
                                                         
                                                            cos
                                                            θ
                                                         
                                                      
                                                      -
                                                      θ
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                2
                                             
                                          
                                          +
                                          ln
                                          (
                                          1
                                          +
                                          
                                             
                                                2
                                             
                                          
                                          )
                                          -
                                          
                                             
                                                π
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                          -
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          -
                                          ln
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          )
                                          +
                                          2
                                          ϕ
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          -
                                          ln
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          -
                                          1.6
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The last equality follows substituting 
                           
                              ϕ
                           
                         from (6). The resulting ratio is 
                           
                              QSR
                              =
                              3.37259535
                           
                        .

We calculated this ratio for rectangles with a base of 1 and a side of 
                           
                              0
                              ⩽
                              θ
                              ⩽
                              1
                           
                        . The resulting QSR either at the center of the rectangle or at one of its vertices is plotted in Fig. 4
                        . Note that when 
                           
                              θ
                              >
                              1
                           
                        , the QSR is the same as its value for 
                           
                              1
                              /
                              θ
                           
                         because the ratio between the two dimensions of the rectangle is the same. Therefore, 
                           
                              θ
                              =
                              1
                           
                         (a square) yields the minimum value of QSR among all rectangles.

As a corollary of Theorem 1, when demand is uniformly distributed along a segment, the 
                           
                              Q
                              (
                              p
                              ,
                              r
                              ,
                              X
                              )
                           
                         is the same at the middle of the segment and at any of its endpoints. This is the limit result when the width of the rectangle converges to zero. It can be easily calculated that for a segment the ratio 
                           
                              QSR
                              (
                              X
                              )
                              =
                              9
                           
                         both at the center of a segment and at its endpoints.

The function 
                           
                              QSR
                              (
                              X
                              )
                           
                         when the facility is located in a segment [0,1] is depicted in Fig. 5
                        . As can be observed in the figure the minimum ratio is indeed 9 which is obtained either at the middle of a segment or its ends. It is interesting that when income is uniformly distributed between 0 and a given maximum value (equivalent to a facility located at one of the endpoints of a segment), the Quintile Share Ratio is equal to 9.

Consider the location of several facilities so that each demand point gets the services from the closest facility. The demand area is partitioned by the Voronoi diagram (Okabe, Boots, Sugihara, & Chiu, 2000) which partitions the plane into polygons so that all the points closest to the facility are in a polygon. Consider a rectangle with four facilities located at its four corners. Consider Fig. 2. The rectangle is partitioned to four small rectangles by the Voronoi diagram. Each facility serves the demand in a small rectangle. Therefore, QSR is the same as one facility located at a corner or the center of the square. Similarly, when four facilities are located at the centers of the small rectangles, the Voronoi diagram remains the same and QSR is the same for this case too. On a line, as a limit case of a rectangle, if two facilities are located at the endpoints of the segment or at 0.25 and 0.75, 
                           
                              QSR
                              =
                              9
                           
                         as well.

The single facility location problem seeks the location X for one facility with the objective of minimizing 
                        
                           QSR
                           (
                           X
                           )
                        
                     . In this section we propose an efficient algorithm for finding the optimal location X.

Both the numerator and the denominator of (2) can be formulated as ordered median problems (Drezner & Nickel, 2009a, 2009b; Nickel & Puerto, 2005). The algorithm developed for solving the minimization of the quotient is based on the ordered median formulation and the Big Square Small Square (BSSS) global optimization procedure (Hansen et al., 1981). The details of these methods are given below.

The single facility Ordered Median Problem (OMP) in the plane is formulated as follows: A vector of weights 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    n
                                 
                              
                           
                        , where n is the number of demand points, is given. The list of distances between demand points and the facility is sorted in a non-decreasing order defining the vector 
                           
                              
                                 
                                    d
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              (
                              X
                              )
                              ⩽
                              ⋯
                              ⩽
                              
                                 
                                    d
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              (
                              X
                              )
                           
                        . Note that the order depends on the location of the facility. The objective is to find a location for a facility that minimizes the weighted (by 
                           
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                           
                        ) sum of distances. The distance to the demand point closest to the facility is multiplied by the weight 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                           
                        , the distance to the second closest by 
                           
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                           
                        , and so on. The distance to the farthest point is multiplied by 
                           
                              
                                 
                                    λ
                                 
                                 
                                    n
                                 
                              
                           
                        :
                           
                              (8)
                              
                                 F
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 (
                                 X
                                 )
                              
                           
                        Many location problems can be formulated as an Ordered One-Median Problem by selecting appropriate 
                           
                              λ
                           
                        ’s. Simple examples include the 
                           
                              λ
                           
                         vectors:
                           
                              –
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       1
                                    
                                  for all i is minimizing the sum of distances,


                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                  while all others are equal to zero is minimizing the maximum distance,


                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       -
                                       1
                                    
                                  and 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       1
                                    
                                  while all others are equal to zero is minimizing the range of distances,


                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             (
                                             n
                                             +
                                             1
                                             )
                                             /
                                             2
                                          
                                       
                                       =
                                       1
                                    
                                  for odd n and 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                             /
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             n
                                             /
                                             2
                                             +
                                             1
                                          
                                       
                                       =
                                       0.5
                                    
                                  for even n while all others are equal to zero is minimizing the median of distances,


                                 Drezner et al. (2009) applied the OMP approach to minimize the Gini coefficient of the Lorenz curve.


                        Problem (2) is a ratio between two OMP formulations. The numerator of (2) is defined by the vector 
                           
                              λ
                              =
                              
                                 
                                    
                                       0
                                       ,
                                       0
                                       ,
                                       …
                                       ,
                                       0
                                       ,
                                       
                                          
                                             1
                                          
                                          
                                             [
                                             nr
                                             ]
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             1
                                          
                                          
                                             [
                                             nr
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                         ending with 
                           
                              [
                              nr
                              ]
                           
                         non-zero elements. The denominator is defined by the vector 
                           
                              λ
                              =
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             [
                                             np
                                             ]
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             1
                                          
                                          
                                             [
                                             np
                                             ]
                                          
                                       
                                       ,
                                       0
                                       ,
                                       …
                                       ,
                                       0
                                    
                                 
                              
                           
                         beginning with 
                           
                              [
                              np
                              ]
                           
                         non-zero elements.

It is proven in Nickel and Puerto (2005) that an ordered median function is convex if and only if 
                           
                              0
                              ⩽
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              ⋯
                              ⩽
                              
                                 
                                    λ
                                 
                                 
                                    n
                                 
                              
                           
                        . Therefore, the numerator of (2) is convex but the denominator is not. The denominator can be easily expressed as a difference between two convex functions. Following the method in Drezner and Nickel (2009a),
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                [
                                                np
                                                ]
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                1
                                             
                                             
                                                [
                                                np
                                                ]
                                             
                                          
                                          ,
                                          0
                                          ,
                                          …
                                          ,
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                [
                                                np
                                                ]
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                1
                                             
                                             
                                                [
                                                np
                                                ]
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          0
                                          ,
                                          …
                                          ,
                                          0
                                          ,
                                          
                                             
                                                1
                                             
                                             
                                                [
                                                np
                                                ]
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                1
                                             
                                             
                                                [
                                                np
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which defines a difference between two convex functions.

In conclusion, the function is:
                           
                              (9)
                              
                                 QSR
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                    
                                       
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       X
                                       )
                                       -
                                       
                                          
                                             F
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                 
                              
                           
                        where
                           
                              (10)
                              
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       [
                                       nr
                                       ]
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          n
                                          +
                                          1
                                          -
                                          [
                                          nr
                                          ]
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 (
                                 X
                                 )
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       [
                                       np
                                       ]
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 (
                                 X
                                 )
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       [
                                       np
                                       ]
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          [
                                          np
                                          ]
                                          +
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 (
                                 X
                                 )
                              
                           
                        all positive convex functions. Note that all three functions are an average of a certain proportion of the top distances.

The Big Square Small Square (BSSS) proposed by Hansen et al. (1981) and improved by Plastria (1992) is a global optimization procedure for finding optimal solutions for two dimensional optimization problems. Variations on the original approach include the Big Triangle Small Triangle (BTST) (Drezner & Suzuki, 2004) which applies triangles rather than squares and uses the Delaunay triangulation (Lee & Schachter, 1980) to generate the initial set of triangles. Schöbel and Scholz (2010) suggested the application of the same idea to higher dimensions and devised the Big Cube Small Cube (BCSC) algorithm. Berman, Drezner, and Krass (2011) suggested the Big Segment Small Segment approach for solving location problems anywhere on a network. All of these approaches are branch and bound global optimization algorithms. We opted to apply the BSSS approach because we solve the problem in a square. BTST will provide a similar performance. A relative accuracy 
                           
                              ∊
                              >
                              0
                           
                         is given.
                           
                              1.
                              The set of squares consists of a square enclosing the feasible area. The best upper bound 
                                    
                                       
                                          
                                             UB
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is the value of the objective function at the center of the square. A lower bound LB in the square is calculated.

The square with the smallest LB is selected and four small squares are constructed by two perpendicular lines through its center parallel to its sides.

For each of the small squares an upper bound UB (the value of the objective function at the center of the square) and a lower bound LB are calculated.

The best upper bound 
                                    
                                       
                                          
                                             UB
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is updated if necessary.

The big square and all squares for which 
                                    
                                       LB
                                       ⩾
                                       
                                          
                                             UB
                                          
                                          
                                             ∗
                                          
                                       
                                       (
                                       1
                                       -
                                       ∊
                                       )
                                    
                                  are discarded from the set of squares. All other squares remain or are added to the set of squares.

If the set of squares is not empty, go to step 2.

Stop with 
                                    
                                       
                                          
                                             UB
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  as the solution. 
                                    
                                       
                                          
                                             UB
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is within a relative accuracy 
                                    
                                       ∊
                                    
                                  of the optimum.

For a successful implementation of BSSS or BTST an effective lower bound in a square or a triangle is needed. An upper bound is easy to obtain. The value of the objective function at any point in a polygon, such as its center, is an upper bound for the smallest value of the objective function in the polygon. However, finding an effective lower bound to the minimum value of the objective function in a polygon (square or triangle) may not be trivial. Numerous papers suggest a variety of lower bounds. Some are general but some are tailored to a specific problem. For a review see (Drezner, 2013).

Consider a convex polygon (such as a triangle or a square) with v vertices 
                              
                                 
                                    
                                       V
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 v
                              
                            and we find a lower bound for the function 
                              
                                 QSR
                                 (
                                 X
                                 )
                              
                            
                           (9) at any point in that polygon.

Let 
                              
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                              
                            for 
                              
                                 k
                                 =
                                 1
                                 ,
                                 
                                 2
                                 ,
                                 
                                 3
                              
                            be a tangent plane to the function 
                              
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                              
                            at a point 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                              
                            in the polygon such as the center of gravity. For Euclidean distances, the tangent plane 
                              
                                 T
                                 (
                                 X
                                 )
                              
                            for 
                              
                                 ϕ
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 X
                                 )
                              
                            where demand point i is located at 
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , the tangent point is 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           , and 
                              
                                 X
                                 =
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            is
                              
                                 (13)
                                 
                                    T
                                    (
                                    X
                                    )
                                    =
                                    ϕ
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    +
                                    (
                                    x
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    +
                                    (
                                    y
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           By the convexity of 
                              
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                                 ,
                                 
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                                 ⩽
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                              
                            for all X. Therefore, by (9)
                           
                              
                                 (14)
                                 
                                    QSR
                                    (
                                    X
                                    )
                                    ⩾
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                       
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                    
                                    =
                                    H
                                    (
                                    X
                                    )
                                 
                              
                           By the convexity of 
                              
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                                 ,
                                 
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                                 ⩽
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 X
                                 )
                              
                            for 
                              
                                 k
                                 =
                                 1
                                 ,
                                 
                                 2
                                 ,
                                 
                                 3
                              
                            even when the order of distances at X is different from their order at 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                              
                           . The order of distances should be determined at 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                              
                            because the function and its derivatives are defined at that point and if the order is changed for another X the tangent plane is still bounding the function because the function is convex.

The function 
                              
                                 H
                                 (
                                 X
                                 )
                              
                            is a ratio of a concave positive function divided by a convex positive function. Such a function is known to be quasiconcave (Schaible & Ibaraki, 1983) which gets its minimum on a vertex of a polygon. Consequently, the following LB is a lower bound in the ploygon:
                              
                                 (15)
                                 
                                    LB
                                    =
                                    
                                       
                                          
                                             min
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             v
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the analysis above it is assumed, for clarity of presentation, that all demand points have equal weights. Suppose that demand point i has a weight 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        . If all weights are integer, then demand point i can be replicated 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         times at the same location. If all weights are rational, each weight can be multiplied by the common denominator of all weights obtaining an equivalent problem with integer weights.

To operationalize this observation, replication is not required. Let
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             W
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             S
                                             (
                                             X
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             k
                                             (
                                             p
                                             ,
                                             X
                                             )
                                             =
                                             
                                                max
                                             
                                             
                                                
                                                   
                                                      k
                                                      |
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                      ⩽
                                                      pW
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             W
                                             (
                                             p
                                             ,
                                             X
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      k
                                                      (
                                                      p
                                                      ,
                                                      X
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             S
                                             (
                                             p
                                             ,
                                             X
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      k
                                                      (
                                                      p
                                                      ,
                                                      X
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        Then, the average distance of the bottom p% 
                           
                              
                                 
                                    1
                                 
                                 
                                    [
                                    np
                                    ]
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    [
                                    np
                                    ]
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                              (
                              X
                              )
                           
                         in (2) is replaced by
                           
                              (16)
                              
                                 A
                                 (
                                 p
                                 ,
                                 X
                                 )
                                 =
                                 
                                    
                                       S
                                       (
                                       p
                                       ,
                                       X
                                       )
                                       +
                                       (
                                       pW
                                       -
                                       W
                                       (
                                       p
                                       ,
                                       X
                                       )
                                       )
                                       
                                          
                                             d
                                          
                                          
                                             k
                                             (
                                             p
                                             ,
                                             X
                                             )
                                             +
                                             1
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                    
                                       pW
                                    
                                 
                              
                           
                        and the top r% (the numerator of (2)) is replaced by
                           
                              (17)
                              
                                 
                                    
                                       S
                                       (
                                       X
                                       )
                                       -
                                       A
                                       (
                                       1
                                       -
                                       r
                                       ,
                                       X
                                       )
                                    
                                    
                                       rW
                                    
                                 
                              
                           
                        The same “replacement” formulas are used in the rest of the analysis.

Demand points are nodes on the network. The distance between two points on the network is the shortest path connecting the two points. If the location of the facility is restricted to nodes, the solution is the minimum value of the objective function on all nodes. If the facility can be located anywhere on the network, a solution can be found by the “Big Segment Small Segment” algorithm (also termed BSSS) (Berman et al., 2011). We outline the big segment small segment algorithm. For complete details the reader is referred to Berman et al. (2011).

The algorithm is similar to the big square small square algorithm detailed in Section 4.2. Segments on links of the network are used rather than squares in the plane. The initial set of segments consists of all the links of the network. Segments are split into two small segments similar to splitting the big square into four small squares. For each segment (a link or part of a link) upper and lower bounds need to be established. An upper bound is the value of the objective function at any point of the segment. We used the value of the objective function at the center of the segment. The lower bound in a segment is calculated as follows.

Consider a segment 
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                         of length s on a link. Let the distance between node i and the ends of the segment be 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              (
                              a
                              )
                           
                         and 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              (
                              b
                              )
                           
                        . The distance function to the points of the segment is a concave function. The minimum distance between node i and all the points in 
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                         is
                           
                              (18)
                              
                                 
                                    
                                       d
                                    
                                    
                                       min
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    min
                                 
                                 {
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 a
                                 )
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 b
                                 )
                                 }
                              
                           
                        The maximum possible distance between node i and all the points in 
                           
                              [
                              a
                              ,
                              b
                              ]
                           
                         is (Minieka, 1983):
                           
                              (19)
                              
                                 
                                    
                                       d
                                    
                                    
                                       max
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 a
                                 )
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 b
                                 )
                                 +
                                 s
                                 ]
                              
                           
                        
                     

Both vectors 
                           
                              
                                 
                                    d
                                 
                                 
                                    min
                                 
                              
                              (
                              i
                              )
                           
                         and 
                           
                              
                                 
                                    d
                                 
                                 
                                    max
                                 
                              
                              (
                              i
                              )
                           
                         for all nodes are sorted. The average of the top 
                           
                              r
                              %
                           
                         of the 
                           
                              
                                 
                                    d
                                 
                                 
                                    min
                                 
                              
                              (
                              i
                              )
                           
                         distances and the average of the bottom 
                           
                              p
                              %
                           
                         of the 
                           
                              
                                 
                                    d
                                 
                                 
                                    max
                                 
                              
                              (
                              i
                              )
                           
                         distances are calculated. The ratio of these averages is a lower bound.

Programs in Fortran using double precision arithmetic were coded, compiled by Intel 11.1 Fortran Compiler with no parallel processing and run on a desktop with the Intel 870/i7 2.93gigahertz CPU Quad processor and 8gigabyte RAM. Only one thread was used. In all experiments we used 
                        
                           p
                           =
                           r
                           =
                           20
                           %
                        
                      and equal weights. A relative accuracy of 
                        
                           ∊
                           =
                           
                              
                                 10
                              
                              
                                 -
                                 10
                              
                           
                        
                      was used for solving planar problems and 
                        
                           ∊
                           =
                           
                              
                                 10
                              
                              
                                 -
                                 6
                              
                           
                        
                      was used for solving the network problems.

Twenty-eight values of 
                           
                              100
                              ⩽
                              n
                              ⩽
                              100
                              ,
                              000
                           
                         were used. All values are multiples of 5 and thus np and nr are integers. For each n, ten randomly generated sets of demand points uniformly located in a unit square were generated. Since the lower bound was constructed for any values of p and r, we expect to obtain the same performance of the algorithm for other values of p and r. The facility can be located anywhere in the square. A relative accuracy of 
                           
                              ∊
                              =
                              
                                 
                                    10
                                 
                                 
                                    -
                                    10
                                 
                              
                           
                         was used. In Table 1
                         the complete results for ten 
                           
                              n
                              =
                              100
                              ,
                              000
                           
                         problems are reported. We list the number of iterations, the maximum number of squares throughout the process, the optimal value of the objective function, the solution point, and the run time in seconds. The run time is approximately proportional to the number of iterations.

In Table 2
                         we report the data concerning the efficiency of the algorithm. As is demonstrated in Table 2 the algorithm is very efficient. The largest problem consisting of 100,000 demand points was solved in an average run time of about half a minute. The number of iterations and the maximum number of squares in the set of squares throughout the procedure are very reasonable.

Note that we applied a relative accuracy of 
                           
                              ∊
                              =
                              
                                 
                                    10
                                 
                                 
                                    -
                                    10
                                 
                              
                           
                        . If a more relaxed accuracy, for example 
                           
                              ∊
                              =
                              
                                 
                                    10
                                 
                                 
                                    -
                                    5
                                 
                              
                           
                         which may be sufficient for practical purposes, is used, the number of iterations, the maximum number of squares, and consequently run times are even better.

In Table 3
                         we report the characteristics of the solutions. We report the minimum, average, and maximum value of the objective function for all ten runs for each value of n. We also counted the number of times (out of 10) in which the solution was close to a vertex of the square, near its center, or elsewhere. A solution is considered near a vertex when it is located in a small square of dimensions 0.1 by 0.1 near the vertex such as 
                           
                              x
                              ⩾
                              0.9
                              ,
                              
                              y
                              ⩾
                              0.9
                           
                        . In our experiments the solution was always exactly on a vertex when this condition held. See also Table 1. It is considered near the “center” when it is located in the square 
                           
                              0.4
                              ⩽
                              x
                              ⩽
                              0.6
                              ,
                              
                              0.4
                              ⩽
                              y
                              ⩽
                              0.6
                           
                        . 92% of the area of the square is considered “other”.

By examining Table 3 we observe that only in one case out of 280 problems the solution was not near the center or a vertex. The vast majority of solution points are near a vertex. Since there are five optimal locations for uniform demand, we expect that about 20% of the optimal locations are near the center of the square which is consistent with the observed distribution in Table 3. The optimal value of the objective function, especially for larger values of n, is quite close to the continuous demand value of 3.3726. In three cases out of 280 problems the optimum slightly exceeded this value because the actual distribution of demand points is not sufficiently uniform.

In order to enable easy replication of the test problems for future comparisons, we selected the 40 Beasley (1990) problems that were designed for experiments with p-median algorithms and used equal weights. We did not use the value of p for these problems. The problems ranged between 100 and 900 nodes. The number of links in the files is 
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              /
                              50
                           
                        . However, there are instances that the same link is present more than once in the data. In such cases the last length of the link is recorded.

The values of the objective function and performance details of the big segment small segment algorithm are presented in Table 4
                        . For each problem we list the number of nodes, the number of links, the optimal solution on nodes, the optimal solution anywhere on the network, the number of iterations, the maximum number of segments observed in the branch and bound phase, and the run time in seconds. The run times for finding the optimal solution on nodes is not reported because the largest problem was solved in 0.1seconds. The optimal solution anywhere on the network was found in about two minutes for the largest problem.

@&#CONCLUSIONS@&#

The European Union is using the “Quintile Share Ratio” (QSR) as a measure of equity. When the goal is to obtain equity of nuisance by an obnoxious facility, QSR is the ratio between the average of the largest 
                        
                           20
                           %
                        
                      distances and the average of the shortest 
                        
                           20
                           %
                        
                      distances. We formulate the objective in a more general form of the top 
                        
                           r
                           %
                        
                      and the bottom 
                        
                           p
                           %
                        
                     . The problem investigated in this paper is finding the location of one obnoxious facility that minimizes the QSR of nuisance distances. The location of the facility must be restricted to a specific area. Otherwise, the solution is at infinity with 
                        
                           QSR
                           (
                           X
                           )
                           =
                           1
                        
                     . This is the most equitable solution but all customers get unacceptable service.

The problem of demand being uniformly distributed in an area and the solution restricted to that area is analyzed. When demand is distributed in a disk, the optimal solution is at its center. When demand is uniformly distributed in a rectangle, the value of the objective function on any of the vertices is equal to its value at the center of the rectangle. Demand distributed along a segment is a limit of a rectangle whose shorter side approaches zero. Therefore, the value of the objective function at the center of a segment is equal to its value at its endpoints. It is interesting that the solutions to the QSR objective are very similar to those that are obtained for the Gini index objective analyzed in Drezner et al. (2009).

We constructed very efficient algorithms for solving the single facility problem when demand is generated at a finite set of demand points. Planar problems with up to 100,000 demand points generated in a square were optimally solved in about half a minute. In almost all problems solved (279 out of 280) the solution was either close to the center of the square or at one of its vertices confirming the result for uniform demand in a rectangle.

Network problems with up to 900 nodes and about 16,000 links were optimally solved for a location anywhere on the network. The largest problem was solved in about two minutes. Finding the optimal solution on nodes is very fast but the solution anywhere on the network is significantly better. There is a significant improvement in the QSR value when the facility can be located anywhere on the network compared to restricting the location to nodes. The improvement ranged between 0.33% and 19.10%. The solution on nodes is feasible for the solution anywhere on the network. However, when a facility is located on a node one of the distances is zero which tends to decrease the denominator of the QSR.

@&#ACKNOWLEDGMENT@&#

We would like to thank the referees for very insightful and constructive comments that significantly improved the paper.

@&#REFERENCES@&#

