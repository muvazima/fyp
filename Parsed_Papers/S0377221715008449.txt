@&#MAIN-TITLE@&#A GLNPSO for multi-level capacitated lot-sizing and scheduling problem in the poultry industry

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a multi-level capacitated lot-sizing problem in egg production industry.


                        
                        
                           
                           An improved hybrid GLNPSO with the local search procedure has been developed.


                        
                        
                           
                           Re-initialization and Re-order strategies were developed to improve the solutions.


                        
                        
                           
                           This approach is evaluated in instances from real data.


                        
                        
                           
                           Analysis of results indicates that the proposed approach is efficient and effective.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Metaheuristics

Multi-level capacitated lot-sizing

Hen egg production

Particle swarm optimization

Local search

@&#ABSTRACT@&#


               
               
                  This paper presents a computation tool for the multi-level capacitated lot-sizing and scheduling problem in hen egg production planning with the aim of minimizing the total cost. A mixed-integer programming model was developed to solve small-size problems. For large-size problems, particle swarm optimization (PSO) was firstly applied. However, the component of traditional PSO for social learning behavior includes only personal and global best positions. Therefore, a variant of PSO such as the particle swarm optimization with combined gbest, lbest and nbest social structures (GLNPSO) which considers multiple social learning terms was proposed. The local search procedure was applied to decide the new sequence of chick and pullet allocation to rapidly converge to a better solution. Moreover, the re-initialization and the re-order strategy were used to improve the possibility of finding an optimal solution in the search space. To test the performance of the algorithm, the two criteria used to measure and evaluate the effectiveness of the proposed algorithm were the performance of the heuristic algorithm (P) obtained by comparing their solutions to optimal solutions, and the relative improvement of the solution (RI) obtained by the firm's current practice with respect to those of traditional PSO and the GLNPSO algorithms. The results demonstrate that the GLNPSO is not only useful for reducing cost compared to the traditional PSO, but also for efficient management of the poultry production system. Furthermore, the method used in this research should prove beneficial to other similar agro-food industries in Thailand and around the world.
               
            

@&#INTRODUCTION@&#

In the egg industry, egg production planning is considered a crucial activity because it may affect production costs. Since egg production planning concerns not only the number of chicks required over a period of time, but also how to allocate chicks to replace birds with diminishing laying capacity, egg production requires efficient planning for minimizing costs in order to maximize profit generation while meeting the customer demand. Moreover, egg production is considered a dynamic system leading to complex production, especially the chick ordering and the decision of how to allocate flocks to facilities. Allocation of flocks to facilities in the current period may affect the efficiency of allocation of the flocks in the next period. The main challenges for the firms when determining the lot size of chicks and allocating them to houses are due to the following production complexities, (1) The egg industry is a hierarchical multi-level production starting from purchasing chicks from a hatchery on a weekly basis and delivering them to the pullet-raising farms where the chicks stay until they are 17 weeks old, then transferring pullets to egg laying units (hen houses) where they are fed to have sufficient body weight to support egg production, and remain there until the age of 75 weeks. Once the hens are no longer valuable as layers, they are moved to be slaughtered at the firm's slaughter house. Hence, the number of chicks required depends on the customer demand (i.e. eggs), pullets on hand, layers on hand, egg production rate of hens and survival rate of both hens and pullets. Chick ordering is considered as medium term planning with hens to be determined before allocating pullets to hen houses (see Fig. 1
                     ). (2) There are numerous houses with limited and heterogeneous capacities. Due to an imbalance between the flow-in flocks and the capacity of the facilities, this challenges the firm attempting to allocate flocks to the facility as fully as possible, because a facility with partial fill of pullets or hens may lead to high production costs. Hence, the capacitated lot sizing problem is very important in managing chick ordering and considered as short term planning (see Fig. 2
                     ). (3) Even though the number of chicks required depends on the crucial factors mentioned earlier, the maximum ordering quantity of chicks must not exceed the maximum daily capacity of the firm's slaughter house. Thus, an egg industry should have an efficient method to make a balance between the customers’ demand and the decision of how many chicks to purchase and deliver to the industry in each time period, while the maximum number of chickens ordered in each period is restricted. However, it can be difficult and complex to combine lot sizing and scheduling problems as they are interdependent. As a result, they are often modeled and solved independently, which may lead to not obtaining globally optimal solutions (Mahdieh, Bijari, & Clark, 2011).

This paper therefore focuses on the multi-level capacitated lot sizing and scheduling problem for egg production with a restriction of the maximum lot size at each time. The objective of this research is to minimize the total costs consisting of chick ordering cost, feed cost of pullets and hens, farm utilization cost, egg storage cost, hen transportation cost from pullet houses to hen houses, and demand shortage costs. To solve the problem, interrelationships existing between the chick ordering level and chick allocation to house level are considered and taken in the model simultaneously in order to obtain globally optimal solutions. An efficient mixed integer programming model was developed for small-size problems. Since the problem considered is an NP-hard problem, the computational effort, in general, required to find an optimal solution grows exponentially with the size of the problem. In an effort to find a near optimal solution for problems with larger, more practical problems, a meta-heuristic was developed. A well-known meta-heuristic called Particle Swarm Optimization (PSO) is brought to develop an efficient algorithm.

PSO is a population based search method which was motivated by group organism behavior such as bee swarms, fish schools, and bird flocks (Kennedy & Eberhart, 1995). It imitates the physical movements of the individuals in the swarm as a search method, altogether with its cognitive and social behavior local and global exploration abilities. Hence, in this paper, the PSO algorithm is firstly applied for the purpose. However, the component of traditional PSO for social learning behavior includes only personal and global best positions. Therefore, a variant of PSO such the particle swarm optimization with combined gbest, lbest and nbest social structures (GLNPSO) developed by Pongchairerks and Kachitvichyanukul (2005, 2006) was proposed in this paper which considers multiple social learning terms including personal, global, local, and near neighbor best positions. The local search procedure is applied to decide the new sequence of chicks and hens allocated in each time period to rapidly converge to the better solution. In order to avoid being trapped into a local optimum, the re-initialization and the re-order strategy are used to improve the possibility of finding an optimal solution in the searching space. To illustrate the proposed method effectiveness, numerical experimental results were compared with the mathematical model, the current practice of the egg industry selected as a case study and also with the traditional PSO. In the next section, related literature is reviewed. In Section 3, we present the hen egg production formulation. In Section 4, we provide a comprehensive detail of our solution procedures. In Section 5, the case study application and an outline of experimental results are presented. Finally, a summary of the main findings is given in Section 6.

@&#LITERATURE REVIEW@&#

Multi-level production lot sizing and scheduling are the most important tasks to fulfill in a manufacturing system, because they have a strong impact on its performance and productivity in terms of operating costs, machine utilization, and customer service quality. A manufacturer must make decisions about these two problems hierarchically and integrally. Due to their dependency, this problem is also called the general lot-sizing and scheduling problem (GLSP), which considers lot-sizing and scheduling simultaneously. Generally, the lot-sizing model is first determined (Karimi, Fatemi Ghomi, & Wilson, 2003; Toledo & Armentano, 2006; Ramezanian, Saidi-Mehrabad, & Fattahi, 2013), then the output from this model will be an input to incorporate the sequences of lots, which involves the determination of when each lot is produced on which machine or production resource. The multi-level lot-sizing and scheduling problems can be very complex and difficult tasks depending on the precedence constraints which have to be satisfied and on the multi-level structure (Toledo, de Oliveira, & Franca, 2013). Generally, they are classified as NP-hard optimization problems (Stockmeyer & Meyer, 2002).

The reviews of Drexl and Kimms (1997), Jans and Degraeve (2008), and Clark, Almada-Lobo, and Almeder (2011) show that the field of lot sizing and scheduling has caught the attention of researchers in order to solve real world problems. Historically, the economic order quantity (EOQ) is well known and popularly applied to determine lot-sizing that balances the setup cost and the inventory holding cost (Harris, 1913; Wilson, 1934). A few decades later, Wagner and Whitin (1958) presented a dynamic programming algorithm for the single-item uncapacitated lot-sizing problem, which provides its optimal solution. More recent work by van Hoesel and Wagelmans (2001) provided a theoretical underpinning for fully polynomial approximation schemes for single-item capacitated economic lot sizing problems. Since industrial development and economic growth has produced more complex situations, traditional methods are cumbersome, and do not readily adapt to changes in demand, resource capacity or material availability, resulting in the need for simultaneous lot sizing and scheduling decisions. However, concurrent decision making in the lot sizing and scheduling (machine sequencing) solution is difficult and complex, so these decisions were separately made in a sequential manner: (1) estimate the available capacity for processing a set of items over required machines in the following periods, (2) determine lot sizes of different items for forthcoming planning periods, (3) determine the best schedule of machines to perform different processes on each items, regarding their lot sizes, and (4) check if the obtained production schedule is feasible in terms of required capacities; if not lead to a number of recursive corrective actions (Karimi-Nasab & Seyedhoseini, 2013). Most authors proposed algorithms and approaches for solving the lot sizing and scheduling problems separately. In previous research, various solution techniques have been applied to determine the quantity to be produced in different periods of the capacitated multistage lot-sizing problem to respond to the initially given demand forecast, while the scheduling involving the assignment of multiple tasks onto each machine was not considered (Berretta & Rodrigues, 2004; Xiao, Zhang, Zhao, Kaku, & Xu, 2014) leading to non-optimality of the above procedure due to non-simultaneity of decision making (Franck, Neumann, & Schwindt, 1997).

Branches of industry in which lot sizing and scheduling solutions should be taken concurrently are such as chemicals, drugs and pharmaceuticals, pulp and paper, textiles, foundries, glass containers, and food and beverage, along with many others (Clark, Almada-Lobo, & Almeder, 2011). In particular, agri-food production is one of the most dynamic and complex operations in most industries. The challenging task in today's food industry is that the decision-makers (agriculturist, planner of industry, or third party logistic service, etc.) often face a complex production planning problem for the allocation of scarce resources over time between competing activities to meet these requirements in an efficient manner (Kopanos, Puigjaner, & Georgiadis, 2011). The agri-foods production planning problems involve the determination of production lot sizes and the sequence of products on the capacitated machine (Guimarães, Klabjan, & Almada-Lobo, 2013) with the uncertain situations such as shelf-life and deterioration constraints of food and agricultural products, including increasing consumer attention about safety. Because of these dynamic and complex features, most lot sizing and scheduling problems in agri-food production planning are hard to solve, therefore the literature in the field of production scheduling and planning of food processing industries is a rather sparse (Kopanos, Puigjaner, Georgiadis, & Bongers, 2011). Most authors have applied mixed integer programming (MIP) for the scheduling and planning problems in agri-food processing such as dairy and yogurt (Kopanos, Puigjaner, & Georgiadis, 2010), an aggregate production planning in the sugar (da Silva, Marins, & Montevechi, 2013), shrimp farming (Yu, Leung, & Bienfang, 2006) or the meat production industry (Gribkovskaia, Gullberg, Hovden, & Wallace, 2006). The aforementioned research has not previously studied the optimal approaches for production planning and scheduling in the poultry and egg industry.

However, proofs from complexity theory as well as computational experiments indicate that the MIP formulations of most lot sizing problems, especially in the case of simultaneous consideration, are hard to solve in reasonable time for medium or large size problems (Jans & Degraeve, 2007; Pochet & Wolsey, 2006). Attempting to fill this gap, therefore, various solution techniques have been proposed to solve them. In the past decade, meta-heuristics have become popular and efficient tools for solving hard combinatorial optimization problems (Jans & Degraeve, 2007). Recently there has been significant research effort to apply evolutionary computation (EC) techniques for lot sizing and scheduling problems. For example, Toledo, da Silva Arantes, de Oliveira, and Almada-Lobo (2013) proposed a new hybrid evolutionary algorithm combining a multi-population hierarchically structured genetic algorithm (GA) with simulated annealing (SA), and a tailor-made heuristic named cavity heuristic (CH) to tackle the short-term production planning and scheduling problems. The hybrid evolutionary method presents a promising performance outperforming literature results. Recently, Seeanner, Almada-Lobo, and Meyr (2013) presented a new idea to solve the kind of problems that typically arise in the consumer goods industry due to sequence-dependent setups and shifting bottlenecks. The variable neighborhood decomposition search (VNDS) with the MIP-based Fix & Optimize heuristic is cross-fertilized. The heuristic provides very good solutions for a real-world problem instance and were significantly better for most of the problem instances when compared to the Xpress MIP Solver. For a real-world production problem such as soft drink production, a synchronized and integrated two-level lot sizing and scheduling problem must be considered. Therefore, as presented in Toledo, de Oliveira, de Freitas Pereira, França, and Morabito (2014), a genetic algorithm embedded with mathematical programming techniques was applied. The computational results show that this evolutionary/mathematical programming approach outperforms the literature methods in terms of production costs and computational times when applied to a set of real-world problem instances provided by a soft drink company.

Particle Swarm Optimization (PSO) is one of the most powerful and interesting methods (Dye & Hsieh, 2010; Dye & Ouyang, 2011; Nearchou, 2011; Tasgetiren, Liang, Sevkli, & Gencyilmaz, 2007). PSO was first proposed by Kennedy and Eberhart in 1995 (Kennedy & Eberhart, 1995) and involves applying logic inspired by social behavior of bird flocking or fish schooling. It is a population based stochastic optimization technique which shares many similarities with evolutionary computation techniques such as GA. The random solutions are initialized with a population called particles and fly through the problem space to search for optima by updating generations. Compared to other evolutionary computation techniques such as GA, the advantages of PSO are that PSO is easy to implement and there are few parameters to adjust. However, the traditional PSO has problems of easily falling into local solutions, slow convergence speed and low convergence accuracy, especially for NP-hard problems (Song, Kong, Gan, & Su, 2008). Therefore, since its first publication, a large amount of research has been done to study performance and improve it (Clerc, 2006; Kennedy, Eberhart, & Shi, 2001). Additionally, how to improve the global convergence ability has been the main research scope. In order to enhance its performance and alleviate the deficiencies to the problem solving, many variants of the PSO algorithm have been proposed (Pratchayaborirak & Kachitvichyanukul, 2007; Shi & Eberhart, 1998; Veeramachaneni, Peram, Mohan, & Osadciw, 2003; Wang & Yeh, 2014). One of the powerful and interesting methods among the many variants of the PSO algorithm is particle swarm optimization combined with gbest, lbest and nbest social structures (GLNPSO). It is effective since it enables the swarm to explore different parts of the search spaces simultaneously (see, Pongchairerks & Kachitvichyanukul, 2005, 2006).

Moreover, experimental results reveal that the hybrids of PSO can effectively produce improved solutions over traditional methods with faster convergence, such as GA, ant colony system (ACS), and Tabu Search. In addition, local search techniques are often used to improve the current solution by moving repeatedly from the current solution to find good solutions in reasonable time. In recent years, it is observed from the literature that meta-heuristics hybridized with a local search procedure often give the best searching results (Lin, Hsu, & Hsu, 2013; Yu, Lin, Lee, & Ting, 2010). Therefore, a hybrid approach based on a variant of the particle swarm optimization, called GLNPSO with the local search procedure is proposed in this paper.

A brief description of the problem is reviewed in order to help in understanding the mathematical formulation. The problem involves the multi-level capacitated lot sizing and scheduling problem for egg production with a restriction on the maximum lot size at each time. Presently, the weekly chicks order volumes from hatcheries depend on egg demand volumes in the planning horizon. Then the chicks are transferred to the contracted pullet-raising farms. When the pullets are K weeks old, they are moved to hen houses. These hens will remain in the hen house until the age of 
                           
                              K
                              +
                              R
                           
                         weeks for egg production. After that, they are slaughtered at the firm's slaughter house (see Fig. 3
                        ). Hence, the number of chicks required depends on the egg demand, pullets on hand, layers on hand, egg production rate of hens, the sizes (capacities) of pullet and hen houses available, each of which normally ranges from small to large, and the capacity of the slaughter houses. To allocate chicken to pullet houses and hen houses, however, the maximum ordering quantity of chicks must not exceed the maximum daily capacity of the firm's slaughter house. This section presents a 0–1 mixed integer programming model with the objective of minimizing the total costs consisting of chick ordering cost, feed cost of pullets and hens, farm utilization cost, egg storage cost, hens transportation cost from pullet houses to hen houses, and demand shortage costs. The model is presented below with a brief explanation of each constraint.

A mixed integer programming formulation was developed as follows: in the problem there are I pullet houses, J hen houses and the planning horizon is finite and consists of T time periods. The egg demand for each time period is known in each time period and satisfied at the beginning of the period. The ordering of chicks will be made in terms of batches and must not exceed the total capacity of slaughterhouses. To allocate chicks and hens, the mixing of flocks at different ages in the same facility is not allowed. The chicks are transferred to pullet-raising farms where they stay until they reach a certain age (K weeks of age). These pullets are then moved to hen houses, and will remain in the laying unit (i.e. hen house) until a certain age (
                           
                              K
                              +
                              R
                           
                         weeks of age). Once the pullets or hens are moved out from the houses, the houses are cleaned in order to be free from infections for CP
                         and CH
                         weeks, respectively. During this cleaning stage, no chicks or hens can be placed in the farm. Parameters and decision variables used in formulating the model are defined in the following.


                        
                           Indices


                           
                              i
                           
                           
                              index for pullet house; i = 1,2,…,I
                              

index for hen house; j = 1,2,…,J
                              

index for pullet age; k = 1,2,…,K
                              

index for hen age; r = 1,2,…,R
                              

index for time period; t = 1,2,…,T
                              

demand for eggs at each time period t
                              

capacity of pullet house i
                              

capacity of hen house j
                              

production rate of eggs becoming laying hens at age r
                              

distance from pullet house i to hen house j
                              

number of pullets on hand in pullet house i aged k at the starting period

number of layers on hand transferred from pullet house i to hen house j aged r at the starting period

initial number of eggs stored at the starting period

total capacity of slaughterhouse

number of chicks per lot size

cleaning time of pullet house after moving pullets to laying hen houses

cleaning time of hen house after moving hens to slaughterhouse

cost of chick ordering

transportation cost

cost of egg storage

feed cost per unit time per pullet

feed cost per unit time per hen

cost of pullet farm utilization

cost of hen farm utilization

cost of loss from inability to respond to demand

big number

number of quantity (lot) of chick ordered at time period t
                              

number of eggs stored at time period t
                              

number of eggs lost that cannot satisfy demands at time period t
                              

number of pullets in pullet house i aged k at time period t
                              

number of hens transferred from pullet house i to hen house j aged r at time period t
                              

= 1, representing chicks were ordered at time period t. Otherwise 0

= 1, representing chicks were allocated to the pullet house i at time period t. Otherwise 0

= 1, representing hens were allocated to the hen house j at time period t. Otherwise 0

= 1, representing pullet house i has pullets aged k at time period t. Otherwise 0

= 1, representing hen house j has hens aged r at time period t. Otherwise 0

By using the notation above, the mathematical formulation for multi-level production lot sizing and scheduling problem to solve the hen egg production planning is presented as follows:


                        Objective function
                        
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             Minimize
                                             
                                             Z
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                t
                                                T
                                             
                                             
                                                O
                                                
                                                   D
                                                   t
                                                
                                                ×
                                                A
                                             
                                             
                                             +
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   i
                                                   I
                                                
                                                
                                                   
                                                      ∑
                                                      k
                                                      K
                                                   
                                                   
                                                      
                                                         ∑
                                                         t
                                                         T
                                                      
                                                      
                                                         
                                                            Q
                                                            
                                                               
                                                                  
                                                                  
                                                                     i
                                                                     ,
                                                                     k
                                                                     ,
                                                                     t
                                                                  
                                                               
                                                            
                                                            P
                                                         
                                                         ×
                                                         
                                                            F
                                                            P
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                i
                                                I
                                             
                                             
                                                
                                                   ∑
                                                   j
                                                   J
                                                
                                                
                                                   
                                                      ∑
                                                      r
                                                      R
                                                   
                                                   
                                                      
                                                         ∑
                                                         t
                                                         T
                                                      
                                                      
                                                         
                                                            Q
                                                            
                                                               
                                                                  
                                                                  
                                                                     i
                                                                     ,
                                                                     j
                                                                     ,
                                                                     r
                                                                     ,
                                                                     t
                                                                  
                                                               
                                                            
                                                            H
                                                         
                                                         ×
                                                         
                                                            F
                                                            H
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      i
                                                      I
                                                   
                                                   
                                                      
                                                         ∑
                                                         t
                                                         T
                                                      
                                                      
                                                         A
                                                         
                                                            C
                                                            
                                                               i
                                                               ,
                                                               t
                                                            
                                                            P
                                                         
                                                         ×
                                                         
                                                            O
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                   +
                                                   
                                                   
                                                      ∑
                                                      j
                                                      J
                                                   
                                                   
                                                      
                                                         ∑
                                                         t
                                                         T
                                                      
                                                      
                                                         A
                                                         
                                                            C
                                                            
                                                               j
                                                               ,
                                                               t
                                                            
                                                            H
                                                         
                                                         ×
                                                         
                                                            O
                                                            H
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      t
                                                      T
                                                   
                                                   
                                                      I
                                                      N
                                                      
                                                         V
                                                         t
                                                      
                                                      ×
                                                      E
                                                      S
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                i
                                                I
                                             
                                             
                                                
                                                   ∑
                                                   j
                                                   J
                                                
                                                
                                                   
                                                      ∑
                                                      t
                                                      T
                                                   
                                                   
                                                      
                                                         D
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                      ×
                                                      
                                                         Q
                                                         
                                                            
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  j
                                                                  ,
                                                                  r
                                                                  =
                                                                  1
                                                                  ,
                                                                  t
                                                               
                                                            
                                                         
                                                         H
                                                      
                                                      ×
                                                      B
                                                   
                                                
                                             
                                             +
                                             
                                                ∑
                                                t
                                                T
                                             
                                             
                                                B
                                                E
                                                
                                                   G
                                                   t
                                                
                                                ×
                                                L
                                                C
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Constraints
                        
                           
                              (2)
                              
                                 
                                    O
                                    
                                       D
                                       t
                                    
                                    ×
                                    m
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ≥
                                    0
                                    ;
                                    
                                    
                                    ∀
                                    t
                                    ,
                                    
                                    
                                    
                                    
                                    k
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    B
                                    
                                       C
                                       t
                                    
                                    ×
                                    L
                                    S
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    t
                                    ,
                                    
                                    
                                    
                                    
                                    k
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ≤
                                    X
                                    C
                                    ×
                                    O
                                    
                                       D
                                       t
                                    
                                    ;
                                    
                                    
                                    ∀
                                    t
                                    ,
                                    
                                    
                                    
                                    
                                    k
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    E
                                    G
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          J
                                       
                                       
                                          
                                             ∑
                                             
                                                r
                                                =
                                                1
                                             
                                             R
                                          
                                          
                                             Q
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                r
                                                ,
                                                t
                                             
                                             H
                                          
                                          ×
                                          
                                             P
                                             r
                                          
                                          −
                                          D
                                          
                                             M
                                             t
                                          
                                       
                                    
                                    =
                                    I
                                    N
                                    
                                       V
                                       t
                                    
                                    −
                                    B
                                    E
                                    
                                       G
                                       t
                                    
                                    ;
                                    
                                    t
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    I
                                    N
                                    
                                       V
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          J
                                       
                                       
                                          
                                             ∑
                                             
                                                r
                                                =
                                                1
                                             
                                             R
                                          
                                          
                                             
                                                Q
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   r
                                                   ,
                                                   t
                                                
                                                H
                                             
                                             ×
                                             
                                                P
                                                r
                                             
                                          
                                          −
                                          D
                                          
                                             M
                                             t
                                          
                                       
                                    
                                    =
                                    I
                                    N
                                    
                                       V
                                       t
                                    
                                    −
                                    B
                                    E
                                    
                                       G
                                       t
                                    
                                    ;
                                    
                                    t
                                    >
                                    1
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          +
                                          1
                                          ,
                                          t
                                       
                                       P
                                    
                                    =
                                    I
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    k
                                    ≤
                                    K
                                    −
                                    1
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    t
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          +
                                          1
                                          ,
                                          t
                                          +
                                          1
                                       
                                       P
                                    
                                    =
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    k
                                    ≤
                                    K
                                    −
                                    1
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    t
                                    ≤
                                    T
                                    −
                                    1
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          +
                                          1
                                          ,
                                          t
                                       
                                       H
                                    
                                    =
                                    I
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                       
                                       H
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    r
                                    ≤
                                    R
                                    −
                                    1
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    t
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          +
                                          1
                                          ,
                                          t
                                          +
                                          1
                                       
                                       H
                                    
                                    =
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    r
                                    ≤
                                    R
                                    −
                                    1
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    t
                                    ≤
                                    T
                                    −
                                    1
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    =
                                    I
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    
                                    
                                    
                                    
                                    k
                                    =
                                    K
                                    ,
                                    
                                    
                                    
                                    
                                    r
                                    =
                                    1
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    
                                    t
                                    =
                                    1
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    =
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    
                                    k
                                    =
                                    K
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    r
                                    =
                                    1
                                    ,
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    1
                                    ≤
                                    t
                                    ≤
                                    T
                                    −
                                    1
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ≤
                                    
                                       C
                                       i
                                       P
                                    
                                    ×
                                    A
                                    
                                       C
                                       
                                          i
                                          ,
                                          t
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       C
                                       i
                                       P
                                    
                                    ×
                                    A
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ≥
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    k
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       A
                                       
                                          Q
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             t
                                          
                                          P
                                       
                                    
                                    =
                                    A
                                    
                                       C
                                       
                                          i
                                          ,
                                          t
                                       
                                       P
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       ∑
                                       
                                          r
                                          =
                                          1
                                       
                                       R
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    ≤
                                    
                                       C
                                       j
                                       H
                                    
                                    ×
                                    A
                                    
                                       C
                                       
                                          j
                                          ,
                                          t
                                       
                                       H
                                    
                                    ;
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       C
                                       j
                                       H
                                    
                                    ×
                                    A
                                    
                                       Q
                                       
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    ≥
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    ;
                                    
                                    
                                    ∀
                                    j
                                    ,
                                    r
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       ∑
                                       
                                          r
                                          =
                                          1
                                       
                                       R
                                    
                                    
                                       A
                                       
                                          Q
                                          
                                             j
                                             ,
                                             r
                                             ,
                                             t
                                          
                                          H
                                       
                                    
                                    =
                                    A
                                    
                                       C
                                       
                                          j
                                          ,
                                          t
                                       
                                       H
                                    
                                    ;
                                    
                                    
                                    ∀
                                    j
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                t
                                                
                                                   t
                                                   +
                                                   K
                                                   +
                                                   
                                                      C
                                                      P
                                                   
                                                   −
                                                   1
                                                
                                             
                                             
                                                A
                                                
                                                   C
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                   P
                                                
                                             
                                             ≤
                                             K
                                             ;
                                             
                                             
                                             ∀
                                             i
                                             ,
                                             
                                             
                                             
                                             
                                             
                                             1
                                             ≤
                                             t
                                             ≤
                                             T
                                             −
                                             K
                                             −
                                             
                                                C
                                                P
                                             
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             where
                                             
                                             
                                             
                                             T
                                             ≥
                                             K
                                             +
                                             
                                                C
                                                P
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                t
                                                
                                                   t
                                                   +
                                                   R
                                                   +
                                                   
                                                      C
                                                      H
                                                   
                                                   −
                                                   1
                                                
                                             
                                             
                                                A
                                                
                                                   C
                                                   
                                                      j
                                                      ,
                                                      t
                                                   
                                                   H
                                                
                                             
                                             ≤
                                             R
                                             ;
                                             
                                             
                                             ∀
                                             j
                                             ,
                                             
                                             
                                             
                                             
                                             
                                             1
                                             ≤
                                             t
                                             ≤
                                             T
                                             −
                                             R
                                             −
                                             
                                                C
                                                H
                                             
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             where
                                             
                                             
                                             
                                             T
                                             ≥
                                             R
                                             +
                                             
                                                C
                                                H
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       I
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          J
                                       
                                       
                                          Q
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             r
                                             ,
                                             t
                                          
                                          H
                                       
                                    
                                    ≤
                                    X
                                    C
                                    ;
                                    
                                    ∀
                                    t
                                    ,
                                    
                                    
                                    
                                    
                                    r
                                    =
                                    R
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                    B
                                    
                                       C
                                       t
                                    
                                    ,
                                    
                                    
                                    I
                                    N
                                    
                                       V
                                       t
                                    
                                    ,
                                    
                                    
                                    B
                                    E
                                    
                                       G
                                       t
                                    
                                    ,
                                    
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ,
                                    
                                    
                                    
                                       Q
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    ≥
                                    0
                                    ;
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    k
                                    ,
                                    r
                                    ,
                                    t
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    O
                                    
                                       D
                                       t
                                    
                                    ,
                                    
                                    
                                    A
                                    
                                       C
                                       
                                          i
                                          ,
                                          t
                                       
                                       P
                                    
                                    ,
                                    
                                    
                                    A
                                    
                                       C
                                       
                                          j
                                          ,
                                          t
                                       
                                       H
                                    
                                    ,
                                    
                                    
                                    A
                                    
                                       Q
                                       
                                          i
                                          ,
                                          k
                                          ,
                                          t
                                       
                                       P
                                    
                                    ,
                                    
                                    
                                    A
                                    
                                       Q
                                       
                                          j
                                          ,
                                          r
                                          ,
                                          t
                                       
                                       H
                                    
                                    
                                    
                                    ∈
                                    
                                    
                                    
                                       {
                                       
                                          0
                                          ,
                                          1
                                       
                                       }
                                    
                                    ;
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    k
                                    ,
                                    r
                                    ,
                                    t
                                 
                              
                           
                        
                     

This model is developed with the objective to minimize the total cost in planning horizon (see Eq. (1)). The first term is chick ordering cost. The second term is feed costs of pullets and hens. The third term is farm utilization cost. This cost can be farm renting from farmers in a contract farming system or operation and depreciation costs for raising hens if the firm owns the farms. The fourth term is eggs storage cost. The fifth term is the transportation cost from pullet houses to hen houses and the sixth term is egg demand shortage cost.

Constraints (2) and (3) ensure that chicks aged 1 week will be purchased and delivered to a pullet house. Constraint (4) ensures that the chick ordering in each time period must not exceed the capacity of the slaughterhouse. Constraints (5) and (6) determine the relationship among demands, inventory levels of egg, and planned quantities. Demand of eggs supplied in each time period, and total egg in-flow from each hen house and eggs stored in distribution center should be equal to total the egg out-flow to customer and eggs stored at time period 
                           
                              t
                              =
                              1
                           
                         and time period t > 1 respectively. Since there could be pullets on hands at the starting period (i.e., 
                           
                              t
                              =
                              1
                           
                        ) in each pullet house i, Constraint (7) is required to determine the age of the pullets from k weeks old since the last period (period 
                           
                              t
                              −
                              1
                           
                         or period 
                           
                              t
                              =
                              0
                           
                        ) to 
                           
                              k
                              +
                              1
                           
                         weeks old in the starting period. For example, if the pullets in pullet house i were 1 week old at period 
                           
                              t
                              −
                              1
                           
                        , then at the starting period, these pullets are 2 weeks of age. Constraint (8) is required to determine the age of the pullets in each pullet house for any period t where 
                           
                              1
                              ≤
                              t
                              ≤
                              T
                              −
                              1
                           
                        . In a similar way, Constraint (9) is required to determine the age of hens on hand in each hen house j at the starting period (i.e., 
                           
                              t
                              =
                              1
                           
                        ), while Constraint (10) is needed to determine the age of hens in each hen house for any period t where 
                           
                              1
                              ≤
                              t
                              ≤
                              T
                              −
                              1
                           
                        . Constraints (11) and (12) ensure that the pullets will remain in the pullet house until the age of K weeks. Then they are transferred to egg laying unit (hen house) to support egg production. Constraints set (13)–(18) ensure that the pullets and the laying hens in each house must not exceed its capacity. Constraints (19) and (20) ensure that chicks cannot be allocated to pullet house, and hens cannot be allocated to hen house until the cleaning stage is finished, respectively. Constraint (21) ensures that hens will remain in the hen house until the age of R weeks. Then they are slaughtered at the slaughterhouse with the total number of hens aged R weeks from all hen houses. The total number of hens transferred to the slaughterhouse must not exceed the slaughterhouse capacity in each time period. Relations (22) and (23) represent the types of variables.

When the size of problems becomes too large and too complicated to be solved by a mathematical model, particle swarm optimization (PSO) is typically employed. Particle swarm optimization was first proposed by Kennedy and Eberhart in 1995 (Kennedy & Eberhart, 1995). PSO is a population based random search method that imitates the physical movements of the individuals in the swarm as a searching mechanism. Within the swarm, the learning mechanisms are based on the cognitive and social behavior of particles. In the traditional PSO algorithm, it consists of a population of particles initialized with random positions and velocities. This population of particles is usually called a swarm.

In one iteration step, each particle is firstly evaluated to find each individual fitness or objective function value. For each particle, if a position is reached which has a better objective function than the previous best position, the personal best position (pbest) is updated. Also, if a current objective function is better than the previous best objective function of the whole swarm, the global best position (gbest) is updated. The velocity of each particle is then updated based on three terms: (1) the velocity term, (2) the gap between the current position and the particle's personal best position, and (3) the gap between the current position and the global best position found so far by the swarm. Every particle is then moved from the current position to the new position based on its updated velocity. The process repeats until the stopping criterion is met. The velocity and position of each particle are updated by the Eqs. (24) and (25), respectively.

                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                ω
                                                
                                                   l
                                                   h
                                                
                                             
                                             
                                                (
                                                τ
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             w
                                             
                                                (
                                                τ
                                                )
                                             
                                             
                                                ω
                                                
                                                   l
                                                   h
                                                
                                             
                                             
                                                (
                                                τ
                                                )
                                             
                                             +
                                             
                                                c
                                                p
                                             
                                             u
                                             
                                                (
                                                
                                                   ψ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                c
                                                g
                                             
                                             u
                                             
                                                (
                                                
                                                   ψ
                                                   
                                                      g
                                                      h
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       θ
                                       
                                          l
                                          h
                                       
                                    
                                    
                                       (
                                       τ
                                       +
                                       1
                                       )
                                    
                                    =
                                    
                                       θ
                                       
                                          l
                                          h
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                    +
                                    
                                       ω
                                       
                                          l
                                          h
                                       
                                    
                                    
                                       (
                                       τ
                                       +
                                       1
                                       )
                                    
                                 
                              
                           
                        where, ωlh
                        (τ) is the velocity of the lth particle at the hth dimension in the τth iteration, cp
                         and cg
                         are called cognitive and social coefficients, u are uniform random numbers in the interval [0,1]. ψlh
                         is the best previous position of the lth particle, θlh
                        (τ) is the position of the lth particle at the hth dimension in the τth iteration, and ψgh
                         is the best position among the whole swarm. w(τ) is the inertia weight in the τth iteration that exerts the effect of the old velocity on the new one.

For the traditional PSO, the component for social learning behavior includes only personal and global best positions. To solve a lot-sizing and scheduling problem for the poultry industry, the modified GLNPSO was thus proposed to improve the research solution. This technique is a hybrid approach based on the variant of PSO algorithm called GLNPSO developed by Pongchairerks and Kachitvichyanukul (2005, 2006) with the local search procedure. The GLNPSO algorithm is an extension of the traditional PSO where each particle communicates with multiple specific subsets of the swarm. Each particle consists of the personal best position (pbest), global best position (gbest), local best position (lbest), and near neighbor best position (nbest), for updating the particle velocities in order to improve the search performance. For each iteration step, a local search procedure with neighborhood search solution was used. Then the inertia weight is the parameter affecting particle movement. High inertia weight means that the particles tend to maintain the current direction and low inertia weight means the particles may be influenced more by the cognitive and social terms. The GLNPSO algorithm for the hen egg production planning is described and the notation used is as follows.
                     


                        
                           Notation


                           
                              τ
                           
                           
                              index for iteration; 
                                    
                                       τ
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       Γ
                                    
                                 
                              

index for re-initialization's iteration of particles; 
                                    
                                       r
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       R
                                       
                                          I
                                          
                                             m
                                             a
                                             x
                                          
                                       
                                    
                                 
                              

index for re-order's iteration of chick ordering; 
                                    
                                       r
                                       o
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       R
                                       
                                          O
                                          
                                             m
                                             a
                                             x
                                          
                                       
                                    
                                 
                              

index for particle; 
                                    
                                       l
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       L
                                    
                                 
                              

index for dimension; 
                                    
                                       h
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       H
                                    
                                 
                              

uniform random number in the interval [0,1]

random number generation of 0 or 1

local best position (lbest) of the lth particle at the hth dimension

near neighbor best position (nbest) of the lth particle at the hth dimension

number of adjacent neighbors

local best position acceleration constant

near neighbor best position acceleration constant

maximum position value

minimum position value

vector position of the lth particle, 
                                    
                                       [
                                       
                                          θ
                                          
                                             l
                                             1
                                          
                                       
                                       ,
                                       
                                          θ
                                          
                                             l
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          θ
                                          
                                             l
                                             H
                                          
                                       
                                       ]
                                    
                                 
                              

vector velocity of the lth particle, 
                                    
                                       [
                                       
                                          ω
                                          
                                             l
                                             1
                                          
                                       
                                       ,
                                       
                                          ω
                                          
                                             l
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ω
                                          
                                             l
                                             H
                                          
                                       
                                       ]
                                    
                                 
                              

vector personal best position of the lth particle, 
                                    
                                       [
                                       
                                          ψ
                                          
                                             l
                                             1
                                          
                                       
                                       ,
                                       
                                          ψ
                                          
                                             l
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ψ
                                          
                                             l
                                             H
                                          
                                       
                                       ]
                                    
                                 
                              

vector global best position, 
                                    
                                       [
                                       
                                          ψ
                                          
                                             g
                                             1
                                          
                                       
                                       ,
                                       
                                          ψ
                                          
                                             g
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ψ
                                          
                                             g
                                             H
                                          
                                       
                                       ]
                                    
                                 
                              

vector local best position of the lth particle, 
                                    
                                       [
                                       
                                          ψ
                                          
                                             
                                                
                                                
                                                   l
                                                   1
                                                
                                             
                                          
                                          L
                                       
                                       ,
                                       
                                          ψ
                                          
                                             
                                                
                                                
                                                   l
                                                   2
                                                
                                             
                                          
                                          L
                                       
                                       ,
                                       …
                                       ,
                                       
                                          ψ
                                          
                                             
                                                
                                                
                                                   l
                                                   K
                                                
                                             
                                          
                                          L
                                       
                                       ]
                                    
                                 
                              

the lth set of solutions

fitness value of Θl
                                 
                              

fitness-distance ratio

The GLNPSO is a population-based search method. A swarm of L particles is generated from a random position (Θl
                        ) in the range [θ
                        min , θ
                        max ] with a velocity (Ωl
                        ). In each GLNPSO iteration, the solution of particle (Rl
                        ) consists of chicks required in each time period and the allocation sequence of chicks to pullet house and hens to hen house based on a ranked-order value (ROV) rule with the fitness value of position, represented by Z(Θl
                        ). Since, the problem considered is very complex in terms of number of chicks purchased and delivered to the industry with the capacitated lot sizing and the allocation of chicken to farms, some parts of the GLNPSO algorithm are modified in order to determine the number of chicks ordered in each time period and suitably applied for allocation of chickens to farms. Therefore, after the decoding process, the local search algorithm is added. Finally, if the objective value does not improve, Re-initialization and Re-order processes are conducted.

In the GLNPSO procedure, there are four operations: solution initialization, local search generation, update the velocity and the position, and re-initialization and re-order operations. The overall steps of the GLNPSO are presented in Fig. 4
                         and details of each operation are presented below.
                     


                        
                           Step 1: Solution initialization
                     

A particle is a set of parameters which defines a proposed solution to the problem that the GLNPSO algorithm is trying to solve. Generating the initial population is a crucial part of the particle swarm optimization algorithm and a good initial population directly affects the quality of the solution. The design of the population and its parameters is represented in the encoding and decoding procedures as follows.
                     

1) Encoding step

In the encoding step, each particle in the swarm is separated into two parts. The first part is the number of chicks purchased and delivered to the poultry industry in each time period and the second part is the allocation of chicks and pullets to farms.


                        The first part of a particle: chick ordering part
                     

We adapted the hierarchy with 4-levels of production planning (egg demand, hen farming, pullet farming and chick ordering) and a lot for lot technique to determine the initial chick ordering. To understand the initial chick ordering process clearly, an example for the hen egg production planning problem is presented. To simplify the problem, Table 1
                         gives the egg demands for a small hen egg production planning problem with five
                         pullet houses and eight hen houses with five weeks of total time periods in the planning horizon. In this example, we consider the maximum ages of pullets and hens are two and three weeks, respectively. When pullets or hens are completely removed from houses, pullet houses and hen houses are cleaned within one and two weeks, respectively. At the starting period, the number of eggs stored in the distribution center is 3,000 eggs, the number of pullets on hand in pullet house No.3 with the age of two weeks (
                           
                              k
                              =
                              2
                           
                        ) is 6,000 and the number of layers on hand in hen house No.5 with the age of one week (
                           
                              r
                              =
                              1
                           
                        ) is 5,000. Total capacity of slaughterhouse is 10,000 chickens per week and the number of chicks per lot size is 1,000 chicks with the fixed cost of chick ordering being 1,000 units per order. For each week, feed cost of pullet and hen is one unit per chicken and holding cost for eggs is one unit per egg per time period. Hen transportation cost from pullet house to hen house is one unit per kilometer per hen and the demand shortage cost is five units per egg. To find the initial chick order in each period, the four steps of initial chick ordering process can be explained as follows.

In the first step, the total number of pullets and layers on hand at the starting period is converted into total layers on hand in each week. Then the number of hens needed in each week is obtained in the second step by considering egg demand in the planning horizon, total number of hens, and number of eggs stored at the starting period. In the third step, the number of hens to be ordered in terms of lot size is obtained by considering the minimum total cost consisting of ordering cost, feed cost of pullets and hens, transportation cost, inventory cost and demand shortage cost. Four strategies of chick ordering are considered: (1) Strategy 0: It is the case that there are no chicks to be ordered or the chick order quantity is zero. (2) Strategy 1: Lot Round Down strategy: In this case, the decrement of the chick ordering is one lot. (3) Strategy 2: Lot Round Up strategy: In this case, the increment of the chick ordering is one lot. (4) Strategy 3: Shifting order strategy: This case is performed to find the new solution of chick ordering in the Re-order operation. In this step, the number of hens to be ordered is derived from the minimum total cost between two strategies, strategy 1: Lot Round Down strategy and strategy 2: Lot Round Up strategy. However the maximum number of chicks to be ordered for either Strategies 1 or 2 must not exceed the maximum capacity of the firm's slaughterhouse. In the last step, the number of chicks purchased and delivered to the industry in each week is given by adapting the lot for lot technique with lead time of K weeks. The example of initial chick ordering from the first step to the final step is shown in Fig. 5.
                     


                        The second part of a particle: chick and pullet allocation part
                     

In the encoding step in the second part of the particle, the chick and pullet allocation to farms is randomly generated by a uniform number within [0,1] for the position of 
                           
                              I
                              +
                              J
                           
                         column and T row.
                     

2) Decoding step

In the decoding step, we present an ROV rule to convert the position in the second part of a particle to a sequence of the chick and pullet allocation to farms. The ROV rule is described as follows. For the first I positions (total number of pullet houses), the largest position value of a particle is first selected and assigned the smallest rank value 1, then the second largest position value is selected and assigned rank value 2. All of the I position values are handled to a sequence of chick allocations to farms. And the next J positions (total number of hen houses) are processed in the same way.

Illustrations of an initial particle obtained in the encoding step and the decoding step are shown in Fig. 6(a) and (b), respectively. Fig. 7
                        
                         gives an illustration of an example solution derived by Fig. 6.
                        
                     


                        
                           Step 2: Local search
                     

If chicks and hens are randomly allocated, the solution space may be enlarged, and a better solution may be found at the expense of computation time. Thus the local search algorithm is adopted to decide the new sequence of chicks and pullets allocated in each time period to rapidly converge to a better solution.

A local search procedure with neighborhood search solutions was used and is embedded in the PSO algorithm. The neighborhood search solution has various types of operations, including insert operation, swap operation, and 2-opt operation to solve problems. These operations are commonly embedded in PSO and other meta-heuristics. Let set N(X) be defined as the set of solutions neighboring a solution X from the allocation sequence of chicks or hens (the second part of the particle). For each particle, the next solution Y is randomly selected from N(X) either by an insert operation, swap operation or 2-opt operation. This process continues until the last neighborhood solution of X is reached.

The three solutions of the neighborhood search solution can be explained as follows: (1) the insert operation is performed by selecting the first position of X and inserting it into the position immediately before the randomly selected ith position of X (see Fig. 8(a)), (2) the swap operation is carried out by a randomly selected ith position of X and exchanged with the first position of X (see Fig. 8(b)) and (3) the 2-opt operation is implemented by selecting the first position of X and the random ith position of X, and then reversing the substring in the solution representation between them (see Fig. 8(c)).

In this paper the development of the local search algorithm is divided into two phases. In the first phase, chick allocation to pullet houses was considered and then pullet allocation to hen houses was performed in the second phase. The two parameters VC
                         and VP
                         are randomly generated between 0 or 1 as the probability to perform the local search for chick allocation phase and pullet allocation phase, respectively. If the local search has been done, time period (t) is randomly selected, and then the solution selected by randomly generating VR
                         in the range [0,1] for neighborhood search in order to generate a new solution (Yt
                        ) with the three cases: (1) by the insert operation, if VR
                         ≤ 1/3, (2) by the swap operation, if 1/3 < VR
                         ≤ 2/3 and (3) by the 2-opt operation, if 2/3 < VR
                         ≤ 1. The local search solution for the GLNPSO algorithm can be explained step by step as follows.

                           
                              
                                 
                                 
                                    
                                       
                                          
                                             Algorithm Local search
                                          
                                       
                                    
                                    
                                       1. Input:
                                          
                                             
                                                Θ
                                                l
                                             
                                          , 
                                             
                                                Ψ
                                                l
                                             
                                           , 
                                             
                                                Ψ
                                                g
                                             
                                          
                                       
                                    
                                    
                                       2. For
                                          
                                             
                                                l
                                                =
                                                1
                                                :
                                                L
                                             
                                          
                                       
                                    
                                    
                                       3. Random number generation 
                                             
                                                V
                                                C
                                             
                                           and 
                                             
                                                V
                                                P
                                             
                                           of 0 or 1
                                    
                                    
                                       4. If
                                          
                                             
                                                
                                                   V
                                                   C
                                                
                                                =
                                                
                                                =
                                                1
                                             
                                           // Perform local search for chick allocation to farm
                                    
                                    
                                       5. Then Random integer number generation 
                                             t
                                           = random [1,T]
                                    
                                    
                                       6. Generate a new solution 
                                             
                                                Y
                                                t
                                             
                                           based on allocation sequence of chicks at time period 
                                             t
                                           by generating 
                                             
                                                V
                                                R
                                             
                                          = random [0,1] to find the neighborhood search solution Endif
                                       
                                    
                                    
                                       7. If
                                          
                                             
                                                
                                                   V
                                                   P
                                                
                                                =
                                                
                                                =
                                                1
                                             
                                           // Perform local search for pullet allocation to farm
                                    
                                    
                                       8. Then Random integer number generation 
                                             t
                                           = random [1,T]
                                    
                                    
                                       9. Generate a new solution 
                                             
                                                Y
                                                t
                                             
                                           based on allocation sequence of hens at time period 
                                             t
                                           by generating 
                                             
                                                V
                                                R
                                             
                                          = random [0,1] to find the neighborhood search solution Endif
                                       
                                    
                                    
                                       10. If
                                          
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Θ
                                                      l
                                                   
                                                   )
                                                
                                                <
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      l
                                                   
                                                   )
                                                
                                             
                                           
                                          Then Update 
                                             
                                                
                                                   Ψ
                                                   l
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                           
                                          Endif
                                       
                                    
                                    
                                       11. If
                                          
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      l
                                                   
                                                   )
                                                
                                                <
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      g
                                                   
                                                   )
                                                
                                             
                                           
                                          Then update 
                                             
                                                
                                                   Ψ
                                                   g
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                           
                                          Endif
                                       
                                    
                                    
                                       12. 
                                             
                                                l
                                                ←
                                                l
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       13. Endfor
                                       
                                    
                                    
                                       14. Output:
                                          
                                             
                                                Θ
                                                l
                                             
                                          , 
                                             
                                                Ψ
                                                l
                                             
                                           and 
                                             
                                                Ψ
                                                g
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           Step 3: Update the velocity and the position
                     

In the next iteration, every particle moves from one position to the next position by the summing of five terms: (1) the current velocity term, (2) the personal best position term, (3) the global best position term, (4) the local best position term, and (5) the nearest neighbor best position term. In the current velocity term, the value of inertia weight (w) is used to improve the search ability by linearly decreasing it (Shi & Eberhart, 1998) as Eq. (26), and then Eq. (27) is applied as the updating velocity of each particle in each iteration and the next new position of the particle is updated by Eq. (25).

                           
                              (26)
                              
                                 
                                    w
                                    
                                       (
                                       τ
                                       )
                                    
                                    =
                                    w
                                    
                                       (
                                       Γ
                                       )
                                    
                                    +
                                    
                                       
                                          τ
                                          −
                                          Γ
                                       
                                       
                                          1
                                          −
                                          Γ
                                       
                                    
                                    
                                       [
                                       w
                                       
                                          (
                                          1
                                          )
                                       
                                       −
                                       w
                                       
                                          (
                                          Γ
                                          )
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                ω
                                                
                                                   l
                                                   h
                                                
                                             
                                             
                                                (
                                                τ
                                                
                                                +
                                                
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             w
                                             
                                                (
                                                τ
                                                )
                                             
                                             
                                                ω
                                                
                                                   l
                                                   h
                                                
                                             
                                             
                                                (
                                                τ
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                c
                                                p
                                             
                                             u
                                             
                                                (
                                                
                                                   ψ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                −
                                                
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                c
                                                g
                                             
                                             u
                                             
                                                (
                                                
                                                   ψ
                                                   
                                                      g
                                                      h
                                                   
                                                
                                                
                                                −
                                                
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                c
                                                l
                                             
                                             u
                                             
                                                (
                                                
                                                   ψ
                                                   
                                                      l
                                                      h
                                                   
                                                   L
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                c
                                                n
                                             
                                             u
                                             
                                                (
                                                
                                                   ψ
                                                   
                                                      l
                                                      h
                                                   
                                                   N
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where w(τ) is the inertia weight in the τth
                         iteration. w(1) and w(Γ) are the inertia weight in the first and the last iteration, respectively. If the next new position of particle reaches more than its the maximum (θ
                        max ) or less than its minimum (θ
                        min ) position value, then the next new position is updated by 
                           
                              
                                 θ
                                 
                                    l
                                    h
                                 
                              
                              
                                 (
                                 τ
                                 +
                                 1
                                 )
                              
                              =
                              
                                 θ
                                 max
                              
                           
                         or 
                           
                              
                                 θ
                                 
                                    l
                                    h
                                 
                              
                              
                                 (
                                 τ
                                 +
                                 1
                                 )
                              
                              =
                              
                                 θ
                                 min
                              
                           
                        , respectively. The process of GLNPSO is repeated until the maximum number of iterations (Γ) is reached.


                        
                           Step 4: Re-initialization and Re-order
                     

During training, if the maximum number of re-initialization iterations of particles reaches (RImax
                        ), the Re-initialization solution will be performed to increase the ability to avoid being trapped in a local optimal solution by randomly generating a new solution in the second part of all particles.

In the case of the maximum number of re-order's iteration of chick ordering reaches (ROmax
                        ), the Re-order of chick ordering operation will be performed to find the new solution of chick ordering. We consider two strategies, Shifting order and Reverse order, to determine the chick ordering (the first part of the particle) in order to obtain a new solution by randomly applying the two strategies.

The key concept of the Shifting order strategy is to reduce the chick ordering cost. After the Shifting order operation is performed to the number of chicks ordered, the strategy in that period is represented by Strategy 3. Fig. 9(
                        a) illustrates this strategy. In the first step, the new solution (a′) is performed by randomly selecting the first time period with non-zero chicks ordered (t
                        1) between t = 1 to T - 1 from the current solution (a). Then the next time period with non-zero chicks to be ordered (t
                        2) is selected by incrementing 1 time period. Finally, the new solution is obtained by shifting the number of chicks ordered from period t
                        2to period t
                        1 by the Eq. (28).

                           
                              (28)
                              
                                 
                                    
                                       a
                                       
                                          t
                                          1
                                       
                                       ′
                                    
                                    =
                                    
                                       a
                                       
                                          t
                                          1
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          ⌈
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      t
                                                      2
                                                   
                                                
                                                /
                                                L
                                                S
                                                )
                                             
                                             ×
                                             
                                                (
                                                1
                                                /
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      (
                                                      
                                                         t
                                                         2
                                                      
                                                      −
                                                      
                                                         t
                                                         1
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          ⌉
                                       
                                       ×
                                       
                                          (
                                          L
                                          S
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Then update the number of chicks to be ordered 
                           
                              
                                 a
                                 
                                    t
                                    2
                                 
                                 ′
                              
                              ←
                              0
                           
                         and also the Strategies for t
                        1 and t
                        2 to 3 and 0, respectively. If t
                        2reaches the maximum for the time period (
                           
                              
                                 t
                                 2
                              
                              =
                              T
                           
                        ) and the number of chicks to be ordered is zero, the new solution is obtained by 
                           
                              
                                 a
                                 
                                    t
                                    1
                                 
                                 ′
                              
                              ←
                              
                                 a
                                 
                                    t
                                    1
                                 
                              
                           
                        and also updating the Strategy for t
                        1 to 3.

For the second strategy, called Reverse order, an example of this strategy is illustrated in Fig. 9(b). In the first step, the new solution (a′) is generated randomly by selecting the time period with non-zero chicks to be ordered (t
                        1) between t = 1 to T from the current solution (a).Then reverse the number of chicks to be ordered between Strategies 1 and 2. If the number of chicks to be ordered is Strategy 3, the new solution is performed by randomly selecting lot size quantity from either Strategies 1 or 2, and then updating the new solution by that selected Strategy.

The GLNPSO algorithm can be explained step by step as follows:

                           
                              
                                 
                                 
                                    
                                       1. Input: problem data and GLNPSO parameters
                                    
                                    
                                       2. 
                                             
                                                τ
                                                ←
                                                1
                                             
                                          , 
                                             
                                                r
                                                i
                                                ←
                                                1
                                             
                                          , 
                                             
                                                r
                                                o
                                                ←
                                                1
                                             
                                          
                                       
                                    
                                    
                                       3. For
                                          
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , Generate the 
                                             
                                                l
                                                th
                                             
                                           particle with the initial chick ordering and the random position 
                                             
                                                
                                                   Θ
                                                   l
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                             
                                           in the range 
                                             
                                                [
                                                
                                                   θ
                                                   min
                                                
                                                ,
                                                
                                                   θ
                                                   max
                                                
                                                ]
                                             
                                          , velocity 
                                             
                                                
                                                   Ω
                                                   l
                                                
                                                =
                                                0
                                             
                                           and personal best 
                                             
                                                
                                                   Ψ
                                                   l
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                           
                                          Endfor
                                       
                                    
                                    
                                       4. While
                                          
                                             
                                                τ
                                                ≤
                                                Γ
                                             
                                          
                                       
                                    
                                    
                                       5. For
                                          
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , decode 
                                             
                                                
                                                   Θ
                                                   l
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                             
                                           to a solution 
                                             
                                                R
                                                l
                                             
                                           and compute the performance measurement of 
                                             
                                                R
                                                l
                                             
                                          , and set this as the fitness value of 
                                             
                                                Θ
                                                l
                                             
                                          , represented by 
                                             
                                                Z
                                                (
                                                
                                                   Θ
                                                   l
                                                
                                                )
                                             
                                           
                                          Endfor
                                       
                                    
                                    
                                       6. For
                                          
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , update 
                                             
                                                
                                                   Ψ
                                                   l
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                          , if 
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Θ
                                                      l
                                                   
                                                   )
                                                
                                                <
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      l
                                                   
                                                   )
                                                
                                             
                                           and update 
                                             
                                                Ψ
                                                g
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                          , if 
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      l
                                                   
                                                   )
                                                
                                                <
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      g
                                                   
                                                   )
                                                
                                             
                                           
                                          Endfor
                                       
                                    
                                    
                                       7. For
                                          
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , perform the local search solution on 
                                             
                                                Θ
                                                l
                                             
                                          , update 
                                             
                                                
                                                   Ψ
                                                   l
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                          , if 
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Θ
                                                      l
                                                   
                                                   )
                                                
                                                <
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      l
                                                   
                                                   )
                                                
                                             
                                           and update 
                                             
                                                
                                                   Ψ
                                                   g
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                          , if 
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      l
                                                   
                                                   )
                                                
                                                <
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      g
                                                   
                                                   )
                                                
                                             
                                           
                                          Endfor
                                       
                                    
                                    
                                       8. For
                                          
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , among all pbest from G neighbors of the 
                                             
                                                l
                                                th
                                             
                                           particle, set the personal best which obtains the least fitness value to be 
                                             
                                                Ψ
                                                l
                                                L
                                             
                                           
                                          Endfor
                                       
                                    
                                    
                                       9. For
                                          
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , and 
                                             
                                                h
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                H
                                             
                                          , set 
                                             
                                                
                                                   ψ
                                                   
                                                      l
                                                      h
                                                   
                                                   N
                                                
                                                =
                                                
                                                   ψ
                                                   
                                                      o
                                                      h
                                                   
                                                
                                             
                                           that maximizes fitness-distance ratio (
                                             
                                                F
                                                D
                                                R
                                             
                                          ) for 
                                             
                                                o
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                          , where 
                                             
                                                F
                                                D
                                                R
                                             
                                           is defined as: 
                                             
                                                F
                                                D
                                                R
                                                =
                                                
                                                   
                                                      Z
                                                      
                                                         (
                                                         
                                                            Θ
                                                            l
                                                         
                                                         )
                                                      
                                                      −
                                                      Z
                                                      
                                                         (
                                                         
                                                            Ψ
                                                            o
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         θ
                                                         
                                                            l
                                                            h
                                                         
                                                      
                                                      −
                                                      
                                                         ψ
                                                         
                                                            o
                                                            h
                                                         
                                                      
                                                      
                                                         |
                                                      
                                                   
                                                
                                                ;
                                                
                                                
                                                l
                                                ≠
                                                o
                                             
                                           
                                          Endfor
                                       
                                    
                                    
                                       10. Update the inertia weight as: 
                                             
                                                w
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                =
                                                w
                                                
                                                   (
                                                   Γ
                                                   )
                                                
                                                +
                                                
                                                   
                                                      τ
                                                      −
                                                      Γ
                                                   
                                                   
                                                      1
                                                      −
                                                      Γ
                                                   
                                                
                                                
                                                   [
                                                   w
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   −
                                                   w
                                                   
                                                      (
                                                      Γ
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                    
                                       11. Update the velocity and position of each 
                                             
                                                l
                                                th
                                             
                                           particle as:
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ω
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                w
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                
                                                   ω
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   p
                                                
                                                u
                                                
                                                   (
                                                   
                                                      ψ
                                                      
                                                         l
                                                         h
                                                      
                                                   
                                                   −
                                                   
                                                      θ
                                                      
                                                         l
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   g
                                                
                                                u
                                                
                                                   (
                                                   
                                                      ψ
                                                      
                                                         g
                                                         h
                                                      
                                                   
                                                   −
                                                   
                                                      θ
                                                      
                                                         l
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                +
                                                
                                                   c
                                                   l
                                                
                                                u
                                                
                                                   (
                                                   
                                                      ψ
                                                      
                                                         l
                                                         h
                                                      
                                                      L
                                                   
                                                   −
                                                   
                                                      θ
                                                      
                                                         l
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   n
                                                
                                                u
                                                
                                                   (
                                                   
                                                      ψ
                                                      
                                                         l
                                                         h
                                                      
                                                      N
                                                   
                                                   −
                                                   
                                                      θ
                                                      
                                                         l
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                                +
                                                
                                                   ω
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       12. If
                                          
                                             
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                >
                                                
                                                   θ
                                                   max
                                                
                                             
                                           
                                          Then
                                          
                                             
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                
                                                   θ
                                                   max
                                                
                                                ;
                                                
                                                
                                                
                                                
                                                   ω
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                0
                                             
                                           
                                          Endif
                                       
                                    
                                    
                                       13. If
                                          
                                             
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                <
                                                
                                                   θ
                                                   min
                                                
                                             
                                           
                                          Then
                                          
                                             
                                                
                                                   θ
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                
                                                   θ
                                                   min
                                                
                                                ;
                                                
                                                
                                                
                                                
                                                   ω
                                                   
                                                      l
                                                      h
                                                   
                                                
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                0
                                             
                                           
                                          Endif
                                       
                                    
                                    
                                       14. If
                                          
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      g
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                   )
                                                
                                                ≥
                                                Z
                                                
                                                   (
                                                   
                                                      Ψ
                                                      g
                                                   
                                                   
                                                      (
                                                      τ
                                                      −
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                             
                                           
                                          Then
                                          
                                             
                                                r
                                                i
                                                ←
                                                r
                                                i
                                                +
                                                1
                                             
                                          , 
                                             
                                                r
                                                o
                                                ←
                                                r
                                                o
                                                +
                                                1
                                             
                                          
                                          Endif
                                       
                                    
                                    
                                       15. If
                                          
                                             
                                                r
                                                i
                                                =
                                                R
                                                
                                                   I
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                             
                                          
                                          Then Generate the 
                                             
                                                l
                                                th
                                             
                                           particle with random position 
                                             
                                                
                                                   Θ
                                                   l
                                                
                                                
                                                   (
                                                   τ
                                                   )
                                                
                                             
                                           in the range 
                                             
                                                [
                                                
                                                   θ
                                                   min
                                                
                                                ,
                                                
                                                   θ
                                                   max
                                                
                                                ]
                                             
                                          , velocity 
                                             
                                                
                                                   Ω
                                                   l
                                                
                                                =
                                                0
                                             
                                           and personal best 
                                             
                                                
                                                   Ψ
                                                   l
                                                
                                                =
                                                
                                                   Θ
                                                   l
                                                
                                             
                                           for 
                                             
                                                l
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                L
                                             
                                           and set 
                                             
                                                r
                                                i
                                                ←
                                                1
                                             
                                          
                                          Endif
                                       
                                    
                                    
                                       16. If
                                          
                                             
                                                r
                                                o
                                                =
                                                R
                                                
                                                   O
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                             
                                          
                                          Then Re-order operation to chick ordering and set 
                                             
                                                r
                                                o
                                                ←
                                                1
                                             
                                          
                                          Endif
                                       
                                    
                                    
                                       17. 
                                             
                                                τ
                                                ←
                                                τ
                                                +
                                                1
                                             
                                           
                                          Endwhile
                                       
                                    
                                    
                                       18. Output:
                                          
                                             
                                                R
                                                l
                                             
                                           and 
                                             
                                                Z
                                                (
                                                
                                                   Θ
                                                   l
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This research was motivated by the interest of a semi-industrial production firm in northeastern Thailand. Currently, the total number of laying hens in its farms is about 1,900,000 hens with a daily production of 1,500,000 eggs. Presently, the weekly chicks order volumes from hatcheries of the case-study company depend on egg demand volumes in the planning horizon. Then the chicks are transferred to the contracted pullet-raising farms. When the pullets are 17 weeks old, they are moved to a laying unit (i.e. hen houses). To transport the hens, the firm has a contract with a third-party transport provider. These hens will remain in the hen house until the age of 75 weeks for egg production. After that, they are slaughtered at the firm's slaughter house.

To allocate chicken to pullet houses and hen houses, two major factors are considered, namely, sizes of the pullet houses and distance between the pullet houses and the hen houses. Currently, the company gives priority to the largest pullet house size to minimize the total number of houses used. To allocate the hens, the firm gives priority to the shortest distance between the pullet houses and the hen houses in order to minimize the traveling distance of the truck. If there are several hen houses with the same distance, the hen house will be selected in the order of larger size.

In this section, the performance of GLNPSO in the hen egg production planning problem was validated by comparing the optimal solution obtained by the MPL/CPLEX software and the traditional PSO. The performance of the proposed methods in terms of the total cost was tested by using 12 randomly generated test instances. The parameters for each instance are given in Table 2
                        
                        
                        . To solve the problem, the traditional PSO and the GLNPSO algorithms were developed using Matlab version 7.9.0.529 on Intel® Core™ i5 processor (2.4 gigahertz), with 3.00 gigabytes of RAM.

For each problem number, the values of weekly order volumes on egg demand in the planning horizon are approximately 50,000–275,000 eggs per week. The chicks are purchased by applying lot size discipline. The number of chicks per lot size (LS) is 1,000 chicks and the pullet-raising farms have heterogeneous capacities ranging from 7,000–14,000 pullets per house. When the pullets are two weeks old (
                           
                              K
                              =
                              2
                           
                        ), they are moved to a laying unit (i.e., hen houses) within a radius of 2–30 kilometers from the pullets farms. These hens will remain in the hen house until the age of five weeks (
                           
                              R
                              =
                              3
                           
                        ) for egg production with the production rate of eggs from laying hens for all ages being seven eggs per week (
                           
                              
                                 P
                                 1
                              
                              ,
                              
                                 P
                                 2
                              
                              ,
                              
                                 P
                                 3
                              
                              =
                              7
                           
                        ). The capacity of the hen houses ranges from 4,000–15,000 laying hens per house. Moving pullets or hens from the houses means complete removal. Then the pullet houses and hen houses are cleaned within one (
                           
                              
                                 C
                                 P
                              
                              =
                              1
                           
                        ) and two (
                           
                              
                                 C
                                 H
                              
                              =
                              2
                           
                        ) weeks, respectively.

To solve the problems, six major factors of cost are determined: (1) chick ordering cost is 1,000 units per order (
                           
                              A
                              =
                              1
                              ,
                              000
                           
                        ); (2) feed costs of pullets and hens are one per chicken per week (
                           
                              
                                 F
                                 P
                              
                              ,
                              
                                 F
                                 H
                              
                              =
                              1
                           
                        ); (3) farm utilization cost of pullet house and hen house is 1,000 units per house per week (
                           
                              
                                 O
                                 P
                              
                              ,
                              
                                 O
                                 H
                              
                              =
                              1
                              ,
                              000
                           
                        ); (4) holing cost of eggs is one unit per egg per week (
                           
                              E
                              S
                              =
                              1
                           
                        ); (5) transportation cost of pullets from pullet house to hen house depending on transportation distance is one unit per kilometer (
                           
                              T
                              R
                              C
                              =
                              1
                           
                        ) and (6) egg demand shortage cost is five units per egg (
                           
                              L
                              C
                              =
                              5
                           
                        ).

In order to determine the suitable control parameters of the proposed algorithm (i.e., GLNPSO), the values of these parameters were initially set with respect to the empirical schemes from the study of Ai and Kachitvichyanukul (2007). After performing the experiments, parameter are set as 
                           
                              G
                              =
                              5
                           
                        , 
                           
                              
                                 c
                                 p
                              
                              =
                              1
                           
                        , 
                           
                              
                                 c
                                 g
                              
                              =
                              1
                           
                        , 
                           
                              
                                 c
                                 l
                              
                              =
                              1
                           
                        , 
                           
                              
                                 c
                                 n
                              
                              =
                              1
                           
                         and the inertia weight(w) is set to linearly decrease from 0.9 to 0.4. Additionally, other control parameters used in the GLNPSO algorithm are presented in Table 3.
                     

In this paper, two quantities are investigated: (1) the performance of the proposed heuristic algorithm, obtained by comparing its solutions to the optimal solution, and (2) the relative improvement of the solutions obtained by the firm's current practice with respect to those of traditional PSO and the GLNPSO algorithms.

To evaluate the proposed heuristic algorithms, two performance measures are used: (1) solution quality, and (2) computational speed. The computational speed of the proposed algorithms is measured by the amount of CPU time required to execute the algorithms. The CPU time is reported in seconds. The quality of a solution generated by the proposed heuristic algorithms (traditional PSO and GLNPSO) is measured in terms of their performance (P) as presented below:

                           
                              (29)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             let
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             P
                                             =
                                             (
                                             S
                                             o
                                             
                                                l
                                                
                                                   o
                                                   p
                                                   t
                                                
                                             
                                             /
                                             S
                                             o
                                             
                                                l
                                                
                                                   h
                                                   e
                                                   u
                                                
                                             
                                             )
                                             ×
                                             100
                                          
                                       
                                    
                                 
                              
                           
                        where


                        P = the proposed heuristic performance (percent)


                        Solopt
                         = the optimal solution


                        Solheu
                         = the solution obtained from the proposed heuristic algorithms

Moreover, a comparison between the firm's current practice and the proposed heuristic algorithms is also performed. The relative improvement (RI) of the solutions obtained from the current practice after applying the proposed heuristic algorithms is evaluated and presented below:

                           
                              (30)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             let
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             R
                                             I
                                             
                                             =
                                             
                                             (
                                             
                                                (
                                                S
                                                o
                                                
                                                   l
                                                   
                                                      c
                                                      u
                                                      r
                                                   
                                                
                                                −
                                                S
                                                o
                                                
                                                   l
                                                   
                                                      h
                                                      e
                                                      u
                                                   
                                                
                                                )
                                             
                                             /
                                             S
                                             o
                                             
                                                l
                                                
                                                   c
                                                   u
                                                   r
                                                
                                             
                                             )
                                             ×
                                             100
                                          
                                       
                                    
                                 
                              
                           
                        where


                        RI = the relative improvement (percent) between Solcur
                         and Solheu
                        
                     


                        Solcur
                         = the solution obtained from the current practice


                        Solheu
                         = the solution obtained from the proposed heuristic algorithms

The following Table 4
                        
                        
                         shows the solution quality in terms of the total cost of the optimal solutions with those of the firm's current practice and the proposed heuristic algorithms (traditional PSO and GLNPSO) obtained on 10 runs for each instance. The standard deviation indicates the stable performance of the proposed heuristic algorithms during the 10 executions and is also presented in Table 4. From this table, we can see that the GLNPSO yields low standard deviation for small sized instances (Problem 1–8) since the planning horizon is short resulting to no various solutions. Therefore, the solution obtained in each replication is very close to the optimal solution. On the other hand, the traditional PSO yields higher standard deviation since the solution obtained in each replication is scattered due to premature convergence of local minima. Considering large size problems (Problems 9–12), since the planning horizon is very long, there are various solution in search space. Hence, in some replications, the solutions obtained are close to optimal solutions, while the other swarms move far from the optimal ones. For the traditional PSO, it yields lower standard deviation since it has not included a local search algorithm (re-initialization and re-ordering strategies) to diversify solutions in search space.

The solution with symbol “a” means the best feasible solution given by the MPL/CPLEX, which is an estimated value since the CPLEX optimizer ran out of memory and the solution with symbol “b” means the optimal solution cannot be obtained by the MPL/CPLEX since the problem is too large to be solved by MPL/CPLEX. It can be seen that the proposed GLNPSO algorithm can find the optimal solution for 5 out of the 8 problem numbers, and 29 out of 80 replicated runs. Based on these results, the performance of the heuristic algorithm (P) of the total cost and the relative improvement (RI) of the solutions obtained from the current practice after applying the traditional PSO and the GLNPSO algorithms are presented in Table 5. From this table, we can observe that the performance of the heuristic algorithm (P) of the total cost ranges from 92.72 to 99.89 percent, with an average of 98.18 percent for the GLNPSO algorithm, and 87.92 to 99.66 percent, with an average of 94.57 percent for the traditional PSO algorithm.

To evaluate the performance on the total cost of the traditional PSO and the GLNPSO algorithms, the analysis was carried out using SPSS Software V14 for Windows. Fig. 10 shows the paired samples tests of MPL/CPLEX performed to compare the total cost of the traditional PSO and the GLNPSO algorithms. Results of the tests indicate that the solutions obtained from both algorithms were not significantly different at 
                           
                              α
                              =
                              0.05
                           
                         compared to those obtained from the mathematical model. However, there are significant differences on the total cost of the traditional PSO algorithm compared with the GLNPSO algorithms (see Fig. 11). For the relative improvement (RI) which compares the total cost of the solutions obtained from the current practice after applying the traditional PSO and the GLNPSO algorithms, the results show that the GLNPSO algorithm provides better total cost value than the firm's current practice, ranging from 9.41 to 40.48 percent (with an average of 31.67 percent) and the traditional PSO algorithm provides better total cost value than the firm's current practice, ranging from 9.20 to 36.41 percent (with an average of 27.75 percent).

The minimal, average and maximal values of the computation speeds (CPU time) of all problem numbers are shown in Table 6
                        . From this table, with the growth of problem size, the MPL/CPEX approach cannot solve the large size problems due to the memory restriction. Fig. 12 shows that the CPU time of MPL/CPLEX expands rapidly with the scale of the problem size, and the CPU times for the traditional PSO and the GLNPSO are lower than that of MPL/CPLEX. This means that the GLNPSO can save computation time and also has more opportunity to get better solutions. GLNPSO also provides slightly lower total cost values than the traditional PSO algorithm. The convergence behaviors of the GLNPSO and the traditional PSO methods were tested. Fig. 13, for instance, shows the convergence behaviors of the GLNPSO and the traditional PSO methods in the iteration of solutions for problem number 8. The results indicate that the proposed GLNPSO yields better solutions than those of the traditional PSO for all problem instances, especially for large-sized
                         problems.

This paper has dealt with an integrated model for multi-level production lot-sizing and scheduling in order to minimize the total cost. A heuristic solution procedure based on the GLNPSO algorithm was developed. The local search procedure with neighborhood search solutions including insert operation, swap operation, and 2-opt operation were applied to speed up the algorithm. In order to avoid being trapped into a local optimum, the Re-initialization and the Re-order strategy were used to improve the possibility of finding an optimal solution in the searching space.

The proposed heuristic performance (P) was used to measure the performance of the proposed algorithms by comparing their solutions to the optimal solution in terms of the total cost. The experimental results showed that the GLNPSO algorithm obtained a near-optimal solution ranging from 92.72 to 99.89 percent, with an average of 98.18 percent, and with a stable performance as indicated by the standard deviation values. From the numerical experiments, it was found that the proposed GLNPSO method yielded the optimal solution, especially in the small-size problems (problem numbers 1 to 4) ranging between 4–9 runs out of 10 replicated runs. The statistical results obtained from paired sample tests performed to compare the total cost of the traditional PSO and the GLNPSO algorithms show that the proposed GLNPSO was significantly better than the traditional PSO. Moreover, the computational time of the GLNPSO algorithm is lower than that of the CPLEX optimizer, especially for the large-size problem.

Additionally, the performance of the heuristic algorithm was measured using the relative improvement (RI), which compared the total cost of the solutions obtained from the firm's current practice after applying the traditional PSO and the GLNPSO algorithms. The results obtained from this study show that the GLNPSO algorithm provided better total cost values than the firm's current practice, ranging from 9.41 to 40.48 percent (with an average of 31.67 percent), and 0.23 to 16.46 percent (with an average of 5.50 percent) better than the traditional PSO algorithm. The proposed GLNPSO also has convergent behavior and yields better solutions than the traditional PSO method for all test instances. The mathematical and heuristic models developed in this paper are easily adaptable and should prove to be beneficial to other poultry industries and other similar agro-food sectors in Thailand and around the world.

However, there is still much opportunity to extend our work in many aspects. To reduce farm utilization cost, mixing of chickens with different ages in the same hen house should be allowed with a certain maximum age difference. Another valuable avenue for future research is to consider some other parameters of the problem as fuzzy variables. Additionally, although the proposed GLNPSO algorithm has shown an outstanding ability to solve the problem at hand, there is a possibility to use hybrid methods

@&#ACKNOWLEDGMENTS@&#

This work was supported by the Higher Education Research Promotion and National Research University Project of Thailand, Office of the Higher Education Commission, through the Food and Functional Food Research Cluster of Khon Kaen University and collaboration with the Research Unit on System Modeling for Industry, Khon Kaen University, Thailand.

@&#REFERENCES@&#

